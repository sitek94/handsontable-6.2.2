import{g as Ll,a as Tb,c as Uo,R as wr,b as mw,r as Qc,j as ln}from"./index-D0RCfcAN.js";function _g(e){return kb(e)||Rb(e)||Ob()}function Ob(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function Rb(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}function kb(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}var eh=new Map;function Bi(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";eh.has(e)||eh.set(e,new Map);var r=eh.get(e);function t(s,l){r.set(s,l)}function n(s){return r.get(s)}function i(s){return r.has(s)}function a(){return _g(r.keys())}function o(){return _g(r.values())}return{register:t,getItem:n,hasItem:i,getNames:a,getValues:o}}function pw(e){for(var r=e.length,t=0;t<r;)e[t]=[e[t]],t+=1}function S0(e,r){for(var t=r.length,n=0;n<t;)e.push(r[n]),n+=1}function yw(e){var r=[];if(!e||e.length===0||!e[0]||e[0].length===0)return r;for(var t=e.length,n=e[0].length,i=0;i<t;i++)for(var a=0;a<n;a++)r[a]||(r[a]=[]),r[a][i]=e[i][a];return r}function hn(e,r,t,n){var i=-1,a=e,o=t;Array.isArray(e)||(a=Array.from(e));var s=a.length;for(n&&s&&(i+=1,o=a[i]),i+=1;i<s;)o=r(o,a[i],i,a),i+=1;return o}function da(e,r){var t=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var i=n.length,a=[],o=-1;t<i;){var s=n[t];r(s,t,n)&&(o+=1,a[o]=s),t+=1}return a}function Zt(e,r){var t=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var i=n.length,a=[],o=-1;t<i;){var s=n[t];o+=1,a[o]=r(s,t,n),t+=1}return a}function pe(e,r){var t=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var i=n.length;t<i&&r(n[t],t,n)!==!1;)t+=1;return e}function ww(e){return hn(e,function(r,t){return r+t},0)}function _w(e){return hn(e,function(r,t){return r>t?r:t},Array.isArray(e)?e[0]:void 0)}function Ab(e){return hn(e,function(r,t){return r<t?r:t},Array.isArray(e)?e[0]:void 0)}function Mb(e){return e.length?ww(e)/e.length:0}function b0(e){return hn(e,function(r,t){return r.concat(Array.isArray(t)?b0(t):t)},[])}function Db(e){var r=[];return pe(e,function(t){r.indexOf(t)===-1&&r.push(t)}),r}const Pb=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:Mb,arrayEach:pe,arrayFilter:da,arrayFlatten:b0,arrayMap:Zt,arrayMax:_w,arrayMin:Ab,arrayReduce:hn,arraySum:ww,arrayUnique:Db,extendArray:S0,pivot:yw,to2dArray:pw},Symbol.toStringTag,{value:"Module"}));function Cg(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function io(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?io=function(t){return typeof t}:io=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},io(e)}function as(e){var r;return Array.isArray(e)?r=[]:(r={},St(e,function(t,n){n!=="__children"&&(t&&io(t)==="object"&&!Array.isArray(t)?r[n]=as(t):Array.isArray(t)?t.length&&io(t[0])==="object"&&!Array.isArray(t[0])?r[n]=[as(t[0])]:r[n]=[]:r[n]=null)})),r}function Wi(e,r){return r.prototype.constructor=r,e.prototype=new r,e.prototype.constructor=e,e}function pn(e,r){return St(r,function(t,n){e[n]=t}),e}function Il(e,r){St(r,function(t,n){r[n]&&io(r[n])==="object"?(e[n]||(Array.isArray(r[n])?e[n]=[]:Object.prototype.toString.call(r[n])==="[object Date]"?e[n]=r[n]:e[n]={}),Il(e[n],r[n])):e[n]=r[n]})}function Wr(e){return io(e)==="object"?JSON.parse(JSON.stringify(e)):e}function gu(e){var r={};return St(e,function(t,n){r[n]=t}),r}function vi(e){e.MIXINS||(e.MIXINS=[]);for(var r=arguments.length,t=new Array(r>1?r-1:0),n=1;n<r;n++)t[n-1]=arguments[n];return pe(t,function(i){e.MIXINS.push(i.MIXIN_NAME),St(i,function(a,o){if(e.prototype[o]!==void 0)throw new Error("Mixin conflict. Property '".concat(o,"' already exist and cannot be overwritten."));if(typeof a=="function")e.prototype[o]=a;else{var s=function(f,c){var h="_".concat(f),d=function(v){var p=v;return(Array.isArray(p)||Rt(p))&&(p=Wr(p)),p};return function(){return this[h]===void 0&&(this[h]=d(c)),this[h]}},l=function(f){var c="_".concat(f);return function(h){this[c]=h}};Object.defineProperty(e.prototype,o,{get:s(o,a),set:l(o),configurable:!0})}})}),e}function x0(e,r){return JSON.stringify(e)===JSON.stringify(r)}function Rt(e){return Object.prototype.toString.call(e)==="[object Object]"}function os(e,r,t,n){n.value=t,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(e,r,n)}function St(e,r){for(var t in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,t))&&r(e[t],t,e)===!1)break;return e}function $h(e,r){var t=r.split("."),n=e;return St(t,function(i){if(n=n[i],n===void 0)return n=void 0,!1}),n}function E0(e){if(!Rt(e))return 0;var r=function t(n){var i=0;return Rt(n)?St(n,function(a){i+=t(a)}):i+=1,i};return r(e)}function Hl(e){var r,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",n="_".concat(t),i=(r={_touched:!1},Cg(r,n,e),Cg(r,"isTouched",function(){return this._touched}),r);return Object.defineProperty(i,t,{get:function(){return this[n]},set:function(o){this._touched=!0,this[n]=o},enumerable:!0,configurable:!0}),i}function At(e,r){return Object.prototype.hasOwnProperty.call(e,r)}const Nb=Object.freeze(Object.defineProperty({__proto__:null,clone:gu,createObjectPropListener:Hl,deepClone:Wr,deepExtend:Il,deepObjectSize:E0,defineGetter:os,duckSchema:as,extend:pn,getProperty:$h,hasOwnProperty:At,inherit:Wi,isObject:Rt,isObjectEqual:x0,mixin:vi,objectEach:St},Symbol.toStringTag,{value:"Module"}));function Fb(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Sg(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function bg(e,r,t){return r&&Sg(e.prototype,r),t&&Sg(e,t),e}var Oo=["afterCellMetaReset","afterChange","afterChangesObserved","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","afterRender","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeRender","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyCol","unmodifyCol","unmodifyRow","modifyColHeader","modifyColWidth","modifyRow","modifyRowHeader","modifyRowHeight","modifyData","modifyRowData","modifyGetCellCoords","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnMove","afterColumnMove","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","modifyColumnHeaderHeight","beforeUndo","afterUndo","beforeRedo","afterRedo","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","skipLengthCache","afterTrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","hiddenRow","hiddenColumn","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten"],at=function(){bg(e,null,[{key:"getSingleton",value:function(){return Ib()}}]);function e(){Fb(this,e),this.globalBucket=this.createEmptyBucket()}return bg(e,[{key:"createEmptyBucket",value:function(){var t=Object.create(null);return pe(Oo,function(n){return t[n]=[]}),t}},{key:"getBucket",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return t?(t.pluginHookBucket||(t.pluginHookBucket=this.createEmptyBucket()),t.pluginHookBucket):this.globalBucket}},{key:"add",value:function(t,n){var i=this,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))pe(n,function(l){return i.add(t,l,a)});else{var o=this.getBucket(a);if(typeof o[t]>"u"&&(this.register(t),o[t]=[]),n.skip=!1,o[t].indexOf(n)===-1){var s=!1;n.initialHook&&pe(o[t],function(l,u){if(l.initialHook)return o[t][u]=n,s=!0,!1}),s||o[t].push(n)}}return this}},{key:"once",value:function(t,n){var i=this,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?pe(n,function(o){return i.once(t,o,a)}):(n.runOnce=!0,this.add(t,n,a))}},{key:"remove",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,a=this.getBucket(i);return typeof a[t]<"u"&&a[t].indexOf(n)>=0?(n.skip=!0,!0):!1}},{key:"has",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=this.getBucket(n);return!!(i[t]!==void 0&&i[t].length)}},{key:"run",value:function(t,n,i,a,o,s,l,u){{var f=this.globalBucket[n],c=f?f.length:0,h=0;if(c)for(;h<c;){if(!f[h]||f[h].skip){h+=1;continue}var d=f[h].call(t,i,a,o,s,l,u);d!==void 0&&(i=d),f[h]&&f[h].runOnce&&this.remove(n,f[h]),h+=1}}{var g=this.getBucket(t)[n],v=g?g.length:0,p=0;if(v)for(;p<v;){if(!g[p]||g[p].skip){p+=1;continue}var C=g[p].call(t,i,a,o,s,l,u);C!==void 0&&(i=C),g[p]&&g[p].runOnce&&this.remove(n,g[p],t),p+=1}}return i}},{key:"destroy",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;St(this.getBucket(t),function(n,i,a){return a[i].length=0})}},{key:"register",value:function(t){this.isRegistered(t)||Oo.push(t)}},{key:"deregister",value:function(t){this.isRegistered(t)&&Oo.splice(Oo.indexOf(t),1)}},{key:"isRegistered",value:function(t){return Oo.indexOf(t)>=0}},{key:"getRegistered",value:function(){return Oo}}]),e}(),Lb=new at;function Ib(){return Lb}function Hb(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function xg(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Eg(e,r,t){return r&&xg(e.prototype,r),t&&xg(e,t),e}var Ro=new WeakMap,T0=function(){Eg(e,null,[{key:"DEFAULT_WIDTH",get:function(){return 50}}]);function e(r,t,n,i,a,o,s){var l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:function(u){return u};Hb(this,e),Ro.set(this,{viewportWidth:r,scrollOffset:t,totalColumns:n,columnWidthFn:i,overrideFn:a,onlyFullyVisible:o,stretchingColumnWidthFn:l}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=s,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return Eg(e,[{key:"calculate",value:function(){for(var t=0,n=!0,i=[],a,o=Ro.get(this),s=o.onlyFullyVisible,l=o.overrideFn,u=o.scrollOffset,f=o.totalColumns,c=o.viewportWidth,h=0;h<f;h++){a=this._getColumnWidth(h),t<=u&&!s&&(this.startColumn=h);var d=u>0?c+1:c;if(t>=u&&t+a<=u+d&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=h),this.endColumn=h),i.push(t),t+=a,s||(this.endColumn=h),t>=u+c){n=!1;break}}if(this.endColumn===f-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var g=i[this.endColumn]+a-i[this.startColumn-1];if((g<=c||!s)&&(this.startColumn-=1),g>c)break}this.startColumn!==null&&l&&l(this),this.startPosition=i[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(t){if(this.stretch!=="none"){var n=t;this.totalTargetWidth=n;for(var i=Ro.get(this),a=i.totalColumns,o=0,s=0;s<a;s++){var l=this._getColumnWidth(s),u=i.stretchingColumnWidthFn(void 0,s);typeof u=="number"?n-=u:o+=l}var f=n-o;if(this.stretch==="all"&&f>0)this.stretchAllRatio=n/o,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&n!==1/0){var c=this._getColumnWidth(a-1),h=f+c;this.stretchLastWidth=h>=0?h:c}}}},{key:"getStretchedColumnWidth",value:function(t,n){var i=null;return this.stretch==="all"&&this.stretchAllRatio!==0?i=this._getStretchedAllColumnWidth(t,n):this.stretch==="last"&&this.stretchLastWidth!==0&&(i=this._getStretchedLastColumnWidth(t)),i}},{key:"_getStretchedAllColumnWidth",value:function(t,n){var i=0,a=Ro.get(this),o=a.totalColumns;if(!this.stretchAllColumnsWidth[t]){var s=Math.round(n*this.stretchAllRatio),l=a.stretchingColumnWidthFn(s,t);l===void 0?this.stretchAllColumnsWidth[t]=s:this.stretchAllColumnsWidth[t]=isNaN(l)?this._getColumnWidth(t):l}if(this.stretchAllColumnsWidth.length===o&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var u=0;u<this.stretchAllColumnsWidth.length;u++)i+=this.stretchAllColumnsWidth[u];i!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-i)}return this.stretchAllColumnsWidth[t]}},{key:"_getStretchedLastColumnWidth",value:function(t){var n=Ro.get(this),i=n.totalColumns;return t===i-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(t){var n=Ro.get(this).columnWidthFn(t);return isNaN(n)&&(n=e.DEFAULT_WIDTH),n}}]),e}();function Bb(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Tg(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Og(e,r,t){return r&&Tg(e.prototype,r),t&&Tg(e,t),e}var Rg=new WeakMap,Wb=function(){Og(e,null,[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]);function e(r,t,n,i,a,o,s){Bb(this,e),Rg.set(this,{viewportHeight:r,scrollOffset:t,totalRows:n,rowHeightFn:i,overrideFn:a,onlyFullyVisible:o,horizontalScrollbarHeight:s}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()}return Og(e,[{key:"calculate",value:function(){for(var t=0,n=!0,i=[],a=Rg.get(this),o=a.onlyFullyVisible,s=a.overrideFn,l=a.rowHeightFn,u=a.scrollOffset,f=a.totalRows,c=a.viewportHeight,h=a.horizontalScrollbarHeight||0,d,g=0;g<f;g++)if(d=l(g),isNaN(d)&&(d=e.DEFAULT_HEIGHT),t<=u&&!o&&(this.startRow=g),t>=u&&t+d<=u+c-h&&(this.startRow===null&&(this.startRow=g),this.endRow=g),i.push(t),t+=d,o||(this.endRow=g),t>=u+c-h){n=!1;break}if(this.endRow===f-1&&n)for(this.startRow=this.endRow;this.startRow>0;){var v=i[this.endRow]+d-i[this.startRow-1];if((v<=c-h||!o)&&(this.startRow-=1),v>=c-h)break}this.startRow!==null&&s&&s(this),this.startPosition=i[this.startRow],this.startPosition===void 0&&(this.startPosition=null),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}]),e}();function $b(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function kg(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ub(e,r,t){return r&&kg(e.prototype,r),t&&kg(e,t),e}var me=function(){function e(r,t){$b(this,e),this.row=null,this.col=null,typeof r<"u"&&typeof t<"u"&&(this.row=r,this.col=t)}return Ub(e,[{key:"isValid",value:function(t){return!(this.row<0||this.col<0||this.row>=t.getSetting("totalRows")||this.col>=t.getSetting("totalColumns"))}},{key:"isEqual",value:function(t){return t===this?!0:this.row===t.row&&this.col===t.col}},{key:"isSouthEastOf",value:function(t){return this.row>=t.row&&this.col>=t.col}},{key:"isNorthWestOf",value:function(t){return this.row<=t.row&&this.col<=t.col}},{key:"isSouthWestOf",value:function(t){return this.row>=t.row&&this.col<=t.col}},{key:"isNorthEastOf",value:function(t){return this.row<=t.row&&this.col>=t.col}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),e}();function Vb(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Ag(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function zb(e,r,t){return r&&Ag(e.prototype,r),t&&Ag(e,t),e}var Kr=function(){function e(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r;Vb(this,e),this.highlight=r,this.from=t,this.to=n}return zb(e,[{key:"setHighlight",value:function(t){return this.highlight=t,this}},{key:"setFrom",value:function(t){return this.from=t,this}},{key:"setTo",value:function(t){return this.to=t,this}},{key:"isValid",value:function(t){return this.from.isValid(t)&&this.to.isValid(t)}},{key:"isSingle",value:function(){return this.from.row===this.to.row&&this.from.col===this.to.col}},{key:"getHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"includes",value:function(t){var n=t.row,i=t.col,a=this.getTopLeftCorner(),o=this.getBottomRightCorner();return a.row<=n&&o.row>=n&&a.col<=i&&o.col>=i}},{key:"includesRange",value:function(t){return this.includes(t.getTopLeftCorner())&&this.includes(t.getBottomRightCorner())}},{key:"isEqual",value:function(t){return Math.min(this.from.row,this.to.row)===Math.min(t.from.row,t.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(t.from.row,t.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(t.from.col,t.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(t.from.col,t.to.col)}},{key:"overlaps",value:function(t){return t.isSouthEastOf(this.getTopLeftCorner())&&t.isNorthWestOf(this.getBottomRightCorner())}},{key:"isSouthEastOf",value:function(t){return this.getTopLeftCorner().isSouthEastOf(t)||this.getBottomRightCorner().isSouthEastOf(t)}},{key:"isNorthWestOf",value:function(t){return this.getTopLeftCorner().isNorthWestOf(t)||this.getBottomRightCorner().isNorthWestOf(t)}},{key:"isOverlappingHorizontally",value:function(t){return this.getTopRightCorner().col>=t.getTopLeftCorner().col&&this.getTopRightCorner().col<=t.getTopRightCorner().col||this.getTopLeftCorner().col<=t.getTopRightCorner().col&&this.getTopLeftCorner().col>=t.getTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(t){return this.getBottomRightCorner().row>=t.getTopRightCorner().row&&this.getBottomRightCorner().row<=t.getBottomRightCorner().row||this.getTopRightCorner().row<=t.getBottomRightCorner().row&&this.getTopRightCorner().row>=t.getTopRightCorner().row}},{key:"expand",value:function(t){var n=this.getTopLeftCorner(),i=this.getBottomRightCorner();return t.row<n.row||t.col<n.col||t.row>i.row||t.col>i.col?(this.from=new me(Math.min(n.row,t.row),Math.min(n.col,t.col)),this.to=new me(Math.max(i.row,t.row),Math.max(i.col,t.col)),!0):!1}},{key:"expandByRange",value:function(t){if(this.includesRange(t)||!this.overlaps(t))return!1;var n=this.getTopLeftCorner(),i=this.getBottomRightCorner(),a=this.getDirection(),o=t.getTopLeftCorner(),s=t.getBottomRightCorner(),l=Math.min(n.row,o.row),u=Math.min(n.col,o.col),f=Math.max(i.row,s.row),c=Math.max(i.col,s.col),h=new me(l,u),d=new me(f,c);return this.from=h,this.to=d,this.setDirection(a),this.highlight.row===this.getBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}},{key:"setDirection",value:function(t){switch(t){case"NW-SE":var n=[this.getTopLeftCorner(),this.getBottomRightCorner()];this.from=n[0],this.to=n[1];break;case"NE-SW":var i=[this.getTopRightCorner(),this.getBottomLeftCorner()];this.from=i[0],this.to=i[1];break;case"SE-NW":var a=[this.getBottomRightCorner(),this.getTopLeftCorner()];this.from=a[0],this.to=a[1];break;case"SW-NE":var o=[this.getBottomLeftCorner(),this.getTopRightCorner()];this.from=o[0],this.to=o[1];break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var t=this.getDirection();switch(t){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}},{key:"flipDirectionHorizontally",value:function(){var t=this.getDirection();switch(t){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}},{key:"getTopLeftCorner",value:function(){return new me(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getBottomRightCorner",value:function(){return new me(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getTopRightCorner",value:function(){return new me(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getBottomLeftCorner",value:function(){return new me(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"isCorner",value:function(t,n){return n&&n.includes(t)&&(this.getTopLeftCorner().isEqual(new me(n.from.row,n.from.col))||this.getTopRightCorner().isEqual(new me(n.from.row,n.to.col))||this.getBottomLeftCorner().isEqual(new me(n.to.row,n.from.col))||this.getBottomRightCorner().isEqual(new me(n.to.row,n.to.col)))?!0:t.isEqual(this.getTopLeftCorner())||t.isEqual(this.getTopRightCorner())||t.isEqual(this.getBottomLeftCorner())||t.isEqual(this.getBottomRightCorner())}},{key:"getOppositeCorner",value:function(t,n){if(!(t instanceof me))return!1;if(n&&n.includes(t)){if(this.getTopLeftCorner().isEqual(new me(n.from.row,n.from.col)))return this.getBottomRightCorner();if(this.getTopRightCorner().isEqual(new me(n.from.row,n.to.col)))return this.getBottomLeftCorner();if(this.getBottomLeftCorner().isEqual(new me(n.to.row,n.from.col)))return this.getTopRightCorner();if(this.getBottomRightCorner().isEqual(new me(n.to.row,n.to.col)))return this.getTopLeftCorner()}if(t.isEqual(this.getBottomRightCorner()))return this.getTopLeftCorner();if(t.isEqual(this.getTopLeftCorner()))return this.getBottomRightCorner();if(t.isEqual(this.getTopRightCorner()))return this.getBottomLeftCorner();if(t.isEqual(this.getBottomLeftCorner()))return this.getTopRightCorner()}},{key:"getBordersSharedWith",value:function(t){if(!this.includesRange(t))return[];var n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(t.from.row,t.to.row),bottom:Math.max(t.from.row,t.to.row),left:Math.min(t.from.col,t.to.col),right:Math.max(t.from.col,t.to.col)},a=[];return n.top===i.top&&a.push("top"),n.right===i.right&&a.push("right"),n.bottom===i.bottom&&a.push("bottom"),n.left===i.left&&a.push("left"),a}},{key:"getInner",value:function(){for(var t=this.getTopLeftCorner(),n=this.getBottomRightCorner(),i=[],a=t.row;a<=n.row;a++)for(var o=t.col;o<=n.col;o++)!(this.from.row===a&&this.from.col===o)&&!(this.to.row===a&&this.to.col===o)&&i.push(new me(a,o));return i}},{key:"getAll",value:function(){for(var t=this.getTopLeftCorner(),n=this.getBottomRightCorner(),i=[],a=t.row;a<=n.row;a++)for(var o=t.col;o<=n.col;o++)t.row===a&&t.col===o?i.push(t):n.row===a&&n.col===o?i.push(n):i.push(new me(a,o));return i}},{key:"forAll",value:function(t){for(var n=this.getTopLeftCorner(),i=this.getBottomRightCorner(),a=n.row;a<=i.row;a++)for(var o=n.col;o<=i.col;o++){var s=t(a,o);if(s===!1)return}}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}}]),e}();function jb(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Mg(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Yb(e,r,t){return r&&Mg(e.prototype,r),t&&Mg(e,t),e}var Gb=function(){function e(r,t,n){jb(this,e),this.offset=r,this.total=t,this.countTH=n}return Yb(e,[{key:"offsetted",value:function(t){return t+this.offset}},{key:"unOffsetted",value:function(t){return t-this.offset}},{key:"renderedToSource",value:function(t){return this.offsetted(t)}},{key:"sourceToRendered",value:function(t){return this.unOffsetted(t)}},{key:"offsettedTH",value:function(t){return t-this.countTH}},{key:"unOffsettedTH",value:function(t){return t+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(t){return this.renderedToSource(this.offsettedTH(t))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(t){return this.unOffsettedTH(this.sourceToRendered(t))}}]),e}();function Xb(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Dg(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Kb(e,r,t){return r&&Dg(e.prototype,r),t&&Dg(e,t),e}var qb=function(){function e(r,t,n){Xb(this,e),this.offset=r,this.total=t,this.countTH=n}return Kb(e,[{key:"offsetted",value:function(t){return t+this.offset}},{key:"unOffsetted",value:function(t){return t-this.offset}},{key:"renderedToSource",value:function(t){return this.offsetted(t)}},{key:"sourceToRendered",value:function(t){return this.unOffsetted(t)}},{key:"offsettedTH",value:function(t){return t-this.countTH}},{key:"unOffsettedTH",value:function(t){return t+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(t){return this.renderedToSource(this.offsettedTH(t))}},{key:"sourceRowToVisibleColHeadedRow",value:function(t){return this.unOffsettedTH(this.sourceToRendered(t))}}]),e}(),Oa=function(r){var t={value:!1};return t.test=function(n,i){t.value=r(n,i)},t},hi={chrome:Oa(function(e,r){return/Chrome/.test(e)&&/Google/.test(r)}),edge:Oa(function(e){return/Edge/.test(e)}),ie:Oa(function(e){return/Trident/.test(e)}),ie8:Oa(function(){return!document.createTextNode("test").textContent}),ie9:Oa(function(){return!!document.documentMode}),mobile:Oa(function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}),safari:Oa(function(e,r){return/Safari/.test(e)&&/Apple Computer/.test(r)})};function Cw(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.userAgent,t=r===void 0?navigator.userAgent:r,n=e.vendor,i=n===void 0?navigator.vendor:n;St(hi,function(a){var o=a.test;return void o(t,i)})}Cw();function Sw(){return hi.chrome.value}function Zb(){return hi.edge.value}function Jb(){return hi.ie.value}function bw(){return hi.ie8.value}function xw(){return hi.ie9.value}function Qb(){return hi.ie.value||hi.edge.value}function ui(){return hi.mobile.value}function Ew(){return hi.safari.value}const ex=Object.freeze(Object.defineProperty({__proto__:null,isChrome:Sw,isEdge:Zb,isIE:Jb,isIE8:bw,isIE9:xw,isMSBrowser:Qb,isMobileBrowser:ui,isSafari:Ew,setBrowserMeta:Cw},Symbol.toStringTag,{value:"Module"}));function mu(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?mu=function(t){return typeof t}:mu=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mu(e)}var Pg=0,Xl=["ms","moz","webkit","o"],ul=window.requestAnimationFrame,pf=window.cancelAnimationFrame;for(var Ps=0;Ps<Xl.length&&!ul;++Ps)ul=window["".concat(Xl[Ps],"RequestAnimationFrame")],pf=window["".concat(Xl[Ps],"CancelAnimationFrame")]||window["".concat(Xl[Ps],"CancelRequestAnimationFrame")];ul||(ul=function(r){var t=new Date().getTime(),n=Math.max(0,16-(t-Pg)),i=window.setTimeout(function(){r(t+n)},n);return Pg=t+n,i});pf||(pf=function(r){clearTimeout(r)});function fl(e){return ul.call(window,e)}function ss(e){pf.call(window,e)}function O0(){return"ontouchstart"in window}function Tw(){var e=document.createElement("div");return!!(e.createShadowRoot&&e.createShadowRoot.toString().match(/\[native code\]/))}var Uh;function tx(){var e=document.createElement("TABLE");e.style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0";var r=document.createElement("TBODY");e.appendChild(r),r.appendChild(document.createElement("TR")),r.firstChild.appendChild(document.createElement("TD")),r.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var t=document.createElement("CAPTION");t.innerHTML="c<br>c<br>c<br>c",t.style.padding="0",t.style.margin="0",e.insertBefore(t,r),document.body.appendChild(e),Uh=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function R0(){return Uh===void 0&&tx(),Uh}var ko;function rx(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ko||((typeof Intl>"u"?"undefined":mu(Intl))==="object"?ko=new Intl.Collator(e,r).compare:typeof String.prototype.localeCompare=="function"?ko=function(n,i){return"".concat(n).localeCompare(i)}:ko=function(n,i){return n===i?0:n>i?-1:1},ko)}const nx=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:ss,getComparisonFunction:rx,hasCaptionProblem:R0,isTouchSupported:O0,isWebComponentSupportedNatively:Tw,requestAnimationFrame:fl},Symbol.toStringTag,{value:"Module"}));function Ng(e){return ox(e)||ax(e)||ix()}function ix(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function ax(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}function ox(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}function Ow(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=-1,n=null,i=e;i!==null;){if(t===r){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(t+=1,i=i.parentNode)}return n}function ao(e,r,t){for(var n=e;n!==null&&n!==t;){if(n.nodeType===Node.ELEMENT_NODE&&(r.indexOf(n.nodeName)>-1||r.indexOf(n)>-1))return n;n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n=n.host:n=n.parentNode}return null}function Ws(e,r,t){for(var n=[],i=e;i&&(i=ao(i,r,t),!(!i||t&&!t.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;var a=n.length;return a?n[a-1]:null}function Ti(e,r){var t=e.parentNode,n=[];for(typeof r=="string"?n=Array.prototype.slice.call(document.querySelectorAll(r),0):n.push(r);t!==null;){if(n.indexOf(t)>-1)return!0;t=t.parentNode}return!1}function Rw(e){var r="hot-table",t=!1,n=yf(e);function i(a){return a.nodeType===Node.ELEMENT_NODE&&a.nodeName===r.toUpperCase()}for(;n!==null;){if(i(n)){t=!0;break}else if(n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(t=i(n.host),t)break;n=n.host}n=n.parentNode}return t}function yf(e){return typeof Polymer<"u"&&typeof wrap=="function"?wrap(e):e}function kw(e){return typeof Polymer<"u"&&typeof unwrap=="function"?unwrap(e):e}function Aw(e){var r=0,t=e;if(t.previousSibling)for(;t=t.previousSibling;)r+=1;return r}function $s(e,r){var t=document.querySelector(".ht_clone_".concat(e));return t?t.contains(r):null}var sx=!!document.documentElement.classList,Vh,zh,jh;function Fg(e){var r=[];if(!e||!e.length)return r;for(var t=0;e[t];)r.push(e[t]),t+=1;return r}if(sx){var Lg=function(){var e=document.createElement("div");return e.classList.add("test","test2"),e.classList.contains("test2")}();Vh=function(r,t){return r.classList===void 0||typeof t!="string"||t===""?!1:r.classList.contains(t)},zh=function(r,t){var n=t;if(typeof n=="string"&&(n=n.split(" ")),n=Fg(n),n.length>0)if(Lg){var i;(i=r.classList).add.apply(i,Ng(n))}else for(var a=0;n&&n[a];)r.classList.add(n[a]),a+=1},jh=function(r,t){var n=t;if(typeof n=="string"&&(n=n.split(" ")),n=Fg(n),n.length>0)if(Lg){var i;(i=r.classList).remove.apply(i,Ng(n))}else for(var a=0;n&&n[a];)r.classList.remove(n[a]),a+=1}}else{var th=function(r){return new RegExp("(\\s|^)".concat(r,"(\\s|$)"))};Vh=function(r,t){return r.className!==void 0&&th(t).test(r.className)},zh=function(r,t){var n=0,i=r.className,a=t;if(typeof a=="string"&&(a=a.split(" ")),i==="")i=a.join(" ");else for(;a&&a[n];)th(a[n]).test(i)||(i+=" ".concat(a[n])),n+=1;r.className=i},jh=function(r,t){var n=0,i=r.className,a=t;for(typeof a=="string"&&(a=a.split(" "));a&&a[n];)i=i.replace(th(a[n])," ").trim(),n+=1;r.className!==i&&(r.className=i)}}function gt(e,r){return Vh(e,r)}function $e(e,r){return zh(e,r)}function pt(e,r){return jh(e,r)}function k0(e,r){if(e.nodeType===3)r.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var t=e.childNodes,n=t.length-1;n>=0;n--)k0(t[n],e)}function Gn(e){for(var r;r=e.lastChild;)e.removeChild(r)}var Mw=/(<(.*)>|&(.*);)/;function ms(e,r){Mw.test(r)?e.innerHTML=r:ps(e,r)}var lx=!!document.createTextNode("test").textContent;function ps(e,r){var t=e.firstChild;t&&t.nodeType===3&&t.nextSibling===null?lx?t.textContent=r:t.data=r:(Gn(e),e.appendChild(document.createTextNode(r)))}function ls(e){for(var r=e;kw(r)!==document.documentElement;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return ls(r.host.impl);if(r.host)return ls(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.style.display==="none")return!1;r=r.parentNode}return!0}function Xt(e){var r=document.documentElement,t=e,n,i,a,o;if(R0()&&t.firstChild&&t.firstChild.nodeName==="CAPTION")return o=t.getBoundingClientRect(),{top:o.top+(window.pageYOffset||r.scrollTop)-(r.clientTop||0),left:o.left+(window.pageXOffset||r.scrollLeft)-(r.clientLeft||0)};for(n=t.offsetLeft,i=t.offsetTop,a=t;(t=t.offsetParent)&&t!==document.body;)n+=t.offsetLeft,i+=t.offsetTop,a=t;return a&&a.style.position==="fixed"&&(n+=window.pageXOffset||r.scrollLeft,i+=window.pageYOffset||r.scrollTop),{left:n,top:i}}function wo(){var e=window.scrollY;return e===void 0&&(e=document.documentElement.scrollTop),e}function ya(){var e=window.scrollX;return e===void 0&&(e=document.documentElement.scrollLeft),e}function cl(e){return e===window?wo():e.scrollTop}function wf(e){return e===window?ya():e.scrollLeft}function co(e){for(var r=["auto","scroll"],t=e.parentNode,n,i,a,o="",s="",l="",u="";t&&t.style&&document.body!==t;){if(n=t.style.overflow,i=t.style.overflowX,a=t.style.overflowY,n==="scroll"||i==="scroll"||a==="scroll")return t;if(window.getComputedStyle&&(o=window.getComputedStyle(t),s=o.getPropertyValue("overflow"),l=o.getPropertyValue("overflow-y"),u=o.getPropertyValue("overflow-x"),s==="scroll"||u==="scroll"||l==="scroll")||t.clientHeight<=t.scrollHeight+1&&(r.indexOf(a)!==-1||r.indexOf(n)!==-1||r.indexOf(s)!==-1||r.indexOf(l)!==-1)||t.clientWidth<=t.scrollWidth+1&&(r.indexOf(i)!==-1||r.indexOf(n)!==-1||r.indexOf(s)!==-1||r.indexOf(u)!==-1))return t;t=t.parentNode}return window}function us(e){for(var r=e.parentNode;r&&r.style&&document.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;var t=ys(r),n=["scroll","hidden","auto"],i=t.getPropertyValue("overflow"),a=t.getPropertyValue("overflow-y"),o=t.getPropertyValue("overflow-x");if(n.includes(i)||n.includes(a)||n.includes(o))return r;r=r.parentNode}return window}function _f(e,r){if(e){if(e===window)return r==="width"?window.innerWidth+"px":r==="height"?window.innerHeight+"px":void 0}else return;var t=e.style[r],n;if(t!==""&&t!==void 0)return t;if(n=ys(e),n[r]!==""&&n[r]!==void 0)return n[r]}function ys(e){return e.currentStyle||document.defaultView.getComputedStyle(e)}function Gt(e){return e.offsetWidth}function sr(e){return R0()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function fi(e){return e.clientHeight||e.innerHeight}function oo(e){return e.clientWidth||e.innerWidth}function ux(e,r,t){window.addEventListener?e.addEventListener(r,t,!1):e.attachEvent("on"+r,t)}function fx(e,r,t){window.removeEventListener?e.removeEventListener(r,t,!1):e.detachEvent("on"+r,t)}function A0(e){if(e.selectionStart)return e.selectionStart;if(document.selection){e.focus();var r=document.selection.createRange();if(r==null)return 0;var t=e.createTextRange(),n=t.duplicate();return t.moveToBookmark(r.getBookmark()),n.setEndPoint("EndToStart",t),n.text.length}return 0}function Dw(e){if(e.selectionEnd)return e.selectionEnd;if(document.selection){var r=document.selection.createRange();if(r==null)return 0;var t=e.createTextRange();return t.text.indexOf(r.text)+r.text.length}return 0}function Pw(){var e="";return window.getSelection?e=window.getSelection().toString():document.selection&&document.selection.type!=="Control"&&(e=document.selection.createRange().text),e}function Bl(e,r,t){if(t===void 0&&(t=r),e.setSelectionRange){e.focus();try{e.setSelectionRange(r,t)}catch{var n=e.parentNode,i=n.style.display;n.style.display="block",e.setSelectionRange(r,t),n.style.display=i}}else if(e.createTextRange){var a=e.createTextRange();a.collapse(!0),a.moveEnd("character",t),a.moveStart("character",r),a.select()}}var rh;function cx(){var e=document.createElement("div");e.style.height="200px",e.style.width="100%";var r=document.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(document.body||document.documentElement).appendChild(r);var t=e.offsetWidth;r.style.overflow="scroll";var n=e.offsetWidth;return t==n&&(n=r.clientWidth),(document.body||document.documentElement).removeChild(r),t-n}function Jt(){return rh===void 0&&(rh=cx()),rh}function Nw(e){return e.offsetWidth!==e.clientWidth}function Fw(e){return e.offsetHeight!==e.clientHeight}function Xf(e,r,t){bw()||xw()?(e.style.top=t,e.style.left=r):Ew()?e.style["-webkit-transform"]="translate3d("+r+","+t+",0)":e.style.transform="translate3d("+r+","+t+",0)"}function $n(e){var r;return e.style.transform&&(r=e.style.transform)!==""?["transform",r]:e.style["-webkit-transform"]&&(r=e.style["-webkit-transform"])!==""?["-webkit-transform",r]:-1}function wa(e){e.style.transform&&e.style.transform!==""?e.style.transform="":e.style["-webkit-transform"]&&e.style["-webkit-transform"]!==""&&(e.style["-webkit-transform"]="")}function Kf(e){var r=["INPUT","SELECT","TEXTAREA"];return e&&(r.indexOf(e.nodeName)>-1||e.contentEditable==="true")}function Lw(e){return Kf(e)&&e.className.indexOf("handsontableInput")==-1&&e.className.indexOf("copyPaste")==-1}const hx=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:Mw,addClass:$e,addEvent:ux,closest:ao,closestDown:Ws,empty:Gn,fastInnerHTML:ms,fastInnerText:ps,getCaretPosition:A0,getComputedStyle:ys,getCssTransform:$n,getParent:Ow,getScrollLeft:wf,getScrollTop:cl,getScrollableElement:co,getScrollbarWidth:Jt,getSelectionEndPosition:Dw,getSelectionText:Pw,getStyle:_f,getTrimmingContainer:us,getWindowScrollLeft:ya,getWindowScrollTop:wo,hasClass:gt,hasHorizontalScrollbar:Fw,hasVerticalScrollbar:Nw,index:Aw,innerHeight:fi,innerWidth:oo,isChildOf:Ti,isChildOfWebComponentTable:Rw,isInput:Kf,isOutsideInput:Lw,isVisible:ls,offset:Xt,outerHeight:sr,outerWidth:Gt,overlayContainsElement:$s,polymerUnwrap:kw,polymerWrap:yf,removeClass:pt,removeEvent:fx,removeTextNodes:k0,resetCssTransform:wa,setCaretPosition:Bl,setOverlayPosition:Xf},Symbol.toStringTag,{value:"Module"}));function Hr(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function Oi(e){return e.isImmediatePropagationEnabled===!1}function Lr(e){typeof e.stopPropagation=="function"?e.stopPropagation():e.cancelBubble=!0}function hl(e){return e.pageX?e.pageX:e.clientX+ya()}function dl(e){return e.pageY?e.pageY:e.clientY+wo()}function vl(e){return e.button===2}function M0(e){return e.button===0}const dx=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Oi,isLeftClick:M0,isRightClick:vl,pageX:hl,pageY:dl,stopImmediatePropagation:Hr,stopPropagation:Lr},Symbol.toStringTag,{value:"Module"}));function vx(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Ig(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function gx(e,r,t){return r&&Ig(e.prototype,r),t&&Ig(e,t),e}var Yh=0,Ft=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;vx(this,e),this.context=r||this,this.context.eventListeners||(this.context.eventListeners=[])}return gx(e,[{key:"addEventListener",value:function(t,n,i){var a=this,o=this.context;function s(l){i.call(this,mx(o,l))}return this.context.eventListeners.push({element:t,event:n,callback:i,callbackProxy:s}),t.addEventListener(n,s,!1),Yh+=1,function(){a.removeEventListener(t,n,i)}}},{key:"removeEventListener",value:function(t,n,i){for(var a=this.context.eventListeners.length,o;a;)if(a-=1,o=this.context.eventListeners[a],o.event===n&&o.element===t){if(i&&i!==o.callback)continue;this.context.eventListeners.splice(a,1),o.element.removeEventListener(o.event,o.callbackProxy,!1),Yh-=1}}},{key:"clearEvents",value:function(){if(this.context)for(var t=this.context.eventListeners.length;t;){t-=1;var n=this.context.eventListeners[t];n&&this.removeEventListener(n.element,n.event,n.callback)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"fireEvent",value:function(t,n){var i={bubbles:!0,cancelable:n!=="mousemove",view:window,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},a;document.createEvent?(a=document.createEvent("MouseEvents"),a.initMouseEvent(n,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,document.body.parentNode)):a=document.createEventObject(),t.dispatchEvent?t.dispatchEvent(a):t.fireEvent("on".concat(n),a)}}]),e}();function mx(e,r){var t="HOT-TABLE",n,i,a,o,s;r.isTargetWebComponent=!1,r.realTarget=r.target;var l=r.stopImmediatePropagation;if(r.stopImmediatePropagation=function(){l.apply(this),Hr(this)},!Ft.isHotTableEnv)return r;for(r=yf(r),s=r.path?r.path.length:0;s;){if(s-=1,r.path[s].nodeName===t)n=!0;else if(n&&r.path[s].shadowRoot){o=r.path[s];break}s===0&&!o&&(o=r.path[s])}return o||(o=r.target),r.isTargetWebComponent=!0,Tw()?r.realTarget=r.srcElement||r.toElement:(At(e,"hot")||e.isHotTableEnv||e.wtTable)&&(At(e,"hot")?i=e.hot?e.hot.view.wt.wtTable.TABLE:null:e.isHotTableEnv?i=e.view.activeWt.wtTable.TABLE.parentNode.parentNode:e.wtTable&&(i=e.wtTable.TABLE.parentNode.parentNode),a=ao(r.target,[t],i),a?r.realTarget=i.querySelector(t)||r.target:r.realTarget=r.target),Object.defineProperty(r,"target",{get:function(){return yf(o)},enumerable:!0,configurable:!0}),r}function px(){return Yh}var Iw;function Pe(){return Iw.apply(null,arguments)}function yx(e){Iw=e}function Yn(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function Gs(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function wx(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var r;for(r in e)if(e.hasOwnProperty(r))return!1;return!0}function jr(e){return e===void 0}function ho(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function qf(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function Hw(e,r){var t=[],n;for(n=0;n<e.length;++n)t.push(r(e[n],n));return t}function lr(e,r){return Object.prototype.hasOwnProperty.call(e,r)}function la(e,r){for(var t in r)lr(r,t)&&(e[t]=r[t]);return lr(r,"toString")&&(e.toString=r.toString),lr(r,"valueOf")&&(e.valueOf=r.valueOf),e}function gi(e,r,t,n){return c1(e,r,t,n,!0).utc()}function _x(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function dt(e){return e._pf==null&&(e._pf=_x()),e._pf}var Gh;Array.prototype.some?Gh=Array.prototype.some:Gh=function(e){for(var r=Object(this),t=r.length>>>0,n=0;n<t;n++)if(n in r&&e.call(this,r[n],n,r))return!0;return!1};function D0(e){if(e._isValid==null){var r=dt(e),t=Gh.call(r.parsedDateParts,function(i){return i!=null}),n=!isNaN(e._d.getTime())&&r.overflow<0&&!r.empty&&!r.invalidMonth&&!r.invalidWeekday&&!r.weekdayMismatch&&!r.nullInput&&!r.invalidFormat&&!r.userInvalidated&&(!r.meridiem||r.meridiem&&t);if(e._strict&&(n=n&&r.charsLeftOver===0&&r.unusedTokens.length===0&&r.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=n;else return n}return e._isValid}function Zf(e){var r=gi(NaN);return e!=null?la(dt(r),e):dt(r).userInvalidated=!0,r}var nh=Pe.momentProperties=[];function P0(e,r){var t,n,i;if(jr(r._isAMomentObject)||(e._isAMomentObject=r._isAMomentObject),jr(r._i)||(e._i=r._i),jr(r._f)||(e._f=r._f),jr(r._l)||(e._l=r._l),jr(r._strict)||(e._strict=r._strict),jr(r._tzm)||(e._tzm=r._tzm),jr(r._isUTC)||(e._isUTC=r._isUTC),jr(r._offset)||(e._offset=r._offset),jr(r._pf)||(e._pf=dt(r)),jr(r._locale)||(e._locale=r._locale),nh.length>0)for(t=0;t<nh.length;t++)n=nh[t],i=r[n],jr(i)||(e[n]=i);return e}var ih=!1;function Wl(e){P0(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),ih===!1&&(ih=!0,Pe.updateOffset(this),ih=!1)}function _a(e){return e instanceof Wl||e!=null&&e._isAMomentObject!=null}function Fn(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function mt(e){var r=+e,t=0;return r!==0&&isFinite(r)&&(t=Fn(r)),t}function Bw(e,r,t){var n=Math.min(e.length,r.length),i=Math.abs(e.length-r.length),a=0,o;for(o=0;o<n;o++)(t&&e[o]!==r[o]||!t&&mt(e[o])!==mt(r[o]))&&a++;return a+i}function Ww(e){Pe.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function Ln(e,r){var t=!0;return la(function(){if(Pe.deprecationHandler!=null&&Pe.deprecationHandler(null,e),t){for(var n=[],i,a=0;a<arguments.length;a++){if(i="",typeof arguments[a]=="object"){i+=`
[`+a+"] ";for(var o in arguments[0])i+=o+": "+arguments[0][o]+", ";i=i.slice(0,-2)}else i=arguments[a];n.push(i)}Ww(e+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),t=!1}return r.apply(this,arguments)},r)}var Hg={};function $w(e,r){Pe.deprecationHandler!=null&&Pe.deprecationHandler(e,r),Hg[e]||(Ww(r),Hg[e]=!0)}Pe.suppressDeprecationWarnings=!1;Pe.deprecationHandler=null;function mi(e){return e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function Cx(e){var r,t;for(t in e)r=e[t],mi(r)?this[t]=r:this["_"+t]=r;this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function Uw(e,r){var t=la({},e),n;for(n in r)lr(r,n)&&(Gs(e[n])&&Gs(r[n])?(t[n]={},la(t[n],e[n]),la(t[n],r[n])):r[n]!=null?t[n]=r[n]:delete t[n]);for(n in e)lr(e,n)&&!lr(r,n)&&Gs(e[n])&&(t[n]=la({},t[n]));return t}function N0(e){e!=null&&this.set(e)}var Xh;Object.keys?Xh=Object.keys:Xh=function(e){var r,t=[];for(r in e)lr(e,r)&&t.push(r);return t};var Sx={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function bx(e,r,t){var n=this._calendar[e]||this._calendar.sameElse;return mi(n)?n.call(r,t):n}var xx={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function Ex(e){var r=this._longDateFormat[e],t=this._longDateFormat[e.toUpperCase()];return r||!t?r:(this._longDateFormat[e]=t.replace(/MMMM|MM|DD|dddd/g,function(n){return n.slice(1)}),this._longDateFormat[e])}var Tx="Invalid date";function Ox(){return this._invalidDate}var Rx="%d",kx=/\d{1,2}/;function Ax(e){return this._ordinal.replace("%d",e)}var Mx={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function Dx(e,r,t,n){var i=this._relativeTime[t];return mi(i)?i(e,r,t,n):i.replace(/%d/i,e)}function Px(e,r){var t=this._relativeTime[e>0?"future":"past"];return mi(t)?t(r):t.replace(/%s/i,r)}var Xs={};function en(e,r){var t=e.toLowerCase();Xs[t]=Xs[t+"s"]=Xs[r]=e}function In(e){return typeof e=="string"?Xs[e]||Xs[e.toLowerCase()]:void 0}function F0(e){var r={},t,n;for(n in e)lr(e,n)&&(t=In(n),t&&(r[t]=e[n]));return r}var Vw={};function tn(e,r){Vw[e]=r}function Nx(e){var r=[];for(var t in e)r.push({unit:t,priority:Vw[t]});return r.sort(function(n,i){return n.priority-i.priority}),r}function Fi(e,r,t){var n=""+Math.abs(e),i=r-n.length,a=e>=0;return(a?t?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var zw=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Kl=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,ah={},Vo={};function rt(e,r,t,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),e&&(Vo[e]=i),r&&(Vo[r[0]]=function(){return Fi(i.apply(this,arguments),r[1],r[2])}),t&&(Vo[t]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function Fx(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function Lx(e){var r=e.match(zw),t,n;for(t=0,n=r.length;t<n;t++)Vo[r[t]]?r[t]=Vo[r[t]]:r[t]=Fx(r[t]);return function(i){var a="",o;for(o=0;o<n;o++)a+=mi(r[o])?r[o].call(i,e):r[o];return a}}function pu(e,r){return e.isValid()?(r=jw(r,e.localeData()),ah[r]=ah[r]||Lx(r),ah[r](e)):e.localeData().invalidDate()}function jw(e,r){var t=5;function n(i){return r.longDateFormat(i)||i}for(Kl.lastIndex=0;t>=0&&Kl.test(e);)e=e.replace(Kl,n),Kl.lastIndex=0,t-=1;return e}var Yw=/\d/,xn=/\d\d/,Gw=/\d{3}/,L0=/\d{4}/,Jf=/[+-]?\d{6}/,Vt=/\d\d?/,Xw=/\d\d\d\d?/,Kw=/\d\d\d\d\d\d?/,Qf=/\d{1,3}/,I0=/\d{1,4}/,ec=/[+-]?\d{1,6}/,Ix=/\d+/,tc=/[+-]?\d+/,Hx=/Z|[+-]\d\d:?\d\d/gi,rc=/Z|[+-]\d\d(?::?\d\d)?/gi,Bx=/[+-]?\d+(\.\d{1,3})?/,$l=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Kh={};function Ze(e,r,t){Kh[e]=mi(r)?r:function(n,i){return n&&t?t:r}}function Wx(e,r){return lr(Kh,e)?Kh[e](r._strict,r._locale):new RegExp($x(e))}function $x(e){return so(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(r,t,n,i,a){return t||n||i||a}))}function so(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var qh={};function zt(e,r){var t,n=r;for(typeof e=="string"&&(e=[e]),ho(r)&&(n=function(i,a){a[r]=mt(i)}),t=0;t<e.length;t++)qh[e[t]]=n}function Ul(e,r){zt(e,function(t,n,i,a){i._w=i._w||{},r(t,i._w,i,a)})}function Ux(e,r,t){r!=null&&lr(qh,e)&&qh[e](r,t._a,t,e)}var zn=0,Ri=1,si=2,Sr=3,Un=4,ki=5,Wa=6,Vx=7,zx=8;rt("Y",0,0,function(){var e=this.year();return e<=9999?""+e:"+"+e});rt(0,["YY",2],0,function(){return this.year()%100});rt(0,["YYYY",4],0,"year");rt(0,["YYYYY",5],0,"year");rt(0,["YYYYYY",6,!0],0,"year");en("year","y");tn("year",1);Ze("Y",tc);Ze("YY",Vt,xn);Ze("YYYY",I0,L0);Ze("YYYYY",ec,Jf);Ze("YYYYYY",ec,Jf);zt(["YYYYY","YYYYYY"],zn);zt("YYYY",function(e,r){r[zn]=e.length===2?Pe.parseTwoDigitYear(e):mt(e)});zt("YY",function(e,r){r[zn]=Pe.parseTwoDigitYear(e)});zt("Y",function(e,r){r[zn]=parseInt(e,10)});function Ks(e){return nc(e)?366:365}function nc(e){return e%4===0&&e%100!==0||e%400===0}Pe.parseTwoDigitYear=function(e){return mt(e)+(mt(e)>68?1900:2e3)};var qw=ws("FullYear",!0);function jx(){return nc(this.year())}function ws(e,r){return function(t){return t!=null?(Zw(this,e,t),Pe.updateOffset(this,r),this):Cf(this,e)}}function Cf(e,r){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+r]():NaN}function Zw(e,r,t){e.isValid()&&!isNaN(t)&&(r==="FullYear"&&nc(e.year())&&e.month()===1&&e.date()===29?e._d["set"+(e._isUTC?"UTC":"")+r](t,e.month(),ic(t,e.month())):e._d["set"+(e._isUTC?"UTC":"")+r](t))}function Yx(e){return e=In(e),mi(this[e])?this[e]():this}function Gx(e,r){if(typeof e=="object"){e=F0(e);for(var t=Nx(e),n=0;n<t.length;n++)this[t[n].unit](e[t[n].unit])}else if(e=In(e),mi(this[e]))return this[e](r);return this}function Xx(e,r){return(e%r+r)%r}var or;Array.prototype.indexOf?or=Array.prototype.indexOf:or=function(e){var r;for(r=0;r<this.length;++r)if(this[r]===e)return r;return-1};function ic(e,r){if(isNaN(e)||isNaN(r))return NaN;var t=Xx(r,12);return e+=(r-t)/12,t===1?nc(e)?29:28:31-t%7%2}rt("M",["MM",2],"Mo",function(){return this.month()+1});rt("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});rt("MMMM",0,0,function(e){return this.localeData().months(this,e)});en("month","M");tn("month",8);Ze("M",Vt);Ze("MM",Vt,xn);Ze("MMM",function(e,r){return r.monthsShortRegex(e)});Ze("MMMM",function(e,r){return r.monthsRegex(e)});zt(["M","MM"],function(e,r){r[Ri]=mt(e)-1});zt(["MMM","MMMM"],function(e,r,t,n){var i=t._locale.monthsParse(e,n,t._strict);i!=null?r[Ri]=i:dt(t).invalidMonth=e});var Jw=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Kx="January_February_March_April_May_June_July_August_September_October_November_December".split("_");function qx(e,r){return e?Yn(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||Jw).test(r)?"format":"standalone"][e.month()]:Yn(this._months)?this._months:this._months.standalone}var Qw="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function Zx(e,r){return e?Yn(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[Jw.test(r)?"format":"standalone"][e.month()]:Yn(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function Jx(e,r,t){var n,i,a,o=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)a=gi([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(a,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(a,"").toLocaleLowerCase();return t?r==="MMM"?(i=or.call(this._shortMonthsParse,o),i!==-1?i:null):(i=or.call(this._longMonthsParse,o),i!==-1?i:null):r==="MMM"?(i=or.call(this._shortMonthsParse,o),i!==-1?i:(i=or.call(this._longMonthsParse,o),i!==-1?i:null)):(i=or.call(this._longMonthsParse,o),i!==-1?i:(i=or.call(this._shortMonthsParse,o),i!==-1?i:null))}function Qx(e,r,t){var n,i,a;if(this._monthsParseExact)return Jx.call(this,e,r,t);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=gi([2e3,n]),t&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!t&&!this._monthsParse[n]&&(a="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(a.replace(".",""),"i")),t&&r==="MMMM"&&this._longMonthsParse[n].test(e))return n;if(t&&r==="MMM"&&this._shortMonthsParse[n].test(e))return n;if(!t&&this._monthsParse[n].test(e))return n}}function e1(e,r){var t;if(!e.isValid())return e;if(typeof r=="string"){if(/^\d+$/.test(r))r=mt(r);else if(r=e.localeData().monthsParse(r),!ho(r))return e}return t=Math.min(e.date(),ic(e.year(),r)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](r,t),e}function t1(e){return e!=null?(e1(this,e),Pe.updateOffset(this,!0),this):Cf(this,"Month")}function eE(){return ic(this.year(),this.month())}var tE=$l;function rE(e){return this._monthsParseExact?(lr(this,"_monthsRegex")||r1.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(lr(this,"_monthsShortRegex")||(this._monthsShortRegex=tE),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}var nE=$l;function iE(e){return this._monthsParseExact?(lr(this,"_monthsRegex")||r1.call(this),e?this._monthsStrictRegex:this._monthsRegex):(lr(this,"_monthsRegex")||(this._monthsRegex=nE),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function r1(){function e(o,s){return s.length-o.length}var r=[],t=[],n=[],i,a;for(i=0;i<12;i++)a=gi([2e3,i]),r.push(this.monthsShort(a,"")),t.push(this.months(a,"")),n.push(this.months(a,"")),n.push(this.monthsShort(a,""));for(r.sort(e),t.sort(e),n.sort(e),i=0;i<12;i++)r[i]=so(r[i]),t[i]=so(t[i]);for(i=0;i<24;i++)n[i]=so(n[i]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+t.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+r.join("|")+")","i")}function aE(e,r,t,n,i,a,o){var s=new Date(e,r,t,n,i,a,o);return e<100&&e>=0&&isFinite(s.getFullYear())&&s.setFullYear(e),s}function gl(e){var r=new Date(Date.UTC.apply(null,arguments));return e<100&&e>=0&&isFinite(r.getUTCFullYear())&&r.setUTCFullYear(e),r}function Sf(e,r,t){var n=7+r-t,i=(7+gl(e,0,n).getUTCDay()-r)%7;return-i+n-1}function n1(e,r,t,n,i){var a=(7+t-n)%7,o=Sf(e,n,i),s=1+7*(r-1)+a+o,l,u;return s<=0?(l=e-1,u=Ks(l)+s):s>Ks(e)?(l=e+1,u=s-Ks(e)):(l=e,u=s),{year:l,dayOfYear:u}}function ml(e,r,t){var n=Sf(e.year(),r,t),i=Math.floor((e.dayOfYear()-n-1)/7)+1,a,o;return i<1?(o=e.year()-1,a=i+lo(o,r,t)):i>lo(e.year(),r,t)?(a=i-lo(e.year(),r,t),o=e.year()+1):(o=e.year(),a=i),{week:a,year:o}}function lo(e,r,t){var n=Sf(e,r,t),i=Sf(e+1,r,t);return(Ks(e)-n+i)/7}rt("w",["ww",2],"wo","week");rt("W",["WW",2],"Wo","isoWeek");en("week","w");en("isoWeek","W");tn("week",5);tn("isoWeek",5);Ze("w",Vt);Ze("ww",Vt,xn);Ze("W",Vt);Ze("WW",Vt,xn);Ul(["w","ww","W","WW"],function(e,r,t,n){r[n.substr(0,1)]=mt(e)});function oE(e){return ml(e,this._week.dow,this._week.doy).week}var sE={dow:0,doy:6};function lE(){return this._week.dow}function uE(){return this._week.doy}function fE(e){var r=this.localeData().week(this);return e==null?r:this.add((e-r)*7,"d")}function cE(e){var r=ml(this,1,4).week;return e==null?r:this.add((e-r)*7,"d")}rt("d",0,"do","day");rt("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});rt("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});rt("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});rt("e",0,0,"weekday");rt("E",0,0,"isoWeekday");en("day","d");en("weekday","e");en("isoWeekday","E");tn("day",11);tn("weekday",11);tn("isoWeekday",11);Ze("d",Vt);Ze("e",Vt);Ze("E",Vt);Ze("dd",function(e,r){return r.weekdaysMinRegex(e)});Ze("ddd",function(e,r){return r.weekdaysShortRegex(e)});Ze("dddd",function(e,r){return r.weekdaysRegex(e)});Ul(["dd","ddd","dddd"],function(e,r,t,n){var i=t._locale.weekdaysParse(e,n,t._strict);i!=null?r.d=i:dt(t).invalidWeekday=e});Ul(["d","e","E"],function(e,r,t,n){r[n]=mt(e)});function hE(e,r){return typeof e!="string"?e:isNaN(e)?(e=r.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function dE(e,r){return typeof e=="string"?r.weekdaysParse(e)%7||7:isNaN(e)?null:e}var vE="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");function gE(e,r){return e?Yn(this._weekdays)?this._weekdays[e.day()]:this._weekdays[this._weekdays.isFormat.test(r)?"format":"standalone"][e.day()]:Yn(this._weekdays)?this._weekdays:this._weekdays.standalone}var i1="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");function mE(e){return e?this._weekdaysShort[e.day()]:this._weekdaysShort}var pE="Su_Mo_Tu_We_Th_Fr_Sa".split("_");function yE(e){return e?this._weekdaysMin[e.day()]:this._weekdaysMin}function wE(e,r,t){var n,i,a,o=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)a=gi([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(a,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(a,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(a,"").toLocaleLowerCase();return t?r==="dddd"?(i=or.call(this._weekdaysParse,o),i!==-1?i:null):r==="ddd"?(i=or.call(this._shortWeekdaysParse,o),i!==-1?i:null):(i=or.call(this._minWeekdaysParse,o),i!==-1?i:null):r==="dddd"?(i=or.call(this._weekdaysParse,o),i!==-1||(i=or.call(this._shortWeekdaysParse,o),i!==-1)?i:(i=or.call(this._minWeekdaysParse,o),i!==-1?i:null)):r==="ddd"?(i=or.call(this._shortWeekdaysParse,o),i!==-1||(i=or.call(this._weekdaysParse,o),i!==-1)?i:(i=or.call(this._minWeekdaysParse,o),i!==-1?i:null)):(i=or.call(this._minWeekdaysParse,o),i!==-1||(i=or.call(this._weekdaysParse,o),i!==-1)?i:(i=or.call(this._shortWeekdaysParse,o),i!==-1?i:null))}function _E(e,r,t){var n,i,a;if(this._weekdaysParseExact)return wE.call(this,e,r,t);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=gi([2e3,1]).day(n),t&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".",".?")+"$","i")),this._weekdaysParse[n]||(a="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(a.replace(".",""),"i")),t&&r==="dddd"&&this._fullWeekdaysParse[n].test(e))return n;if(t&&r==="ddd"&&this._shortWeekdaysParse[n].test(e))return n;if(t&&r==="dd"&&this._minWeekdaysParse[n].test(e))return n;if(!t&&this._weekdaysParse[n].test(e))return n}}function CE(e){if(!this.isValid())return e!=null?this:NaN;var r=this._isUTC?this._d.getUTCDay():this._d.getDay();return e!=null?(e=hE(e,this.localeData()),this.add(e-r,"d")):r}function SE(e){if(!this.isValid())return e!=null?this:NaN;var r=(this.day()+7-this.localeData()._week.dow)%7;return e==null?r:this.add(e-r,"d")}function bE(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var r=dE(e,this.localeData());return this.day(this.day()%7?r:r-7)}else return this.day()||7}var xE=$l;function EE(e){return this._weekdaysParseExact?(lr(this,"_weekdaysRegex")||H0.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(lr(this,"_weekdaysRegex")||(this._weekdaysRegex=xE),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}var TE=$l;function OE(e){return this._weekdaysParseExact?(lr(this,"_weekdaysRegex")||H0.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(lr(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=TE),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}var RE=$l;function kE(e){return this._weekdaysParseExact?(lr(this,"_weekdaysRegex")||H0.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(lr(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=RE),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function H0(){function e(f,c){return c.length-f.length}var r=[],t=[],n=[],i=[],a,o,s,l,u;for(a=0;a<7;a++)o=gi([2e3,1]).day(a),s=this.weekdaysMin(o,""),l=this.weekdaysShort(o,""),u=this.weekdays(o,""),r.push(s),t.push(l),n.push(u),i.push(s),i.push(l),i.push(u);for(r.sort(e),t.sort(e),n.sort(e),i.sort(e),a=0;a<7;a++)t[a]=so(t[a]),n[a]=so(n[a]),i[a]=so(i[a]);this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+t.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+r.join("|")+")","i")}function B0(){return this.hours()%12||12}function AE(){return this.hours()||24}rt("H",["HH",2],0,"hour");rt("h",["hh",2],0,B0);rt("k",["kk",2],0,AE);rt("hmm",0,0,function(){return""+B0.apply(this)+Fi(this.minutes(),2)});rt("hmmss",0,0,function(){return""+B0.apply(this)+Fi(this.minutes(),2)+Fi(this.seconds(),2)});rt("Hmm",0,0,function(){return""+this.hours()+Fi(this.minutes(),2)});rt("Hmmss",0,0,function(){return""+this.hours()+Fi(this.minutes(),2)+Fi(this.seconds(),2)});function a1(e,r){rt(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),r)})}a1("a",!0);a1("A",!1);en("hour","h");tn("hour",13);function o1(e,r){return r._meridiemParse}Ze("a",o1);Ze("A",o1);Ze("H",Vt);Ze("h",Vt);Ze("k",Vt);Ze("HH",Vt,xn);Ze("hh",Vt,xn);Ze("kk",Vt,xn);Ze("hmm",Xw);Ze("hmmss",Kw);Ze("Hmm",Xw);Ze("Hmmss",Kw);zt(["H","HH"],Sr);zt(["k","kk"],function(e,r,t){var n=mt(e);r[Sr]=n===24?0:n});zt(["a","A"],function(e,r,t){t._isPm=t._locale.isPM(e),t._meridiem=e});zt(["h","hh"],function(e,r,t){r[Sr]=mt(e),dt(t).bigHour=!0});zt("hmm",function(e,r,t){var n=e.length-2;r[Sr]=mt(e.substr(0,n)),r[Un]=mt(e.substr(n)),dt(t).bigHour=!0});zt("hmmss",function(e,r,t){var n=e.length-4,i=e.length-2;r[Sr]=mt(e.substr(0,n)),r[Un]=mt(e.substr(n,2)),r[ki]=mt(e.substr(i)),dt(t).bigHour=!0});zt("Hmm",function(e,r,t){var n=e.length-2;r[Sr]=mt(e.substr(0,n)),r[Un]=mt(e.substr(n))});zt("Hmmss",function(e,r,t){var n=e.length-4,i=e.length-2;r[Sr]=mt(e.substr(0,n)),r[Un]=mt(e.substr(n,2)),r[ki]=mt(e.substr(i))});function ME(e){return(e+"").toLowerCase().charAt(0)==="p"}var DE=/[ap]\.?m?\.?/i;function PE(e,r,t){return e>11?t?"pm":"PM":t?"am":"AM"}var NE=ws("Hours",!0),s1={calendar:Sx,longDateFormat:xx,invalidDate:Tx,ordinal:Rx,dayOfMonthOrdinalParse:kx,relativeTime:Mx,months:Kx,monthsShort:Qw,week:sE,weekdays:vE,weekdaysMin:pE,weekdaysShort:i1,meridiemParse:DE},yr={},Ns={},bf;function Bg(e){return e&&e.toLowerCase().replace("_","-")}function FE(e){for(var r=0,t,n,i,a;r<e.length;){for(a=Bg(e[r]).split("-"),t=a.length,n=Bg(e[r+1]),n=n?n.split("-"):null;t>0;){if(i=W0(a.slice(0,t).join("-")),i)return i;if(n&&n.length>=t&&Bw(a,n,!0)>=t-1)break;t--}r++}return null}function W0(e){var r=null;if(!yr[e]&&typeof module<"u"&&module&&module.exports)try{r=bf._abbr;var t=require;t("./locale/"+e),_s(r)}catch{}return yr[e]}function _s(e,r){var t;return e&&(jr(r)?t=Ca(e):t=$0(e,r),t&&(bf=t)),bf._abbr}function $0(e,r){if(r!==null){var t=s1;if(r.abbr=e,yr[e]!=null)$w("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),t=yr[e]._config;else if(r.parentLocale!=null)if(yr[r.parentLocale]!=null)t=yr[r.parentLocale]._config;else return Ns[r.parentLocale]||(Ns[r.parentLocale]=[]),Ns[r.parentLocale].push({name:e,config:r}),null;return yr[e]=new N0(Uw(t,r)),Ns[e]&&Ns[e].forEach(function(n){$0(n.name,n.config)}),_s(e),yr[e]}else return delete yr[e],null}function LE(e,r){if(r!=null){var t,n,i=s1;n=W0(e),n!=null&&(i=n._config),r=Uw(i,r),t=new N0(r),t.parentLocale=yr[e],yr[e]=t,_s(e)}else yr[e]!=null&&(yr[e].parentLocale!=null?yr[e]=yr[e].parentLocale:yr[e]!=null&&delete yr[e]);return yr[e]}function Ca(e){var r;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return bf;if(!Yn(e)){if(r=W0(e),r)return r;e=[e]}return FE(e)}function IE(){return Xh(yr)}function U0(e){var r,t=e._a;return t&&dt(e).overflow===-2&&(r=t[Ri]<0||t[Ri]>11?Ri:t[si]<1||t[si]>ic(t[zn],t[Ri])?si:t[Sr]<0||t[Sr]>24||t[Sr]===24&&(t[Un]!==0||t[ki]!==0||t[Wa]!==0)?Sr:t[Un]<0||t[Un]>59?Un:t[ki]<0||t[ki]>59?ki:t[Wa]<0||t[Wa]>999?Wa:-1,dt(e)._overflowDayOfYear&&(r<zn||r>si)&&(r=si),dt(e)._overflowWeeks&&r===-1&&(r=Vx),dt(e)._overflowWeekday&&r===-1&&(r=zx),dt(e).overflow=r),e}function Bo(e,r,t){return e??r??t}function HE(e){var r=new Date(Pe.now());return e._useUTC?[r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate()]:[r.getFullYear(),r.getMonth(),r.getDate()]}function V0(e){var r,t,n=[],i,a,o;if(!e._d){for(i=HE(e),e._w&&e._a[si]==null&&e._a[Ri]==null&&BE(e),e._dayOfYear!=null&&(o=Bo(e._a[zn],i[zn]),(e._dayOfYear>Ks(o)||e._dayOfYear===0)&&(dt(e)._overflowDayOfYear=!0),t=gl(o,0,e._dayOfYear),e._a[Ri]=t.getUTCMonth(),e._a[si]=t.getUTCDate()),r=0;r<3&&e._a[r]==null;++r)e._a[r]=n[r]=i[r];for(;r<7;r++)e._a[r]=n[r]=e._a[r]==null?r===2?1:0:e._a[r];e._a[Sr]===24&&e._a[Un]===0&&e._a[ki]===0&&e._a[Wa]===0&&(e._nextDay=!0,e._a[Sr]=0),e._d=(e._useUTC?gl:aE).apply(null,n),a=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Sr]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==a&&(dt(e).weekdayMismatch=!0)}}function BE(e){var r,t,n,i,a,o,s,l;if(r=e._w,r.GG!=null||r.W!=null||r.E!=null)a=1,o=4,t=Bo(r.GG,e._a[zn],ml(er(),1,4).year),n=Bo(r.W,1),i=Bo(r.E,1),(i<1||i>7)&&(l=!0);else{a=e._locale._week.dow,o=e._locale._week.doy;var u=ml(er(),a,o);t=Bo(r.gg,e._a[zn],u.year),n=Bo(r.w,u.week),r.d!=null?(i=r.d,(i<0||i>6)&&(l=!0)):r.e!=null?(i=r.e+a,(r.e<0||r.e>6)&&(l=!0)):i=a}n<1||n>lo(t,a,o)?dt(e)._overflowWeeks=!0:l!=null?dt(e)._overflowWeekday=!0:(s=n1(t,n,i,a,o),e._a[zn]=s.year,e._dayOfYear=s.dayOfYear)}var WE=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,$E=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,UE=/Z|[+-]\d\d(?::?\d\d)?/,ql=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],oh=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],VE=/^\/?Date\((\-?\d+)/i;function l1(e){var r,t,n=e._i,i=WE.exec(n)||$E.exec(n),a,o,s,l;if(i){for(dt(e).iso=!0,r=0,t=ql.length;r<t;r++)if(ql[r][1].exec(i[1])){o=ql[r][0],a=ql[r][2]!==!1;break}if(o==null){e._isValid=!1;return}if(i[3]){for(r=0,t=oh.length;r<t;r++)if(oh[r][1].exec(i[3])){s=(i[2]||" ")+oh[r][0];break}if(s==null){e._isValid=!1;return}}if(!a&&s!=null){e._isValid=!1;return}if(i[4])if(UE.exec(i[4]))l="Z";else{e._isValid=!1;return}e._f=o+(s||"")+(l||""),z0(e)}else e._isValid=!1}var zE=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;function jE(e,r,t,n,i,a){var o=[YE(e),Qw.indexOf(r),parseInt(t,10),parseInt(n,10),parseInt(i,10)];return a&&o.push(parseInt(a,10)),o}function YE(e){var r=parseInt(e,10);return r<=49?2e3+r:r<=999?1900+r:r}function GE(e){return e.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}function XE(e,r,t){if(e){var n=i1.indexOf(e),i=new Date(r[0],r[1],r[2]).getDay();if(n!==i)return dt(t).weekdayMismatch=!0,t._isValid=!1,!1}return!0}var KE={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function qE(e,r,t){if(e)return KE[e];if(r)return 0;var n=parseInt(t,10),i=n%100,a=(n-i)/100;return a*60+i}function u1(e){var r=zE.exec(GE(e._i));if(r){var t=jE(r[4],r[3],r[2],r[5],r[6],r[7]);if(!XE(r[1],t,e))return;e._a=t,e._tzm=qE(r[8],r[9],r[10]),e._d=gl.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),dt(e).rfc2822=!0}else e._isValid=!1}function ZE(e){var r=VE.exec(e._i);if(r!==null){e._d=new Date(+r[1]);return}if(l1(e),e._isValid===!1)delete e._isValid;else return;if(u1(e),e._isValid===!1)delete e._isValid;else return;Pe.createFromInputFallback(e)}Pe.createFromInputFallback=Ln("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});Pe.ISO_8601=function(){};Pe.RFC_2822=function(){};function z0(e){if(e._f===Pe.ISO_8601){l1(e);return}if(e._f===Pe.RFC_2822){u1(e);return}e._a=[],dt(e).empty=!0;var r=""+e._i,t,n,i,a,o,s=r.length,l=0;for(i=jw(e._f,e._locale).match(zw)||[],t=0;t<i.length;t++)a=i[t],n=(r.match(Wx(a,e))||[])[0],n&&(o=r.substr(0,r.indexOf(n)),o.length>0&&dt(e).unusedInput.push(o),r=r.slice(r.indexOf(n)+n.length),l+=n.length),Vo[a]?(n?dt(e).empty=!1:dt(e).unusedTokens.push(a),Ux(a,n,e)):e._strict&&!n&&dt(e).unusedTokens.push(a);dt(e).charsLeftOver=s-l,r.length>0&&dt(e).unusedInput.push(r),e._a[Sr]<=12&&dt(e).bigHour===!0&&e._a[Sr]>0&&(dt(e).bigHour=void 0),dt(e).parsedDateParts=e._a.slice(0),dt(e).meridiem=e._meridiem,e._a[Sr]=JE(e._locale,e._a[Sr],e._meridiem),V0(e),U0(e)}function JE(e,r,t){var n;return t==null?r:e.meridiemHour!=null?e.meridiemHour(r,t):(e.isPM!=null&&(n=e.isPM(t),n&&r<12&&(r+=12),!n&&r===12&&(r=0)),r)}function QE(e){var r,t,n,i,a;if(e._f.length===0){dt(e).invalidFormat=!0,e._d=new Date(NaN);return}for(i=0;i<e._f.length;i++)a=0,r=P0({},e),e._useUTC!=null&&(r._useUTC=e._useUTC),r._f=e._f[i],z0(r),D0(r)&&(a+=dt(r).charsLeftOver,a+=dt(r).unusedTokens.length*10,dt(r).score=a,(n==null||a<n)&&(n=a,t=r));la(e,t||r)}function eT(e){if(!e._d){var r=F0(e._i);e._a=Hw([r.year,r.month,r.day||r.date,r.hour,r.minute,r.second,r.millisecond],function(t){return t&&parseInt(t,10)}),V0(e)}}function tT(e){var r=new Wl(U0(f1(e)));return r._nextDay&&(r.add(1,"d"),r._nextDay=void 0),r}function f1(e){var r=e._i,t=e._f;return e._locale=e._locale||Ca(e._l),r===null||t===void 0&&r===""?Zf({nullInput:!0}):(typeof r=="string"&&(e._i=r=e._locale.preparse(r)),_a(r)?new Wl(U0(r)):(qf(r)?e._d=r:Yn(t)?QE(e):t?z0(e):rT(e),D0(e)||(e._d=null),e))}function rT(e){var r=e._i;jr(r)?e._d=new Date(Pe.now()):qf(r)?e._d=new Date(r.valueOf()):typeof r=="string"?ZE(e):Yn(r)?(e._a=Hw(r.slice(0),function(t){return parseInt(t,10)}),V0(e)):Gs(r)?eT(e):ho(r)?e._d=new Date(r):Pe.createFromInputFallback(e)}function c1(e,r,t,n,i){var a={};return(t===!0||t===!1)&&(n=t,t=void 0),(Gs(e)&&wx(e)||Yn(e)&&e.length===0)&&(e=void 0),a._isAMomentObject=!0,a._useUTC=a._isUTC=i,a._l=t,a._i=e,a._f=r,a._strict=n,tT(a)}function er(e,r,t,n){return c1(e,r,t,n,!1)}var nT=Ln("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=er.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:Zf()}),iT=Ln("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=er.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:Zf()});function h1(e,r){var t,n;if(r.length===1&&Yn(r[0])&&(r=r[0]),!r.length)return er();for(t=r[0],n=1;n<r.length;++n)(!r[n].isValid()||r[n][e](t))&&(t=r[n]);return t}function aT(){var e=[].slice.call(arguments,0);return h1("isBefore",e)}function oT(){var e=[].slice.call(arguments,0);return h1("isAfter",e)}var sT=function(){return Date.now?Date.now():+new Date},Fs=["year","quarter","month","week","day","hour","minute","second","millisecond"];function lT(e){for(var r in e)if(!(or.call(Fs,r)!==-1&&(e[r]==null||!isNaN(e[r]))))return!1;for(var t=!1,n=0;n<Fs.length;++n)if(e[Fs[n]]){if(t)return!1;parseFloat(e[Fs[n]])!==mt(e[Fs[n]])&&(t=!0)}return!0}function uT(){return this._isValid}function fT(){return Xn(NaN)}function ac(e){var r=F0(e),t=r.year||0,n=r.quarter||0,i=r.month||0,a=r.week||0,o=r.day||0,s=r.hour||0,l=r.minute||0,u=r.second||0,f=r.millisecond||0;this._isValid=lT(r),this._milliseconds=+f+u*1e3+l*6e4+s*1e3*60*60,this._days=+o+a*7,this._months=+i+n*3+t*12,this._data={},this._locale=Ca(),this._bubble()}function Zh(e){return e instanceof ac}function Jh(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function d1(e,r){rt(e,0,0,function(){var t=this.utcOffset(),n="+";return t<0&&(t=-t,n="-"),n+Fi(~~(t/60),2)+r+Fi(~~t%60,2)})}d1("Z",":");d1("ZZ","");Ze("Z",rc);Ze("ZZ",rc);zt(["Z","ZZ"],function(e,r,t){t._useUTC=!0,t._tzm=j0(rc,e)});var cT=/([\+\-]|\d\d)/gi;function j0(e,r){var t=(r||"").match(e);if(t===null)return null;var n=t[t.length-1]||[],i=(n+"").match(cT)||["-",0,0],a=+(i[1]*60)+mt(i[2]);return a===0?0:i[0]==="+"?a:-a}function Y0(e,r){var t,n;return r._isUTC?(t=r.clone(),n=(_a(e)||qf(e)?e.valueOf():er(e).valueOf())-t.valueOf(),t._d.setTime(t._d.valueOf()+n),Pe.updateOffset(t,!1),t):er(e).local()}function Qh(e){return-Math.round(e._d.getTimezoneOffset()/15)*15}Pe.updateOffset=function(){};function hT(e,r,t){var n=this._offset||0,i;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=j0(rc,e),e===null)return this}else Math.abs(e)<16&&!t&&(e=e*60);return!this._isUTC&&r&&(i=Qh(this)),this._offset=e,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==e&&(!r||this._changeInProgress?m1(this,Xn(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Pe.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:Qh(this)}function dT(e,r){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,r),this):-this.utcOffset()}function vT(e){return this.utcOffset(0,e)}function gT(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Qh(this),"m")),this}function mT(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=j0(Hx,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function pT(e){return this.isValid()?(e=e?er(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function yT(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function wT(){if(!jr(this._isDSTShifted))return this._isDSTShifted;var e={};if(P0(e,this),e=f1(e),e._a){var r=e._isUTC?gi(e._a):er(e._a);this._isDSTShifted=this.isValid()&&Bw(e._a,r.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function _T(){return this.isValid()?!this._isUTC:!1}function CT(){return this.isValid()?this._isUTC:!1}function v1(){return this.isValid()?this._isUTC&&this._offset===0:!1}var ST=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,bT=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Xn(e,r){var t=e,n=null,i,a,o;return Zh(e)?t={ms:e._milliseconds,d:e._days,M:e._months}:ho(e)?(t={},r?t[r]=e:t.milliseconds=e):(n=ST.exec(e))?(i=n[1]==="-"?-1:1,t={y:0,d:mt(n[si])*i,h:mt(n[Sr])*i,m:mt(n[Un])*i,s:mt(n[ki])*i,ms:mt(Jh(n[Wa]*1e3))*i}):(n=bT.exec(e))?(i=n[1]==="-"?-1:(n[1]==="+",1),t={y:Ra(n[2],i),M:Ra(n[3],i),w:Ra(n[4],i),d:Ra(n[5],i),h:Ra(n[6],i),m:Ra(n[7],i),s:Ra(n[8],i)}):t==null?t={}:typeof t=="object"&&("from"in t||"to"in t)&&(o=xT(er(t.from),er(t.to)),t={},t.ms=o.milliseconds,t.M=o.months),a=new ac(t),Zh(e)&&lr(e,"_locale")&&(a._locale=e._locale),a}Xn.fn=ac.prototype;Xn.invalid=fT;function Ra(e,r){var t=e&&parseFloat(e.replace(",","."));return(isNaN(t)?0:t)*r}function Wg(e,r){var t={milliseconds:0,months:0};return t.months=r.month()-e.month()+(r.year()-e.year())*12,e.clone().add(t.months,"M").isAfter(r)&&--t.months,t.milliseconds=+r-+e.clone().add(t.months,"M"),t}function xT(e,r){var t;return e.isValid()&&r.isValid()?(r=Y0(r,e),e.isBefore(r)?t=Wg(e,r):(t=Wg(r,e),t.milliseconds=-t.milliseconds,t.months=-t.months),t):{milliseconds:0,months:0}}function g1(e,r){return function(t,n){var i,a;return n!==null&&!isNaN(+n)&&($w(r,"moment()."+r+"(period, number) is deprecated. Please use moment()."+r+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),a=t,t=n,n=a),t=typeof t=="string"?+t:t,i=Xn(t,n),m1(this,i,e),this}}function m1(e,r,t,n){var i=r._milliseconds,a=Jh(r._days),o=Jh(r._months);e.isValid()&&(n=n??!0,o&&e1(e,Cf(e,"Month")+o*t),a&&Zw(e,"Date",Cf(e,"Date")+a*t),i&&e._d.setTime(e._d.valueOf()+i*t),n&&Pe.updateOffset(e,a||o))}var ET=g1(1,"add"),TT=g1(-1,"subtract");function OT(e,r){var t=e.diff(r,"days",!0);return t<-6?"sameElse":t<-1?"lastWeek":t<0?"lastDay":t<1?"sameDay":t<2?"nextDay":t<7?"nextWeek":"sameElse"}function RT(e,r){var t=e||er(),n=Y0(t,this).startOf("day"),i=Pe.calendarFormat(this,n)||"sameElse",a=r&&(mi(r[i])?r[i].call(this,t):r[i]);return this.format(a||this.localeData().calendar(i,this,er(t)))}function kT(){return new Wl(this)}function AT(e,r){var t=_a(e)?e:er(e);return this.isValid()&&t.isValid()?(r=In(jr(r)?"millisecond":r),r==="millisecond"?this.valueOf()>t.valueOf():t.valueOf()<this.clone().startOf(r).valueOf()):!1}function MT(e,r){var t=_a(e)?e:er(e);return this.isValid()&&t.isValid()?(r=In(jr(r)?"millisecond":r),r==="millisecond"?this.valueOf()<t.valueOf():this.clone().endOf(r).valueOf()<t.valueOf()):!1}function DT(e,r,t,n){return n=n||"()",(n[0]==="("?this.isAfter(e,t):!this.isBefore(e,t))&&(n[1]===")"?this.isBefore(r,t):!this.isAfter(r,t))}function PT(e,r){var t=_a(e)?e:er(e),n;return this.isValid()&&t.isValid()?(r=In(r||"millisecond"),r==="millisecond"?this.valueOf()===t.valueOf():(n=t.valueOf(),this.clone().startOf(r).valueOf()<=n&&n<=this.clone().endOf(r).valueOf())):!1}function NT(e,r){return this.isSame(e,r)||this.isAfter(e,r)}function FT(e,r){return this.isSame(e,r)||this.isBefore(e,r)}function LT(e,r,t){var n,i,a;if(!this.isValid())return NaN;if(n=Y0(e,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,r=In(r),r){case"year":a=sh(this,n)/12;break;case"month":a=sh(this,n);break;case"quarter":a=sh(this,n)/3;break;case"second":a=(this-n)/1e3;break;case"minute":a=(this-n)/6e4;break;case"hour":a=(this-n)/36e5;break;case"day":a=(this-n-i)/864e5;break;case"week":a=(this-n-i)/6048e5;break;default:a=this-n}return t?a:Fn(a)}function sh(e,r){var t=(r.year()-e.year())*12+(r.month()-e.month()),n=e.clone().add(t,"months"),i,a;return r-n<0?(i=e.clone().add(t-1,"months"),a=(r-n)/(n-i)):(i=e.clone().add(t+1,"months"),a=(r-n)/(i-n)),-(t+a)||0}Pe.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Pe.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function IT(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function HT(e){if(!this.isValid())return null;var r=e!==!0,t=r?this.clone().utc():this;return t.year()<0||t.year()>9999?pu(t,r?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):mi(Date.prototype.toISOString)?r?this.toDate().toISOString():new Date(this._d.valueOf()).toISOString().replace("Z",pu(t,"Z")):pu(t,r?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function BT(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",r="";this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",r="Z");var t="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",a=r+'[")]';return this.format(t+n+i+a)}function WT(e){e||(e=this.isUtc()?Pe.defaultFormatUtc:Pe.defaultFormat);var r=pu(this,e);return this.localeData().postformat(r)}function $T(e,r){return this.isValid()&&(_a(e)&&e.isValid()||er(e).isValid())?Xn({to:this,from:e}).locale(this.locale()).humanize(!r):this.localeData().invalidDate()}function UT(e){return this.from(er(),e)}function VT(e,r){return this.isValid()&&(_a(e)&&e.isValid()||er(e).isValid())?Xn({from:this,to:e}).locale(this.locale()).humanize(!r):this.localeData().invalidDate()}function zT(e){return this.to(er(),e)}function p1(e){var r;return e===void 0?this._locale._abbr:(r=Ca(e),r!=null&&(this._locale=r),this)}var y1=Ln("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function w1(){return this._locale}function jT(e){switch(e=In(e),e){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return e==="week"&&this.weekday(0),e==="isoWeek"&&this.isoWeekday(1),e==="quarter"&&this.month(Math.floor(this.month()/3)*3),this}function YT(e){return e=In(e),e===void 0||e==="millisecond"?this:(e==="date"&&(e="day"),this.startOf(e).add(1,e==="isoWeek"?"week":e).subtract(1,"ms"))}function GT(){return this._d.valueOf()-(this._offset||0)*6e4}function XT(){return Math.floor(this.valueOf()/1e3)}function KT(){return new Date(this.valueOf())}function qT(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function ZT(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function JT(){return this.isValid()?this.toISOString():null}function QT(){return D0(this)}function eO(){return la({},dt(this))}function tO(){return dt(this).overflow}function rO(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}rt(0,["gg",2],0,function(){return this.weekYear()%100});rt(0,["GG",2],0,function(){return this.isoWeekYear()%100});function oc(e,r){rt(0,[e,e.length],0,r)}oc("gggg","weekYear");oc("ggggg","weekYear");oc("GGGG","isoWeekYear");oc("GGGGG","isoWeekYear");en("weekYear","gg");en("isoWeekYear","GG");tn("weekYear",1);tn("isoWeekYear",1);Ze("G",tc);Ze("g",tc);Ze("GG",Vt,xn);Ze("gg",Vt,xn);Ze("GGGG",I0,L0);Ze("gggg",I0,L0);Ze("GGGGG",ec,Jf);Ze("ggggg",ec,Jf);Ul(["gggg","ggggg","GGGG","GGGGG"],function(e,r,t,n){r[n.substr(0,2)]=mt(e)});Ul(["gg","GG"],function(e,r,t,n){r[n]=Pe.parseTwoDigitYear(e)});function nO(e){return _1.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function iO(e){return _1.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function aO(){return lo(this.year(),1,4)}function oO(){var e=this.localeData()._week;return lo(this.year(),e.dow,e.doy)}function _1(e,r,t,n,i){var a;return e==null?ml(this,n,i).year:(a=lo(e,n,i),r>a&&(r=a),sO.call(this,e,r,t,n,i))}function sO(e,r,t,n,i){var a=n1(e,r,t,n,i),o=gl(a.year,0,a.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}rt("Q",0,"Qo","quarter");en("quarter","Q");tn("quarter",7);Ze("Q",Yw);zt("Q",function(e,r){r[Ri]=(mt(e)-1)*3});function lO(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}rt("D",["DD",2],"Do","date");en("date","D");tn("date",9);Ze("D",Vt);Ze("DD",Vt,xn);Ze("Do",function(e,r){return e?r._dayOfMonthOrdinalParse||r._ordinalParse:r._dayOfMonthOrdinalParseLenient});zt(["D","DD"],si);zt("Do",function(e,r){r[si]=mt(e.match(Vt)[0])});var C1=ws("Date",!0);rt("DDD",["DDDD",3],"DDDo","dayOfYear");en("dayOfYear","DDD");tn("dayOfYear",4);Ze("DDD",Qf);Ze("DDDD",Gw);zt(["DDD","DDDD"],function(e,r,t){t._dayOfYear=mt(e)});function uO(e){var r=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?r:this.add(e-r,"d")}rt("m",["mm",2],0,"minute");en("minute","m");tn("minute",14);Ze("m",Vt);Ze("mm",Vt,xn);zt(["m","mm"],Un);var fO=ws("Minutes",!1);rt("s",["ss",2],0,"second");en("second","s");tn("second",15);Ze("s",Vt);Ze("ss",Vt,xn);zt(["s","ss"],ki);var cO=ws("Seconds",!1);rt("S",0,0,function(){return~~(this.millisecond()/100)});rt(0,["SS",2],0,function(){return~~(this.millisecond()/10)});rt(0,["SSS",3],0,"millisecond");rt(0,["SSSS",4],0,function(){return this.millisecond()*10});rt(0,["SSSSS",5],0,function(){return this.millisecond()*100});rt(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});rt(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});rt(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});rt(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});en("millisecond","ms");tn("millisecond",16);Ze("S",Qf,Yw);Ze("SS",Qf,xn);Ze("SSS",Qf,Gw);var ua;for(ua="SSSS";ua.length<=9;ua+="S")Ze(ua,Ix);function hO(e,r){r[Wa]=mt(("0."+e)*1e3)}for(ua="S";ua.length<=9;ua+="S")zt(ua,hO);var dO=ws("Milliseconds",!1);rt("z",0,0,"zoneAbbr");rt("zz",0,0,"zoneName");function vO(){return this._isUTC?"UTC":""}function gO(){return this._isUTC?"Coordinated Universal Time":""}var Ae=Wl.prototype;Ae.add=ET;Ae.calendar=RT;Ae.clone=kT;Ae.diff=LT;Ae.endOf=YT;Ae.format=WT;Ae.from=$T;Ae.fromNow=UT;Ae.to=VT;Ae.toNow=zT;Ae.get=Yx;Ae.invalidAt=tO;Ae.isAfter=AT;Ae.isBefore=MT;Ae.isBetween=DT;Ae.isSame=PT;Ae.isSameOrAfter=NT;Ae.isSameOrBefore=FT;Ae.isValid=QT;Ae.lang=y1;Ae.locale=p1;Ae.localeData=w1;Ae.max=iT;Ae.min=nT;Ae.parsingFlags=eO;Ae.set=Gx;Ae.startOf=jT;Ae.subtract=TT;Ae.toArray=qT;Ae.toObject=ZT;Ae.toDate=KT;Ae.toISOString=HT;Ae.inspect=BT;Ae.toJSON=JT;Ae.toString=IT;Ae.unix=XT;Ae.valueOf=GT;Ae.creationData=rO;Ae.year=qw;Ae.isLeapYear=jx;Ae.weekYear=nO;Ae.isoWeekYear=iO;Ae.quarter=Ae.quarters=lO;Ae.month=t1;Ae.daysInMonth=eE;Ae.week=Ae.weeks=fE;Ae.isoWeek=Ae.isoWeeks=cE;Ae.weeksInYear=oO;Ae.isoWeeksInYear=aO;Ae.date=C1;Ae.day=Ae.days=CE;Ae.weekday=SE;Ae.isoWeekday=bE;Ae.dayOfYear=uO;Ae.hour=Ae.hours=NE;Ae.minute=Ae.minutes=fO;Ae.second=Ae.seconds=cO;Ae.millisecond=Ae.milliseconds=dO;Ae.utcOffset=hT;Ae.utc=vT;Ae.local=gT;Ae.parseZone=mT;Ae.hasAlignedHourOffset=pT;Ae.isDST=yT;Ae.isLocal=_T;Ae.isUtcOffset=CT;Ae.isUtc=v1;Ae.isUTC=v1;Ae.zoneAbbr=vO;Ae.zoneName=gO;Ae.dates=Ln("dates accessor is deprecated. Use date instead.",C1);Ae.months=Ln("months accessor is deprecated. Use month instead",t1);Ae.years=Ln("years accessor is deprecated. Use year instead",qw);Ae.zone=Ln("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",dT);Ae.isDSTShifted=Ln("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",wT);function mO(e){return er(e*1e3)}function pO(){return er.apply(null,arguments).parseZone()}function S1(e){return e}var It=N0.prototype;It.calendar=bx;It.longDateFormat=Ex;It.invalidDate=Ox;It.ordinal=Ax;It.preparse=S1;It.postformat=S1;It.relativeTime=Dx;It.pastFuture=Px;It.set=Cx;It.months=qx;It.monthsShort=Zx;It.monthsParse=Qx;It.monthsRegex=iE;It.monthsShortRegex=rE;It.week=oE;It.firstDayOfYear=uE;It.firstDayOfWeek=lE;It.weekdays=gE;It.weekdaysMin=yE;It.weekdaysShort=mE;It.weekdaysParse=_E;It.weekdaysRegex=EE;It.weekdaysShortRegex=OE;It.weekdaysMinRegex=kE;It.isPM=ME;It.meridiem=PE;function xf(e,r,t,n){var i=Ca(),a=gi().set(n,r);return i[t](a,e)}function b1(e,r,t){if(ho(e)&&(r=e,e=void 0),e=e||"",r!=null)return xf(e,r,t,"month");var n,i=[];for(n=0;n<12;n++)i[n]=xf(e,n,t,"month");return i}function G0(e,r,t,n){typeof e=="boolean"?(ho(r)&&(t=r,r=void 0),r=r||""):(r=e,t=r,e=!1,ho(r)&&(t=r,r=void 0),r=r||"");var i=Ca(),a=e?i._week.dow:0;if(t!=null)return xf(r,(t+a)%7,n,"day");var o,s=[];for(o=0;o<7;o++)s[o]=xf(r,(o+a)%7,n,"day");return s}function yO(e,r){return b1(e,r,"months")}function wO(e,r){return b1(e,r,"monthsShort")}function _O(e,r,t){return G0(e,r,t,"weekdays")}function CO(e,r,t){return G0(e,r,t,"weekdaysShort")}function SO(e,r,t){return G0(e,r,t,"weekdaysMin")}_s("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var r=e%10,t=mt(e%100/10)===1?"th":r===1?"st":r===2?"nd":r===3?"rd":"th";return e+t}});Pe.lang=Ln("moment.lang is deprecated. Use moment.locale instead.",_s);Pe.langData=Ln("moment.langData is deprecated. Use moment.localeData instead.",Ca);var _i=Math.abs;function bO(){var e=this._data;return this._milliseconds=_i(this._milliseconds),this._days=_i(this._days),this._months=_i(this._months),e.milliseconds=_i(e.milliseconds),e.seconds=_i(e.seconds),e.minutes=_i(e.minutes),e.hours=_i(e.hours),e.months=_i(e.months),e.years=_i(e.years),this}function x1(e,r,t,n){var i=Xn(r,t);return e._milliseconds+=n*i._milliseconds,e._days+=n*i._days,e._months+=n*i._months,e._bubble()}function xO(e,r){return x1(this,e,r,1)}function EO(e,r){return x1(this,e,r,-1)}function $g(e){return e<0?Math.floor(e):Math.ceil(e)}function TO(){var e=this._milliseconds,r=this._days,t=this._months,n=this._data,i,a,o,s,l;return e>=0&&r>=0&&t>=0||e<=0&&r<=0&&t<=0||(e+=$g(ed(t)+r)*864e5,r=0,t=0),n.milliseconds=e%1e3,i=Fn(e/1e3),n.seconds=i%60,a=Fn(i/60),n.minutes=a%60,o=Fn(a/60),n.hours=o%24,r+=Fn(o/24),l=Fn(E1(r)),t+=l,r-=$g(ed(l)),s=Fn(t/12),t%=12,n.days=r,n.months=t,n.years=s,this}function E1(e){return e*4800/146097}function ed(e){return e*146097/4800}function OO(e){if(!this.isValid())return NaN;var r,t,n=this._milliseconds;if(e=In(e),e==="month"||e==="year")return r=this._days+n/864e5,t=this._months+E1(r),e==="month"?t:t/12;switch(r=this._days+Math.round(ed(this._months)),e){case"week":return r/7+n/6048e5;case"day":return r+n/864e5;case"hour":return r*24+n/36e5;case"minute":return r*1440+n/6e4;case"second":return r*86400+n/1e3;case"millisecond":return Math.floor(r*864e5)+n;default:throw new Error("Unknown unit "+e)}}function RO(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+mt(this._months/12)*31536e6:NaN}function Sa(e){return function(){return this.as(e)}}var kO=Sa("ms"),AO=Sa("s"),MO=Sa("m"),DO=Sa("h"),PO=Sa("d"),NO=Sa("w"),FO=Sa("M"),LO=Sa("y");function IO(){return Xn(this)}function HO(e){return e=In(e),this.isValid()?this[e+"s"]():NaN}function _o(e){return function(){return this.isValid()?this._data[e]:NaN}}var BO=_o("milliseconds"),WO=_o("seconds"),$O=_o("minutes"),UO=_o("hours"),VO=_o("days"),zO=_o("months"),jO=_o("years");function YO(){return Fn(this.days()/7)}var Gi=Math.round,ii={ss:44,s:45,m:45,h:22,d:26,M:11};function GO(e,r,t,n,i){return i.relativeTime(r||1,!!t,e,n)}function XO(e,r,t){var n=Xn(e).abs(),i=Gi(n.as("s")),a=Gi(n.as("m")),o=Gi(n.as("h")),s=Gi(n.as("d")),l=Gi(n.as("M")),u=Gi(n.as("y")),f=i<=ii.ss&&["s",i]||i<ii.s&&["ss",i]||a<=1&&["m"]||a<ii.m&&["mm",a]||o<=1&&["h"]||o<ii.h&&["hh",o]||s<=1&&["d"]||s<ii.d&&["dd",s]||l<=1&&["M"]||l<ii.M&&["MM",l]||u<=1&&["y"]||["yy",u];return f[2]=r,f[3]=+e>0,f[4]=t,GO.apply(null,f)}function KO(e){return e===void 0?Gi:typeof e=="function"?(Gi=e,!0):!1}function qO(e,r){return ii[e]===void 0?!1:r===void 0?ii[e]:(ii[e]=r,e==="s"&&(ii.ss=r-1),!0)}function ZO(e){if(!this.isValid())return this.localeData().invalidDate();var r=this.localeData(),t=XO(this,!e,r);return e&&(t=r.pastFuture(+this,t)),r.postformat(t)}var lh=Math.abs;function Ao(e){return(e>0)-(e<0)||+e}function sc(){if(!this.isValid())return this.localeData().invalidDate();var e=lh(this._milliseconds)/1e3,r=lh(this._days),t=lh(this._months),n,i,a;n=Fn(e/60),i=Fn(n/60),e%=60,n%=60,a=Fn(t/12),t%=12;var o=a,s=t,l=r,u=i,f=n,c=e?e.toFixed(3).replace(/\.?0+$/,""):"",h=this.asSeconds();if(!h)return"P0D";var d=h<0?"-":"",g=Ao(this._months)!==Ao(h)?"-":"",v=Ao(this._days)!==Ao(h)?"-":"",p=Ao(this._milliseconds)!==Ao(h)?"-":"";return d+"P"+(o?g+o+"Y":"")+(s?g+s+"M":"")+(l?v+l+"D":"")+(u||f||c?"T":"")+(u?p+u+"H":"")+(f?p+f+"M":"")+(c?p+c+"S":"")}var _t=ac.prototype;_t.isValid=uT;_t.abs=bO;_t.add=xO;_t.subtract=EO;_t.as=OO;_t.asMilliseconds=kO;_t.asSeconds=AO;_t.asMinutes=MO;_t.asHours=DO;_t.asDays=PO;_t.asWeeks=NO;_t.asMonths=FO;_t.asYears=LO;_t.valueOf=RO;_t._bubble=TO;_t.clone=IO;_t.get=HO;_t.milliseconds=BO;_t.seconds=WO;_t.minutes=$O;_t.hours=UO;_t.days=VO;_t.weeks=YO;_t.months=zO;_t.years=jO;_t.humanize=ZO;_t.toISOString=sc;_t.toString=sc;_t.toJSON=sc;_t.locale=p1;_t.localeData=w1;_t.toIsoString=Ln("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",sc);_t.lang=y1;rt("X",0,0,"unix");rt("x",0,0,"valueOf");Ze("x",tc);Ze("X",Bx);zt("X",function(e,r,t){t._d=new Date(parseFloat(e,10)*1e3)});zt("x",function(e,r,t){t._d=new Date(mt(e))});//! moment.js
//! version : 2.20.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
Pe.version="2.20.1";yx(er);Pe.fn=Ae;Pe.min=aT;Pe.max=oT;Pe.now=sT;Pe.utc=gi;Pe.unix=mO;Pe.months=yO;Pe.isDate=qf;Pe.locale=_s;Pe.invalid=Zf;Pe.duration=Xn;Pe.isMoment=_a;Pe.weekdays=_O;Pe.parseZone=pO;Pe.localeData=Ca;Pe.isDuration=Zh;Pe.monthsShort=wO;Pe.weekdaysMin=SO;Pe.defineLocale=$0;Pe.updateLocale=LE;Pe.locales=IE;Pe.weekdaysShort=CO;Pe.normalizeUnits=In;Pe.relativeTimeRounding=KO;Pe.relativeTimeThreshold=qO;Pe.calendarFormat=OT;Pe.prototype=Ae;Pe.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"YYYY-[W]WW",MONTH:"YYYY-MM"};const JO=Object.freeze(Object.defineProperty({__proto__:null,default:Pe},Symbol.toStringTag,{value:"Module"}));function ci(e){for(var r=arguments.length,t=new Array(r>1?r-1:0),n=1;n<r;n++)t[n-1]=arguments[n];var i=hn(e,function(a,o,s){var l=o.replace(/(?:\r?\n\s+)/g,""),u=t[s]?t[s]:"";return a+l+u},"");return i.trim()}function T1(){var e=QO([`
          Your license key of Handsontable Pro has expired.‌‌‌‌ 
          Renew your maintenance plan at https://handsontable.com or downgrade to the previous version of the software.
          `]);return T1=function(){return e},e}function QO(e,r){return r||(r=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(r)}}))}function yu(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?yu=function(t){return typeof t}:yu=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yu(e)}function ba(e){var r;switch(yu(e)){case"string":case"number":r="".concat(e);break;case"object":r=e===null?"":e.toString();break;case"undefined":r="";break;default:r=e.toString();break}return r}function ir(e){return typeof e<"u"}function Mr(e){return typeof e>"u"}function bn(e){return e===null||e===""||Mr(e)}function O1(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var Us="length",qs=function(r){return parseInt(r,16)},Ug=function(r){return parseInt(r,10)},Ef=function(r,t,n){return r.substr(t,n)},Zs=function(r){return r.codePointAt(0)-65},td=function(r){return"".concat(r).replace(/\-/g,"")},eR=function(r){return qs(Ef(td(r),qs("12"),Zs("F")))/(qs(Ef(td(r),Zs("B"),~~![][Us]))||9)},tR=function(){return typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},Vg=!1;function rR(e,r){e=td(e||"");var t="",n=!0,i=nR(e),a=tR(),o=bn(e)||e==="trial";if(o||i)if(i){var s=Math.floor(Pe("19/12/2018","DD/MM/YYYY").toDate().getTime()/864e5),l=eR(e);(l>45e3||l!==parseInt(l,10))&&(t="The license key provided to Handsontable Pro is invalid. Make sure you pass it correctly."),t||(s>l+1&&(t=ci(T1())),n=s>l+15)}else t="Evaluation version of Handsontable Pro. Not licensed for use in a production environment.";else t="The license key provided to Handsontable Pro is invalid. Make sure you pass it correctly.";if(a&&(t=!1,n=!1),t&&!Vg&&(console[o?"info":"warn"](t),Vg=!0),n&&r.parentNode){var u=document.createElement("div");u.id="hot-display-license-info",u.appendChild(document.createTextNode("Evaluation version of Handsontable Pro.")),u.appendChild(document.createElement("br")),u.appendChild(document.createTextNode("Not licensed for production use.")),r.parentNode.insertBefore(u,r.nextSibling)}}function nR(e){var r=[][Us],t=r;if(e[Us]!==Zs("Z"))return!1;for(var n="",i="B<H4P+".split(""),a=Zs(i.shift());a;a=Zs(i.shift()||"A"))--a<""[Us]?t=t|(Ug("".concat(Ug(qs(n)+(qs(Ef(e,Math.abs(a),2))+[]).padStart(2,"0"))))%97||2)>>1:n=Ef(e,a,a?i[Us]===1?9:8:6);return t===r}const iR=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:rR,isDefined:ir,isEmpty:bn,isRegExp:O1,isUndefined:Mr,stringify:ba},Symbol.toStringTag,{value:"Module"}));function va(e){return e[0].toUpperCase()+e.substr(1)}function rd(){for(var e=[],r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n];for(var i=t.length;i;){i-=1;var a=ba(t[i]).toLowerCase();e.indexOf(a)===-1&&e.push(a)}return e.length===1}function X0(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}function K0(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function aR(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,function(t,n){return t.charAt(0)==="\\"?t.substr(1,t.length-1):r[n]===void 0?"":r[n]})}var oR=/<\/?\w+\/?>|<\w+[\s|/][^>]*>/gi;function q0(e){return"".concat(e).replace(oR,"")}const sR=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:rd,isPercentValue:K0,randomString:X0,stripTags:q0,substitute:aR,toUpperCaseFirst:va},Symbol.toStringTag,{value:"Module"}));function Or(e){return typeof e=="function"}function R1(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,t=0,n={lastCallThrottled:!0},i=null;function a(){for(var o=this,s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];var f=Date.now(),c=!1;n.lastCallThrottled=!0,t||(t=f,c=!0);var h=r-(f-t);return c?(n.lastCallThrottled=!1,e.apply(this,l)):(i&&clearTimeout(i),i=setTimeout(function(){n.lastCallThrottled=!1,e.apply(o,l),t=0,i=void 0},h)),n}return a}function lR(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,n=R1(e,r),i=t;function a(){i=t}function o(){for(var s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return i?(i-=1,e.apply(this,l)):n.apply(this,l)}return o.clearHits=a,o}function Z0(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,t=null,n;function i(){for(var a=this,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return t&&clearTimeout(t),t=setTimeout(function(){n=e.apply(a,s)},r),n}return i}function uR(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];var n=r[0],i=r.slice(1);return function(){for(var o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return hn(i,function(u,f){return f(u)},n.apply(this,s))}}function J0(e){for(var r=arguments.length,t=new Array(r>1?r-1:0),n=1;n<r;n++)t[n-1]=arguments[n];return function(){for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return e.apply(this,t.concat(o))}}function fR(e){var r=e.length;function t(n){return function(){for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];var l=n.concat(o),u;return l.length>=r?u=e.apply(this,l):u=t(l),u}}return t([])}function cR(e){var r=e.length;function t(n){return function(){for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];var l=n.concat(o.reverse()),u;return l.length>=r?u=e.apply(this,l):u=t(l),u}}return t([])}const hR=Object.freeze(Object.defineProperty({__proto__:null,curry:fR,curryRight:cR,debounce:Z0,isFunction:Or,partial:J0,pipe:uR,throttle:R1,throttleAfterHits:lR},Symbol.toStringTag,{value:"Module"}));function dR(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function zg(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function vR(e,r,t){return r&&zg(e.prototype,r),t&&zg(e,t),e}var Mo=new WeakMap,jg=function(){function e(r){dR(this,e),this.instance=r,this.eventManager=new Ft(r),Mo.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return vR(e,[{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(this.instance.wtTable.holder,"contextmenu",function(a){return t.onContextMenu(a)}),this.eventManager.addEventListener(this.instance.wtTable.TABLE,"mouseover",function(a){return t.onMouseOver(a)}),this.eventManager.addEventListener(this.instance.wtTable.TABLE,"mouseout",function(a){return t.onMouseOut(a)});var n=function(){t.eventManager.addEventListener(t.instance.wtTable.holder,"touchstart",function(o){return t.onTouchStart(o)}),t.eventManager.addEventListener(t.instance.wtTable.holder,"touchend",function(o){return t.onTouchEnd(o)}),t.instance.momentumScrolling||(t.instance.momentumScrolling={}),t.eventManager.addEventListener(t.instance.wtTable.holder,"scroll",function(){clearTimeout(t.instance.momentumScrolling._timeout),t.instance.momentumScrolling.ongoing||t.instance.getSetting("onBeforeTouchScroll"),t.instance.momentumScrolling.ongoing=!0,t.instance.momentumScrolling._timeout=setTimeout(function(){t.instance.touchApplied||(t.instance.momentumScrolling.ongoing=!1,t.instance.getSetting("onAfterMomentumScroll"))},200)})},i=function(){t.eventManager.addEventListener(t.instance.wtTable.holder,"mouseup",function(o){return t.onMouseUp(o)}),t.eventManager.addEventListener(t.instance.wtTable.holder,"mousedown",function(o){return t.onMouseDown(o)})};ui()?n():(O0()&&n(),i()),this.eventManager.addEventListener(window,"resize",function(){t.instance.getSetting("stretchH")!=="none"&&t.instance.draw()})}},{key:"selectedCellWasTouched",value:function(t){var n=Mo.get(this),i=this.parentCell(t),a=i.coords;if(n.selectedCellBeforeTouchEnd&&a){var o=[a.row,n.selectedCellBeforeTouchEnd.from.row],s=o[0],l=o[1],u=[a.col,n.selectedCellBeforeTouchEnd.from.col],f=u[0],c=u[1];return s===l&&f===c}return!1}},{key:"parentCell",value:function(t){var n={},i=this.instance.wtTable.TABLE,a=Ws(t,["TD","TH"],i);return a?(n.coords=this.instance.wtTable.getCoords(a),n.TD=a):gt(t,"wtBorder")&&gt(t,"current")?(n.coords=this.instance.selections.getCell().cellRange.highlight,n.TD=this.instance.wtTable.getCell(n.coords)):gt(t,"wtBorder")&&gt(t,"area")&&this.instance.selections.createOrGetArea().cellRange&&(n.coords=this.instance.selections.createOrGetArea().cellRange.to,n.TD=this.instance.wtTable.getCell(n.coords)),n}},{key:"onMouseDown",value:function(t){var n=Mo.get(this),i=document.activeElement,a=J0(Ow,t.realTarget),o=t.realTarget;if(!(o===i||a(0)===i||a(1)===i)){var s=this.parentCell(o);gt(o,"corner")?this.instance.getSetting("onCellCornerMouseDown",t,o):s.TD&&this.instance.hasSetting("onCellMouseDown")&&this.instance.getSetting("onCellMouseDown",t,s.coords,s.TD,this.instance),t.button!==2&&s.TD&&(n.dblClickOrigin[0]=s.TD,clearTimeout(n.dblClickTimeout[0]),n.dblClickTimeout[0]=setTimeout(function(){n.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(t){if(this.instance.hasSetting("onCellContextMenu")){var n=this.parentCell(t.realTarget);n.TD&&this.instance.getSetting("onCellContextMenu",t,n.coords,n.TD,this.instance)}}},{key:"onMouseOver",value:function(t){if(this.instance.hasSetting("onCellMouseOver")){var n=this.instance.wtTable.TABLE,i=Ws(t.realTarget,["TD","TH"],n),a=this.instance.cloneSource||this.instance;i&&i!==a.lastMouseOver&&Ti(i,n)&&(a.lastMouseOver=i,this.instance.getSetting("onCellMouseOver",t,this.instance.wtTable.getCoords(i),i,this.instance))}}},{key:"onMouseOut",value:function(t){if(this.instance.hasSetting("onCellMouseOut")){var n=this.instance.wtTable.TABLE,i=Ws(t.realTarget,["TD","TH"],n),a=Ws(t.relatedTarget,["TD","TH"],n);i&&i!==a&&Ti(i,n)&&this.instance.getSetting("onCellMouseOut",t,this.instance.wtTable.getCoords(i),i,this.instance)}}},{key:"onMouseUp",value:function(t){if(t.button!==2){var n=Mo.get(this),i=this.parentCell(t.realTarget);i.TD&&this.instance.hasSetting("onCellMouseUp")&&this.instance.getSetting("onCellMouseUp",t,i.coords,i.TD,this.instance),i.TD===n.dblClickOrigin[0]&&i.TD===n.dblClickOrigin[1]?(gt(t.realTarget,"corner")?this.instance.getSetting("onCellCornerDblClick",t,i.coords,i.TD,this.instance):this.instance.getSetting("onCellDblClick",t,i.coords,i.TD,this.instance),n.dblClickOrigin[0]=null,n.dblClickOrigin[1]=null):i.TD===n.dblClickOrigin[0]&&(n.dblClickOrigin[1]=i.TD,clearTimeout(n.dblClickTimeout[1]),n.dblClickTimeout[1]=setTimeout(function(){n.dblClickOrigin[1]=null},500))}}},{key:"onTouchStart",value:function(t){var n=Mo.get(this);n.selectedCellBeforeTouchEnd=this.instance.selections.getCell().cellRange,this.instance.touchApplied=!0,this.onMouseDown(t)}},{key:"onTouchEnd",value:function(t){var n=["A","BUTTON","INPUT"],i=t.target;this.instance.touchApplied=!1,this.selectedCellWasTouched(i)===!1&&n.includes(i.tagName)&&t.preventDefault(),this.onMouseUp(t)}},{key:"destroy",value:function(){var t=Mo.get(this);clearTimeout(t.dblClickTimeout[0]),clearTimeout(t.dblClickTimeout[1]),this.eventManager.destroy()}}]),e}(),De={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL:17,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88};function k1(e){return e===32||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function Q0(e){var r=[De.ARROW_DOWN,De.ARROW_UP,De.ARROW_LEFT,De.ARROW_RIGHT,De.HOME,De.END,De.DELETE,De.BACKSPACE,De.F1,De.F2,De.F3,De.F4,De.F5,De.F6,De.F7,De.F8,De.F9,De.F10,De.F11,De.F12,De.TAB,De.PAGE_DOWN,De.PAGE_UP,De.ENTER,De.ESCAPE,De.SHIFT,De.CAPS_LOCK,De.ALT];return r.indexOf(e)!==-1}function gR(e){var r=[];return window.navigator.platform.includes("Mac")?r.push(De.COMMAND_LEFT,De.COMMAND_RIGHT,De.COMMAND_FIREFOX):r.push(De.CONTROL),r.includes(e)}function ev(e){return[De.CONTROL,De.COMMAND_LEFT,De.COMMAND_RIGHT,De.COMMAND_FIREFOX].includes(e)}function tv(e,r){var t=r.split("|"),n=!1;return pe(t,function(i){if(e===De[i])return n=!0,!1}),n}const mR=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:De,isCtrlKey:gR,isCtrlMetaKey:ev,isKey:tv,isMetaKey:Q0,isPrintableChar:k1},Symbol.toStringTag,{value:"Module"}));function pR(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Yg(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function yR(e,r,t){return r&&Yg(e.prototype,r),t&&Yg(e,t),e}var wR=function(){function e(r){pR(this,e);var t=parseInt(getComputedStyle(document.body).lineHeight,10),n=parseInt(getComputedStyle(document.body).fontSize,10)*1.2;this.wot=r,this.instance=this.wot,this.eventManager=new Ft(this.wot),this.wot.update("scrollbarWidth",Jt()),this.wot.update("scrollbarHeight",Jt()),this.scrollableElement=co(this.wot.wtTable.TABLE),this.prepareOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.overlayScrollPositions={master:{top:0,left:0},top:{top:null,left:0},bottom:{top:null,left:0},left:{top:0,left:null}},this.pendingScrollCallbacks={master:{top:0,left:0},top:{left:0},bottom:{left:0},left:{top:0}},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.delegatedScrollCallback=!1,this.registeredListeners=[],this.browserLineHeight=t||n,this.registerListeners()}return yR(e,[{key:"prepareOverlays",value:function(){var t=!1;return this.topOverlay?t=this.topOverlay.updateStateOfRendering()||t:this.topOverlay=Le.createOverlay(Le.CLONE_TOP,this.wot),Le.hasOverlay(Le.CLONE_BOTTOM)||(this.bottomOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),Le.hasOverlay(Le.CLONE_BOTTOM_LEFT_CORNER)||(this.bottomLeftCornerOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),this.bottomOverlay?t=this.bottomOverlay.updateStateOfRendering()||t:this.bottomOverlay=Le.createOverlay(Le.CLONE_BOTTOM,this.wot),this.leftOverlay?t=this.leftOverlay.updateStateOfRendering()||t:this.leftOverlay=Le.createOverlay(Le.CLONE_LEFT,this.wot),this.topOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.topLeftCornerOverlay?t=this.topLeftCornerOverlay.updateStateOfRendering()||t:this.topLeftCornerOverlay=Le.createOverlay(Le.CLONE_TOP_LEFT_CORNER,this.wot)),this.bottomOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.bottomLeftCornerOverlay?t=this.bottomLeftCornerOverlay.updateStateOfRendering()||t:this.bottomLeftCornerOverlay=Le.createOverlay(Le.CLONE_BOTTOM_LEFT_CORNER,this.wot)),this.wot.getSetting("debug")&&!this.debug&&(this.debug=Le.createOverlay(Le.CLONE_DEBUG,this.wot)),t}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wot.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.leftOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var t=this,n=this.topOverlay.mainTableScrollableElement,i=this.leftOverlay.mainTableScrollableElement,a=[];a.push([document.documentElement,"keydown",function(l){return t.onKeyDown(l)}]),a.push([document.documentElement,"keyup",function(){return t.onKeyUp()}]),a.push([document,"visibilitychange",function(){return t.onKeyUp()}]),a.push([n,"scroll",function(l){return t.onTableScroll(l)}]),n!==i&&a.push([i,"scroll",function(l){return t.onTableScroll(l)}]);var o=window.devicePixelRatio&&window.devicePixelRatio>1;for(o||!Sw()?a.push([this.instance.wtTable.wtRootElement.parentNode,"wheel",function(l){return t.onCloneWheel(l)}]):(this.topOverlay.needFullRender&&a.push([this.topOverlay.clone.wtTable.holder,"wheel",function(l){return t.onCloneWheel(l)}]),this.bottomOverlay.needFullRender&&a.push([this.bottomOverlay.clone.wtTable.holder,"wheel",function(l){return t.onCloneWheel(l)}]),this.leftOverlay.needFullRender&&a.push([this.leftOverlay.clone.wtTable.holder,"wheel",function(l){return t.onCloneWheel(l)}]),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.needFullRender&&a.push([this.topLeftCornerOverlay.clone.wtTable.holder,"wheel",function(l){return t.onCloneWheel(l)}]),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.needFullRender&&a.push([this.bottomLeftCornerOverlay.clone.wtTable.holder,"wheel",function(l){return t.onCloneWheel(l)}])),this.topOverlay.trimmingContainer!==window&&this.leftOverlay.trimmingContainer!==window&&a.push([window,"wheel",function(l){var u,f=l.wheelDeltaY||l.deltaY,c=l.wheelDeltaX||l.deltaX;t.topOverlay.clone.wtTable.holder.contains(l.realTarget)?u="top":t.bottomOverlay.clone&&t.bottomOverlay.clone.wtTable.holder.contains(l.realTarget)?u="bottom":t.leftOverlay.clone.wtTable.holder.contains(l.realTarget)?u="left":t.topLeftCornerOverlay&&t.topLeftCornerOverlay.clone&&t.topLeftCornerOverlay.clone.wtTable.holder.contains(l.realTarget)?u="topLeft":t.bottomLeftCornerOverlay&&t.bottomLeftCornerOverlay.clone&&t.bottomLeftCornerOverlay.clone.wtTable.holder.contains(l.realTarget)&&(u="bottomLeft"),(u==="top"&&f!==0||u==="left"&&c!==0||u==="bottom"&&f!==0||(u==="topLeft"||u==="bottomLeft")&&(f!==0||c!==0))&&l.preventDefault()}]);a.length;){var s=a.pop();this.eventManager.addEventListener(s[0],s[1],s[2]),this.registeredListeners.push(s)}}},{key:"deregisterListeners",value:function(){for(;this.registeredListeners.length;){var t=this.registeredListeners.pop();this.eventManager.removeEventListener(t[0],t[1],t[2])}}},{key:"onTableScroll",value:function(t){var n=this.leftOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,a=t.target;this.keyPressed&&(i!==window&&a!==window&&!t.target.contains(i)||n!==window&&a!==window&&!t.target.contains(n))||this.syncScrollPositions(t)}},{key:"onCloneWheel",value:function(t){this.scrollableElement!==window&&t.preventDefault();var n=this.leftOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,a=t.target,o=i!==window&&a!==window&&!t.target.contains(i),s=n!==window&&a!==window&&!t.target.contains(n);this.keyPressed&&(o||s)||this.translateMouseWheelToScroll(t)}},{key:"onKeyDown",value:function(t){this.keyPressed=tv(t.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(t){var n=isNaN(t.deltaY)?-1*t.wheelDeltaY:t.deltaY,i=isNaN(t.deltaX)?-1*t.wheelDeltaX:t.deltaX;return t.deltaMode===1&&(i+=i*this.browserLineHeight,n+=n*this.browserLineHeight),this.scrollVertically(n),this.scrollHorizontally(i),!1}},{key:"scrollVertically",value:function(t){if(t===0)return 0;this.scrollableElement.scrollTop+=t}},{key:"scrollHorizontally",value:function(t){if(t===0)return 0;this.scrollableElement.scrollLeft+=t}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var t=this.topOverlay.clone.wtTable.holder,n=this.leftOverlay.clone.wtTable.holder,i=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],a=i[0],o=i[1];if(this.horizontalScrolling=t.scrollLeft!==a,this.verticalScrolling=n.scrollTop!==o,this.horizontalScrolling){t.scrollLeft=a;var s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=a)}this.verticalScrolling&&(n.scrollTop=o),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var t=this.topOverlay.mainTableScrollableElement,n=t.scrollLeft,i=t.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.leftOverlay.needFullRender&&(this.leftOverlay.clone.wtTable.holder.scrollTop=i)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.leftOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement(),this.scrollableElement=co(this.wot.wtTable.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.leftOverlay.destroy(),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.destroy(),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.destroy(),this.debug&&this.debug.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted){var n=this.wot.wtTable.wtRootElement.parentNode||this.wot.wtTable.wtRootElement,i=n.clientWidth,a=n.clientHeight;(i!==this.spreaderLastSize.width||a!==this.spreaderLastSize.height)&&(this.spreaderLastSize.width=i,this.spreaderLastSize.height=a,this.adjustElementsSize())}this.bottomOverlay.clone&&this.bottomOverlay.refresh(t),this.leftOverlay.refresh(t),this.topOverlay.refresh(t),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.refresh(t),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.refresh(t),this.debug&&this.debug.refresh(t)}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wot.getSetting("totalColumns"),i=this.wot.getSetting("totalRows"),a=this.wot.wtViewport.getRowHeaderWidth(),o=this.wot.wtViewport.getColumnHeaderHeight(),s=this.wot.wtTable.hider.style;s.width="".concat(a+this.leftOverlay.sumCellSizes(0,n),"px"),s.height="".concat(o+this.topOverlay.sumCellSizes(0,i)+1,"px"),this.topOverlay.adjustElementsSize(t),this.leftOverlay.adjustElementsSize(t),this.bottomOverlay.clone&&this.bottomOverlay.adjustElementsSize(t)}},{key:"applyToDOM",value:function(){(!this.topOverlay.areElementSizesAdjusted||!this.leftOverlay.areElementSizesAdjusted)&&this.adjustElementsSize(),this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.leftOverlay.applyToDOM()}},{key:"getParentOverlay",value:function(t){if(!t)return null;var n=[this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay],i=null;return pe(n,function(a){a&&a.clone&&a.clone.wtTable.TABLE.contains(t)&&(i=a.clone)}),i}}]),e}();function wu(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?wu=function(t){return typeof t}:wu=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wu(e)}function bi(e){var r=wu(e);return r=="number"?!isNaN(e)&&isFinite(e):r=="string"?e.length?e.length==1?/\d/.test(e):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(e):!1:r=="object"?!!e&&typeof e.valueOf()=="number"&&!(e instanceof Date):!1}function Ke(e,r,t){var n=-1;for(typeof r=="function"?(t=r,r=e):n=e-1;++n<=r&&t(n)!==!1;);}function fs(e,r,t){var n=e+1;for(typeof r=="function"&&(t=r,r=0);--n>=r&&t(n)!==!1;);}function rv(e,r){return r=parseInt(r.toString().replace("%",""),10),r=parseInt(e*r/100,10),r}const _R=Object.freeze(Object.defineProperty({__proto__:null,isNumeric:bi,rangeEach:Ke,rangeEachReverse:fs,valueAccordingPercent:rv},Symbol.toStringTag,{value:"Module"}));function CR(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Gg(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function SR(e,r,t){return r&&Gg(e.prototype,r),t&&Gg(e,t),e}var Xg=function(){function e(r){CR(this,e),this.wot=r,this.instance=r}return SR(e,[{key:"scrollViewport",value:function(t,n,i,a,o){var s=this.scrollViewportHorizontally(t.col,i,o),l=this.scrollViewportVertically(t.row,n,a);return s||l}},{key:"scrollViewportHorizontally",value:function(t,n,i){if(!this.wot.drawn)return!1;var a=this._getVariables(),o=a.fixedColumnsLeft,s=a.leftOverlay,l=a.totalColumns,u=!1;return t>=0&&t<=Math.max(l-1,0)&&(t>=o&&(t<this.getFirstVisibleColumn()||i)?u=s.scrollTo(t):(t>this.getLastVisibleColumn()||n)&&(u=s.scrollTo(t,!0))),u}},{key:"scrollViewportVertically",value:function(t,n,i){if(!this.wot.drawn)return!1;var a=this._getVariables(),o=a.fixedRowsBottom,s=a.fixedRowsTop,l=a.topOverlay,u=a.totalRows,f=!1;return t>=0&&t<=Math.max(u-1,0)&&(t>=s&&(t<this.getFirstVisibleRow()||n)?f=l.scrollTo(t):(t>this.getLastVisibleRow()&&t<u-o||i)&&(f=l.scrollTo(t,!0))),f}},{key:"getFirstVisibleRow",value:function(){var t=this._getVariables(),n=t.topOverlay,i=t.wtTable,a=t.wtViewport,o=t.totalRows,s=t.fixedRowsTop,l=i.getFirstVisibleRow();if(n.mainTableScrollableElement===window){var u=Xt(i.wtRootElement),f=fi(i.hider),c=fi(window),h=cl(window);if(u.top+f-c<=h){var d=a.getColumnHeaderHeight();d+=n.sumCellSizes(0,s),fs(o,1,function(g){if(d+=n.sumCellSizes(g-1,g),u.top+f-d<=h)return l=g,!1})}}return l}},{key:"getLastVisibleRow",value:function(){var t=this._getVariables(),n=t.topOverlay,i=t.wtTable,a=t.wtViewport,o=t.totalRows,s=i.getLastVisibleRow();if(n.mainTableScrollableElement===window){var l=Xt(i.wtRootElement),u=fi(window),f=cl(window);if(l.top>f){var c=a.getColumnHeaderHeight();Ke(1,o,function(h){if(c+=n.sumCellSizes(h-1,h),l.top+c-f>=u)return s=h-2,!1})}}return s}},{key:"getFirstVisibleColumn",value:function(){var t=this._getVariables(),n=t.leftOverlay,i=t.wtTable,a=t.wtViewport,o=t.totalColumns,s=i.getFirstVisibleColumn();if(n.mainTableScrollableElement===window){var l=Xt(i.wtRootElement),u=oo(i.hider),f=oo(window),c=wf(window);if(l.left+u-f<=c){var h=a.getRowHeaderWidth();fs(o,1,function(d){if(h+=n.sumCellSizes(d-1,d),l.left+u-h<=c)return s=d,!1})}}return s}},{key:"getLastVisibleColumn",value:function(){var t=this._getVariables(),n=t.leftOverlay,i=t.wtTable,a=t.wtViewport,o=t.totalColumns,s=i.getLastVisibleColumn();if(n.mainTableScrollableElement===window){var l=Xt(i.wtRootElement),u=oo(window),f=wf(window);if(l.left>f){var c=a.getRowHeaderWidth();Ke(1,o,function(h){if(c+=n.sumCellSizes(h-1,h),l.left+c-f>=u)return s=h-2,!1})}}return s}},{key:"_getVariables",value:function(){var t=this.wot,n=t.wtOverlays.topOverlay,i=t.wtOverlays.leftOverlay,a=t.wtTable,o=t.wtViewport,s=t.getSetting("totalRows"),l=t.getSetting("totalColumns"),u=t.getSetting("fixedRowsTop"),f=t.getSetting("fixedRowsBottom"),c=t.getSetting("fixedColumnsLeft");return{topOverlay:n,leftOverlay:i,wtTable:a,wtViewport:o,totalRows:s,totalColumns:l,fixedRowsTop:u,fixedRowsBottom:f,fixedColumnsLeft:c}}}]),e}();function bR(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Kg(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function xR(e,r,t){return r&&Kg(e.prototype,r),t&&Kg(e,t),e}var ER=function(){function e(r,t){var n=this;bR(this,e),this.wot=r,this.instance=r,this.defaults={table:void 0,debug:!1,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},data:void 0,freezeOverlays:!1,fixedColumnsLeft:0,fixedRowsTop:0,fixedRowsBottom:0,minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(a,o,s){var l=n.getSetting("data",a,o);ps(s,l??"")},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(a){return a},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null},this.settings={},St(this.defaults,function(i,a){if(t[a]!==void 0)n.settings[a]=t[a];else{if(i===void 0)throw new Error('A required setting "'.concat(a,'" was not provided'));n.settings[a]=i}})}return xR(e,[{key:"update",value:function(t,n){var i=this;return n===void 0?St(t,function(a,o){i.settings[o]=a}):this.settings[t]=n,this.wot}},{key:"getSetting",value:function(t,n,i,a,o){return typeof this.settings[t]=="function"?this.settings[t](n,i,a,o):n!==void 0&&Array.isArray(this.settings[t])?this.settings[t][n]:this.settings[t]}},{key:"has",value:function(t){return!!this.settings[t]}}]),e}();function fa(){if(ir(console)){var e;(e=console).warn.apply(e,arguments)}}function TR(){if(ir(console)){var e;(e=console).error.apply(e,arguments)}}function A1(){var e=OR([`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting the number 
          of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`]);return A1=function(){return e},e}function OR(e,r){return r||(r=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(r)}}))}function RR(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function qg(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function kR(e,r,t){return r&&qg(e.prototype,r),t&&qg(e,t),e}var Zg=!1,AR=function(){function e(r){RR(this,e),this.wtTable=r,this.wot=r.instance,this.instance=r.instance,this.rowFilter=r.rowFilter,this.columnFilter=r.columnFilter,this.TABLE=r.TABLE,this.THEAD=r.THEAD,this.TBODY=r.TBODY,this.COLGROUP=r.COLGROUP,this.rowHeaders=[],this.rowHeaderCount=0,this.columnHeaders=[],this.columnHeaderCount=0,this.fixedRowsTop=0,this.fixedRowsBottom=0}return kR(e,[{key:"render",value:function(){if(!this.wtTable.isWorkingOnClone()){var t={};if(this.wot.getSetting("beforeDraw",!0,t),t.skipRender===!0)return}this.rowHeaders=this.wot.getSetting("rowHeaders"),this.rowHeaderCount=this.rowHeaders.length,this.fixedRowsTop=this.wot.getSetting("fixedRowsTop"),this.fixedRowsBottom=this.wot.getSetting("fixedRowsBottom"),this.columnHeaders=this.wot.getSetting("columnHeaders"),this.columnHeaderCount=this.columnHeaders.length;var n=this.wtTable.getRenderedColumnsCount(),i=this.wtTable.getRenderedRowsCount(),a=this.wot.getSetting("totalColumns"),o=this.wot.getSetting("totalRows"),s,l=!1;if((Le.isOverlayTypeOf(this.wot.cloneOverlay,Le.CLONE_BOTTOM)||Le.isOverlayTypeOf(this.wot.cloneOverlay,Le.CLONE_BOTTOM_LEFT_CORNER))&&(this.columnHeaders=[],this.columnHeaderCount=0),a>=0&&(this.adjustAvailableNodes(),l=!0,this.renderColumnHeaders(),this.renderRows(o,i,n),this.wtTable.isWorkingOnClone()||(s=this.wot.wtViewport.getWorkspaceWidth(),this.wot.wtViewport.containerWidth=null),this.adjustColumnWidths(n),this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights()),l||this.adjustAvailableNodes(),this.removeRedundantRows(i),(!this.wtTable.isWorkingOnClone()||this.wot.isOverlayName(Le.CLONE_BOTTOM))&&this.markOversizedRows(),this.wtTable.isWorkingOnClone())this.wot.isOverlayName(Le.CLONE_BOTTOM)&&this.wot.cloneSource.wtOverlays.adjustElementsSize();else{this.wot.wtViewport.createVisibleCalculators(),this.wot.wtOverlays.refresh(!1),this.wot.wtOverlays.applyToDOM();var u=Gt(this.wtTable.hider),f=Gt(this.wtTable.TABLE);if(u!==0&&f!==u&&this.adjustColumnWidths(n),s!==this.wot.wtViewport.getWorkspaceWidth()){this.wot.wtViewport.containerWidth=null;var c=this.wtTable.getFirstRenderedColumn(),h=this.wtTable.getLastRenderedColumn(),d=this.wot.getSetting("defaultColumnWidth"),g=this.wot.getSetting("rowHeaderWidth");if(g=this.instance.getSetting("onModifyRowHeaderWidth",g),g!=null)for(var v=0;v<this.rowHeaderCount;v++){var p=Array.isArray(g)?g[v]:g;p=p??d,this.COLGROUP.childNodes[v].style.width="".concat(p,"px")}for(var C=c;C<h;C++){var F=this.wtTable.getStretchedColumnWidth(C),D=this.columnFilter.sourceToRendered(C);this.COLGROUP.childNodes[D+this.rowHeaderCount].style.width="".concat(F,"px")}}this.wot.getSetting("onDraw",!0)}}},{key:"removeRedundantRows",value:function(t){for(;this.wtTable.tbodyChildrenLength>t;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength-=1}},{key:"renderRows",value:function(t,n,i){for(var a,o=0,s=this.rowFilter.renderedToSource(o),l=this.wtTable.isWorkingOnClone();s<t&&s>=0&&(!Zg&&o>1e3&&(Zg=!0,fa(ci(A1()))),!(n!==void 0&&o===n));){if(a=this.getOrCreateTrForRow(o,a),this.renderRowHeaders(s,a),this.adjustColumns(a,i+this.rowHeaderCount),this.renderCells(s,a,i),(!l||this.wot.isOverlayName(Le.CLONE_BOTTOM))&&this.resetOversizedRow(s),a.firstChild){var u=this.wot.wtTable.getRowHeight(s);u?(u-=1,a.firstChild.style.height="".concat(u,"px")):a.firstChild.style.height=""}o+=1,s=this.rowFilter.renderedToSource(o)}}},{key:"resetOversizedRow",value:function(t){this.wot.getSetting("externalRowCalculator")||this.wot.wtViewport.oversizedRows&&this.wot.wtViewport.oversizedRows[t]&&(this.wot.wtViewport.oversizedRows[t]=void 0)}},{key:"markOversizedRows",value:function(){if(!this.wot.getSetting("externalRowCalculator")){var t=this.instance.wtTable.TBODY.childNodes.length,n=t*this.instance.wtSettings.settings.defaultRowHeight,i=fi(this.instance.wtTable.TBODY)-1,a,o,s,l,u;if(!(n===i&&!this.instance.getSetting("fixedRowsBottom")))for(;t;)t-=1,s=this.instance.wtTable.rowFilter.renderedToSource(t),a=this.instance.wtTable.getRowHeight(s),l=this.instance.wtTable.getTrForRow(s),u=l.querySelector("th"),u?o=fi(u):o=fi(l)-1,(!a&&this.instance.wtSettings.settings.defaultRowHeight<o||a<o)&&(o+=1,this.instance.wtViewport.oversizedRows[s]=o)}}},{key:"markOversizedColumnHeaders",value:function(){var t=this.wot.getOverlayName();if(!(!this.columnHeaderCount||this.wot.wtViewport.hasOversizedColumnHeadersMarked[t]||this.wtTable.isWorkingOnClone())){for(var n=this.wtTable.getRenderedColumnsCount(),i=0;i<this.columnHeaderCount;i++)for(var a=-1*this.rowHeaderCount;a<n;a++)this.markIfOversizedColumnHeader(a);this.wot.wtViewport.hasOversizedColumnHeadersMarked[t]=!0}}},{key:"adjustColumnHeaderHeights",value:function(){for(var t=this.wot.getSetting("columnHeaders"),n=this.wot.wtTable.THEAD.childNodes,i=this.wot.wtViewport.oversizedColumnHeaders,a=0,o=t.length;a<o;a++)if(i[a]){if(!n[a]||n[a].childNodes.length===0)return;n[a].childNodes[0].style.height="".concat(i[a],"px")}}},{key:"markIfOversizedColumnHeader",value:function(t){for(var n=this.wot.wtTable.columnFilter.renderedToSource(t),i=this.columnHeaderCount,a=this.wot.wtSettings.settings.defaultRowHeight,o,s,l,u=this.wot.getSetting("columnHeaderHeight")||[];i;)i-=1,o=this.wot.wtTable.getColumnHeaderHeight(i),s=this.wot.wtTable.getColumnHeader(n,i),s&&(l=fi(s),(!o&&a<l||o<l)&&(this.wot.wtViewport.oversizedColumnHeaders[i]=l),Array.isArray(u)?u[i]!==null&&u[i]!==void 0&&(this.wot.wtViewport.oversizedColumnHeaders[i]=u[i]):isNaN(u)||(this.wot.wtViewport.oversizedColumnHeaders[i]=u),this.wot.wtViewport.oversizedColumnHeaders[i]<(u[i]||u)&&(this.wot.wtViewport.oversizedColumnHeaders[i]=u[i]||u))}},{key:"renderCells",value:function(t,n,i){for(var a,o,s=0;s<i;s++)o=this.columnFilter.renderedToSource(s),s===0?a=n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(o)]:a=a.nextSibling,a.nodeName==="TH"&&(a=DR(a,n)),gt(a,"hide")||(a.className=""),a.removeAttribute("style"),this.wot.wtSettings.settings.cellRenderer(t,o,a);return a}},{key:"adjustColumnWidths",value:function(t){var n=0,i=this.wot.cloneSource?this.wot.cloneSource:this.wot,a=i.wtTable.holder,o=this.wot.getSetting("defaultColumnWidth"),s=this.wot.getSetting("rowHeaderWidth");if(a.offsetHeight<a.scrollHeight&&(n=Jt()),this.wot.wtViewport.columnsRenderCalculator.refreshStretching(this.wot.wtViewport.getViewportWidth()-n),s=this.instance.getSetting("onModifyRowHeaderWidth",s),s!=null)for(var l=0;l<this.rowHeaderCount;l++){var u=Array.isArray(s)?s[l]:s;u=u??o,this.COLGROUP.childNodes[l].style.width="".concat(u,"px")}for(var f=0;f<t;f++){var c=this.wtTable.getStretchedColumnWidth(this.columnFilter.renderedToSource(f));this.COLGROUP.childNodes[f+this.rowHeaderCount].style.width="".concat(c,"px")}}},{key:"appendToTbody",value:function(t){this.TBODY.appendChild(t),this.wtTable.tbodyChildrenLength+=1}},{key:"getOrCreateTrForRow",value:function(t,n){var i;return t>=this.wtTable.tbodyChildrenLength?(i=this.createRow(),this.appendToTbody(i)):t===0?i=this.TBODY.firstChild:i=n.nextSibling,i.className&&i.removeAttribute("class"),i}},{key:"createRow",value:function(){for(var t=document.createElement("TR"),n=0;n<this.rowHeaderCount;n++)t.appendChild(document.createElement("TH"));return t}},{key:"renderRowHeader",value:function(t,n,i){i.className="",i.removeAttribute("style"),this.rowHeaders[n](t,i,n)}},{key:"renderRowHeaders",value:function(t,n){for(var i=n.firstChild,a=0;a<this.rowHeaderCount;a++)i?i.nodeName==="TD"&&(i=MR(i,n)):(i=document.createElement("TH"),n.appendChild(i)),this.renderRowHeader(t,a,i),i=i.nextSibling}},{key:"adjustAvailableNodes",value:function(){this.adjustColGroups(),this.adjustThead()}},{key:"renderColumnHeaders",value:function(){if(this.columnHeaderCount)for(var t=this.wtTable.getRenderedColumnsCount(),n=0;n<this.columnHeaderCount;n++)for(var i=this.getTrForColumnHeaders(n),a=-1*this.rowHeaderCount;a<t;a++){var o=this.columnFilter.renderedToSource(a);this.renderColumnHeader(n,o,i.childNodes[a+this.rowHeaderCount])}}},{key:"adjustColGroups",value:function(){for(var t=this.wtTable.getRenderedColumnsCount();this.wtTable.colgroupChildrenLength<t+this.rowHeaderCount;)this.COLGROUP.appendChild(document.createElement("COL")),this.wtTable.colgroupChildrenLength+=1;for(;this.wtTable.colgroupChildrenLength>t+this.rowHeaderCount;)this.COLGROUP.removeChild(this.COLGROUP.lastChild),this.wtTable.colgroupChildrenLength-=1;this.rowHeaderCount&&$e(this.COLGROUP.childNodes[0],"rowHeader")}},{key:"adjustThead",value:function(){var t=this.wtTable.getRenderedColumnsCount(),n=this.THEAD.firstChild;if(this.columnHeaders.length){for(var i=0,a=this.columnHeaders.length;i<a;i++){for(n=this.THEAD.childNodes[i],n||(n=document.createElement("TR"),this.THEAD.appendChild(n)),this.theadChildrenLength=n.childNodes.length;this.theadChildrenLength<t+this.rowHeaderCount;)n.appendChild(document.createElement("TH")),this.theadChildrenLength+=1;for(;this.theadChildrenLength>t+this.rowHeaderCount;)n.removeChild(n.lastChild),this.theadChildrenLength-=1}var o=this.THEAD.childNodes.length;if(o>this.columnHeaders.length)for(var s=this.columnHeaders.length;s<o;s++)this.THEAD.removeChild(this.THEAD.lastChild)}else n&&Gn(n)}},{key:"getTrForColumnHeaders",value:function(t){return this.THEAD.childNodes[t]}},{key:"renderColumnHeader",value:function(t,n,i){return i.className="",i.removeAttribute("style"),this.columnHeaders[t](n,i,t)}},{key:"adjustColumns",value:function(t,n){for(var i=t.childNodes.length;i<n;){var a=document.createElement("TD");t.appendChild(a),i+=1}for(;i>n;)t.removeChild(t.lastChild),i-=1}},{key:"removeRedundantColumns",value:function(t){for(;this.wtTable.tbodyChildrenLength>t;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength-=1}}]),e}();function MR(e,r){var t=document.createElement("TH");return r.insertBefore(t,e),r.removeChild(e),t}function DR(e,r){var t=document.createElement("TD");return r.insertBefore(t,e),r.removeChild(e),t}function PR(e){return LR(e)||FR(e)||NR()}function NR(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function FR(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}function LR(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}function _u(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_u=function(t){return typeof t}:_u=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_u(e)}function IR(e,r){return WR(e)||BR(e,r)||HR()}function HR(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function BR(e,r){var t=[],n=!0,i=!1,a=void 0;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done)&&(t.push(s.value),!(r&&t.length===r));n=!0);}catch(l){i=!0,a=l}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw a}}return t}function WR(e){if(Array.isArray(e))return e}function $R(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Jg(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function UR(e,r,t){return r&&Jg(e.prototype,r),t&&Jg(e,t),e}var Qg=function(){function e(r,t){var n=this;$R(this,e),this.wot=r,this.instance=this.wot,this.TABLE=t,this.TBODY=null,this.THEAD=null,this.COLGROUP=null,this.tableOffset=0,this.holderOffset=0,k0(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.colgroupChildrenLength=this.COLGROUP.childNodes.length,this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0,this.tbodyChildrenLength=this.TBODY.childNodes.length,this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var i=this.wot.wtSettings.settings.rowHeaderWidth;this.wot.wtSettings.settings.rowHeaderWidth=function(){return n._modifyRowHeaderWidth(i)}}return UR(e,[{key:"fixTableDomTree",value:function(){this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=document.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=document.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=document.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD)),this.wot.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length&&this.THEAD.appendChild(document.createElement("TR"))}},{key:"createSpreader",value:function(t){var n=t.parentNode,i;return(!n||n.nodeType!==1||!gt(n,"wtHolder"))&&(i=document.createElement("div"),i.className="wtSpreader",n&&n.insertBefore(i,t),i.appendChild(t)),i.style.position="relative",i}},{key:"createHider",value:function(t){var n=t.parentNode,i;return(!n||n.nodeType!==1||!gt(n,"wtHolder"))&&(i=document.createElement("div"),i.className="wtHider",n&&n.insertBefore(i,t),i.appendChild(t)),i}},{key:"createHolder",value:function(t){var n=t.parentNode,i;return(!n||n.nodeType!==1||!gt(n,"wtHolder"))&&(i=document.createElement("div"),i.style.position="relative",i.className="wtHolder",n&&n.insertBefore(i,t),this.isWorkingOnClone()||(i.parentNode.className+="ht_master handsontable"),i.appendChild(t)),i}},{key:"alignOverlaysWithTrimmingContainer",value:function(){var t=us(this.wtRootElement);if(!this.isWorkingOnClone())if(this.holder.parentNode.style.position="relative",t===window){var n=this.wot.getSetting("preventOverflow");n||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else this.holder.style.width=_f(t,"width"),this.holder.style.height=_f(t,"height"),this.holder.style.overflow=""}},{key:"isWorkingOnClone",value:function(){return!!this.wot.cloneSource}},{key:"draw",value:function(t){var n=this.wot,i=n.wtOverlays,a=n.wtViewport,o=this.instance.getSetting("totalRows"),s=this.wot.getSetting("rowHeaders").length,l=this.wot.getSetting("columnHeaders").length,u=!1,f=t;if(!this.isWorkingOnClone()&&(this.holderOffset=Xt(this.holder),f=a.createRenderCalculators(f),s&&!this.wot.getSetting("fixedColumnsLeft"))){var c=i.leftOverlay.getScrollPosition(),h=this.correctHeaderWidth;this.correctHeaderWidth=c>0,h!==this.correctHeaderWidth&&(f=!1)}if(this.isWorkingOnClone()||(u=i.prepareOverlays()),f)this.isWorkingOnClone()||a.createVisibleCalculators(),i&&i.refresh(!0);else{this.isWorkingOnClone()?this.tableOffset=this.wot.cloneSource.wtTable.tableOffset:this.tableOffset=Xt(this.TABLE);var d;Le.isOverlayTypeOf(this.wot.cloneOverlay,Le.CLONE_DEBUG)||Le.isOverlayTypeOf(this.wot.cloneOverlay,Le.CLONE_TOP)||Le.isOverlayTypeOf(this.wot.cloneOverlay,Le.CLONE_TOP_LEFT_CORNER)?d=0:Le.isOverlayTypeOf(this.instance.cloneOverlay,Le.CLONE_BOTTOM)||Le.isOverlayTypeOf(this.instance.cloneOverlay,Le.CLONE_BOTTOM_LEFT_CORNER)?d=Math.max(o-this.wot.getSetting("fixedRowsBottom"),0):d=a.rowsRenderCalculator.startRow;var g;Le.isOverlayTypeOf(this.wot.cloneOverlay,Le.CLONE_DEBUG)||Le.isOverlayTypeOf(this.wot.cloneOverlay,Le.CLONE_LEFT)||Le.isOverlayTypeOf(this.wot.cloneOverlay,Le.CLONE_TOP_LEFT_CORNER)||Le.isOverlayTypeOf(this.wot.cloneOverlay,Le.CLONE_BOTTOM_LEFT_CORNER)?g=0:g=a.columnsRenderCalculator.startColumn,this.rowFilter=new qb(d,o,l),this.columnFilter=new Gb(g,this.wot.getSetting("totalColumns"),s),this.alignOverlaysWithTrimmingContainer(),this._doDraw()}return this.refreshSelections(f),this.isWorkingOnClone()||(i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&i.bottomOverlay.resetFixedPosition(),i.leftOverlay.resetFixedPosition(),i.topLeftCornerOverlay&&i.topLeftCornerOverlay.resetFixedPosition(),i.bottomLeftCornerOverlay&&i.bottomLeftCornerOverlay.clone&&i.bottomLeftCornerOverlay.resetFixedPosition()),u&&i.syncScrollWithMaster(),this.wot.drawn=!0,this}},{key:"_doDraw",value:function(){var t=new AR(this);t.render()}},{key:"removeClassFromCells",value:function(t){for(var n=this.TABLE.querySelectorAll(".".concat(t)),i=0,a=n.length;i<a;i++)pt(n[i],t)}},{key:"refreshSelections",value:function(t){if(this.wot.selections){var n=Array.from(this.wot.selections),i=n.length;if(t){for(var a=[],o=0;o<i;o++){for(var s=n[o].settings,l=s.highlightHeaderClassName,u=s.highlightRowClassName,f=s.highlightColumnClassName,c=n[o].classNames,h=c.length,d=0;d<h;d++)a.includes(c[d])||a.push(c[d]);l&&!a.includes(l)&&a.push(l),u&&!a.includes(u)&&a.push(u),f&&!a.includes(f)&&a.push(f)}var g=this.wot.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(g))for(var v=0;v<g.length;v++)a.push(g[v]);for(var p=a.length,C=0;C<p;C++)this.removeClassFromCells(a[C])}for(var F=0;F<i;F++)n[F].draw(this.wot,t)}}},{key:"getCell",value:function(t){var n=t.row,i=t.col,a=this.wot.getSetting("onModifyGetCellCoords",n,i);if(a&&Array.isArray(a)){var o=IR(a,2);n=o[0],i=o[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;var s=this.TBODY.childNodes[this.rowFilter.sourceToRendered(n)];if(s)return s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)]}},{key:"getColumnHeader",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=this.THEAD.childNodes[n];if(i)return i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t)]}},{key:"getRowHeader",value:function(t){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return null;var n=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)];if(n)return n.childNodes[0]}},{key:"getCoords",value:function(t){var n=t;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=ao(n,["TD","TH"])),n===null)return null;var i=n.parentNode,a=i.parentNode,o=Aw(i),s=n.cellIndex;return $s(Le.CLONE_TOP_LEFT_CORNER,n)||$s(Le.CLONE_TOP,n)?a.nodeName==="THEAD"&&(o-=a.childNodes.length):a===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):o=this.rowFilter.renderedToSource(o),$s(Le.CLONE_TOP_LEFT_CORNER,n)||$s(Le.CLONE_LEFT,n)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),new me(o,s)}},{key:"getTrForRow",value:function(t){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)]}},{key:"getFirstRenderedRow",value:function(){return this.wot.wtViewport.rowsRenderCalculator.startRow}},{key:"getFirstVisibleRow",value:function(){return this.wot.wtViewport.rowsVisibleCalculator.startRow}},{key:"getFirstRenderedColumn",value:function(){return this.wot.wtViewport.columnsRenderCalculator.startColumn}},{key:"getFirstVisibleColumn",value:function(){return this.wot.wtViewport.columnsVisibleCalculator.startColumn}},{key:"getLastRenderedRow",value:function(){return this.wot.wtViewport.rowsRenderCalculator.endRow}},{key:"getLastVisibleRow",value:function(){return this.wot.wtViewport.rowsVisibleCalculator.endRow}},{key:"getLastRenderedColumn",value:function(){return this.wot.wtViewport.columnsRenderCalculator.endColumn}},{key:"getLastVisibleColumn",value:function(){return this.wot.wtViewport.columnsVisibleCalculator.endColumn}},{key:"isRowBeforeRenderedRows",value:function(t){return this.rowFilter&&this.rowFilter.sourceToRendered(t)<0&&t>=0}},{key:"isRowAfterViewport",value:function(t){return this.rowFilter&&this.rowFilter.sourceToRendered(t)>this.getLastVisibleRow()}},{key:"isRowAfterRenderedRows",value:function(t){return this.rowFilter&&this.rowFilter.sourceToRendered(t)>this.getLastRenderedRow()}},{key:"isColumnBeforeViewport",value:function(t){return this.columnFilter&&this.columnFilter.sourceToRendered(t)<0&&t>=0}},{key:"isColumnAfterViewport",value:function(t){return this.columnFilter&&this.columnFilter.sourceToRendered(t)>this.getLastVisibleColumn()}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"getRenderedColumnsCount",value:function(){var t=this.wot.wtViewport.columnsRenderCalculator.count,n=this.wot.getSetting("totalColumns");if(this.wot.isOverlayName(Le.CLONE_DEBUG))t=n;else if(this.wot.isOverlayName(Le.CLONE_LEFT)||this.wot.isOverlayName(Le.CLONE_TOP_LEFT_CORNER)||this.wot.isOverlayName(Le.CLONE_BOTTOM_LEFT_CORNER))return Math.min(this.wot.getSetting("fixedColumnsLeft"),n);return t}},{key:"getRenderedRowsCount",value:function(){var t=this.wot.wtViewport.rowsRenderCalculator.count,n=this.wot.getSetting("totalRows");return this.wot.isOverlayName(Le.CLONE_DEBUG)?t=n:this.wot.isOverlayName(Le.CLONE_TOP)||this.wot.isOverlayName(Le.CLONE_TOP_LEFT_CORNER)?t=Math.min(this.wot.getSetting("fixedRowsTop"),n):(this.wot.isOverlayName(Le.CLONE_BOTTOM)||this.wot.isOverlayName(Le.CLONE_BOTTOM_LEFT_CORNER))&&(t=Math.min(this.wot.getSetting("fixedRowsBottom"),n)),t}},{key:"getVisibleRowsCount",value:function(){return this.wot.wtViewport.rowsVisibleCalculator.count}},{key:"allRowsInViewport",value:function(){return this.wot.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"getRowHeight",value:function(t){var n=this.wot.wtSettings.settings.rowHeight(t),i=this.wot.wtViewport.oversizedRows[t];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}},{key:"getColumnHeaderHeight",value:function(t){var n=this.wot.wtSettings.settings.defaultRowHeight,i=this.wot.wtViewport.oversizedColumnHeaders[t];return i!==void 0&&(n=n?Math.max(n,i):i),n}},{key:"getVisibleColumnsCount",value:function(){return this.wot.wtViewport.columnsVisibleCalculator.count}},{key:"allColumnsInViewport",value:function(){return this.wot.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getColumnWidth",value:function(t){var n=this.wot.wtSettings.settings.columnWidth;return typeof n=="function"?n=n(t):_u(n)==="object"&&(n=n[t]),n||this.wot.wtSettings.settings.defaultColumnWidth}},{key:"getStretchedColumnWidth",value:function(t){var n=this.getColumnWidth(t),i=n??this.instance.wtSettings.settings.defaultColumnWidth,a=this.wot.wtViewport.columnsRenderCalculator;if(a){var o=a.getStretchedColumnWidth(t,i);o&&(i=o)}return i}},{key:"_modifyRowHeaderWidth",value:function(t){var n=Or(t)?t():null;return Array.isArray(n)?(n=PR(n),n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}},{key:"_correctRowHeaderWidth",value:function(t){var n=t;return typeof t!="number"&&(n=this.wot.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}]),e}();function VR(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function em(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function zR(e,r,t){return r&&em(e.prototype,r),t&&em(e,t),e}var jR=function(){function e(r){var t=this;VR(this,e),this.wot=r,this.instance=this.wot,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=new Ft(this.wot),this.eventManager.addEventListener(window,"resize",function(){t.clientHeight=t.getWorkspaceHeight()})}return zR(e,[{key:"getWorkspaceHeight",value:function(){var t=this.instance.wtOverlays.topOverlay.trimmingContainer,n,i=0;return t===window?i=document.documentElement.clientHeight:(n=sr(t),i=n>0&&t.clientHeight>0?t.clientHeight:1/0),i}},{key:"getWorkspaceWidth",value:function(){var t,n=this.wot.getSetting("totalColumns"),i=this.instance.wtOverlays.leftOverlay.trimmingContainer,a,o=this.wot.getSetting("stretchH"),s=document.documentElement.offsetWidth,l=this.wot.getSetting("preventOverflow");return l?Gt(this.instance.wtTable.wtRootElement):(this.wot.getSetting("freezeOverlays")?t=Math.min(s-this.getWorkspaceOffset().left,s):t=Math.min(this.getContainerFillWidth(),s-this.getWorkspaceOffset().left,s),i===window&&n>0&&this.sumColumnWidths(0,n-1)>t?document.documentElement.clientWidth:i!==window&&(a=_f(this.instance.wtOverlays.leftOverlay.trimmingContainer,"overflow"),a==="scroll"||a==="hidden"||a==="auto")?Math.max(t,i.clientWidth):o==="none"||!o?Math.max(t,Gt(this.instance.wtTable.TABLE)):t)}},{key:"hasVerticalScroll",value:function(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(t,n){for(var i=this.wot.wtTable,a=0,o=t;o<n;)a+=i.getColumnWidth(o),o+=1;return a}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var t=this.instance.wtTable.holder,n=document.createElement("div");n.style.width="100%",n.style.height="1px",t.appendChild(n);var i=n.offsetWidth;return this.containerWidth=i,t.removeChild(n),i}},{key:"getWorkspaceOffset",value:function(){return Xt(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualHeight",value:function(){return sr(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualWidth",value:function(){return Gt(this.wot.wtTable.TABLE)||Gt(this.wot.wtTable.TBODY)||Gt(this.wot.wtTable.THEAD)}},{key:"getColumnHeaderHeight",value:function(){return isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=sr(this.wot.wtTable.THEAD)),this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var t=this.getWorkspaceHeight();if(t===1/0)return t;var n=this.getColumnHeaderHeight();return n>0&&(t-=n),t}},{key:"getRowHeaderWidth",value:function(){var t=this.instance.getSetting("rowHeaderWidth"),n=this.instance.getSetting("rowHeaders");if(t){this.rowHeaderWidth=0;for(var i=0,a=n.length;i<a;i++)this.rowHeaderWidth+=t[i]||t}if(this.wot.cloneSource)return this.wot.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth))if(n.length){var o=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var s=0,l=n.length;s<l;s++)o?(this.rowHeaderWidth+=Gt(o),o=o.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.instance.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var t=this.getWorkspaceWidth();if(t===1/0)return t;var n=this.getRowHeaderWidth();return n>0?t-n:t}},{key:"createRowsCalculator",value:function(){var t=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i,a,o;this.rowHeaderWidth=NaN,this.wot.wtSettings.settings.renderAllRows&&!n?i=1/0:i=this.getViewportHeight();var s=this.wot.wtOverlays.topOverlay.getScrollPosition()-this.wot.wtOverlays.topOverlay.getTableParentOffset();s<0&&(s=0);var l=this.wot.getSetting("fixedRowsTop"),u=this.wot.getSetting("fixedRowsBottom"),f=this.wot.getSetting("totalRows");return l&&(o=this.wot.wtOverlays.topOverlay.sumCellSizes(0,l),s+=o,i-=o),u&&this.wot.wtOverlays.bottomOverlay.clone&&(o=this.wot.wtOverlays.bottomOverlay.sumCellSizes(f-u,f),i-=o),this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight?a=0:a=Jt(),new Wb(i,s,this.wot.getSetting("totalRows"),function(c){return t.wot.wtTable.getRowHeight(c)},n?null:this.wot.wtSettings.settings.viewportRowCalculatorOverride,n,a)}},{key:"createColumnsCalculator",value:function(){var t=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=this.getViewportWidth(),a=this.wot.wtOverlays.leftOverlay.getScrollPosition()-this.wot.wtOverlays.leftOverlay.getTableParentOffset();this.columnHeaderHeight=NaN,a<0&&(a=0);var o=this.wot.getSetting("fixedColumnsLeft");if(o){var s=this.wot.wtOverlays.leftOverlay.sumCellSizes(0,o);a+=s,i-=s}return this.wot.wtTable.holder.clientWidth!==this.wot.wtTable.holder.offsetWidth&&(i-=Jt()),new T0(i,a,this.wot.getSetting("totalColumns"),function(l){return t.wot.wtTable.getColumnWidth(l)},n?null:this.wot.wtSettings.settings.viewportColumnCalculatorOverride,n,this.wot.getSetting("stretchH"),function(l,u){return t.wot.getSetting("onBeforeStretchingColumnWidth",l,u)})}},{key:"createRenderCalculators",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=t;if(n){var i=this.createRowsCalculator(!0),a=this.createColumnsCalculator(!0);this.areAllProposedVisibleRowsAlreadyRendered(i)&&this.areAllProposedVisibleColumnsAlreadyRendered(a)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(),this.columnsRenderCalculator=this.createColumnsCalculator()),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(!0),this.columnsVisibleCalculator=this.createColumnsCalculator(!0)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(t){return this.rowsVisibleCalculator?t.startRow<this.rowsRenderCalculator.startRow||t.startRow===this.rowsRenderCalculator.startRow&&t.startRow>0?!1:!(t.endRow>this.rowsRenderCalculator.endRow||t.endRow===this.rowsRenderCalculator.endRow&&t.endRow<this.wot.getSetting("totalRows")-1):!1}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(t){return this.columnsVisibleCalculator?t.startColumn<this.columnsRenderCalculator.startColumn||t.startColumn===this.columnsRenderCalculator.startColumn&&t.startColumn>0?!1:!(t.endColumn>this.columnsRenderCalculator.endColumn||t.endColumn===this.columnsRenderCalculator.endColumn&&t.endColumn<this.wot.getSetting("totalColumns")-1):!1}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){St(this.hasOversizedColumnHeadersMarked,function(t,n,i){i[n]=void 0})}}]),e}();function YR(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function tm(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function GR(e,r,t){return r&&tm(e.prototype,r),t&&tm(e,t),e}var M1=function(){function e(r){YR(this,e);var t=[];if(this.guid="wt_".concat(X0()),r.cloneSource?(this.cloneSource=r.cloneSource,this.cloneOverlay=r.cloneOverlay,this.wtSettings=r.cloneSource.wtSettings,this.wtTable=new Qg(this,r.table,r.wtRootElement),this.wtScroll=new Xg(this),this.wtViewport=r.cloneSource.wtViewport,this.wtEvent=new jg(this),this.selections=this.cloneSource.selections):(this.wtSettings=new ER(this,r),this.wtTable=new Qg(this,r.table),this.wtScroll=new Xg(this),this.wtViewport=new jR(this),this.wtEvent=new jg(this),this.selections=this.getSetting("selections"),this.wtOverlays=new wR(this),this.exportSettingsAsClassNames()),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;n<i;n++)t.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(a,o){ps(o,t[a])}])}this.drawn=!1,this.drawInterrupted=!1}return GR(e,[{key:"draw",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!t&&!ls(this.wtTable.TABLE)?this.drawInterrupted=!0:this.wtTable.draw(t),this}},{key:"getCell",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!n)return this.wtTable.getCell(t);var i=this.wtSettings.getSetting("totalRows"),a=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsLeft");if(t.row<a&&t.col<s)return this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(t);if(t.row<a)return this.wtOverlays.topOverlay.clone.wtTable.getCell(t);if(t.col<s&&t.row>=i-o){if(this.wtOverlays.bottomLeftCornerOverlay&&this.wtOverlays.bottomLeftCornerOverlay.clone)return this.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell(t)}else{if(t.col<s)return this.wtOverlays.leftOverlay.clone.wtTable.getCell(t);if(t.row<i&&t.row>i-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(t)}return this.wtTable.getCell(t)}},{key:"update",value:function(t,n){return this.wtSettings.update(t,n)}},{key:"scrollViewport",value:function(t,n,i,a,o){return this.wtScroll.scrollViewport(t,n,i,a,o)}},{key:"scrollViewportHorizontally",value:function(t,n,i){return this.wtScroll.scrollViewportHorizontally(t,n,i)}},{key:"scrollViewportVertically",value:function(t,n,i){return this.wtScroll.scrollViewportVertically(t,n,i)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"getOverlayName",value:function(){return this.cloneOverlay?this.cloneOverlay.type:"master"}},{key:"isOverlayName",value:function(t){return this.cloneOverlay?this.cloneOverlay.type===t:!1}},{key:"exportSettingsAsClassNames",value:function(){var t=this,n={rowHeaders:["array"],columnHeaders:["array"]},i=[],a=[];St(n,function(o,s){o.indexOf("array")>-1&&t.getSetting(s).length&&a.push("ht".concat(va(s))),i.push("ht".concat(va(s)))}),pt(this.wtTable.wtRootElement.parentNode,i),$e(this.wtTable.wtRootElement.parentNode,a)}},{key:"getSetting",value:function(t,n,i,a,o){return this.wtSettings.getSetting(t,n,i,a,o)}},{key:"hasSetting",value:function(t){return this.wtSettings.has(t)}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}}]),e}();function XR(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function rm(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function nm(e,r,t){return r&&rm(e.prototype,r),t&&rm(e,t),e}var Ls={},Le=function(){nm(e,null,[{key:"registerOverlay",value:function(t,n){if(e.CLONE_TYPES.indexOf(t)===-1)throw new Error("Unsupported overlay (".concat(t,")."));Ls[t]=n}},{key:"createOverlay",value:function(t,n){return new Ls[t](n)}},{key:"hasOverlay",value:function(t){return Ls[t]!==void 0}},{key:"isOverlayTypeOf",value:function(t,n){return!t||!Ls[n]?!1:t instanceof Ls[n]}},{key:"CLONE_TOP",get:function(){return"top"}},{key:"CLONE_BOTTOM",get:function(){return"bottom"}},{key:"CLONE_LEFT",get:function(){return"left"}},{key:"CLONE_TOP_LEFT_CORNER",get:function(){return"top_left_corner"}},{key:"CLONE_BOTTOM_LEFT_CORNER",get:function(){return"bottom_left_corner"}},{key:"CLONE_DEBUG",get:function(){return"debug"}},{key:"CLONE_TYPES",get:function(){return[e.CLONE_TOP,e.CLONE_BOTTOM,e.CLONE_LEFT,e.CLONE_TOP_LEFT_CORNER,e.CLONE_BOTTOM_LEFT_CORNER,e.CLONE_DEBUG]}}]);function e(r){XR(this,e),os(this,"wot",r,{writable:!1}),this.instance=this.wot,this.type="",this.mainTableScrollableElement=null,this.TABLE=this.wot.wtTable.TABLE,this.hider=this.wot.wtTable.hider,this.spreader=this.wot.wtTable.spreader,this.holder=this.wot.wtTable.holder,this.wtRootElement=this.wot.wtTable.wtRootElement,this.trimmingContainer=us(this.hider.parentNode.parentNode),this.areElementSizesAdjusted=!1,this.updateStateOfRendering()}return nm(e,[{key:"updateStateOfRendering",value:function(){var t=this.needFullRender;this.needFullRender=this.shouldBeRendered();var n=t!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=us(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){this.mainTableScrollableElement=co(this.wot.wtTable.TABLE)}},{key:"makeClone",value:function(t){if(e.CLONE_TYPES.indexOf(t)===-1)throw new Error('Clone type "'.concat(t,'" is not supported.'));var n=document.createElement("DIV"),i=document.createElement("TABLE");n.className="ht_clone_".concat(t," handsontable"),n.style.position="absolute",n.style.top=0,n.style.left=0,n.style.overflow="hidden",i.className=this.wot.wtTable.TABLE.className,n.appendChild(i),this.type=t,this.wot.wtTable.wtRootElement.parentNode.appendChild(n);var a=this.wot.getSetting("preventOverflow");return a===!0||a==="horizontal"&&this.type===e.CLONE_TOP||a==="vertical"&&this.type===e.CLONE_LEFT?this.mainTableScrollableElement=window:this.mainTableScrollableElement=co(this.wot.wtTable.TABLE),new M1({cloneSource:this.wot,cloneOverlay:this,table:i})}},{key:"refresh",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(t),this.needFullRender=n}},{key:"reset",value:function(){if(this.clone){var t=this.clone.wtTable.holder,n=this.clone.wtTable.hider,i=t.style,a=n.style,o=t.parentNode.style;pe([i,a,o],function(s){s.width="",s.height=""})}}},{key:"destroy",value:function(){new Ft(this.clone).destroy()}}]),e}();function Cu(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Cu=function(t){return typeof t}:Cu=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cu(e)}function KR(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function qR(e,r){return r&&(Cu(r)==="object"||typeof r=="function")?r:ZR(e)}function ZR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nd(e){return nd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},nd(e)}function JR(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&id(e,r)}function id(e,r){return id=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},id(e,r)}var QR=function(e){JR(r,e);function r(t){var n;return KR(this,r),n=qR(this,nd(r).call(this,t)),n.clone=n.makeClone(Le.CLONE_DEBUG),n.clone.wtTable.holder.style.opacity=.4,n.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000",$e(n.clone.wtTable.holder.parentNode,"wtDebugVisible"),n}return r}(Le);Le.registerOverlay(Le.CLONE_DEBUG,QR);function Su(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Su=function(t){return typeof t}:Su=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Su(e)}function ek(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function im(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function tk(e,r,t){return r&&im(e.prototype,r),t&&im(e,t),e}function rk(e,r){return r&&(Su(r)==="object"||typeof r=="function")?r:nk(e)}function nk(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ad(e){return ad=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ad(e)}function ik(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&od(e,r)}function od(e,r){return od=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},od(e,r)}var ak=function(e){ik(r,e);function r(t){var n;return ek(this,r),n=rk(this,ad(r).call(this,t)),n.clone=n.makeClone(Le.CLONE_LEFT),n}return tk(r,[{key:"shouldBeRendered",value:function(){return!!(this.wot.getSetting("fixedColumnsLeft")||this.wot.getSetting("rowHeaders").length)}},{key:"resetFixedPosition",value:function(){if(!(!this.needFullRender||!this.wot.wtTable.holder.parentNode)){var n=this.clone.wtTable.holder.parentNode,i=0,a=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===window&&(!a||a!=="horizontal")){var o=this.wot.wtTable.hider.getBoundingClientRect(),s=Math.ceil(o.left),l=Math.ceil(o.right),u,f;f=this.wot.wtTable.hider.style.top,f=f===""?0:f,s<0&&l-n.offsetWidth>0?u=-s:u=0,i=u,u+="px",Xf(n,u,f)}else i=this.getScrollPosition(),wa(n);this.adjustHeaderBordersPosition(i),this.adjustElementsSize()}}},{key:"setScrollPosition",value:function(n){var i=!1;return this.mainTableScrollableElement===window&&window.scrollX!==n?(window.scrollTo(n,wo()),i=!0):this.mainTableScrollableElement.scrollLeft!==n&&(this.mainTableScrollableElement.scrollLeft=n,i=!0),i}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(n,i){for(var a=this.wot.wtSettings.defaultColumnWidth,o=n,s=0;o<i;)s+=this.wot.wtTable.getStretchedColumnWidth(o)||a,o+=1;return s}},{key:"adjustElementsSize",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||n)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),n||(this.areElementSizesAdjusted=!0))}},{key:"adjustRootElementSize",value:function(){var n=this.wot.wtTable.holder,i=n.clientHeight===n.offsetHeight?0:Jt(),a=this.clone.wtTable.holder.parentNode,o=a.style,s=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||s==="vertical"){var l=this.wot.wtViewport.getWorkspaceHeight()-i;l=Math.min(l,fi(this.wot.wtTable.wtRootElement)),o.height="".concat(l,"px")}else o.height="";this.clone.wtTable.holder.style.height=o.height;var u=Gt(this.clone.wtTable.TABLE);o.width="".concat(u===0?u:u+4,"px")}},{key:"adjustRootChildrenSize",value:function(){var n=Jt();this.clone.wtTable.hider.style.height=this.hider.style.height,this.clone.wtTable.holder.style.height=this.clone.wtTable.holder.parentNode.style.height,n===0&&(n=30),this.clone.wtTable.holder.style.width="".concat(parseInt(this.clone.wtTable.holder.parentNode.style.width,10)+n,"px")}},{key:"applyToDOM",value:function(){var n=this.wot.getSetting("totalColumns");if(this.areElementSizesAdjusted||this.adjustElementsSize(),typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style.left="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else if(n===0)this.spreader.style.left="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(n,i){var a=this.getTableParentOffset(),o=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=o.wtTable.holder,l=0;return i&&s.offsetWidth!==s.clientWidth&&(l=Jt()),i?(a+=this.sumCellSizes(0,n+1),a-=this.wot.wtViewport.getViewportWidth()):a+=this.sumCellSizes(this.wot.getSetting("fixedColumnsLeft"),n),a+=l,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){var n=this.wot.getSetting("preventOverflow"),i=0;return!n&&this.trimmingContainer===window&&(i=this.wot.wtTable.holderOffset.left),i}},{key:"getScrollPosition",value:function(){return wf(this.mainTableScrollableElement)}},{key:"adjustHeaderBordersPosition",value:function(n){var i=this.wot.wtTable.holder.parentNode,a=this.wot.getSetting("rowHeaders"),o=this.wot.getSetting("fixedColumnsLeft"),s=this.wot.getSetting("totalRows");if(s?pt(i,"emptyRows"):$e(i,"emptyRows"),o&&!a.length)$e(i,"innerBorderLeft");else if(!o&&a.length){var l=gt(i,"innerBorderLeft");n?$e(i,"innerBorderLeft"):pt(i,"innerBorderLeft"),(!l&&n||l&&!n)&&this.wot.wtOverlays.adjustElementsSize()}}}]),r}(Le);Le.registerOverlay(Le.CLONE_LEFT,ak);function bu(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?bu=function(t){return typeof t}:bu=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bu(e)}function ok(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function am(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function sk(e,r,t){return r&&am(e.prototype,r),t&&am(e,t),e}function lk(e,r){return r&&(bu(r)==="object"||typeof r=="function")?r:uk(e)}function uk(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sd(e){return sd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},sd(e)}function fk(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&ld(e,r)}function ld(e,r){return ld=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},ld(e,r)}var ck=function(e){fk(r,e);function r(t){var n;return ok(this,r),n=lk(this,sd(r).call(this,t)),n.clone=n.makeClone(Le.CLONE_TOP),n}return sk(r,[{key:"shouldBeRendered",value:function(){return!!(this.wot.getSetting("fixedRowsTop")||this.wot.getSetting("columnHeaders").length)}},{key:"resetFixedPosition",value:function(){if(!(!this.needFullRender||!this.wot.wtTable.holder.parentNode)){var n=this.clone.wtTable.holder.parentNode,i=0,a=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===window&&(!a||a!=="vertical")){var o=this.wot.wtTable.hider.getBoundingClientRect(),s=Math.ceil(o.top),l=Math.ceil(o.bottom),u,f;u=this.wot.wtTable.hider.style.left,u=u===""?0:u,s<0&&l-n.offsetHeight>0?f=-s:f=0,i=f,f+="px",Xf(n,u,f)}else i=this.getScrollPosition(),wa(n);this.adjustHeaderBordersPosition(i),this.adjustElementsSize()}}},{key:"setScrollPosition",value:function(n){var i=!1;return this.mainTableScrollableElement===window&&window.scrollY!==n?(window.scrollTo(ya(),n),i=!0):this.mainTableScrollableElement.scrollTop!==n&&(this.mainTableScrollableElement.scrollTop=n,i=!0),i}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(n,i){for(var a=this.wot.wtSettings.settings.defaultRowHeight,o=n,s=0;o<i;){var l=this.wot.wtTable.getRowHeight(o);s+=l===void 0?a:l,o+=1}return s}},{key:"adjustElementsSize",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||n)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),n||(this.areElementSizesAdjusted=!0))}},{key:"adjustRootElementSize",value:function(){var n=this.wot.wtTable.holder,i=n.clientWidth===n.offsetWidth?0:Jt(),a=this.clone.wtTable.holder.parentNode,o=a.style,s=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||s==="horizontal"){var l=this.wot.wtViewport.getWorkspaceWidth()-i;l=Math.min(l,oo(this.wot.wtTable.wtRootElement)),o.width="".concat(l,"px")}else o.width="";this.clone.wtTable.holder.style.width=o.width;var u=sr(this.clone.wtTable.TABLE);o.height="".concat(u===0?u:u+4,"px")}},{key:"adjustRootChildrenSize",value:function(){var n=Jt();this.clone.wtTable.hider.style.width=this.hider.style.width,this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width,n===0&&(n=30),this.clone.wtTable.holder.style.height="".concat(parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+n,"px")}},{key:"applyToDOM",value:function(){var n=this.wot.getSetting("totalRows");if(this.areElementSizesAdjusted||this.adjustElementsSize(),typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(n===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.left="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.left=""}},{key:"scrollTo",value:function(n,i){var a=this.getTableParentOffset(),o=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=o.wtTable.holder,l=0;if(i&&s.offsetHeight!==s.clientHeight&&(l=Jt()),i){var u=this.wot.getSetting("fixedRowsBottom"),f=this.wot.getSetting("totalRows");a+=this.sumCellSizes(0,n+1),a-=this.wot.wtViewport.getViewportHeight()-this.sumCellSizes(f-u,f),a+=1}else a+=this.sumCellSizes(this.wot.getSetting("fixedRowsTop"),n);return a+=l,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===window?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return cl(this.mainTableScrollableElement)}},{key:"redrawSelectionBorders",value:function(n){if(n&&n.cellRange){var i=n.getBorder(this.wot),a=n.getCorners();i.disappear(),i.appear(a)}}},{key:"redrawAllSelectionsBorders",value:function(){var n=this,i=this.wot.selections;this.redrawSelectionBorders(i.getCell()),pe(i.getAreas(),function(a){n.redrawSelectionBorders(a)}),this.redrawSelectionBorders(i.getFill()),this.wot.wtTable.wot.wtOverlays.leftOverlay.refresh()}},{key:"adjustHeaderBordersPosition",value:function(n){var i=this.wot.wtTable.holder.parentNode,a=this.wot.getSetting("totalColumns");if(a?pt(i,"emptyColumns"):$e(i,"emptyColumns"),this.wot.getSetting("fixedRowsTop")===0&&this.wot.getSetting("columnHeaders").length>0){var o=gt(i,"innerBorderTop");n||this.wot.getSetting("totalRows")===0?$e(i,"innerBorderTop"):pt(i,"innerBorderTop"),(!o&&n||o&&!n)&&(this.wot.wtOverlays.adjustElementsSize(),this.redrawAllSelectionsBorders())}if(this.wot.getSetting("rowHeaders").length===0){var s=this.clone.wtTable.THEAD.querySelectorAll("th:nth-of-type(2)");if(s)for(var l=0;l<s.length;l++)s[l].style["border-left-width"]=0}}}]),r}(Le);Le.registerOverlay(Le.CLONE_TOP,ck);function xu(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?xu=function(t){return typeof t}:xu=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xu(e)}function hk(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function om(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function dk(e,r,t){return r&&om(e.prototype,r),t&&om(e,t),e}function vk(e,r){return r&&(xu(r)==="object"||typeof r=="function")?r:gk(e)}function gk(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ud(e){return ud=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ud(e)}function mk(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&fd(e,r)}function fd(e,r){return fd=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},fd(e,r)}var pk=function(e){mk(r,e);function r(t){var n;return hk(this,r),n=vk(this,ud(r).call(this,t)),n.clone=n.makeClone(Le.CLONE_TOP_LEFT_CORNER),n}return dk(r,[{key:"shouldBeRendered",value:function(){return!!((this.wot.getSetting("fixedRowsTop")||this.wot.getSetting("columnHeaders").length)&&(this.wot.getSetting("fixedColumnsLeft")||this.wot.getSetting("rowHeaders").length))}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!!this.wot.wtTable.holder.parentNode){var n=this.clone.wtTable.holder.parentNode,i=sr(this.clone.wtTable.TABLE),a=Gt(this.clone.wtTable.TABLE),o=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===window){var s=this.wot.wtTable.hider.getBoundingClientRect(),l=Math.ceil(s.top),u=Math.ceil(s.left),f=Math.ceil(s.bottom),c=Math.ceil(s.right),h="0",d="0";(!o||o==="vertical")&&u<0&&c-n.offsetWidth>0&&(h="".concat(-u,"px")),(!o||o==="horizontal")&&l<0&&f-n.offsetHeight>0&&(d="".concat(-l,"px")),Xf(n,h,d)}else wa(n);n.style.height="".concat(i===0?i:i+4,"px"),n.style.width="".concat(a===0?a:a+4,"px")}}}]),r}(Le);Le.registerOverlay(Le.CLONE_TOP_LEFT_CORNER,pk);function Eu(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Eu=function(t){return typeof t}:Eu=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eu(e)}function yk(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function sm(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function wk(e,r,t){return r&&sm(e.prototype,r),t&&sm(e,t),e}function _k(e,r){return r&&(Eu(r)==="object"||typeof r=="function")?r:Ck(e)}function Ck(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cd(e){return cd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},cd(e)}function Sk(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&hd(e,r)}function hd(e,r){return hd=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},hd(e,r)}var bk=function(e){Sk(r,e);function r(t){var n;return yk(this,r),n=_k(this,cd(r).call(this,t)),n.clone=n.makeClone(Le.CLONE_BOTTOM),n}return wk(r,[{key:"repositionOverlay",value:function(){var n=Jt(),i=this.clone.wtTable.holder.parentNode;this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight&&(n=0),i.style.top="",i.style.bottom="".concat(n,"px")}},{key:"shouldBeRendered",value:function(){return!!this.wot.getSetting("fixedRowsBottom")}},{key:"resetFixedPosition",value:function(){if(!(!this.needFullRender||!this.wot.wtTable.holder.parentNode)){var n=this.clone.wtTable.holder.parentNode,i=0;if(n.style.top="",this.wot.wtOverlays.leftOverlay.trimmingContainer===window){var a=this.wot.wtTable.hider.getBoundingClientRect(),o=Math.ceil(a.bottom),s,l,u=document.body.offsetHeight;s=this.wot.wtTable.hider.style.left,s=s===""?0:s,o>u?l=o-u:l=0,i=l,l+="px",n.style.top="",n.style.left=s,n.style.bottom=l}else i=this.getScrollPosition(),wa(n),this.repositionOverlay();this.adjustHeaderBordersPosition(i)}}},{key:"setScrollPosition",value:function(n){this.mainTableScrollableElement===window?window.scrollTo(ya(),n):this.mainTableScrollableElement.scrollTop=n}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(n,i){for(var a=n,o=0,s=this.wot.wtSettings.settings.defaultRowHeight;a<i;){var l=this.wot.wtTable.getRowHeight(a);o+=l===void 0?s:l,a+=1}return o}},{key:"adjustElementsSize",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||n)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),n||(this.areElementSizesAdjusted=!0))}},{key:"adjustRootElementSize",value:function(){var n=this.wot.wtTable.holder,i=n.clientWidth===n.offsetWidth?0:Jt(),a=this.clone.wtTable.holder.parentNode,o=a.style;this.trimmingContainer===window?o.width="":o.width="".concat(this.wot.wtViewport.getWorkspaceWidth()-i,"px"),this.clone.wtTable.holder.style.width=o.width;var s=sr(this.clone.wtTable.TABLE);o.height="".concat(s,"px")}},{key:"adjustRootChildrenSize",value:function(){var n=Jt();this.clone.wtTable.hider.style.width=this.hider.style.width,this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width,n===0&&(n=30),this.clone.wtTable.holder.style.height="".concat(parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+n,"px")}},{key:"applyToDOM",value:function(){var n=this.wot.getSetting("totalRows");if(this.areElementSizesAdjusted||this.adjustElementsSize(),typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(n===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.left="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.left=""}},{key:"scrollTo",value:function(n,i){var a=this.getTableParentOffset(),o=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=o.wtTable.holder,l=0;i&&s.offsetHeight!==s.clientHeight&&(l=Jt()),i?(a+=this.sumCellSizes(0,n+1),a-=this.wot.wtViewport.getViewportHeight(),a+=1):a+=this.sumCellSizes(this.wot.getSetting("fixedRowsBottom"),n),a+=l,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===window?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return cl(this.mainTableScrollableElement)}},{key:"adjustHeaderBordersPosition",value:function(n){if(this.wot.getSetting("fixedRowsBottom")===0&&this.wot.getSetting("columnHeaders").length>0){var i=this.wot.wtTable.holder.parentNode,a=gt(i,"innerBorderTop");n?$e(i,"innerBorderTop"):pt(i,"innerBorderTop"),(!a&&n||a&&!n)&&this.wot.wtOverlays.adjustElementsSize()}if(this.wot.getSetting("rowHeaders").length===0){var o=this.clone.wtTable.THEAD.querySelector("th:nth-of-type(2)");o&&(o.style["border-left-width"]=0)}}}]),r}(Le);Le.registerOverlay(Le.CLONE_BOTTOM,bk);function Tu(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Tu=function(t){return typeof t}:Tu=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tu(e)}function xk(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function lm(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ek(e,r,t){return r&&lm(e.prototype,r),t&&lm(e,t),e}function Tk(e,r){return r&&(Tu(r)==="object"||typeof r=="function")?r:Ok(e)}function Ok(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dd(e){return dd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},dd(e)}function Rk(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&vd(e,r)}function vd(e,r){return vd=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},vd(e,r)}var kk=function(e){Rk(r,e);function r(t){var n;return xk(this,r),n=Tk(this,dd(r).call(this,t)),n.clone=n.makeClone(Le.CLONE_BOTTOM_LEFT_CORNER),n}return Ek(r,[{key:"shouldBeRendered",value:function(){return!!(this.wot.getSetting("fixedRowsBottom")&&(this.wot.getSetting("fixedColumnsLeft")||this.wot.getSetting("rowHeaders").length))}},{key:"repositionOverlay",value:function(){var n=Jt(),i=this.clone.wtTable.holder.parentNode;this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight&&(n=0),i.style.top="",i.style.bottom="".concat(n,"px")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!!this.wot.wtTable.holder.parentNode){var n=this.clone.wtTable.holder.parentNode,i=sr(this.clone.wtTable.TABLE),a=Gt(this.clone.wtTable.TABLE);if(n.style.top="",this.trimmingContainer===window){var o=this.wot.wtTable.hider.getBoundingClientRect(),s=Math.ceil(o.bottom),l=Math.ceil(o.left),u,f,c=document.body.offsetHeight;l<0?u=-l:u=0,s>c?f=s-c:f=0,f+="px",u+="px",n.style.top="",n.style.left=u,n.style.bottom=f}else wa(n),this.repositionOverlay();n.style.height="".concat(i,"px"),n.style.width="".concat(a,"px")}}}]),r}(Le);Le.registerOverlay(Le.CLONE_BOTTOM_LEFT_CORNER,kk);function uh(e,r){return Dk(e)||Mk(e,r)||Ak()}function Ak(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function Mk(e,r){var t=[],n=!0,i=!1,a=void 0;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done)&&(t.push(s.value),!(r&&t.length===r));n=!0);}catch(l){i=!0,a=l}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw a}}return t}function Dk(e){if(Array.isArray(e))return e}function Pk(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function um(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Nk(e,r,t){return r&&um(e.prototype,r),t&&um(e,t),e}var Fk=function(){function e(r,t){Pk(this,e),t&&(this.eventManager=new Ft(r),this.instance=r,this.wot=r,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.left=null,this.bottom=null,this.right=null,this.topStyle=null,this.leftStyle=null,this.bottomStyle=null,this.rightStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}return Nk(e,[{key:"registerListeners",value:function(){var t=this;this.eventManager.addEventListener(document.body,"mousedown",function(){return t.onMouseDown()}),this.eventManager.addEventListener(document.body,"mouseup",function(){return t.onMouseUp()});for(var n=function(s,l){t.eventManager.addEventListener(t.main.childNodes[s],"mouseenter",function(u){return t.onMouseEnter(u,t.main.childNodes[s])})},i=0,a=this.main.childNodes.length;i<a;i++)n(i)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(t,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;t.preventDefault(),Hr(t);var i=this,a=n.getBoundingClientRect();n.style.display="none";function o(l){if(l.clientY<Math.floor(a.top)||l.clientY>Math.ceil(a.top+a.height)||l.clientX<Math.floor(a.left)||l.clientX>Math.ceil(a.left+a.width))return!0}function s(l){o(l)&&(i.eventManager.removeEventListener(document.body,"mousemove",s),n.style.display="block")}this.eventManager.addEventListener(document.body,"mousemove",s)}},{key:"createBorders",value:function(t){this.main=document.createElement("div");var n=["top","left","bottom","right","corner"],i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(var a=0;a<5;a++){var o=n[a],s=document.createElement("div");s.className="wtBorder ".concat(this.settings.className||""),this.settings[o]&&this.settings[o].hide&&(s.className+=" hidden"),i=s.style,i.backgroundColor=this.settings[o]&&this.settings[o].color?this.settings[o].color:t.border.color,i.height=this.settings[o]&&this.settings[o].width?"".concat(this.settings[o].width,"px"):"".concat(t.border.width,"px"),i.width=this.settings[o]&&this.settings[o].width?"".concat(this.settings[o].width,"px"):"".concat(t.border.width,"px"),this.main.appendChild(s)}this.top=this.main.childNodes[0],this.left=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.right=this.main.childNodes[3],this.topStyle=this.top.style,this.leftStyle=this.left.style,this.bottomStyle=this.bottom.style,this.rightStyle=this.right.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),ui()&&this.createMultipleSelectorHandles(),this.disappear();var l=this.wot.wtTable.bordersHolder;l||(l=document.createElement("div"),l.className="htBorders",this.wot.wtTable.bordersHolder=l,this.wot.wtTable.spreader.appendChild(l)),l.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var t=this;this.selectionHandles={topLeft:document.createElement("DIV"),topLeftHitArea:document.createElement("DIV"),bottomRight:document.createElement("DIV"),bottomRightHitArea:document.createElement("DIV")};var n=10,i=40;this.selectionHandles.topLeft.className="topLeftSelectionHandle",this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea",this.selectionHandles.bottomRight.className="bottomRightSelectionHandle",this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};var a={position:"absolute",height:"".concat(i,"px"),width:"".concat(i,"px"),"border-radius":"".concat(parseInt(i/1.5,10),"px")};St(a,function(s,l){t.selectionHandles.styles.bottomRightHitArea[l]=s,t.selectionHandles.styles.topLeftHitArea[l]=s});var o={position:"absolute",height:"".concat(n,"px"),width:"".concat(n,"px"),"border-radius":"".concat(parseInt(n/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};St(o,function(s,l){t.selectionHandles.styles.bottomRight[l]=s,t.selectionHandles.styles.topLeft[l]=s}),this.main.appendChild(this.selectionHandles.topLeft),this.main.appendChild(this.selectionHandles.bottomRight),this.main.appendChild(this.selectionHandles.topLeftHitArea),this.main.appendChild(this.selectionHandles.bottomRightHitArea)}},{key:"isPartRange",value:function(t,n){var i=this.wot.selections.createOrGetArea();return!!(i.cellRange&&(t!==i.cellRange.to.row||n!==i.cellRange.to.col))}},{key:"updateMultipleSelectionHandlesPosition",value:function(t,n,i,a,o,s){var l=parseInt(this.selectionHandles.styles.topLeft.width,10),u=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top="".concat(parseInt(i-l,10),"px"),this.selectionHandles.styles.topLeft.left="".concat(parseInt(a-l,10),"px"),this.selectionHandles.styles.topLeftHitArea.top="".concat(parseInt(i-u/4*3,10),"px"),this.selectionHandles.styles.topLeftHitArea.left="".concat(parseInt(a-u/4*3,10),"px"),this.selectionHandles.styles.bottomRight.top="".concat(parseInt(i+s,10),"px"),this.selectionHandles.styles.bottomRight.left="".concat(parseInt(a+o,10),"px"),this.selectionHandles.styles.bottomRightHitArea.top="".concat(parseInt(i+s-u/4,10),"px"),this.selectionHandles.styles.bottomRightHitArea.left="".concat(parseInt(a+o-u/4,10),"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(this.selectionHandles.styles.topLeft.display="block",this.selectionHandles.styles.topLeftHitArea.display="block",this.isPartRange(t,n)?(this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"):(this.selectionHandles.styles.bottomRight.display="block",this.selectionHandles.styles.bottomRightHitArea.display="block")):(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.topLeftHitArea.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"),t===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsLeft")?(this.selectionHandles.styles.topLeft.zIndex="9999",this.selectionHandles.styles.topLeftHitArea.zIndex="9999"):(this.selectionHandles.styles.topLeft.zIndex="",this.selectionHandles.styles.topLeftHitArea.zIndex="")}},{key:"appear",value:function(t){if(!this.disabled){for(var n,i,a,o,s=this.wot.wtTable.getRenderedRowsCount(),l=0;l<s;l+=1){var u=this.wot.wtTable.rowFilter.renderedToSource(l);if(u>=t[0]&&u<=t[2]){n=u;break}}for(var f=s-1;f>=0;f-=1){var c=this.wot.wtTable.rowFilter.renderedToSource(f);if(c>=t[0]&&c<=t[2]){i=c;break}}for(var h=this.wot.wtTable.getRenderedColumnsCount(),d=0;d<h;d+=1){var g=this.wot.wtTable.columnFilter.renderedToSource(d);if(g>=t[1]&&g<=t[3]){a=g;break}}for(var v=h-1;v>=0;v-=1){var p=this.wot.wtTable.columnFilter.renderedToSource(v);if(p>=t[1]&&p<=t[3]){o=p;break}}if(n===void 0||a===void 0){this.disappear();return}var C=this.wot.wtTable.getCell(new me(n,a)),F=n!==i||a!==o,D=F?this.wot.wtTable.getCell(new me(i,o)):C,ee=Xt(C),ue=F?Xt(D):ee,se=Xt(this.wot.wtTable.TABLE),U=ee.top,re=ee.left,m=re-se.left-1,_=ue.left+Gt(D)-re;if(this.isEntireColumnSelected(n,i)){var x=this.getDimensionsFromHeader("columns",a,o,se),B=null;if(x){var Q=uh(x,3);B=Q[0],m=Q[1],_=Q[2]}B&&(C=B)}var A=U-se.top-1,W=ue.top+sr(D)-U;if(this.isEntireRowSelected(a,o)){var ne=this.getDimensionsFromHeader("rows",n,i,se),b=null;if(ne){var R=uh(ne,3);b=R[0],A=R[1],W=R[2]}b&&(C=b)}var Z=ys(C);parseInt(Z.borderTopWidth,10)>0&&(A+=1,W=W>0?W-1:0),parseInt(Z.borderLeftWidth,10)>0&&(m+=1,_=_>0?_-1:0),this.topStyle.top="".concat(A,"px"),this.topStyle.left="".concat(m,"px"),this.topStyle.width="".concat(_,"px"),this.topStyle.display="block",this.leftStyle.top="".concat(A,"px"),this.leftStyle.left="".concat(m,"px"),this.leftStyle.height="".concat(W,"px"),this.leftStyle.display="block";var ie=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(A+W-ie,"px"),this.bottomStyle.left="".concat(m,"px"),this.bottomStyle.width="".concat(_,"px"),this.bottomStyle.display="block",this.rightStyle.top="".concat(A,"px"),this.rightStyle.left="".concat(m+_-ie,"px"),this.rightStyle.height="".concat(W+1,"px"),this.rightStyle.display="block";var ve=this.settings.border.cornerVisible;ve=typeof ve=="function"?ve(this.settings.layerLevel):ve;var le=this.wot.getSetting("onModifyGetCellCoords",i,o),ge=i,Se=o;if(le&&Array.isArray(le)){var Ee=uh(le,4);ge=Ee[2],Se=Ee[3]}if(ui()||!ve||this.isPartRange(ge,Se))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(A+W-4,"px"),this.cornerStyle.left="".concat(m+_-4,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var Re=us(this.wot.wtTable.TABLE),ze=Re===window;if(ze&&(Re=document.documentElement),o===this.wot.getSetting("totalColumns")-1){var P=ze?D.getBoundingClientRect().left:D.offsetLeft,H=P+Gt(D)+parseInt(this.cornerDefaultStyle.width,10)/2,O=H>=oo(Re);O&&(this.cornerStyle.left="".concat(Math.floor(m+_-3-parseInt(this.cornerDefaultStyle.width,10)/2),"px"),this.cornerStyle.borderRightWidth=0)}if(i===this.wot.getSetting("totalRows")-1){var T=ze?D.getBoundingClientRect().top:D.offsetTop,Y=T+sr(D)+parseInt(this.cornerDefaultStyle.height,10)/2,q=Y>=fi(Re);q&&(this.cornerStyle.top="".concat(Math.floor(A+W-3-parseInt(this.cornerDefaultStyle.height,10)/2),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}ui()&&this.updateMultipleSelectionHandlesPosition(i,o,A,m,_,W)}}},{key:"isEntireColumnSelected",value:function(t,n){return t===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(t,n){return t===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(t,n,i,a){var o=this,s=this.wot.wtTable.wtRootElement.parentNode,l=null,u=null,f=null,c=null,h=null,d=null,g=null,v=null;switch(t){case"rows":l=function(){var ee;return(ee=o.wot.wtTable).getRowHeader.apply(ee,arguments)},u=function(){return sr.apply(void 0,arguments)},f="ht__selection--rows",d="top";break;case"columns":l=function(){var ee;return(ee=o.wot.wtTable).getColumnHeader.apply(ee,arguments)},u=function(){return Gt.apply(void 0,arguments)},f="ht__selection--columns",d="left";break}if(s.className.includes(f)){var p=this.wot.getSetting("columnHeaders").length;if(g=l(n,p-1),v=l(i,p-1),!g||!v)return!1;var C=Xt(g),F=Xt(v);return g&&v&&(c=C[d]-a[d]-1,h=F[d]+u(v)-C[d]),[g,c,h]}return!1}},{key:"changeBorderStyle",value:function(t,n){var i=this[t].style,a=n[t];!a||a.hide?$e(this[t],"hidden"):(gt(this[t],"hidden")&&pt(this[t],"hidden"),i.backgroundColor=a.color,(t==="top"||t==="bottom")&&(i.height="".concat(a.width,"px")),(t==="right"||t==="left")&&(i.width="".concat(a.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(t){var n={width:1,color:"#000"},i=this[t].style;i.backgroundColor=n.color,i.width="".concat(n.width,"px"),i.height="".concat(n.width,"px")}},{key:"toggleHiddenClass",value:function(t,n){this.changeBorderToDefaultStyle(t),n?$e(this[t],"hidden"):pt(this[t],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.leftStyle.display="none",this.bottomStyle.display="none",this.rightStyle.display="none",this.cornerStyle.display="none",ui()&&(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none")}}]),e}();function Lk(e,r){return Bk(e)||Hk(e,r)||Ik()}function Ik(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function Hk(e,r){var t=[],n=!0,i=!1,a=void 0;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done)&&(t.push(s.value),!(r&&t.length===r));n=!0);}catch(l){i=!0,a=l}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw a}}return t}function Bk(e){if(Array.isArray(e))return e}function Ou(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ou=function(t){return typeof t}:Ou=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ou(e)}function Wk(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function fm(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function $k(e,r,t){return r&&fm(e.prototype,r),t&&fm(e,t),e}var Cs=function(){function e(r,t){Wk(this,e),this.settings=r,this.cellRange=t||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return $k(e,[{key:"getBorder",value:function(t){return this.instanceBorders[t.guid]||(this.instanceBorders[t.guid]=new Fk(t,this.settings)),this.instanceBorders[t.guid]}},{key:"isEmpty",value:function(){return this.cellRange===null}},{key:"add",value:function(t){return this.isEmpty()?this.cellRange=new Kr(t):this.cellRange.expand(t),this}},{key:"replace",value:function(t,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(t))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(t))return this.cellRange.to=n,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var t=this.cellRange.getTopLeftCorner(),n=this.cellRange.getBottomRightCorner();return[t.row,t.col,n.row,n.col]}},{key:"addClassAtCoords",value:function(t,n,i,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,s=t.wtTable.getCell(new me(n,i));if(Ou(s)==="object"){var l=a;o&&(l=this.classNameGenerator(s),this.classNames.includes(l)||this.classNames.push(l)),$e(s,l)}return this}},{key:"linearClassNameGenerator",value:function(t,n){return function i(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(n===0||o===0)return t;var s=o>=0?o:n,l=t;s-=1;var u=s===0?t:"".concat(t,"-").concat(s);if(gt(a,u)){var f=s+1;l="".concat(t,"-").concat(f)}else l=i(a,s);return l}}},{key:"draw",value:function(t){if(this.isEmpty()){this.settings.border&&this.getBorder(t).disappear();return}for(var n=t.wtTable.getRenderedRowsCount(),i=t.wtTable.getRenderedColumnsCount(),a=this.getCorners(),o=Lk(a,4),s=o[0],l=o[1],u=o[2],f=o[3],c=0;c<i;c+=1){var h=t.wtTable.columnFilter.renderedToSource(c);if(h>=l&&h<=f){var d=t.wtTable.getColumnHeader(h);if(d){var g=[];this.settings.highlightHeaderClassName&&g.push(this.settings.highlightHeaderClassName),this.settings.highlightColumnClassName&&g.push(this.settings.highlightColumnClassName),$e(d,g)}}}for(var v=0;v<n;v+=1){var p=t.wtTable.rowFilter.renderedToSource(v);if(p>=s&&p<=u){var C=t.wtTable.getRowHeader(p);if(C){var F=[];this.settings.highlightHeaderClassName&&F.push(this.settings.highlightHeaderClassName),this.settings.highlightRowClassName&&F.push(this.settings.highlightRowClassName),$e(C,F)}}for(var D=0;D<i;D+=1){var ee=t.wtTable.columnFilter.renderedToSource(D);p>=s&&p<=u&&ee>=l&&ee<=f?this.settings.className&&this.addClassAtCoords(t,p,ee,this.settings.className,this.settings.markIntersections):p>=s&&p<=u?this.settings.highlightRowClassName&&this.addClassAtCoords(t,p,ee,this.settings.highlightRowClassName):ee>=l&&ee<=f&&this.settings.highlightColumnClassName&&this.addClassAtCoords(t,p,ee,this.settings.highlightColumnClassName);var ue=t.getSetting("onAfterDrawSelection",p,ee,a,this.settings.layerLevel);typeof ue=="string"&&this.addClassAtCoords(t,p,ee,ue)}}t.getSetting("onBeforeDrawBorders",a,this.settings.className),this.settings.border&&this.getBorder(t).appear(a)}}]),e}(),_r={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"};function jt(e){this.instance=e,this.state=_r.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.init()}jt.prototype._fireCallbacks=function(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)};jt.prototype.init=function(){};jt.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented")};jt.prototype.setValue=function(){throw Error("Editor setValue() method unimplemented")};jt.prototype.open=function(){throw Error("Editor open() method unimplemented")};jt.prototype.close=function(){throw Error("Editor close() method unimplemented")};jt.prototype.prepare=function(e,r,t,n,i,a){this.TD=n,this.row=e,this.col=r,this.prop=t,this.originalValue=i,this.cellProperties=a,this.state=_r.VIRGIN};jt.prototype.extend=function(){var e=this.constructor;function r(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];e.apply(this,i)}function t(n,i){function a(){}return a.prototype=i.prototype,n.prototype=new a,n.prototype.constructor=n,n}return t(r,e)};jt.prototype.saveValue=function(e,r){var t,n;r?(t=this.instance.getSelectedLast(),t[0]>t[2]&&(n=t[0],t[0]=t[2],t[2]=n),t[1]>t[3]&&(n=t[1],t[1]=t[3],t[3]=n)):t=[this.row,this.col,null,null],this.instance.populateFromArray(t[0],t[1],e,t[2],t[3],"edit")};jt.prototype.beginEditing=function(e,r){if(this.state===_r.VIRGIN){if(this.instance.view.scrollViewport(new me(this.row,this.col)),this.state=_r.EDITING,this.isInFullEditMode()){var t=typeof e=="string"?e:ba(this.originalValue);this.setValue(t)}this.open(r),this._opened=!0,this.focus(),this.instance.view.render(),this.instance.runHooks("afterBeginEditing",this.row,this.col)}};jt.prototype.finishEditing=function(e,r,t){var n=this,i;if(t){var a=this._closeCallback;this._closeCallback=function(s){a&&a(s),t(s),n.instance.view.render()}}if(!this.isWaiting()){if(this.state===_r.VIRGIN){this.instance._registerTimeout(function(){n._fireCallbacks(!0)});return}if(this.state===_r.EDITING){if(e){this.cancelChanges(),this.instance.view.render();return}var o=this.getValue();this.instance.getSettings().trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=_r.WAITING,this.saveValue(i,r),this.instance.getCellValidator(this.cellProperties)?this.instance.addHookOnce("postAfterValidate",function(s){n.state=_r.FINISHED,n.discardEditor(s)}):(this.state=_r.FINISHED,this.discardEditor(!0))}}};jt.prototype.cancelChanges=function(){this.state=_r.FINISHED,this.discardEditor()};jt.prototype.discardEditor=function(e){this.state===_r.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.instance.selectCell(this.row,this.col),this.focus(),this.state=_r.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=_r.VIRGIN,this._fireCallbacks(!0)))};jt.prototype.enableFullEditMode=function(){this._fullEditMode=!0};jt.prototype.isInFullEditMode=function(){return this._fullEditMode};jt.prototype.isOpened=function(){return this._opened};jt.prototype.isWaiting=function(){return this.state===_r.WAITING};jt.prototype.checkEditorSection=function(){var e=this.instance.countRows(),r="";return this.row<this.instance.getSettings().fixedRowsTop?this.col<this.instance.getSettings().fixedColumnsLeft?r="top-left-corner":r="top":this.instance.getSettings().fixedRowsBottom&&this.row>=e-this.instance.getSettings().fixedRowsBottom?this.col<this.instance.getSettings().fixedColumnsLeft?r="bottom-left-corner":r="bottom":this.col<this.instance.getSettings().fixedColumnsLeft&&(r="left"),r};var D1={exports:{}};(function(e,r){function t(){var n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},i,a=document.body,o=document.createTextNode(""),s=document.createElement("SPAN"),l=function(v,p,C){v.addEventListener(p,C,!1)},u=function(v,p,C){v.removeEventListener(p,C,!1)},f=function(v){var p,C;v?/^[a-zA-Z \.,\\\/\|0-9]$/.test(v)||(v="."):v="",o.textContent!==void 0?o.textContent=i.value+v:o.data=i.value+v,s.style.fontSize=g(i).fontSize,s.style.fontFamily=g(i).fontFamily,s.style.whiteSpace="pre",a.appendChild(s),p=s.clientWidth+2,a.removeChild(s),i.style.height=n.minHeight+"px",n.minWidth>p?i.style.width=n.minWidth+"px":p>n.maxWidth?i.style.width=n.maxWidth+"px":i.style.width=p+"px",C=i.scrollHeight?i.scrollHeight-1:0,n.minHeight>C?i.style.height=n.minHeight+"px":n.maxHeight<C?(i.style.height=n.maxHeight+"px",i.style.overflowY="visible"):i.style.height=C+"px"},c=function(){window.setTimeout(f,0)},h=function(v){if(v&&v.minHeight)if(v.minHeight=="inherit")n.minHeight=i.clientHeight;else{var p=parseInt(v.minHeight);isNaN(p)||(n.minHeight=p)}if(v&&v.maxHeight)if(v.maxHeight=="inherit")n.maxHeight=i.clientHeight;else{var C=parseInt(v.maxHeight);isNaN(C)||(n.maxHeight=C)}if(v&&v.minWidth)if(v.minWidth=="inherit")n.minWidth=i.clientWidth;else{var F=parseInt(v.minWidth);isNaN(F)||(n.minWidth=F)}if(v&&v.maxWidth)if(v.maxWidth=="inherit")n.maxWidth=i.clientWidth;else{var D=parseInt(v.maxWidth);isNaN(D)||(n.maxWidth=D)}s.firstChild||(s.className="autoResize",s.style.display="inline-block",s.appendChild(o))},d=function(v,p,C){i=v,h(p),i.nodeName=="TEXTAREA"&&(i.style.resize="none",i.style.overflowY="",i.style.height=n.minHeight+"px",i.style.minWidth=n.minWidth+"px",i.style.maxWidth=n.maxWidth+"px",i.style.overflowY="hidden"),C&&(l(i,"change",f),l(i,"cut",c),l(i,"paste",c),l(i,"drop",c),l(i,"keydown",c),l(i,"focus",f),l(i,"compositionstart",c),l(i,"compositionupdate",c),l(i,"compositionend",c)),f()};function g(v){return v.currentStyle||document.defaultView.getComputedStyle(v)}return{init:function(v,p,C){d(v,p,C)},unObserve:function(){u(i,"change",f),u(i,"cut",c),u(i,"paste",c),u(i,"drop",c),u(i,"keydown",c),u(i,"focus",f),u(i,"compositionstart",c),u(i,"compositionupdate",c),u(i,"compositionend",c)},resize:f}}e.exports=t})(D1);var Uk=D1.exports;const Vk=Ll(Uk);var Mt=jt.prototype.extend();Mt.prototype.init=function(){var e=this;this.createElements(),this.eventManager=new Ft(this),this.bindEvents(),this.autoResize=Vk(),this.holderZIndex=-1,this.instance.addHook("afterDestroy",function(){e.destroy()})};Mt.prototype.prepare=function(e,r,t,n,i,a){for(var o=this,s=this.state,l=arguments.length,u=new Array(l>6?l-6:0),f=6;f<l;f++)u[f-6]=arguments[f];if(jt.prototype.prepare.apply(this,[e,r,t,n,i,a].concat(u)),!a.readOnly){this.refreshDimensions(!0);var c=a.allowInvalid,h=a.fragmentSelection;c&&(this.TEXTAREA.value=""),s!==_r.FINISHED&&this.hideEditableElement();var d=!h;d&&!ui()&&this.instance._registerImmediate(function(){return o.focus()})}};Mt.prototype.hideEditableElement=function(){this.textareaParentStyle.top="-9999px",this.textareaParentStyle.left="-9999px",this.textareaParentStyle.zIndex="-1",this.textareaParentStyle.position="fixed"};Mt.prototype.showEditableElement=function(){this.textareaParentStyle.zIndex=this.holderZIndex>=0?this.holderZIndex:"",this.textareaParentStyle.position=""};Mt.prototype.getValue=function(){return this.TEXTAREA.value};Mt.prototype.setValue=function(e){this.TEXTAREA.value=e};Mt.prototype.beginEditing=function(){if(this.state===_r.VIRGIN){this.TEXTAREA.value="";for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];jt.prototype.beginEditing.apply(this,r)}};var P1=function(r){var t=this,n=t.getActiveEditor(),i=(r.ctrlKey||r.metaKey)&&!r.altKey;if(!(r.target!==n.TEXTAREA||Oi(r))){switch(r.keyCode){case De.ARROW_RIGHT:n.isInFullEditMode()&&(!n.isWaiting()&&!n.allowKeyEventPropagation||!n.isWaiting()&&n.allowKeyEventPropagation&&!n.allowKeyEventPropagation(r.keyCode))&&Hr(r);break;case De.ARROW_LEFT:n.isInFullEditMode()&&(!n.isWaiting()&&!n.allowKeyEventPropagation||!n.isWaiting()&&n.allowKeyEventPropagation&&!n.allowKeyEventPropagation(r.keyCode))&&Hr(r);break;case De.ARROW_UP:case De.ARROW_DOWN:n.isInFullEditMode()&&(!n.isWaiting()&&!n.allowKeyEventPropagation||!n.isWaiting()&&n.allowKeyEventPropagation&&!n.allowKeyEventPropagation(r.keyCode))&&Hr(r);break;case De.ENTER:{var a=this.selection.isMultiple();if(i&&!a||r.altKey){if(n.isOpened()){var o=A0(n.TEXTAREA),s=n.getValue(),l="".concat(s.slice(0,o),`
`).concat(s.slice(o));n.setValue(l),Bl(n.TEXTAREA,o+1)}else n.beginEditing("".concat(n.originalValue,`
`));Hr(r)}r.preventDefault();break}case De.BACKSPACE:case De.DELETE:case De.HOME:case De.END:Hr(r);break}[De.ARROW_UP,De.ARROW_RIGHT,De.ARROW_DOWN,De.ARROW_LEFT].indexOf(r.keyCode)===-1&&n.autoResize.resize(String.fromCharCode(r.keyCode))}};Mt.prototype.open=function(){this.refreshDimensions(),this.showEditableElement(),this.instance.addHook("beforeKeyDown",P1)};Mt.prototype.close=function(){this.autoResize.unObserve(),document.activeElement===this.TEXTAREA&&this.instance.listen(),this.hideEditableElement(),this.instance.removeHook("beforeKeyDown",P1)};Mt.prototype.focus=function(){this.TEXTAREA.select(),Bl(this.TEXTAREA,this.TEXTAREA.value.length)};Mt.prototype.createElements=function(){this.TEXTAREA=document.createElement("TEXTAREA"),this.TEXTAREA.tabIndex=-1,$e(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.TEXTAREA_PARENT=document.createElement("DIV"),$e(this.TEXTAREA_PARENT,"handsontableInputHolder"),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.textareaParentStyle.zIndex="-1",this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.instance.rootElement.appendChild(this.TEXTAREA_PARENT)};Mt.prototype.getEditedCell=function(){var e=this.checkEditorSection(),r;switch(e){case"top":r=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.holderZIndex=101;break;case"top-left-corner":r=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.holderZIndex=103;break;case"bottom-left-corner":r=this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.holderZIndex=103;break;case"left":r=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.holderZIndex=102;break;case"bottom":r=this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.holderZIndex=102;break;default:r=this.instance.getCell(this.row,this.col),this.holderZIndex=-1;break}return r!==-1&&r!==-2?r:void 0};Mt.prototype.refreshValue=function(){var e=this.instance.toPhysicalRow(this.row),r=this.instance.getSourceDataAtCell(e,this.col);this.originalValue=r,this.setValue(r),this.refreshDimensions()};Mt.prototype.refreshDimensions=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(this.state!==_r.EDITING&&!e)){if(this.TD=this.getEditedCell(),!this.TD){e||this.close(!0);return}var r=Xt(this.TD),t=Xt(this.instance.rootElement),n=this.instance.view.wt.wtOverlays.topOverlay.mainTableScrollableElement,i=this.instance.view.wt.wtOverlays.leftOverlay.mainTableScrollableElement,a=this.instance.countRows(),o=n!==window?n.scrollTop:0,s=i!==window?i.scrollLeft:0,l=this.checkEditorSection(),u=["","left"].includes(l)?o:0,f=["","top","bottom"].includes(l)?s:0,c=r.top===t.top?0:1,h=this.instance.getSettings(),d=this.instance.hasColHeaders(),g=this.TD.style.backgroundColor,v=r.top-t.top-c-u,p=r.left-t.left-1-f,C;switch(l){case"top":C=$n(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":C=$n(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":C=$n(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":C=$n(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":C=$n(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode);break}(d&&this.instance.getSelectedLast()[0]===0||h.fixedRowsBottom&&this.instance.getSelectedLast()[0]===a-h.fixedRowsBottom)&&(v+=1),this.instance.getSelectedLast()[1]===0&&(p+=1),C&&C!==-1?this.textareaParentStyle[C[0]]=C[1]:wa(this.TEXTAREA_PARENT),this.textareaParentStyle.top="".concat(v,"px"),this.textareaParentStyle.left="".concat(p,"px"),this.showEditableElement();var F=this.instance.view.wt.wtViewport.rowsRenderCalculator.startPosition,D=this.instance.view.wt.wtViewport.columnsRenderCalculator.startPosition,ee=this.instance.view.wt.wtOverlays.leftOverlay.getScrollPosition(),ue=this.instance.view.wt.wtOverlays.topOverlay.getScrollPosition(),se=Jt(),U=this.TD.offsetTop+F-ue,re=this.TD.offsetLeft+D-ee,m=oo(this.TD)-8,_=Nw(n)?se:0,x=Fw(i)?se:0,B=this.instance.view.maximumVisibleElementWidth(re)-9-_,Q=this.TD.scrollHeight+1,A=Math.max(this.instance.view.maximumVisibleElementHeight(U)-x,23),W=ys(this.TD);this.TEXTAREA.style.fontSize=W.fontSize,this.TEXTAREA.style.fontFamily=W.fontFamily,this.TEXTAREA.style.backgroundColor=g,this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(Q,A),maxHeight:A,minWidth:Math.min(m,B),maxWidth:B},!0)}};Mt.prototype.bindEvents=function(){var e=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(r){Lr(r)}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(r){Lr(r)}),this.instance.addHook("afterScrollHorizontally",function(){e.refreshDimensions()}),this.instance.addHook("afterScrollVertically",function(){e.refreshDimensions()}),this.instance.addHook("afterColumnResize",function(){e.refreshDimensions(),e.focus()}),this.instance.addHook("afterRowResize",function(){e.refreshDimensions(),e.focus()}),this.instance.addHook("afterDestroy",function(){e.eventManager.destroy()})};Mt.prototype.destroy=function(){this.eventManager.destroy()};var Vr=Mt.prototype.extend();Vr.prototype.createElements=function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];Mt.prototype.createElements.apply(this,r);var n=document.createElement("DIV");n.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(n),this.htContainer=n,this.assignHooks()};Vr.prototype.prepare=function(e,r,t,n,i,a){for(var o=arguments.length,s=new Array(o>6?o-6:0),l=6;l<o;l++)s[l-6]=arguments[l];Mt.prototype.prepare.apply(this,[e,r,t,n,i,a].concat(s));var u=this,f={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(h,d){var g=this.getSourceData(d.row,d.col);g!==void 0&&u.setValue(g),u.instance.destroyEditor()}};this.cellProperties.handsontable&&pn(f,a.handsontable),this.htOptions=f};var N1=function(r){if(!Oi(r)){var t=this.getActiveEditor(),n=t.htEditor.getInstance(),i,a;if(r.keyCode===De.ARROW_DOWN){if(!n.getSelectedLast()&&!n.flipped)i=0;else if(n.getSelectedLast()){if(n.flipped)i=n.getSelectedLast()[0]+1;else if(!n.flipped){var o=n.countRows()-1;a=n.getSelectedLast()[0],i=Math.min(o,a+1)}}}else r.keyCode===De.ARROW_UP&&(!n.getSelectedLast()&&n.flipped?i=n.countRows()-1:n.getSelectedLast()&&(n.flipped?(a=n.getSelectedLast()[0],i=Math.max(0,a-1)):(a=n.getSelectedLast()[0],i=a-1)));i!==void 0&&(i<0||n.flipped&&i>n.countRows()-1?n.deselectCell():n.selectCell(i,0),n.getData().length&&(r.preventDefault(),Hr(r),t.instance.listen(),t.TEXTAREA.focus()))}};Vr.prototype.open=function(){this.instance.addHook("beforeKeyDown",N1);for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];Mt.prototype.open.apply(this,r),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.instance.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Bl(this.TEXTAREA,0,this.TEXTAREA.value.length)};Vr.prototype.close=function(){this.htEditor.rootElement.style.display="none",this.instance.removeHook("beforeKeyDown",N1);for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];Mt.prototype.close.apply(this,r)};Vr.prototype.focus=function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];Mt.prototype.focus.apply(this,r)};Vr.prototype.beginEditing=function(){var e=this.instance.getSettings().onBeginEditing;if(!(e&&e()===!1)){for(var r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n];Mt.prototype.beginEditing.apply(this,t)}};Vr.prototype.finishEditing=function(){if(this.htEditor&&this.htEditor.isListening()&&this.instance.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var e=this.htEditor.getInstance().getValue();e!==void 0&&this.setValue(e)}for(var r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n];return Mt.prototype.finishEditing.apply(this,t)};Vr.prototype.assignHooks=function(){var e=this;this.instance.addHook("afterDestroy",function(){e.htEditor&&e.htEditor.destroy()})};var $t=Vr.prototype.extend();$t.prototype.init=function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];Vr.prototype.init.apply(this,r),this.query=null,this.strippedChoices=[],this.rawChoices=[]};$t.prototype.getValue=function(){var e=this,r=this.rawChoices.find(function(t){var n=e.stripValueIfNeeded(t);return n===e.TEXTAREA.value});return ir(r)?r:this.TEXTAREA.value};$t.prototype.createElements=function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];Vr.prototype.createElements.apply(this,r),$e(this.htContainer,"autocompleteEditor"),$e(this.htContainer,window.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")};function F1(e){var r=this.getActiveEditor();if(k1(e.keyCode)||e.keyCode===De.BACKSPACE||e.keyCode===De.DELETE||e.keyCode===De.INSERT){var t=0;if(e.keyCode===De.C&&(e.ctrlKey||e.metaKey))return;r.isOpened()||(t+=10),r.htEditor&&r.instance._registerTimeout(function(){r.queryChoices(r.TEXTAREA.value)},t)}}$t.prototype.prepare=function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];Vr.prototype.prepare.apply(this,r)};$t.prototype.open=function(){this.instance.addHook("beforeKeyDown",F1),this.TEXTAREA_PARENT.style.overflow="auto";for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];Vr.prototype.open.apply(this,r),this.TEXTAREA_PARENT.style.overflow="";var n=this.htEditor.getInstance(),i=this,a=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus(),n.updateSettings({colWidths:a?[Gt(this.TEXTAREA)-2]:void 0,width:a?Gt(this.TEXTAREA)+Jt()+2:void 0,afterRenderer:function(s,l,u,f,c){var h=i.cellProperties,d=h.filteringCaseSensitive,g=h.allowHtml,v=ba(c),p,C;v&&!g&&(p=d===!0?v.indexOf(this.query):v.toLowerCase().indexOf(i.query.toLowerCase()),p!==-1&&(C=v.substr(p,i.query.length),v=v.replace(C,"<strong>".concat(C,"</strong>")))),s.innerHTML=v},autoColumnSize:!0,modifyColWidth:function(s,l){var u=this.getPlugin("autoColumnSize").widths,f=s;return u[l]&&(f=u[l]),a?f:f+15}}),this.htEditor.view.wt.wtTable.holder.parentNode.style["padding-right"]="".concat(Jt()+2,"px"),i.instance._registerTimeout(function(){i.queryChoices(i.TEXTAREA.value)})};$t.prototype.queryChoices=function(e){var r=this;this.query=e;var t=this.cellProperties.source;typeof t=="function"?t.call(this.cellProperties,e,function(n){r.rawChoices=n,r.updateChoicesList(r.stripValuesIfNeeded(n))}):Array.isArray(t)?(this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))):this.updateChoicesList([])};$t.prototype.updateChoicesList=function(e){var r=A0(this.TEXTAREA),t=Dw(this.TEXTAREA),n=this.cellProperties.sortByRelevance,i=this.cellProperties.filter,a=null,o=null,s=e;n&&(a=$t.sortByRelevance(this.stripValueIfNeeded(this.getValue()),s,this.cellProperties.filteringCaseSensitive));var l=Array.isArray(a)?a.length:0;if(i===!1)l&&(o=a[0]);else{for(var u=[],f=0,c=s.length;f<c&&!(n&&l<=f);f++)l?u.push(s[a[f]]):u.push(s[f]);o=0,s=u}this.strippedChoices=s,this.htEditor.loadData(yw([s])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(o),this.instance.listen(!1),Bl(this.TEXTAREA,r,r===t?void 0:t)};$t.prototype.flipDropdownIfNeeded=function(){var e=Xt(this.TEXTAREA),r=sr(this.TEXTAREA),t=this.getDropdownHeight(),n=us(this.instance.view.wt.wtTable.TABLE),i=n.scrollTop,a=sr(this.instance.view.wt.wtTable.THEAD),o={row:0,col:0};n!==window&&(o=Xt(n));var s=e.top-o.top-a+i,l=n.scrollHeight-s-a-r,u=t>l&&s>l;return u?this.flipDropdown(t):this.unflipDropdown(),this.limitDropdownIfNeeded(u?s:l,t),u};$t.prototype.limitDropdownIfNeeded=function(e,r){if(r>e){var t=0,n=0,i=0,a=null;do i=this.htEditor.getRowHeight(n)||this.htEditor.view.wt.wtSettings.settings.defaultRowHeight,t+=i,n+=1;while(t<e);a=t-i,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+r-a,"px")),this.setDropdownHeight(t-i)}};$t.prototype.flipDropdown=function(e){var r=this.htEditor.rootElement.style;r.position="absolute",r.top="".concat(-e,"px"),this.htEditor.flipped=!0};$t.prototype.unflipDropdown=function(){var e=this.htEditor.rootElement.style;e.position==="absolute"&&(e.position="",e.top=""),this.htEditor.flipped=void 0};$t.prototype.updateDropdownHeight=function(){var e=this.htEditor.getColWidth(0)+Jt()+2,r=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:r?void 0:e}),this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer()};$t.prototype.setDropdownHeight=function(e){this.htEditor.updateSettings({height:e})};$t.prototype.finishEditing=function(e){for(var r=arguments.length,t=new Array(r>1?r-1:0),n=1;n<r;n++)t[n-1]=arguments[n];Vr.prototype.finishEditing.apply(this,[e].concat(t))};$t.prototype.highlightBestMatchingChoice=function(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()};$t.sortByRelevance=function(e,r,t){var n=[],i,a=e.length,o,s,l=[],u,f=r.length;if(a===0){for(u=0;u<f;u++)l.push(u);return l}for(u=0;u<f;u++)i=q0(ba(r[u])),t?o=i.indexOf(e):o=i.toLowerCase().indexOf(e.toLowerCase()),o!==-1&&(s=i.length-o-a,n.push({baseIndex:u,index:o,charsLeft:s,value:i}));for(n.sort(function(c,h){if(h.index===-1)return-1;if(c.index===-1)return 1;if(c.index<h.index)return-1;if(h.index<c.index)return 1;if(c.index===h.index){if(c.charsLeft<h.charsLeft)return-1;if(c.charsLeft>h.charsLeft)return 1}return 0}),u=0,f=n.length;u<f;u++)l.push(n[u].baseIndex);return l};$t.prototype.getDropdownHeight=function(){var e=this.htEditor.getInstance().getRowHeight(0)||23,r=this.cellProperties.visibleRows;return this.strippedChoices.length>=r?r*e:this.strippedChoices.length*e+8};$t.prototype.stripValueIfNeeded=function(e){return this.stripValuesIfNeeded([e])[0]};$t.prototype.stripValuesIfNeeded=function(e){var r=this.cellProperties.allowHtml,t=Zt(e,function(i){return ba(i)}),n=Zt(t,function(i){return r?i:q0(i)});return n};$t.prototype.allowKeyEventPropagation=function(e){var r=this.htEditor.getSelectedRangeLast(),t={row:r?r.from.row:-1},n=!1;return e===De.ARROW_DOWN&&t.row>0&&t.row<this.htEditor.countRows()-1&&(n=!0),e===De.ARROW_UP&&t.row>-1&&(n=!0),n};$t.prototype.close=function(){this.instance.removeHook("beforeKeyDown",F1);for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];Vr.prototype.close.apply(this,r)};$t.prototype.discardEditor=function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];Vr.prototype.discardEditor.apply(this,r),this.instance.view.render()};function Ru(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ru=function(t){return typeof t}:Ru=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ru(e)}function zk(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function cm(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function jk(e,r,t){return r&&cm(e.prototype,r),t&&cm(e,t),e}function Yk(e,r){return r&&(Ru(r)==="object"||typeof r=="function")?r:Gk(e)}function Gk(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gd(e){return gd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},gd(e)}function Xk(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&md(e,r)}function md(e,r){return md=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},md(e,r)}var Kk=function(e){Xk(r,e);function r(){return zk(this,r),Yk(this,gd(r).apply(this,arguments))}return jk(r,[{key:"beginEditing",value:function(n,i){if(i&&i.type==="mouseup"){var a=this.TD.querySelector('input[type="checkbox"]');gt(a,"htBadValue")||a.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}]),r}(jt),L1={exports:{}};const qk=Tb(JO);/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/dbushell/Pikaday
 */(function(e,r){(function(t,n){var i;{try{i=qk}catch{}e.exports=n(i)}})(Uo,function(t){var n=typeof t=="function",i=!!window.addEventListener,a=window.document,o=window.setTimeout,s=function(b,R,Z,ie){i?b.addEventListener(R,Z,!!ie):b.attachEvent("on"+R,Z)},l=function(b,R,Z,ie){i?b.removeEventListener(R,Z,!!ie):b.detachEvent("on"+R,Z)},u=function(b,R,Z){var ie;a.createEvent?(ie=a.createEvent("HTMLEvents"),ie.initEvent(R,!0,!1),ie=ue(ie,Z),b.dispatchEvent(ie)):a.createEventObject&&(ie=a.createEventObject(),ie=ue(ie,Z),b.fireEvent("on"+R,ie))},f=function(b){return b.trim?b.trim():b.replace(/^\s+|\s+$/g,"")},c=function(b,R){return(" "+b.className+" ").indexOf(" "+R+" ")!==-1},h=function(b,R){c(b,R)||(b.className=b.className===""?R:b.className+" "+R)},d=function(b,R){b.className=f((" "+b.className+" ").replace(" "+R+" "," "))},g=function(b){return/Array/.test(Object.prototype.toString.call(b))},v=function(b){return/Date/.test(Object.prototype.toString.call(b))&&!isNaN(b.getTime())},p=function(b){var R=b.getDay();return R===0||R===6},C=function(b){return b%4===0&&b%100!==0||b%400===0},F=function(b,R){return[31,C(b)?29:28,31,30,31,30,31,31,30,31,30,31][R]},D=function(b){v(b)&&b.setHours(0,0,0,0)},ee=function(b,R){return b.getTime()===R.getTime()},ue=function(b,R,Z){var ie,ve;for(ie in R)ve=b[ie]!==void 0,ve&&typeof R[ie]=="object"&&R[ie]!==null&&R[ie].nodeName===void 0?v(R[ie])?Z&&(b[ie]=new Date(R[ie].getTime())):g(R[ie])?Z&&(b[ie]=R[ie].slice(0)):b[ie]=ue({},R[ie],Z):(Z||!ve)&&(b[ie]=R[ie]);return b},se=function(b){return b.month<0&&(b.year-=Math.ceil(Math.abs(b.month)/12),b.month+=12),b.month>11&&(b.year+=Math.floor(Math.abs(b.month)/12),b.month-=12),b},U={field:null,bound:void 0,position:"bottom left",reposition:!0,format:"YYYY-MM-DD",defaultDate:null,setDefaultDate:!1,firstDay:0,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,onSelect:null,onOpen:null,onClose:null,onDraw:null},re=function(b,R,Z){for(R+=b.firstDay;R>=7;)R-=7;return Z?b.i18n.weekdaysShort[R]:b.i18n.weekdays[R]},m=function(b){var R=[],Z="false";if(b.isEmpty)if(b.showDaysInNextAndPreviousMonths)R.push("is-outside-current-month");else return'<td class="is-empty"></td>';return b.isDisabled&&R.push("is-disabled"),b.isToday&&R.push("is-today"),b.isSelected&&(R.push("is-selected"),Z="true"),b.isInRange&&R.push("is-inrange"),b.isStartRange&&R.push("is-startrange"),b.isEndRange&&R.push("is-endrange"),'<td data-day="'+b.day+'" class="'+R.join(" ")+'" aria-selected="'+Z+'"><button class="pika-button pika-day" type="button" data-pika-year="'+b.year+'" data-pika-month="'+b.month+'" data-pika-day="'+b.day+'">'+b.day+"</button></td>"},_=function(b,R,Z){var ie=new Date(Z,0,1),ve=Math.ceil(((new Date(Z,R,b)-ie)/864e5+ie.getDay()+1)/7);return'<td class="pika-week">'+ve+"</td>"},x=function(b,R){return"<tr>"+(R?b.reverse():b).join("")+"</tr>"},B=function(b){return"<tbody>"+b.join("")+"</tbody>"},Q=function(b){var R,Z=[];for(b.showWeekNumber&&Z.push("<th></th>"),R=0;R<7;R++)Z.push('<th scope="col"><abbr title="'+re(b,R)+'">'+re(b,R,!0)+"</abbr></th>");return"<thead><tr>"+(b.isRTL?Z.reverse():Z).join("")+"</tr></thead>"},A=function(b,R,Z,ie,ve,le){var ge,Se,Ee,Re=b._o,ze=Z===Re.minYear,P=Z===Re.maxYear,H='<div id="'+le+'" class="pika-title" role="heading" aria-live="assertive">',O,T,Y=!0,q=!0;for(Ee=[],ge=0;ge<12;ge++)Ee.push('<option value="'+(Z===ve?ge-R:12+ge-R)+'"'+(ge===ie?' selected="selected"':"")+(ze&&ge<Re.minMonth||P&&ge>Re.maxMonth?'disabled="disabled"':"")+">"+Re.i18n.months[ge]+"</option>");for(O='<div class="pika-label">'+Re.i18n.months[ie]+'<select class="pika-select pika-select-month" tabindex="-1">'+Ee.join("")+"</select></div>",g(Re.yearRange)?(ge=Re.yearRange[0],Se=Re.yearRange[1]+1):(ge=Z-Re.yearRange,Se=1+Z+Re.yearRange),Ee=[];ge<Se&&ge<=Re.maxYear;ge++)ge>=Re.minYear&&Ee.push('<option value="'+ge+'"'+(ge===Z?' selected="selected"':"")+">"+ge+"</option>");return T='<div class="pika-label">'+Z+Re.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+Ee.join("")+"</select></div>",Re.showMonthAfterYear?H+=T+O:H+=O+T,ze&&(ie===0||Re.minMonth>=ie)&&(Y=!1),P&&(ie===11||Re.maxMonth<=ie)&&(q=!1),R===0&&(H+='<button class="pika-prev'+(Y?"":" is-disabled")+'" type="button">'+Re.i18n.previousMonth+"</button>"),R===b._o.numberOfMonths-1&&(H+='<button class="pika-next'+(q?"":" is-disabled")+'" type="button">'+Re.i18n.nextMonth+"</button>"),H+="</div>"},W=function(b,R,Z){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+Z+'">'+Q(b)+B(R)+"</table>"},ne=function(b){var R=this,Z=R.config(b);R._onMouseDown=function(ve){if(R._v){ve=ve||window.event;var le=ve.target||ve.srcElement;if(le)if(c(le,"is-disabled")||(c(le,"pika-button")&&!c(le,"is-empty")&&!c(le.parentNode,"is-disabled")?(R.setDate(new Date(le.getAttribute("data-pika-year"),le.getAttribute("data-pika-month"),le.getAttribute("data-pika-day"))),Z.bound&&o(function(){R.hide(),Z.field&&Z.field.blur()},100)):c(le,"pika-prev")?R.prevMonth():c(le,"pika-next")&&R.nextMonth()),c(le,"pika-select"))R._c=!0;else if(ve.preventDefault)ve.preventDefault();else return ve.returnValue=!1,!1}},R._onChange=function(ve){ve=ve||window.event;var le=ve.target||ve.srcElement;le&&(c(le,"pika-select-month")?R.gotoMonth(le.value):c(le,"pika-select-year")&&R.gotoYear(le.value))},R._onKeyChange=function(ve){if(ve=ve||window.event,R.isVisible())switch(ve.keyCode){case 13:case 27:Z.field.blur();break;case 37:ve.preventDefault(),R.adjustDate("subtract",1);break;case 38:R.adjustDate("subtract",7);break;case 39:R.adjustDate("add",1);break;case 40:R.adjustDate("add",7);break}},R._onInputChange=function(ve){var le;ve.firedBy!==R&&(n?(le=t(Z.field.value,Z.format,Z.formatStrict),le=le&&le.isValid()?le.toDate():null):le=new Date(Date.parse(Z.field.value)),v(le)&&R.setDate(le),R._v||R.show())},R._onInputFocus=function(){R.show()},R._onInputClick=function(){R.show()},R._onInputBlur=function(){var ve=a.activeElement;do if(c(ve,"pika-single"))return;while(ve=ve.parentNode);R._c||(R._b=o(function(){R.hide()},50)),R._c=!1},R._onClick=function(ve){ve=ve||window.event;var le=ve.target||ve.srcElement,ge=le;if(le){!i&&c(le,"pika-select")&&(le.onchange||(le.setAttribute("onchange","return;"),s(le,"change",R._onChange)));do if(c(ge,"pika-single")||ge===Z.trigger)return;while(ge=ge.parentNode);R._v&&le!==Z.trigger&&ge!==Z.trigger&&R.hide()}},R.el=a.createElement("div"),R.el.className="pika-single"+(Z.isRTL?" is-rtl":"")+(Z.theme?" "+Z.theme:""),s(R.el,"mousedown",R._onMouseDown,!0),s(R.el,"touchend",R._onMouseDown,!0),s(R.el,"change",R._onChange),s(a,"keydown",R._onKeyChange),Z.field&&(Z.container?Z.container.appendChild(R.el):Z.bound?a.body.appendChild(R.el):Z.field.parentNode.insertBefore(R.el,Z.field.nextSibling),s(Z.field,"change",R._onInputChange),Z.defaultDate||(n&&Z.field.value?Z.defaultDate=t(Z.field.value,Z.format).toDate():Z.defaultDate=new Date(Date.parse(Z.field.value)),Z.setDefaultDate=!0));var ie=Z.defaultDate;v(ie)?Z.setDefaultDate?R.setDate(ie,!0):R.gotoDate(ie):R.gotoDate(new Date),Z.bound?(this.hide(),R.el.className+=" is-bound",s(Z.trigger,"click",R._onInputClick),s(Z.trigger,"focus",R._onInputFocus),s(Z.trigger,"blur",R._onInputBlur)):this.show()};return ne.prototype={config:function(b){this._o||(this._o=ue({},U,!0));var R=ue(this._o,b,!0);R.isRTL=!!R.isRTL,R.field=R.field&&R.field.nodeName?R.field:null,R.theme=typeof R.theme=="string"&&R.theme?R.theme:null,R.bound=!!(R.bound!==void 0?R.field&&R.bound:R.field),R.trigger=R.trigger&&R.trigger.nodeName?R.trigger:R.field,R.disableWeekends=!!R.disableWeekends,R.disableDayFn=typeof R.disableDayFn=="function"?R.disableDayFn:null;var Z=parseInt(R.numberOfMonths,10)||1;if(R.numberOfMonths=Z>4?4:Z,v(R.minDate)||(R.minDate=!1),v(R.maxDate)||(R.maxDate=!1),R.minDate&&R.maxDate&&R.maxDate<R.minDate&&(R.maxDate=R.minDate=!1),R.minDate&&this.setMinDate(R.minDate),R.maxDate&&this.setMaxDate(R.maxDate),g(R.yearRange)){var ie=new Date().getFullYear()-10;R.yearRange[0]=parseInt(R.yearRange[0],10)||ie,R.yearRange[1]=parseInt(R.yearRange[1],10)||ie}else R.yearRange=Math.abs(parseInt(R.yearRange,10))||U.yearRange,R.yearRange>100&&(R.yearRange=100);return R},toString:function(b){return v(this._d)?n?t(this._d).format(b||this._o.format):this._d.toDateString():""},getMoment:function(){return n?t(this._d):null},setMoment:function(b,R){n&&t.isMoment(b)&&this.setDate(b.toDate(),R)},getDate:function(){return v(this._d)?new Date(this._d.getTime()):new Date},setDate:function(b,R){if(!b)return this._d=null,this._o.field&&(this._o.field.value="",u(this._o.field,"change",{firedBy:this})),this.draw();if(typeof b=="string"&&(b=new Date(Date.parse(b))),!!v(b)){var Z=this._o.minDate,ie=this._o.maxDate;v(Z)&&b<Z?b=Z:v(ie)&&b>ie&&(b=ie),this._d=new Date(b.getTime()),D(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),u(this._o.field,"change",{firedBy:this})),!R&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},gotoDate:function(b){var R=!0;if(v(b)){if(this.calendars){var Z=new Date(this.calendars[0].year,this.calendars[0].month,1),ie=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),ve=b.getTime();ie.setMonth(ie.getMonth()+1),ie.setDate(ie.getDate()-1),R=ve<Z.getTime()||ie.getTime()<ve}R&&(this.calendars=[{month:b.getMonth(),year:b.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(b,R){var Z=this.getDate(),ie=parseInt(R)*24*60*60*1e3,ve;b==="add"?ve=new Date(Z.valueOf()+ie):b==="subtract"&&(ve=new Date(Z.valueOf()-ie)),n&&(b==="add"?ve=t(Z).add(R,"days").toDate():b==="subtract"&&(ve=t(Z).subtract(R,"days").toDate())),this.setDate(ve)},adjustCalendars:function(){this.calendars[0]=se(this.calendars[0]);for(var b=1;b<this._o.numberOfMonths;b++)this.calendars[b]=se({month:this.calendars[0].month+b,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(b){isNaN(b)||(this.calendars[0].month=parseInt(b,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(b){isNaN(b)||(this.calendars[0].year=parseInt(b,10),this.adjustCalendars())},setMinDate:function(b){b instanceof Date?(D(b),this._o.minDate=b,this._o.minYear=b.getFullYear(),this._o.minMonth=b.getMonth()):(this._o.minDate=U.minDate,this._o.minYear=U.minYear,this._o.minMonth=U.minMonth,this._o.startRange=U.startRange),this.draw()},setMaxDate:function(b){b instanceof Date?(D(b),this._o.maxDate=b,this._o.maxYear=b.getFullYear(),this._o.maxMonth=b.getMonth()):(this._o.maxDate=U.maxDate,this._o.maxYear=U.maxYear,this._o.maxMonth=U.maxMonth,this._o.endRange=U.endRange),this.draw()},setStartRange:function(b){this._o.startRange=b},setEndRange:function(b){this._o.endRange=b},draw:function(b){if(!(!this._v&&!b)){var R=this._o,Z=R.minYear,ie=R.maxYear,ve=R.minMonth,le=R.maxMonth,ge="",Se;this._y<=Z&&(this._y=Z,!isNaN(ve)&&this._m<ve&&(this._m=ve)),this._y>=ie&&(this._y=ie,!isNaN(le)&&this._m>le&&(this._m=le)),Se="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2);for(var Ee=0;Ee<R.numberOfMonths;Ee++)ge+='<div class="pika-lendar">'+A(this,Ee,this.calendars[Ee].year,this.calendars[Ee].month,this.calendars[0].year,Se)+this.render(this.calendars[Ee].year,this.calendars[Ee].month,Se)+"</div>";this.el.innerHTML=ge,R.bound&&R.field.type!=="hidden"&&o(function(){R.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),R.bound&&R.field.setAttribute("aria-label","Use the arrow keys to pick a date")}},adjustPosition:function(){var b,R,Z,ie,ve,le,ge,Se,Ee,Re;if(!this._o.container){if(this.el.style.position="absolute",b=this._o.trigger,R=b,Z=this.el.offsetWidth,ie=this.el.offsetHeight,ve=window.innerWidth||a.documentElement.clientWidth,le=window.innerHeight||a.documentElement.clientHeight,ge=window.pageYOffset||a.body.scrollTop||a.documentElement.scrollTop,typeof b.getBoundingClientRect=="function")Re=b.getBoundingClientRect(),Se=Re.left+window.pageXOffset,Ee=Re.bottom+window.pageYOffset;else for(Se=R.offsetLeft,Ee=R.offsetTop+R.offsetHeight;R=R.offsetParent;)Se+=R.offsetLeft,Ee+=R.offsetTop;(this._o.reposition&&Se+Z>ve||this._o.position.indexOf("right")>-1&&Se-Z+b.offsetWidth>0)&&(Se=Se-Z+b.offsetWidth),(this._o.reposition&&Ee+ie>le+ge||this._o.position.indexOf("top")>-1&&Ee-ie-b.offsetHeight>0)&&(Ee=Ee-ie-b.offsetHeight),this.el.style.left=Se+"px",this.el.style.top=Ee+"px"}},render:function(b,R,Z){var ie=this._o,ve=new Date,le=F(b,R),ge=new Date(b,R,1).getDay(),Se=[],Ee=[];D(ve),ie.firstDay>0&&(ge-=ie.firstDay,ge<0&&(ge+=7));for(var Re=R===0?11:R-1,ze=R===11?0:R+1,P=R===0?b-1:b,H=R===11?b+1:b,O=F(P,Re),T=le+ge,Y=T;Y>7;)Y-=7;T+=7-Y;for(var q=0,ae=0;q<T;q++){var he=new Date(b,R,1+(q-ge)),oe=v(this._d)?ee(he,this._d):!1,be=ee(he,ve),ce=q<ge||q>=le+ge,Ce=1+(q-ge),Me=R,Fe=b,ke=ie.startRange&&ee(ie.startRange,he),de=ie.endRange&&ee(ie.endRange,he),Oe=ie.startRange&&ie.endRange&&ie.startRange<he&&he<ie.endRange,we=ie.minDate&&he<ie.minDate||ie.maxDate&&he>ie.maxDate||ie.disableWeekends&&p(he)||ie.disableDayFn&&ie.disableDayFn(he);ce&&(q<ge?(Ce=O+Ce,Me=Re,Fe=P):(Ce=Ce-le,Me=ze,Fe=H));var et={day:Ce,month:Me,year:Fe,isSelected:oe,isToday:be,isDisabled:we,isEmpty:ce,isStartRange:ke,isEndRange:de,isInRange:Oe,showDaysInNextAndPreviousMonths:ie.showDaysInNextAndPreviousMonths};Ee.push(m(et)),++ae===7&&(ie.showWeekNumber&&Ee.unshift(_(q-ge,R,b)),Se.push(x(Ee,ie.isRTL)),Ee=[],ae=0)}return W(ie,Se,Z)},isVisible:function(){return this._v},show:function(){this.isVisible()||(d(this.el,"is-hidden"),this._v=!0,this.draw(),this._o.bound&&(s(a,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var b=this._v;b!==!1&&(this._o.bound&&l(a,"click",this._onClick),this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto",h(this.el,"is-hidden"),this._v=!1,b!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){this.hide(),l(this.el,"mousedown",this._onMouseDown,!0),l(this.el,"touchend",this._onMouseDown,!0),l(this.el,"change",this._onChange),this._o.field&&(l(this._o.field,"change",this._onInputChange),this._o.bound&&(l(this._o.trigger,"click",this._onInputClick),l(this._o.trigger,"focus",this._onInputFocus),l(this._o.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},ne})})(L1);var Zk=L1.exports;const hm=Ll(Zk);function ku(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ku=function(t){return typeof t}:ku=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ku(e)}function Jk(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function dm(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Qk(e,r,t){return r&&dm(e.prototype,r),t&&dm(e,t),e}function e2(e,r){return r&&(ku(r)==="object"||typeof r=="function")?r:t2(e)}function t2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xi(e,r,t){return typeof Reflect<"u"&&Reflect.get?xi=Reflect.get:xi=function(i,a,o){var s=r2(i,a);if(s){var l=Object.getOwnPropertyDescriptor(s,a);return l.get?l.get.call(o):l.value}},xi(e,r,t||e)}function r2(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=ri(e),e!==null););return e}function ri(e){return ri=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ri(e)}function n2(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&pd(e,r)}function pd(e,r){return pd=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},pd(e,r)}var i2=function(e){n2(r,e);function r(t){var n;return Jk(this,r),n=e2(this,ri(r).call(this,t)),n.defaultDateFormat="DD/MM/YYYY",n.isCellEdited=!1,n.parentDestroyed=!1,n}return Qk(r,[{key:"init",value:function(){var n=this;if(typeof Pe!="function")throw new Error("You need to include moment.js to your project.");if(typeof hm!="function")throw new Error("You need to include Pikaday to your project.");xi(ri(r.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){n.parentDestroyed=!0,n.destroyElements()})}},{key:"createElements",value:function(){xi(ri(r.prototype),"createElements",this).call(this),this.datePicker=document.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,$e(this.datePicker,"htDatepickerHolder"),document.body.appendChild(this.datePicker),this.$datePicker=new hm(this.getDatePickerConfig());var n=new Ft(this);n.addEventListener(this.datePicker,"mousedown",function(i){return Lr(i)}),this.hideDatepicker()}},{key:"destroyElements",value:function(){this.$datePicker.destroy()}},{key:"prepare",value:function(n,i,a,o,s,l){xi(ri(r.prototype),"prepare",this).call(this,n,i,a,o,s,l)}},{key:"open",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;xi(ri(r.prototype),"open",this).call(this),this.showDatepicker(n)}},{key:"close",value:function(){var n=this;this._opened=!1,this.instance._registerTimeout(function(){n.instance._refreshBorders()}),xi(ri(r.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(n){var a=this.originalValue;a!==void 0&&this.setValue(a)}this.hideDatepicker(),xi(ri(r.prototype),"finishEditing",this).call(this,n,i)}},{key:"showDatepicker",value:function(n){this.$datePicker.config(this.getDatePickerConfig());var i=this.TD.getBoundingClientRect(),a=this.cellProperties.dateFormat||this.defaultDateFormat,o=this.$datePicker.config(),s,l=this.instance.view.isMouseDown(),u=n?Q0(n.keyCode):!1;this.datePickerStyle.top="".concat(window.pageYOffset+i.top+sr(this.TD),"px"),this.datePickerStyle.left="".concat(window.pageXOffset+i.left,"px"),this.$datePicker._onInputFocus=function(){},o.format=a,this.originalValue?(s=this.originalValue,Pe(s,a,!0).isValid()&&this.$datePicker.setMoment(Pe(s,a),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!u&&!l&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,o.defaultDate=s,Pe(s,a,!0).isValid()&&this.$datePicker.setMoment(Pe(s,a),!0),!u&&!l&&this.setValue("")):this.$datePicker.gotoToday(),this.datePickerStyle.display="block",this.$datePicker.show()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var n=this,i=this.TEXTAREA,a={};this.cellProperties&&this.cellProperties.datePickerConfig&&Il(a,this.cellProperties.datePickerConfig);var o=a.onSelect,s=a.onClose;return a.field=i,a.trigger=i,a.container=this.datePicker,a.bound=!1,a.format=a.format||this.defaultDateFormat,a.reposition=a.reposition||!1,a.onSelect=function(l){var u=l;isNaN(u.getTime())||(u=Pe(u).format(n.cellProperties.dateFormat||n.defaultDateFormat)),n.setValue(u),n.hideDatepicker(),o&&o()},a.onClose=function(){n.parentDestroyed||n.finishEditing(!1),s&&s()},a}}]),r}(Mt);function Au(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Au=function(t){return typeof t}:Au=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Au(e)}function a2(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function vm(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o2(e,r,t){return r&&vm(e.prototype,r),t&&vm(e,t),e}function s2(e,r){return r&&(Au(r)==="object"||typeof r=="function")?r:l2(e)}function l2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Mu(e,r,t){return typeof Reflect<"u"&&Reflect.get?Mu=Reflect.get:Mu=function(i,a,o){var s=u2(i,a);if(s){var l=Object.getOwnPropertyDescriptor(s,a);return l.get?l.get.call(o):l.value}},Mu(e,r,t||e)}function u2(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=pl(e),e!==null););return e}function pl(e){return pl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},pl(e)}function f2(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&yd(e,r)}function yd(e,r){return yd=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},yd(e,r)}var I1=function(e){f2(r,e);function r(){return a2(this,r),s2(this,pl(r).apply(this,arguments))}return o2(r,[{key:"prepare",value:function(n,i,a,o,s,l){Mu(pl(r.prototype),"prepare",this).call(this,n,i,a,o,s,l),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}]),r}($t);at.getSingleton().add("beforeValidate",function(e,r,t){var n=this.getCellMeta(r,this.propToCol(t));n.editor===I1&&n.strict===void 0&&(n.filter=!1,n.strict=!0)});function Du(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Du=function(t){return typeof t}:Du=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Du(e)}function c2(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function h2(e,r){return r&&(Du(r)==="object"||typeof r=="function")?r:d2(e)}function d2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wd(e){return wd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},wd(e)}function v2(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&_d(e,r)}function _d(e,r){return _d=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},_d(e,r)}var g2=function(e){v2(r,e);function r(){return c2(this,r),h2(this,wd(r).apply(this,arguments))}return r}(Mt);function Pu(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Pu=function(t){return typeof t}:Pu=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pu(e)}function m2(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function gm(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p2(e,r,t){return r&&gm(e.prototype,r),t&&gm(e,t),e}function y2(e,r){return r&&(Pu(r)==="object"||typeof r=="function")?r:w2(e)}function w2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nu(e,r,t){return typeof Reflect<"u"&&Reflect.get?Nu=Reflect.get:Nu=function(i,a,o){var s=_2(i,a);if(s){var l=Object.getOwnPropertyDescriptor(s,a);return l.get?l.get.call(o):l.value}},Nu(e,r,t||e)}function _2(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=yl(e),e!==null););return e}function yl(e){return yl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},yl(e)}function C2(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&Cd(e,r)}function Cd(e,r){return Cd=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Cd(e,r)}var S2=function(e){C2(r,e);function r(){return m2(this,r),y2(this,yl(r).apply(this,arguments))}return p2(r,[{key:"createElements",value:function(){Nu(yl(r.prototype),"createElements",this).call(this),this.TEXTAREA=document.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Gn(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}]),r}(Mt);function Fu(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Fu=function(t){return typeof t}:Fu=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fu(e)}var En=jt.prototype.extend();En.prototype.init=function(){this.select=document.createElement("SELECT"),$e(this.select,"htSelectEditor"),this.select.style.display="none",this.instance.rootElement.appendChild(this.select),this.registerHooks()};En.prototype.registerHooks=function(){var e=this;this.instance.addHook("afterScrollHorizontally",function(){return e.refreshDimensions()}),this.instance.addHook("afterScrollVertically",function(){return e.refreshDimensions()}),this.instance.addHook("afterColumnResize",function(){return e.refreshDimensions()}),this.instance.addHook("afterRowResize",function(){return e.refreshDimensions()})};En.prototype.prepare=function(){for(var e=this,r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n];jt.prototype.prepare.apply(this,t);var i=this.cellProperties.selectOptions,a;typeof i=="function"?a=this.prepareOptions(i(this.row,this.col,this.prop)):a=this.prepareOptions(i),Gn(this.select),St(a,function(o,s){var l=document.createElement("OPTION");l.value=s,ms(l,o),e.select.appendChild(l)})};En.prototype.prepareOptions=function(e){var r={};if(Array.isArray(e))for(var t=0,n=e.length;t<n;t++)r[e[t]]=e[t];else Fu(e)==="object"&&(r=e);return r};En.prototype.getValue=function(){return this.select.value};En.prototype.setValue=function(e){this.select.value=e};var H1=function(r){var t=this,n=t.getActiveEditor(),i=n.select.selectedIndex-1,a=n.select.selectedIndex+1;switch(r.keyCode){case De.ARROW_UP:i>=0&&(n.select[i].selected=!0),Hr(r),r.preventDefault();break;case De.ARROW_DOWN:a<=n.select.length-1&&(n.select[a].selected=!0),Hr(r),r.preventDefault();break}};En.prototype.open=function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.instance.addHook("beforeKeyDown",H1)};En.prototype.close=function(){this._opened=!1,this.select.style.display="none",this.instance.removeHook("beforeKeyDown",H1)};En.prototype.focus=function(){this.select.focus()};En.prototype.refreshValue=function(){var e=this.instance.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()};En.prototype.refreshDimensions=function(){if(this.state===_r.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close();return}var e=Xt(this.TD),r=Xt(this.instance.rootElement),t=co(this.TD),n=this.checkEditorSection(),i=Gt(this.TD)+1,a=sr(this.TD)+1,o=e.top-r.top-1-(t.scrollTop||0),s=e.left-r.left-1-(t.scrollLeft||0),l;switch(n){case"top":l=$n(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":l=$n(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":l=$n(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":l=$n(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":l=$n(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode);break}this.instance.getSelectedLast()[0]===0&&(o+=1),this.instance.getSelectedLast()[1]===0&&(s+=1);var u=this.select.style;l&&l!==-1?u[l[0]]=l[1]:wa(this.select);var f=ys(this.TD);parseInt(f.borderTopWidth,10)>0&&(a-=1),parseInt(f.borderLeftWidth,10)>0&&(i-=1),u.height="".concat(a,"px"),u.minWidth="".concat(i,"px"),u.top="".concat(o,"px"),u.left="".concat(s,"px"),u.margin="0px"}};En.prototype.getEditedCell=function(){var e=this.checkEditorSection(),r;switch(e){case"top":r=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.select.style.zIndex=101;break;case"corner":r=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.select.style.zIndex=103;break;case"left":r=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.select.style.zIndex=102;break;default:r=this.instance.getCell(this.row,this.col),this.select.style.zIndex="";break}return r!==-1&&r!==-2?r:void 0};var Sd=new WeakMap,lc=Bi("editors"),b2=lc.register,B1=lc.getItem,x2=lc.hasItem,E2=lc.getNames;Tn("base",jt);Tn("autocomplete",$t);Tn("checkbox",Kk);Tn("date",i2);Tn("dropdown",I1);Tn("handsontable",Vr);Tn("numeric",g2);Tn("password",S2);Tn("select",En);Tn("text",Mt);function T2(e){var r={},t=e;this.getConstructor=function(){return e},this.getInstance=function(n){return n.guid in r||(r[n.guid]=new t(n)),r[n.guid]},at.getSingleton().add("afterDestroy",function(){r[this.guid]=null})}function W1(e,r){var t;if(typeof e=="function")Sd.get(e)||Tn(null,e),t=Sd.get(e);else if(typeof e=="string")t=B1(e);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!t)throw Error('No editor registered under name "'.concat(e,'"'));return t.getInstance(r)}function Kn(e){if(!x2(e))throw Error('No registered editor found under "'.concat(e,'" name'));return B1(e).getConstructor()}function Tn(e,r){var t=new T2(r);typeof e=="string"&&b2(e,t),Sd.set(r,t)}function O2(e,r,t,n,i,a,o){var s=[],l=[];o.className&&(r.className?r.className="".concat(r.className," ").concat(o.className):r.className=o.className),o.readOnly&&s.push(o.readOnlyCellClassName),o.valid===!1&&o.invalidCellClassName?s.push(o.invalidCellClassName):l.push(o.invalidCellClassName),o.wordWrap===!1&&o.noWordWrapClassName&&s.push(o.noWordWrapClassName),!a&&o.placeholder&&s.push(o.placeholderCellClassName),pt(r,l),$e(r,s)}var R2=document.createElement("DIV");R2.className="htAutocompleteWrapper";var nv=document.createElement("DIV");nv.className="htAutocompleteArrow";nv.appendChild(document.createTextNode("▼"));function k2(e,r,t,n,i,a,o){for(var s=o.allowHtml?"html":"text",l=nv.cloneNode(!0),u=arguments.length,f=new Array(u>7?u-7:0),c=7;c<u;c++)f[c-7]=arguments[c];if(Dr(s).apply(this,[e,r,t,n,i,a,o].concat(f)),r.firstChild||r.appendChild(document.createTextNode(" ")),r.insertBefore(l,r.firstChild),$e(r,"htAutocomplete"),!e.acArrowListener){var h=new Ft(e);e.acArrowListener=function(d){gt(d.target,"htAutocompleteArrow")&&e.view.wt.getSetting("onCellDblClick",null,new me(t,n),r)},h.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",function(){h.destroy()})}}var mm=new WeakMap,pm=new WeakMap,A2="htBadValue";function M2(e,r,t,n,i,a,o){for(var s=arguments.length,l=new Array(s>7?s-7:0),u=7;u<s;u++)l[u-7]=arguments[u];Dr("base").apply(this,[e,r,t,n,i,a,o].concat(l)),D2(e);var f=P2(),c=o.label,h=!1;if(typeof o.checkedTemplate>"u"&&(o.checkedTemplate=!0),typeof o.uncheckedTemplate>"u"&&(o.uncheckedTemplate=!1),Gn(r),a===o.checkedTemplate||rd(a,o.checkedTemplate)?f.checked=!0:a===o.uncheckedTemplate||rd(a,o.uncheckedTemplate)?f.checked=!1:a===null?$e(f,"noValue"):(f.style.display="none",$e(f,A2),h=!0),f.setAttribute("data-row",t),f.setAttribute("data-col",n),!h&&c){var d="";c.value?d=typeof c.value=="function"?c.value.call(this,t,n,i,a):c.value:c.property&&(d=e.getDataAtRowProp(t,c.property));var g=N2(d);c.position==="before"?g.appendChild(f):g.insertBefore(f,g.firstChild),f=g}r.appendChild(f),h&&r.appendChild(document.createTextNode("#bad-value#")),mm.has(e)||(mm.set(e,!0),e.addHook("beforeKeyDown",v));function v(F){var D="SPACE|ENTER",ee="DELETE|BACKSPACE",ue=J0(tv,F.keyCode);!e.getSettings().enterBeginsEditing&&ue("ENTER")||(ue("".concat(D,"|").concat(ee))&&!Oi(F)&&C(function(){Hr(F),F.preventDefault()}),ue(D)&&p(),ue(ee)&&p(!0))}function p(){var F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,D=e.getSelectedRangeLast();if(D){for(var ee=D.getTopLeftCorner(),ue=ee.row,se=ee.col,U=D.getBottomRightCorner(),re=U.row,m=U.col,_=[],x=ue;x<=re;x+=1)for(var B=se;B<=m;B+=1){var Q=e.getCellMeta(x,B);if(Q.type!=="checkbox")return;if(Q.readOnly!==!0){typeof Q.checkedTemplate>"u"&&(Q.checkedTemplate=!0),typeof Q.uncheckedTemplate>"u"&&(Q.uncheckedTemplate=!1);var A=e.getDataAtCell(x,B);F===!1?[Q.checkedTemplate,Q.checkedTemplate.toString()].includes(A)?_.push([x,B,Q.uncheckedTemplate]):[Q.uncheckedTemplate,Q.uncheckedTemplate.toString(),null,void 0].includes(A)&&_.push([x,B,Q.checkedTemplate]):_.push([x,B,Q.uncheckedTemplate])}}_.length>0&&e.setDataAtCell(_)}}function C(F){var D=e.getSelectedRangeLast();if(D)for(var ee=D.getTopLeftCorner(),ue=D.getBottomRightCorner(),se=ee.row;se<=ue.row;se++)for(var U=ee.col;U<=ue.col;U++){var re=e.getCellMeta(se,U);if(re.type!=="checkbox")return;var m=e.getCell(se,U);if(m==null)F(se,U,re);else{var _=m.querySelectorAll("input[type=checkbox]");_.length>0&&!re.readOnly&&F(_)}}}}function D2(e){var r=pm.get(e);return r||(r=new Ft(e),r.addEventListener(e.rootElement,"click",function(t){return L2(t,e)}),r.addEventListener(e.rootElement,"mouseup",function(t){return F2(t,e)}),r.addEventListener(e.rootElement,"change",function(t){return I2(t,e)}),pm.set(e,r)),r}function P2(){var e=document.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("autocomplete","off"),e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function N2(e){var r=document.createElement("label");return r.className="htCheckboxRendererLabel",r.appendChild(document.createTextNode(e)),r.cloneNode(!0)}function F2(e,r){iv(e.target)&&setTimeout(r.listen,10)}function L2(e,r){if(!iv(e.target))return!1;var t=parseInt(e.target.getAttribute("data-row"),10),n=parseInt(e.target.getAttribute("data-col"),10),i=r.getCellMeta(t,n);i.readOnly&&e.preventDefault()}function I2(e,r){if(!iv(e.target))return!1;var t=parseInt(e.target.getAttribute("data-row"),10),n=parseInt(e.target.getAttribute("data-col"),10),i=r.getCellMeta(t,n);if(!i.readOnly){var a=null;e.target.checked?a=i.uncheckedTemplate===void 0?!0:i.checkedTemplate:a=i.uncheckedTemplate===void 0?!1:i.uncheckedTemplate,r.setDataAtCell(t,n,a)}}function iv(e){return e.tagName==="INPUT"&&e.getAttribute("type")==="checkbox"}function H2(e,r,t,n,i,a){for(var o=arguments.length,s=new Array(o>6?o-6:0),l=6;l<o;l++)s[l-6]=arguments[l];Dr("base").apply(this,[e,r,t,n,i,a].concat(s)),ms(r,a??"")}var $1={exports:{}};(function(e,r){(function(t,n){e.exports=n()})(Uo,function(){var t=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Uo<"u"?Uo:typeof self<"u"?self:{};function n(H){return H&&H.__esModule&&Object.prototype.hasOwnProperty.call(H,"default")?H.default:H}/*!
	 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
	 *
	 * Permission is hereby granted, free of charge, to any person obtaining a copy
	 * of this software and associated documentation files (the "Software"), to deal
	 * in the Software without restriction, including without limitation the rights
	 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
	 * copies of the Software, and to permit persons to whom the Software is
	 * furnished to do so, subject to the following conditions:
	 *
	 * The above copyright notice and this permission notice shall be included in
	 * all copies or substantial portions of the Software.
	 *
	 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
	 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
	 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
	 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
	 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
	 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
	 * SOFTWARE.
	 */var i,a,o,s,l={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(H){let O=H%10;return~~(H%100/10)==1?"th":O===1?"st":O===2?"nd":O===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}};/*!
	 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
	 *
	 * Permission is hereby granted, free of charge, to any person obtaining a copy
	 * of this software and associated documentation files (the "Software"), to deal
	 * in the Software without restriction, including without limitation the rights
	 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
	 * copies of the Software, and to permit persons to whom the Software is
	 * furnished to do so, subject to the following conditions:
	 *
	 * The above copyright notice and this permission notice shall be included in
	 * all copies or substantial portions of the Software.
	 *
	 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
	 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
	 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
	 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
	 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
	 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
	 * SOFTWARE.
	 */function u(){if(a)return i;a=1;const H=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function O(q){return q.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function T(q,ae,he,oe,be,ce,Ce){if(!isNaN(+q))return+q;let Me="",Fe=q.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(Fe!==q)return-1*T(Fe,ae,he,oe,be,ce);for(let ut=0;ut<H.length;ut++){let nt=H[ut];if(Me=q.replace(RegExp(`([0-9 ])(${nt.key})$`),"$1"),Me!==q)return T(Me,ae,he,oe,be,ce)*nt.factor}if(Me=q.replace("%",""),Me!==q)return T(Me,ae,he,oe,be,ce)/100;let ke=parseFloat(q);if(isNaN(ke))return;let de=oe(ke);if(de&&de!=="."&&(Me=q.replace(new RegExp(`${O(de)}$`),""),Me!==q))return T(Me,ae,he,oe,be,ce);let Oe={};Object.keys(ce).forEach(ut=>{Oe[ce[ut]]=ut});let we=Object.keys(Oe).sort().reverse(),et=we.length;for(let ut=0;ut<et;ut++){let nt=we[ut],tr=Oe[nt];if(Me=q.replace(nt,""),Me!==q){let Ve;switch(tr){case"thousand":Ve=Math.pow(10,3);break;case"million":Ve=Math.pow(10,6);break;case"billion":Ve=Math.pow(10,9);break;case"trillion":Ve=Math.pow(10,12)}return T(Me,ae,he,oe,be,ce)*Ve}}}function Y(q,ae,he="",oe,be,ce,Ce){if(q==="")return;if(q===be)return 0;let Me=function(Fe,ke,de){let Oe=Fe.replace(de,"");return Oe=Oe.replace(new RegExp(`([0-9])${O(ke.thousands)}([0-9])`,"g"),"$1$2"),Oe=Oe.replace(ke.decimal,"."),Oe}(q,ae,he);return T(Me,ae,he,oe,be,ce)}return i={unformat:function(q,ae){const he=g();let oe,be=he.currentDelimiters(),ce=he.currentCurrency().symbol,Ce=he.currentOrdinal(),Me=he.getZeroFormat(),Fe=he.currentAbbreviations();if(typeof q=="string")oe=function(ke,de){if(!ke.indexOf(":")||de.thousands===":")return!1;let Oe=ke.split(":");if(Oe.length!==3)return!1;let we=+Oe[0],et=+Oe[1],ut=+Oe[2];return!isNaN(we)&&!isNaN(et)&&!isNaN(ut)}(q,be)?function(ke){let de=ke.split(":"),Oe=+de[0],we=+de[1];return+de[2]+60*we+3600*Oe}(q):Y(q,be,ce,Ce,Me,Fe);else{if(typeof q!="number")return;oe=q}if(oe!==void 0)return oe}},i}/*!
	 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
	 *
	 * Permission is hereby granted, free of charge, to any person obtaining a copy
	 * of this software and associated documentation files (the "Software"), to deal
	 * in the Software without restriction, including without limitation the rights
	 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
	 * copies of the Software, and to permit persons to whom the Software is
	 * furnished to do so, subject to the following conditions:
	 *
	 * The above copyright notice and this permission notice shall be included in
	 * all copies or substantial portions of the Software.
	 *
	 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
	 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
	 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
	 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
	 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
	 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
	 * SOFTWARE.
	 */function f(){if(s)return o;s=1;let H=u();const O=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,T={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:(oe,be)=>be.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:oe=>oe.output==="byte"},characteristic:{type:"number",restriction:oe=>oe>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",lowPrecision:{type:"boolean",restriction:(oe,be)=>be.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:oe=>oe>=0,message:"value must be positive"},{restriction:(oe,be)=>!be.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:oe=>oe>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(oe,be)=>be.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},Y={languageTag:{type:"string",mandatory:!0,restriction:oe=>oe.match(O),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function q(oe){return H.unformat(oe)!==void 0}function ae(oe,be,ce,Ce=!1){let Me=Object.keys(oe).map(Fe=>{if(!be[Fe])return console.error(`${ce} Invalid key: ${Fe}`),!1;let ke=oe[Fe],de=be[Fe];if(typeof de=="string"&&(de={type:de}),de.type==="format"){if(!ae(ke,T,`[Validate ${Fe}]`,!0))return!1}else if(typeof ke!==de.type)return console.error(`${ce} ${Fe} type mismatched: "${de.type}" expected, "${typeof ke}" provided`),!1;if(de.restrictions&&de.restrictions.length){let Oe=de.restrictions.length;for(let we=0;we<Oe;we++){let{restriction:et,message:ut}=de.restrictions[we];if(!et(ke,oe))return console.error(`${ce} ${Fe} invalid value: ${ut}`),!1}}return de.restriction&&!de.restriction(ke,oe)?(console.error(`${ce} ${Fe} invalid value: ${de.message}`),!1):de.validValues&&de.validValues.indexOf(ke)===-1?(console.error(`${ce} ${Fe} invalid value: must be among ${JSON.stringify(de.validValues)}, "${ke}" provided`),!1):!(de.children&&!ae(ke,de.children,`[Validate ${Fe}]`))});return Ce||Me.push(...Object.keys(be).map(Fe=>{let ke=be[Fe];if(typeof ke=="string"&&(ke={type:ke}),ke.mandatory){let de=ke.mandatory;if(typeof de=="function"&&(de=de(oe)),de&&oe[Fe]===void 0)return console.error(`${ce} Missing mandatory key "${Fe}"`),!1}return!0})),Me.reduce((Fe,ke)=>Fe&&ke,!0)}function he(oe){return ae(oe,T,"[Validate format]")}return o={validate:function(oe,be){let ce=q(oe),Ce=he(be);return ce&&Ce},validateFormat:he,validateInput:q,validateLanguage:function(oe){return ae(oe,Y,"[Validate language]")}},o}/*!
	 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
	 *
	 * Permission is hereby granted, free of charge, to any person obtaining a copy
	 * of this software and associated documentation files (the "Software"), to deal
	 * in the Software without restriction, including without limitation the rights
	 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
	 * copies of the Software, and to permit persons to whom the Software is
	 * furnished to do so, subject to the following conditions:
	 *
	 * The above copyright notice and this permission notice shall be included in
	 * all copies or substantial portions of the Software.
	 *
	 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
	 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
	 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
	 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
	 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
	 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
	 * SOFTWARE.
	 */var c,h,d={parseFormat:function(H,O={}){return typeof H!="string"?H:(function(T,Y){if(T.indexOf("$")===-1){if(T.indexOf("%")===-1)return T.indexOf("bd")!==-1?(Y.output="byte",void(Y.base="general")):T.indexOf("b")!==-1?(Y.output="byte",void(Y.base="binary")):T.indexOf("d")!==-1?(Y.output="byte",void(Y.base="decimal")):void(T.indexOf(":")===-1?T.indexOf("o")!==-1&&(Y.output="ordinal"):Y.output="time");Y.output="percent"}else Y.output="currency"}(H=function(T,Y){let q=T.match(/{([^}]*)}$/);return q?(Y.postfix=q[1],T.slice(0,-q[0].length)):T}(H=function(T,Y){let q=T.match(/^{([^}]*)}/);return q?(Y.prefix=q[1],T.slice(q[0].length)):T}(H,O),O),O),function(T,Y){let q=T.match(/[1-9]+[0-9]*/);q&&(Y.totalLength=+q[0])}(H,O),function(T,Y){let q=T.split(".")[0].match(/0+/);q&&(Y.characteristic=q[0].length)}(H,O),function(T,Y){if(T.indexOf(".")!==-1){let q=T.split(".")[0];Y.optionalCharacteristic=q.indexOf("0")===-1}}(H,O),function(T,Y){T.indexOf("a")!==-1&&(Y.average=!0)}(H,O),function(T,Y){T.indexOf("K")!==-1?Y.forceAverage="thousand":T.indexOf("M")!==-1?Y.forceAverage="million":T.indexOf("B")!==-1?Y.forceAverage="billion":T.indexOf("T")!==-1&&(Y.forceAverage="trillion")}(H,O),function(T,Y){let q=T.split(".")[1];if(q){let ae=q.match(/0+/);ae&&(Y.mantissa=ae[0].length)}}(H,O),function(T,Y){T.match(/\[\.]/)?Y.optionalMantissa=!0:T.match(/\./)&&(Y.optionalMantissa=!1)}(H,O),function(T,Y){const q=T.split(".")[1];q&&(Y.trimMantissa=q.indexOf("[")!==-1)}(H,O),function(T,Y){T.indexOf(",")!==-1&&(Y.thousandSeparated=!0)}(H,O),function(T,Y){T.indexOf(" ")!==-1&&(Y.spaceSeparated=!0,Y.spaceSeparatedCurrency=!0,(Y.average||Y.forceAverage)&&(Y.spaceSeparatedAbbreviation=!0))}(H,O),function(T,Y){T.match(/^\+?\([^)]*\)$/)&&(Y.negative="parenthesis"),T.match(/^\+?-/)&&(Y.negative="sign")}(H,O),function(T,Y){T.match(/^\+/)&&(Y.forceSign=!0)}(H,O),O)}};/*!
	 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
	 *
	 * Permission is hereby granted, free of charge, to any person obtaining a copy
	 * of this software and associated documentation files (the "Software"), to deal
	 * in the Software without restriction, including without limitation the rights
	 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
	 * copies of the Software, and to permit persons to whom the Software is
	 * furnished to do so, subject to the following conditions:
	 *
	 * The above copyright notice and this permission notice shall be included in
	 * all copies or substantial portions of the Software.
	 *
	 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
	 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
	 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
	 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
	 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
	 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
	 * SOFTWARE.
	 */function g(){if(h)return c;h=1;const H=l,O=f(),T=d;let Y,q={},ae={},he=null,oe={};function be(Ce){Y=Ce}function ce(){return ae[Y]}return q.languages=()=>Object.assign({},ae),q.currentLanguage=()=>Y,q.currentBytes=()=>ce().bytes||{},q.currentCurrency=()=>ce().currency,q.currentAbbreviations=()=>ce().abbreviations,q.currentDelimiters=()=>ce().delimiters,q.currentOrdinal=()=>ce().ordinal,q.currentDefaults=()=>Object.assign({},ce().defaults,oe),q.currentOrdinalDefaultFormat=()=>Object.assign({},q.currentDefaults(),ce().ordinalFormat),q.currentByteDefaultFormat=()=>Object.assign({},q.currentDefaults(),ce().byteFormat),q.currentPercentageDefaultFormat=()=>Object.assign({},q.currentDefaults(),ce().percentageFormat),q.currentCurrencyDefaultFormat=()=>Object.assign({},q.currentDefaults(),ce().currencyFormat),q.currentTimeDefaultFormat=()=>Object.assign({},q.currentDefaults(),ce().timeFormat),q.setDefaults=Ce=>{Ce=T.parseFormat(Ce),O.validateFormat(Ce)&&(oe=Ce)},q.getZeroFormat=()=>he,q.setZeroFormat=Ce=>he=typeof Ce=="string"?Ce:null,q.hasZeroFormat=()=>he!==null,q.languageData=Ce=>{if(Ce){if(ae[Ce])return ae[Ce];throw new Error(`Unknown tag "${Ce}"`)}return ce()},q.registerLanguage=(Ce,Me=!1)=>{if(!O.validateLanguage(Ce))throw new Error("Invalid language data");ae[Ce.languageTag]=Ce,Me&&be(Ce.languageTag)},q.setLanguage=(Ce,Me=H.languageTag)=>{if(!ae[Ce]){let Fe=Ce.split("-")[0],ke=Object.keys(ae).find(de=>de.split("-")[0]===Fe);return ae[ke]?void be(ke):void be(Me)}be(Ce)},q.registerLanguage(H),Y=H.languageTag,c=q}/*!
	 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
	 *
	 * Permission is hereby granted, free of charge, to any person obtaining a copy
	 * of this software and associated documentation files (the "Software"), to deal
	 * in the Software without restriction, including without limitation the rights
	 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
	 * copies of the Software, and to permit persons to whom the Software is
	 * furnished to do so, subject to the following conditions:
	 *
	 * The above copyright notice and this permission notice shall be included in
	 * all copies or substantial portions of the Software.
	 *
	 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
	 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
	 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
	 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
	 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
	 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
	 * SOFTWARE.
	 */function v(H,O){H.forEach(T=>{let Y;try{Y=function(q){throw new Error('Could not dynamically require "'+q+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}(`../languages/${T}`)}catch{console.error(`Unable to load "${T}". No matching language file found.`)}Y&&O.registerLanguage(Y)})}var p={exports:{}};(function(H){(function(O){var T,Y=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,q=Math.ceil,ae=Math.floor,he="[BigNumber Error] ",oe=he+"Number primitive has more than 15 significant digits: ",be=1e14,ce=14,Ce=9007199254740991,Me=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],Fe=1e7,ke=1e9;function de(Ve){var Ie=0|Ve;return Ve>0||Ve===Ie?Ie:Ie-1}function Oe(Ve){for(var Ie,Xe,tt=1,Qe=Ve.length,ot=Ve[0]+"";tt<Qe;){for(Ie=Ve[tt++]+"",Xe=ce-Ie.length;Xe--;Ie="0"+Ie);ot+=Ie}for(Qe=ot.length;ot.charCodeAt(--Qe)===48;);return ot.slice(0,Qe+1||1)}function we(Ve,Ie){var Xe,tt,Qe=Ve.c,ot=Ie.c,ht=Ve.s,it=Ie.s,wt=Ve.e,qt=Ie.e;if(!ht||!it)return null;if(Xe=Qe&&!Qe[0],tt=ot&&!ot[0],Xe||tt)return Xe?tt?0:-it:ht;if(ht!=it)return ht;if(Xe=ht<0,tt=wt==qt,!Qe||!ot)return tt?0:!Qe^Xe?1:-1;if(!tt)return wt>qt^Xe?1:-1;for(it=(wt=Qe.length)<(qt=ot.length)?wt:qt,ht=0;ht<it;ht++)if(Qe[ht]!=ot[ht])return Qe[ht]>ot[ht]^Xe?1:-1;return wt==qt?0:wt>qt^Xe?1:-1}function et(Ve,Ie,Xe,tt){if(Ve<Ie||Ve>Xe||Ve!==ae(Ve))throw Error(he+(tt||"Argument")+(typeof Ve=="number"?Ve<Ie||Ve>Xe?" out of range: ":" not an integer: ":" not a primitive number: ")+String(Ve))}function ut(Ve){var Ie=Ve.c.length-1;return de(Ve.e/ce)==Ie&&Ve.c[Ie]%2!=0}function nt(Ve,Ie){return(Ve.length>1?Ve.charAt(0)+"."+Ve.slice(1):Ve)+(Ie<0?"e":"e+")+Ie}function tr(Ve,Ie,Xe){var tt,Qe;if(Ie<0){for(Qe=Xe+".";++Ie;Qe+=Xe);Ve=Qe+Ve}else if(++Ie>(tt=Ve.length)){for(Qe=Xe,Ie-=tt;--Ie;Qe+=Xe);Ve+=Qe}else Ie<tt&&(Ve=Ve.slice(0,Ie)+"."+Ve.slice(Ie));return Ve}T=function Ve(Ie){var Xe,tt,Qe,ot,ht,it,wt,qt,xr,Ht,Ne=y.prototype={constructor:y,toString:null,valueOf:null},Er=new y(1),Tr=20,rr=4,zr=-7,vn=21,Rn=-1e7,Fr=1e7,gn=!1,Ta=1,kn=0,As={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},wi="0123456789abcdefghijklmnopqrstuvwxyz",Ms=!0;function y(w,S){var E,N,k,j,G,X,K,J,te=this;if(!(te instanceof y))return new y(w,S);if(S==null){if(w&&w._isBigNumber===!0)return te.s=w.s,void(!w.c||w.e>Fr?te.c=te.e=null:w.e<Rn?te.c=[te.e=0]:(te.e=w.e,te.c=w.c.slice()));if((X=typeof w=="number")&&0*w==0){if(te.s=1/w<0?(w=-w,-1):1,w===~~w){for(j=0,G=w;G>=10;G/=10,j++);return void(j>Fr?te.c=te.e=null:(te.e=j,te.c=[w]))}J=String(w)}else{if(!Y.test(J=String(w)))return Qe(te,J,X);te.s=J.charCodeAt(0)==45?(J=J.slice(1),-1):1}(j=J.indexOf("."))>-1&&(J=J.replace(".","")),(G=J.search(/e/i))>0?(j<0&&(j=G),j+=+J.slice(G+1),J=J.substring(0,G)):j<0&&(j=J.length)}else{if(et(S,2,wi.length,"Base"),S==10&&Ms)return I(te=new y(w),Tr+te.e+1,rr);if(J=String(w),X=typeof w=="number"){if(0*w!=0)return Qe(te,J,X,S);if(te.s=1/w<0?(J=J.slice(1),-1):1,y.DEBUG&&J.replace(/^0\.0*|\./,"").length>15)throw Error(oe+w)}else te.s=J.charCodeAt(0)===45?(J=J.slice(1),-1):1;for(E=wi.slice(0,S),j=G=0,K=J.length;G<K;G++)if(E.indexOf(N=J.charAt(G))<0){if(N=="."){if(G>j){j=K;continue}}else if(!k&&(J==J.toUpperCase()&&(J=J.toLowerCase())||J==J.toLowerCase()&&(J=J.toUpperCase()))){k=!0,G=-1,j=0;continue}return Qe(te,String(w),X,S)}X=!1,(j=(J=tt(J,S,10,te.s)).indexOf("."))>-1?J=J.replace(".",""):j=J.length}for(G=0;J.charCodeAt(G)===48;G++);for(K=J.length;J.charCodeAt(--K)===48;);if(J=J.slice(G,++K)){if(K-=G,X&&y.DEBUG&&K>15&&(w>Ce||w!==ae(w)))throw Error(oe+te.s*w);if((j=j-G-1)>Fr)te.c=te.e=null;else if(j<Rn)te.c=[te.e=0];else{if(te.e=j,te.c=[],G=(j+1)%ce,j<0&&(G+=ce),G<K){for(G&&te.c.push(+J.slice(0,G)),K-=ce;G<K;)te.c.push(+J.slice(G,G+=ce));G=ce-(J=J.slice(G)).length}else G-=K;for(;G--;J+="0");te.c.push(+J)}}else te.c=[te.e=0]}function V(w,S,E,N){var k,j,G,X,K;if(E==null?E=rr:et(E,0,8),!w.c)return w.toString();if(k=w.c[0],G=w.e,S==null)K=Oe(w.c),K=N==1||N==2&&(G<=zr||G>=vn)?nt(K,G):tr(K,G,"0");else if(j=(w=I(new y(w),S,E)).e,X=(K=Oe(w.c)).length,N==1||N==2&&(S<=j||j<=zr)){for(;X<S;K+="0",X++);K=nt(K,j)}else if(S-=G,K=tr(K,j,"0"),j+1>X){if(--S>0)for(K+=".";S--;K+="0");}else if((S+=j-X)>0)for(j+1==X&&(K+=".");S--;K+="0");return w.s<0&&k?"-"+K:K}function M(w,S){for(var E,N,k=1,j=new y(w[0]);k<w.length;k++)(!(N=new y(w[k])).s||(E=we(j,N))===S||E===0&&j.s===S)&&(j=N);return j}function L(w,S,E){for(var N=1,k=S.length;!S[--k];S.pop());for(k=S[0];k>=10;k/=10,N++);return(E=N+E*ce-1)>Fr?w.c=w.e=null:E<Rn?w.c=[w.e=0]:(w.e=E,w.c=S),w}function I(w,S,E,N){var k,j,G,X,K,J,te,xe=w.c,He=Me;if(xe){e:{for(k=1,X=xe[0];X>=10;X/=10,k++);if((j=S-k)<0)j+=ce,G=S,K=xe[J=0],te=ae(K/He[k-G-1]%10);else if((J=q((j+1)/ce))>=xe.length){if(!N)break e;for(;xe.length<=J;xe.push(0));K=te=0,k=1,G=(j%=ce)-ce+1}else{for(K=X=xe[J],k=1;X>=10;X/=10,k++);te=(G=(j%=ce)-ce+k)<0?0:ae(K/He[k-G-1]%10)}if(N=N||S<0||xe[J+1]!=null||(G<0?K:K%He[k-G-1]),N=E<4?(te||N)&&(E==0||E==(w.s<0?3:2)):te>5||te==5&&(E==4||N||E==6&&(j>0?G>0?K/He[k-G]:0:xe[J-1])%10&1||E==(w.s<0?8:7)),S<1||!xe[0])return xe.length=0,N?(S-=w.e+1,xe[0]=He[(ce-S%ce)%ce],w.e=-S||0):xe[0]=w.e=0,w;if(j==0?(xe.length=J,X=1,J--):(xe.length=J+1,X=He[ce-j],xe[J]=G>0?ae(K/He[k-G]%He[G])*X:0),N)for(;;){if(J==0){for(j=1,G=xe[0];G>=10;G/=10,j++);for(G=xe[0]+=X,X=1;G>=10;G/=10,X++);j!=X&&(w.e++,xe[0]==be&&(xe[0]=1));break}if(xe[J]+=X,xe[J]!=be)break;xe[J--]=0,X=1}for(j=xe.length;xe[--j]===0;xe.pop());}w.e>Fr?w.c=w.e=null:w.e<Rn&&(w.c=[w.e=0])}return w}function z(w){var S,E=w.e;return E===null?w.toString():(S=Oe(w.c),S=E<=zr||E>=vn?nt(S,E):tr(S,E,"0"),w.s<0?"-"+S:S)}return y.clone=Ve,y.ROUND_UP=0,y.ROUND_DOWN=1,y.ROUND_CEIL=2,y.ROUND_FLOOR=3,y.ROUND_HALF_UP=4,y.ROUND_HALF_DOWN=5,y.ROUND_HALF_EVEN=6,y.ROUND_HALF_CEIL=7,y.ROUND_HALF_FLOOR=8,y.EUCLID=9,y.config=y.set=function(w){var S,E;if(w!=null){if(typeof w!="object")throw Error(he+"Object expected: "+w);if(w.hasOwnProperty(S="DECIMAL_PLACES")&&(et(E=w[S],0,ke,S),Tr=E),w.hasOwnProperty(S="ROUNDING_MODE")&&(et(E=w[S],0,8,S),rr=E),w.hasOwnProperty(S="EXPONENTIAL_AT")&&((E=w[S])&&E.pop?(et(E[0],-ke,0,S),et(E[1],0,ke,S),zr=E[0],vn=E[1]):(et(E,-ke,ke,S),zr=-(vn=E<0?-E:E))),w.hasOwnProperty(S="RANGE"))if((E=w[S])&&E.pop)et(E[0],-ke,-1,S),et(E[1],1,ke,S),Rn=E[0],Fr=E[1];else{if(et(E,-ke,ke,S),!E)throw Error(he+S+" cannot be zero: "+E);Rn=-(Fr=E<0?-E:E)}if(w.hasOwnProperty(S="CRYPTO")){if((E=w[S])!==!!E)throw Error(he+S+" not true or false: "+E);if(E){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw gn=!E,Error(he+"crypto unavailable");gn=E}else gn=E}if(w.hasOwnProperty(S="MODULO_MODE")&&(et(E=w[S],0,9,S),Ta=E),w.hasOwnProperty(S="POW_PRECISION")&&(et(E=w[S],0,ke,S),kn=E),w.hasOwnProperty(S="FORMAT")){if(typeof(E=w[S])!="object")throw Error(he+S+" not an object: "+E);As=E}if(w.hasOwnProperty(S="ALPHABET")){if(typeof(E=w[S])!="string"||/^.?$|[+\-.\s]|(.).*\1/.test(E))throw Error(he+S+" invalid: "+E);Ms=E.slice(0,10)=="0123456789",wi=E}}return{DECIMAL_PLACES:Tr,ROUNDING_MODE:rr,EXPONENTIAL_AT:[zr,vn],RANGE:[Rn,Fr],CRYPTO:gn,MODULO_MODE:Ta,POW_PRECISION:kn,FORMAT:As,ALPHABET:wi}},y.isBigNumber=function(w){if(!w||w._isBigNumber!==!0)return!1;if(!y.DEBUG)return!0;var S,E,N=w.c,k=w.e,j=w.s;e:if({}.toString.call(N)=="[object Array]"){if((j===1||j===-1)&&k>=-ke&&k<=ke&&k===ae(k)){if(N[0]===0){if(k===0&&N.length===1)return!0;break e}if((S=(k+1)%ce)<1&&(S+=ce),String(N[0]).length==S){for(S=0;S<N.length;S++)if((E=N[S])<0||E>=be||E!==ae(E))break e;if(E!==0)return!0}}}else if(N===null&&k===null&&(j===null||j===1||j===-1))return!0;throw Error(he+"Invalid BigNumber: "+w)},y.maximum=y.max=function(){return M(arguments,-1)},y.minimum=y.min=function(){return M(arguments,1)},y.random=(ot=9007199254740992,ht=Math.random()*ot&2097151?function(){return ae(Math.random()*ot)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(w){var S,E,N,k,j,G=0,X=[],K=new y(Er);if(w==null?w=Tr:et(w,0,ke),k=q(w/ce),gn)if(crypto.getRandomValues){for(S=crypto.getRandomValues(new Uint32Array(k*=2));G<k;)(j=131072*S[G]+(S[G+1]>>>11))>=9e15?(E=crypto.getRandomValues(new Uint32Array(2)),S[G]=E[0],S[G+1]=E[1]):(X.push(j%1e14),G+=2);G=k/2}else{if(!crypto.randomBytes)throw gn=!1,Error(he+"crypto unavailable");for(S=crypto.randomBytes(k*=7);G<k;)(j=281474976710656*(31&S[G])+1099511627776*S[G+1]+4294967296*S[G+2]+16777216*S[G+3]+(S[G+4]<<16)+(S[G+5]<<8)+S[G+6])>=9e15?crypto.randomBytes(7).copy(S,G):(X.push(j%1e14),G+=7);G=k/7}if(!gn)for(;G<k;)(j=ht())<9e15&&(X[G++]=j%1e14);for(k=X[--G],w%=ce,k&&w&&(j=Me[ce-w],X[G]=ae(k/j)*j);X[G]===0;X.pop(),G--);if(G<0)X=[N=0];else{for(N=-1;X[0]===0;X.splice(0,1),N-=ce);for(G=1,j=X[0];j>=10;j/=10,G++);G<ce&&(N-=ce-G)}return K.e=N,K.c=X,K}),y.sum=function(){for(var w=1,S=arguments,E=new y(S[0]);w<S.length;)E=E.plus(S[w++]);return E},tt=function(){var w="0123456789";function S(E,N,k,j){for(var G,X,K=[0],J=0,te=E.length;J<te;){for(X=K.length;X--;K[X]*=N);for(K[0]+=j.indexOf(E.charAt(J++)),G=0;G<K.length;G++)K[G]>k-1&&(K[G+1]==null&&(K[G+1]=0),K[G+1]+=K[G]/k|0,K[G]%=k)}return K.reverse()}return function(E,N,k,j,G){var X,K,J,te,xe,He,je,vt,Pt=E.indexOf("."),Bt=Tr,ct=rr;for(Pt>=0&&(te=kn,kn=0,E=E.replace(".",""),He=(vt=new y(N)).pow(E.length-Pt),kn=te,vt.c=S(tr(Oe(He.c),He.e,"0"),10,k,w),vt.e=vt.c.length),J=te=(je=S(E,N,k,G?(X=wi,w):(X=w,wi))).length;je[--te]==0;je.pop());if(!je[0])return X.charAt(0);if(Pt<0?--J:(He.c=je,He.e=J,He.s=j,je=(He=Xe(He,vt,Bt,ct,k)).c,xe=He.r,J=He.e),Pt=je[K=J+Bt+1],te=k/2,xe=xe||K<0||je[K+1]!=null,xe=ct<4?(Pt!=null||xe)&&(ct==0||ct==(He.s<0?3:2)):Pt>te||Pt==te&&(ct==4||xe||ct==6&&1&je[K-1]||ct==(He.s<0?8:7)),K<1||!je[0])E=xe?tr(X.charAt(1),-Bt,X.charAt(0)):X.charAt(0);else{if(je.length=K,xe)for(--k;++je[--K]>k;)je[K]=0,K||(++J,je=[1].concat(je));for(te=je.length;!je[--te];);for(Pt=0,E="";Pt<=te;E+=X.charAt(je[Pt++]));E=tr(E,J,X.charAt(0))}return E}}(),Xe=function(){function w(N,k,j){var G,X,K,J,te=0,xe=N.length,He=k%Fe,je=k/Fe|0;for(N=N.slice();xe--;)te=((X=He*(K=N[xe]%Fe)+(G=je*K+(J=N[xe]/Fe|0)*He)%Fe*Fe+te)/j|0)+(G/Fe|0)+je*J,N[xe]=X%j;return te&&(N=[te].concat(N)),N}function S(N,k,j,G){var X,K;if(j!=G)K=j>G?1:-1;else for(X=K=0;X<j;X++)if(N[X]!=k[X]){K=N[X]>k[X]?1:-1;break}return K}function E(N,k,j,G){for(var X=0;j--;)N[j]-=X,X=N[j]<k[j]?1:0,N[j]=X*G+N[j]-k[j];for(;!N[0]&&N.length>1;N.splice(0,1));}return function(N,k,j,G,X){var K,J,te,xe,He,je,vt,Pt,Bt,ct,Ct,Lt,Gl,Zc,Jc,qn,Ds,An=N.s==k.s?1:-1,rn=N.c,nr=k.c;if(!(rn&&rn[0]&&nr&&nr[0]))return new y(N.s&&k.s&&(rn?!nr||rn[0]!=nr[0]:nr)?rn&&rn[0]==0||!nr?0*An:An/0:NaN);for(Bt=(Pt=new y(An)).c=[],An=j+(J=N.e-k.e)+1,X||(X=be,J=de(N.e/ce)-de(k.e/ce),An=An/ce|0),te=0;nr[te]==(rn[te]||0);te++);if(nr[te]>(rn[te]||0)&&J--,An<0)Bt.push(1),xe=!0;else{for(Zc=rn.length,qn=nr.length,te=0,An+=2,(He=ae(X/(nr[0]+1)))>1&&(nr=w(nr,He,X),rn=w(rn,He,X),qn=nr.length,Zc=rn.length),Gl=qn,Ct=(ct=rn.slice(0,qn)).length;Ct<qn;ct[Ct++]=0);Ds=nr.slice(),Ds=[0].concat(Ds),Jc=nr[0],nr[1]>=X/2&&Jc++;do{if(He=0,(K=S(nr,ct,qn,Ct))<0){if(Lt=ct[0],qn!=Ct&&(Lt=Lt*X+(ct[1]||0)),(He=ae(Lt/Jc))>1)for(He>=X&&(He=X-1),vt=(je=w(nr,He,X)).length,Ct=ct.length;S(je,ct,vt,Ct)==1;)He--,E(je,qn<vt?Ds:nr,vt,X),vt=je.length,K=1;else He==0&&(K=He=1),vt=(je=nr.slice()).length;if(vt<Ct&&(je=[0].concat(je)),E(ct,je,Ct,X),Ct=ct.length,K==-1)for(;S(nr,ct,qn,Ct)<1;)He++,E(ct,qn<Ct?Ds:nr,Ct,X),Ct=ct.length}else K===0&&(He++,ct=[0]);Bt[te++]=He,ct[0]?ct[Ct++]=rn[Gl]||0:(ct=[rn[Gl]],Ct=1)}while((Gl++<Zc||ct[0]!=null)&&An--);xe=ct[0]!=null,Bt[0]||Bt.splice(0,1)}if(X==be){for(te=1,An=Bt[0];An>=10;An/=10,te++);I(Pt,j+(Pt.e=te+J*ce-1)+1,G,xe)}else Pt.e=J,Pt.r=+xe;return Pt}}(),it=/^(-?)0([xbo])(?=\w[\w.]*$)/i,wt=/^([^.]+)\.$/,qt=/^\.([^.]+)$/,xr=/^-?(Infinity|NaN)$/,Ht=/^\s*\+(?=[\w.])|^\s+|\s+$/g,Qe=function(w,S,E,N){var k,j=E?S:S.replace(Ht,"");if(xr.test(j))w.s=isNaN(j)?null:j<0?-1:1;else{if(!E&&(j=j.replace(it,function(G,X,K){return k=(K=K.toLowerCase())=="x"?16:K=="b"?2:8,N&&N!=k?G:X}),N&&(k=N,j=j.replace(wt,"$1").replace(qt,"0.$1")),S!=j))return new y(j,k);if(y.DEBUG)throw Error(he+"Not a"+(N?" base "+N:"")+" number: "+S);w.s=null}w.c=w.e=null},Ne.absoluteValue=Ne.abs=function(){var w=new y(this);return w.s<0&&(w.s=1),w},Ne.comparedTo=function(w,S){return we(this,new y(w,S))},Ne.decimalPlaces=Ne.dp=function(w,S){var E,N,k,j=this;if(w!=null)return et(w,0,ke),S==null?S=rr:et(S,0,8),I(new y(j),w+j.e+1,S);if(!(E=j.c))return null;if(N=((k=E.length-1)-de(this.e/ce))*ce,k=E[k])for(;k%10==0;k/=10,N--);return N<0&&(N=0),N},Ne.dividedBy=Ne.div=function(w,S){return Xe(this,new y(w,S),Tr,rr)},Ne.dividedToIntegerBy=Ne.idiv=function(w,S){return Xe(this,new y(w,S),0,1)},Ne.exponentiatedBy=Ne.pow=function(w,S){var E,N,k,j,G,X,K,J,te=this;if((w=new y(w)).c&&!w.isInteger())throw Error(he+"Exponent not an integer: "+z(w));if(S!=null&&(S=new y(S)),G=w.e>14,!te.c||!te.c[0]||te.c[0]==1&&!te.e&&te.c.length==1||!w.c||!w.c[0])return J=new y(Math.pow(+z(te),G?w.s*(2-ut(w)):+z(w))),S?J.mod(S):J;if(X=w.s<0,S){if(S.c?!S.c[0]:!S.s)return new y(NaN);(N=!X&&te.isInteger()&&S.isInteger())&&(te=te.mod(S))}else{if(w.e>9&&(te.e>0||te.e<-1||(te.e==0?te.c[0]>1||G&&te.c[1]>=24e7:te.c[0]<8e13||G&&te.c[0]<=9999975e7)))return j=te.s<0&&ut(w)?-0:0,te.e>-1&&(j=1/j),new y(X?1/j:j);kn&&(j=q(kn/ce+2))}for(G?(E=new y(.5),X&&(w.s=1),K=ut(w)):K=(k=Math.abs(+z(w)))%2,J=new y(Er);;){if(K){if(!(J=J.times(te)).c)break;j?J.c.length>j&&(J.c.length=j):N&&(J=J.mod(S))}if(k){if((k=ae(k/2))===0)break;K=k%2}else if(I(w=w.times(E),w.e+1,1),w.e>14)K=ut(w);else{if((k=+z(w))==0)break;K=k%2}te=te.times(te),j?te.c&&te.c.length>j&&(te.c.length=j):N&&(te=te.mod(S))}return N?J:(X&&(J=Er.div(J)),S?J.mod(S):j?I(J,kn,rr,void 0):J)},Ne.integerValue=function(w){var S=new y(this);return w==null?w=rr:et(w,0,8),I(S,S.e+1,w)},Ne.isEqualTo=Ne.eq=function(w,S){return we(this,new y(w,S))===0},Ne.isFinite=function(){return!!this.c},Ne.isGreaterThan=Ne.gt=function(w,S){return we(this,new y(w,S))>0},Ne.isGreaterThanOrEqualTo=Ne.gte=function(w,S){return(S=we(this,new y(w,S)))===1||S===0},Ne.isInteger=function(){return!!this.c&&de(this.e/ce)>this.c.length-2},Ne.isLessThan=Ne.lt=function(w,S){return we(this,new y(w,S))<0},Ne.isLessThanOrEqualTo=Ne.lte=function(w,S){return(S=we(this,new y(w,S)))===-1||S===0},Ne.isNaN=function(){return!this.s},Ne.isNegative=function(){return this.s<0},Ne.isPositive=function(){return this.s>0},Ne.isZero=function(){return!!this.c&&this.c[0]==0},Ne.minus=function(w,S){var E,N,k,j,G=this,X=G.s;if(S=(w=new y(w,S)).s,!X||!S)return new y(NaN);if(X!=S)return w.s=-S,G.plus(w);var K=G.e/ce,J=w.e/ce,te=G.c,xe=w.c;if(!K||!J){if(!te||!xe)return te?(w.s=-S,w):new y(xe?G:NaN);if(!te[0]||!xe[0])return xe[0]?(w.s=-S,w):new y(te[0]?G:rr==3?-0:0)}if(K=de(K),J=de(J),te=te.slice(),X=K-J){for((j=X<0)?(X=-X,k=te):(J=K,k=xe),k.reverse(),S=X;S--;k.push(0));k.reverse()}else for(N=(j=(X=te.length)<(S=xe.length))?X:S,X=S=0;S<N;S++)if(te[S]!=xe[S]){j=te[S]<xe[S];break}if(j&&(k=te,te=xe,xe=k,w.s=-w.s),(S=(N=xe.length)-(E=te.length))>0)for(;S--;te[E++]=0);for(S=be-1;N>X;){if(te[--N]<xe[N]){for(E=N;E&&!te[--E];te[E]=S);--te[E],te[N]+=be}te[N]-=xe[N]}for(;te[0]==0;te.splice(0,1),--J);return te[0]?L(w,te,J):(w.s=rr==3?-1:1,w.c=[w.e=0],w)},Ne.modulo=Ne.mod=function(w,S){var E,N,k=this;return w=new y(w,S),!k.c||!w.s||w.c&&!w.c[0]?new y(NaN):!w.c||k.c&&!k.c[0]?new y(k):(Ta==9?(N=w.s,w.s=1,E=Xe(k,w,0,3),w.s=N,E.s*=N):E=Xe(k,w,0,Ta),(w=k.minus(E.times(w))).c[0]||Ta!=1||(w.s=k.s),w)},Ne.multipliedBy=Ne.times=function(w,S){var E,N,k,j,G,X,K,J,te,xe,He,je,vt,Pt,Bt,ct=this,Ct=ct.c,Lt=(w=new y(w,S)).c;if(!(Ct&&Lt&&Ct[0]&&Lt[0]))return!ct.s||!w.s||Ct&&!Ct[0]&&!Lt||Lt&&!Lt[0]&&!Ct?w.c=w.e=w.s=null:(w.s*=ct.s,Ct&&Lt?(w.c=[0],w.e=0):w.c=w.e=null),w;for(N=de(ct.e/ce)+de(w.e/ce),w.s*=ct.s,(K=Ct.length)<(xe=Lt.length)&&(vt=Ct,Ct=Lt,Lt=vt,k=K,K=xe,xe=k),k=K+xe,vt=[];k--;vt.push(0));for(Pt=be,Bt=Fe,k=xe;--k>=0;){for(E=0,He=Lt[k]%Bt,je=Lt[k]/Bt|0,j=k+(G=K);j>k;)E=((J=He*(J=Ct[--G]%Bt)+(X=je*J+(te=Ct[G]/Bt|0)*He)%Bt*Bt+vt[j]+E)/Pt|0)+(X/Bt|0)+je*te,vt[j--]=J%Pt;vt[j]=E}return E?++N:vt.splice(0,1),L(w,vt,N)},Ne.negated=function(){var w=new y(this);return w.s=-w.s||null,w},Ne.plus=function(w,S){var E,N=this,k=N.s;if(S=(w=new y(w,S)).s,!k||!S)return new y(NaN);if(k!=S)return w.s=-S,N.minus(w);var j=N.e/ce,G=w.e/ce,X=N.c,K=w.c;if(!j||!G){if(!X||!K)return new y(k/0);if(!X[0]||!K[0])return K[0]?w:new y(X[0]?N:0*k)}if(j=de(j),G=de(G),X=X.slice(),k=j-G){for(k>0?(G=j,E=K):(k=-k,E=X),E.reverse();k--;E.push(0));E.reverse()}for((k=X.length)-(S=K.length)<0&&(E=K,K=X,X=E,S=k),k=0;S;)k=(X[--S]=X[S]+K[S]+k)/be|0,X[S]=be===X[S]?0:X[S]%be;return k&&(X=[k].concat(X),++G),L(w,X,G)},Ne.precision=Ne.sd=function(w,S){var E,N,k,j=this;if(w!=null&&w!==!!w)return et(w,1,ke),S==null?S=rr:et(S,0,8),I(new y(j),w,S);if(!(E=j.c))return null;if(N=(k=E.length-1)*ce+1,k=E[k]){for(;k%10==0;k/=10,N--);for(k=E[0];k>=10;k/=10,N++);}return w&&j.e+1>N&&(N=j.e+1),N},Ne.shiftedBy=function(w){return et(w,-9007199254740991,Ce),this.times("1e"+w)},Ne.squareRoot=Ne.sqrt=function(){var w,S,E,N,k,j=this,G=j.c,X=j.s,K=j.e,J=Tr+4,te=new y("0.5");if(X!==1||!G||!G[0])return new y(!X||X<0&&(!G||G[0])?NaN:G?j:1/0);if((X=Math.sqrt(+z(j)))==0||X==1/0?(((S=Oe(G)).length+K)%2==0&&(S+="0"),X=Math.sqrt(+S),K=de((K+1)/2)-(K<0||K%2),E=new y(S=X==1/0?"5e"+K:(S=X.toExponential()).slice(0,S.indexOf("e")+1)+K)):E=new y(X+""),E.c[0]){for((X=(K=E.e)+J)<3&&(X=0);;)if(k=E,E=te.times(k.plus(Xe(j,k,J,1))),Oe(k.c).slice(0,X)===(S=Oe(E.c)).slice(0,X)){if(E.e<K&&--X,(S=S.slice(X-3,X+1))!="9999"&&(N||S!="4999")){+S&&(+S.slice(1)||S.charAt(0)!="5")||(I(E,E.e+Tr+2,1),w=!E.times(E).eq(j));break}if(!N&&(I(k,k.e+Tr+2,0),k.times(k).eq(j))){E=k;break}J+=4,X+=4,N=1}}return I(E,E.e+Tr+1,rr,w)},Ne.toExponential=function(w,S){return w!=null&&(et(w,0,ke),w++),V(this,w,S,1)},Ne.toFixed=function(w,S){return w!=null&&(et(w,0,ke),w=w+this.e+1),V(this,w,S)},Ne.toFormat=function(w,S,E){var N,k=this;if(E==null)w!=null&&S&&typeof S=="object"?(E=S,S=null):w&&typeof w=="object"?(E=w,w=S=null):E=As;else if(typeof E!="object")throw Error(he+"Argument not an object: "+E);if(N=k.toFixed(w,S),k.c){var j,G=N.split("."),X=+E.groupSize,K=+E.secondaryGroupSize,J=E.groupSeparator||"",te=G[0],xe=G[1],He=k.s<0,je=He?te.slice(1):te,vt=je.length;if(K&&(j=X,X=K,K=j,vt-=j),X>0&&vt>0){for(j=vt%X||X,te=je.substr(0,j);j<vt;j+=X)te+=J+je.substr(j,X);K>0&&(te+=J+je.slice(j)),He&&(te="-"+te)}N=xe?te+(E.decimalSeparator||"")+((K=+E.fractionGroupSize)?xe.replace(new RegExp("\\d{"+K+"}\\B","g"),"$&"+(E.fractionGroupSeparator||"")):xe):te}return(E.prefix||"")+N+(E.suffix||"")},Ne.toFraction=function(w){var S,E,N,k,j,G,X,K,J,te,xe,He,je=this,vt=je.c;if(w!=null&&(!(X=new y(w)).isInteger()&&(X.c||X.s!==1)||X.lt(Er)))throw Error(he+"Argument "+(X.isInteger()?"out of range: ":"not an integer: ")+z(X));if(!vt)return new y(je);for(S=new y(Er),J=E=new y(Er),N=K=new y(Er),He=Oe(vt),j=S.e=He.length-je.e-1,S.c[0]=Me[(G=j%ce)<0?ce+G:G],w=!w||X.comparedTo(S)>0?j>0?S:J:X,G=Fr,Fr=1/0,X=new y(He),K.c[0]=0;te=Xe(X,S,0,1),(k=E.plus(te.times(N))).comparedTo(w)!=1;)E=N,N=k,J=K.plus(te.times(k=J)),K=k,S=X.minus(te.times(k=S)),X=k;return k=Xe(w.minus(E),N,0,1),K=K.plus(k.times(J)),E=E.plus(k.times(N)),K.s=J.s=je.s,xe=Xe(J,N,j*=2,rr).minus(je).abs().comparedTo(Xe(K,E,j,rr).minus(je).abs())<1?[J,N]:[K,E],Fr=G,xe},Ne.toNumber=function(){return+z(this)},Ne.toPrecision=function(w,S){return w!=null&&et(w,1,ke),V(this,w,S,2)},Ne.toString=function(w){var S,E=this,N=E.s,k=E.e;return k===null?N?(S="Infinity",N<0&&(S="-"+S)):S="NaN":(w==null?S=k<=zr||k>=vn?nt(Oe(E.c),k):tr(Oe(E.c),k,"0"):w===10&&Ms?S=tr(Oe((E=I(new y(E),Tr+k+1,rr)).c),E.e,"0"):(et(w,2,wi.length,"Base"),S=tt(tr(Oe(E.c),k,"0"),10,w,N,!0)),N<0&&E.c[0]&&(S="-"+S)),S},Ne.valueOf=Ne.toJSON=function(){return z(this)},Ne._isBigNumber=!0,Ie!=null&&y.set(Ie),y}(),T.default=T.BigNumber=T,H.exports?H.exports=T:(O||(O=typeof self<"u"&&self?self:window),O.BigNumber=T)})(t)})(p);var C=p.exports;/*!
	 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
	 *
	 * Permission is hereby granted, free of charge, to any person obtaining a copy
	 * of this software and associated documentation files (the "Software"), to deal
	 * in the Software without restriction, including without limitation the rights
	 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
	 * copies of the Software, and to permit persons to whom the Software is
	 * furnished to do so, subject to the following conditions:
	 *
	 * The above copyright notice and this permission notice shall be included in
	 * all copies or substantial portions of the Software.
	 *
	 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
	 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
	 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
	 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
	 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
	 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
	 * SOFTWARE.
	 */const F=g(),D=f(),ee=d,ue=C,se={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},U={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:re,decimalSuffixes:m}=F.currentBytes(),_={general:{scale:1024,suffixes:m,marker:"bd"},binary:{scale:1024,suffixes:re,marker:"b"},decimal:{scale:1e3,suffixes:m,marker:"d"}};function x(H,O={},T){if(typeof O=="string"&&(O=ee.parseFormat(O)),!D.validateFormat(O))return"ERROR: invalid format";let Y=O.prefix||"",q=O.postfix||"",ae=function(he,oe,be){switch(oe.output){case"currency":return function(ce,Ce,Me){const Fe=Me.currentCurrency();let ke,de=Object.assign({},Ce),Oe=Object.assign({},U,de),we="",et=!!Oe.totalLength||!!Oe.forceAverage||Oe.average,ut=de.currencyPosition||Fe.position,nt=de.currencySymbol||Fe.symbol;const tr=Oe.spaceSeparatedCurrency!==void 0?Oe.spaceSeparatedCurrency:Oe.spaceSeparated;de.lowPrecision===void 0&&(de.lowPrecision=!1),tr&&(we=" "),ut==="infix"&&(ke=we+nt+we);let Ve=W({instance:ce,providedFormat:de,state:Me,decimalSeparator:ke});return ut==="prefix"&&(Ve=ce._value<0&&Oe.negative==="sign"?`-${we}${nt}${Ve.slice(1)}`:ce._value>0&&Oe.forceSign?`+${we}${nt}${Ve.slice(1)}`:nt+we+Ve),ut&&ut!=="postfix"||(we=!Oe.spaceSeparatedAbbreviation&&et?"":we,Ve=Ve+we+nt),Ve}(he,oe=ne(oe,F.currentCurrencyDefaultFormat()),F);case"percent":return function(ce,Ce,Me,Fe){let ke=Ce.prefixSymbol,de=W({instance:Fe(100*ce._value),providedFormat:Ce,state:Me}),Oe=Object.assign({},U,Ce);return ke?`%${Oe.spaceSeparated?" ":""}${de}`:`${de}${Oe.spaceSeparated?" ":""}%`}(he,oe=ne(oe,F.currentPercentageDefaultFormat()),F,be);case"byte":return function(ce,Ce,Me,Fe){let ke=Ce.base||"binary",de=Object.assign({},U,Ce);const{binarySuffixes:Oe,decimalSuffixes:we}=Me.currentBytes();let et={general:{scale:1024,suffixes:we||m,marker:"bd"},binary:{scale:1024,suffixes:Oe||re,marker:"b"},decimal:{scale:1e3,suffixes:we||m,marker:"d"}}[ke],{value:ut,suffix:nt}=B(ce._value,et.suffixes,et.scale);return`${W({instance:Fe(ut),providedFormat:Ce,state:Me,defaults:Me.currentByteDefaultFormat()})}${de.spaceSeparated?" ":""}${nt}`}(he,oe=ne(oe,F.currentByteDefaultFormat()),F,be);case"time":return oe=ne(oe,F.currentTimeDefaultFormat()),function(ce){let Ce=Math.floor(ce._value/60/60),Me=Math.floor((ce._value-60*Ce*60)/60),Fe=Math.round(ce._value-60*Ce*60-60*Me);return`${Ce}:${Me<10?"0":""}${Me}:${Fe<10?"0":""}${Fe}`}(he);case"ordinal":return function(ce,Ce,Me){let Fe=Me.currentOrdinal(),ke=Object.assign({},U,Ce),de=W({instance:ce,providedFormat:Ce,state:Me}),Oe=Fe(ce._value);return`${de}${ke.spaceSeparated?" ":""}${Oe}`}(he,oe=ne(oe,F.currentOrdinalDefaultFormat()),F);default:return W({instance:he,providedFormat:oe,numbro:be})}}(H,O,T);return ae=function(he,oe){return oe+he}(ae,Y),ae=function(he,oe){return he+oe}(ae,q),ae}function B(H,O,T){let Y=O[0],q=Math.abs(H);if(q>=T){for(let ae=1;ae<O.length;++ae){let he=Math.pow(T,ae),oe=Math.pow(T,ae+1);if(q>=he&&q<oe){Y=O[ae],H/=he;break}}Y===O[0]&&(H/=Math.pow(T,O.length-1),Y=O[O.length-1])}return{value:H,suffix:Y}}function Q(H){let O="";for(let T=0;T<H;T++)O+="0";return O}function A(H,O,T=Math.round){return H.toString().indexOf("e")!==-1?function(Y,q){let ae=Y.toString(),[he,oe]=ae.split("e"),[be,ce=""]=he.split(".");if(+oe>0)ae=be+ce+Q(oe-ce.length);else{let Ce=".";Ce=+be<0?`-0${Ce}`:`0${Ce}`;let Me=(Q(-oe-1)+Math.abs(be)+ce).substr(0,q);Me.length<q&&(Me+=Q(q-Me.length)),ae=Ce+Me}return+oe>0&&q>0&&(ae+=`.${Q(q)}`),ae}(H,O):new ue(T(+`${H}e+${O}`)/Math.pow(10,O)).toFixed(O)}function W({instance:H,providedFormat:O,state:T=F,decimalSeparator:Y,defaults:q=T.currentDefaults()}){let ae=H._value;if(ae===0&&T.hasZeroFormat())return T.getZeroFormat();if(!isFinite(ae))return ae.toString();let he=Object.assign({},U,q,O),oe=he.totalLength,be=oe?0:he.characteristic,ce=he.optionalCharacteristic,Ce=he.forceAverage,Me=he.lowPrecision,Fe=!!oe||!!Ce||he.average,ke=oe?-1:Fe&&O.mantissa===void 0?0:he.mantissa,de=!oe&&(O.optionalMantissa===void 0?ke===-1:he.optionalMantissa),Oe=he.trimMantissa,we=he.thousandSeparated,et=he.spaceSeparated,ut=he.negative,nt=he.forceSign,tr=he.exponential,Ve=he.roundingFunction,Ie="";if(Fe){let tt=function({value:Qe,forceAverage:ot,lowPrecision:ht=!0,abbreviations:it,spaceSeparated:wt=!1,totalLength:qt=0,roundingFunction:xr=Math.round}){let Ht="",Ne=Math.abs(Qe),Er=-1;if(ot&&it[ot]&&se[ot]?(Ht=it[ot],Qe/=se[ot]):Ne>=se.trillion||ht&&xr(Ne/se.trillion)===1?(Ht=it.trillion,Qe/=se.trillion):Ne<se.trillion&&Ne>=se.billion||ht&&xr(Ne/se.billion)===1?(Ht=it.billion,Qe/=se.billion):Ne<se.billion&&Ne>=se.million||ht&&xr(Ne/se.million)===1?(Ht=it.million,Qe/=se.million):(Ne<se.million&&Ne>=se.thousand||ht&&xr(Ne/se.thousand)===1)&&(Ht=it.thousand,Qe/=se.thousand),Ht&&(Ht=(wt?" ":"")+Ht),qt){let Tr=Qe<0,rr=Qe.toString().split(".")[0],zr=Tr?rr.length-1:rr.length;Er=Math.max(qt-zr,0)}return{value:Qe,abbreviation:Ht,mantissaPrecision:Er}}({value:ae,forceAverage:Ce,lowPrecision:Me,abbreviations:T.currentAbbreviations(),spaceSeparated:et,roundingFunction:Ve,totalLength:oe});ae=tt.value,Ie+=tt.abbreviation,oe&&(ke=tt.mantissaPrecision)}if(tr){let tt=function({value:Qe,characteristicPrecision:ot}){let[ht,it]=Qe.toExponential().split("e"),wt=+ht;return ot?(1<ot&&(wt*=Math.pow(10,ot-1),it=+it-(ot-1),it=it>=0?`+${it}`:it),{value:wt,abbreviation:`e${it}`}):{value:wt,abbreviation:`e${it}`}}({value:ae,characteristicPrecision:be});ae=tt.value,Ie=tt.abbreviation+Ie}let Xe=function(tt,Qe,ot,ht,it,wt){if(ht===-1)return tt;let qt=A(Qe,ht,wt),[xr,Ht=""]=qt.toString().split(".");if(Ht.match(/^0+$/)&&(ot||it))return xr;let Ne=Ht.match(/0+$/);return it&&Ne?`${xr}.${Ht.toString().slice(0,Ne.index)}`:qt.toString()}(ae.toString(),ae,de,ke,Oe,Ve);return Xe=function(tt,Qe,ot,ht){let it=tt,[wt,qt]=it.toString().split(".");if(wt.match(/^-?0$/)&&ot)return qt?`${wt.replace("0","")}.${qt}`:wt.replace("0","");const xr=Qe<0&&wt.indexOf("-")===0;if(xr&&(wt=wt.slice(1),it=it.slice(1)),wt.length<ht){let Ht=ht-wt.length;for(let Ne=0;Ne<Ht;Ne++)it=`0${it}`}return xr&&(it=`-${it}`),it.toString()}(Xe,ae,ce,be),Xe=function(tt,Qe,ot,ht,it){let wt=ht.currentDelimiters(),qt=wt.thousands;it=it||wt.decimal;let xr=wt.thousandsSize||3,Ht=tt.toString(),Ne=Ht.split(".")[0],Er=Ht.split(".")[1];const Tr=Qe<0&&Ne.indexOf("-")===0;return ot&&(Tr&&(Ne=Ne.slice(1)),function(zr,vn){let Rn=[],Fr=0;for(let gn=zr;gn>0;gn--)Fr===vn&&(Rn.unshift(gn),Fr=0),Fr++;return Rn}(Ne.length,xr).forEach((zr,vn)=>{Ne=Ne.slice(0,zr+vn)+qt+Ne.slice(zr+vn)}),Tr&&(Ne=`-${Ne}`)),Ht=Er?Ne+it+Er:Ne,Ht}(Xe,ae,we,T,Y),(Fe||tr)&&(Xe=function(tt,Qe){return tt+Qe}(Xe,Ie)),(nt||ae<0)&&(Xe=function(tt,Qe,ot){return Qe===0?tt:+tt==0?tt.replace("-",""):Qe>0?`+${tt}`:ot==="sign"?tt:`(${tt.replace("-","")})`}(Xe,ae,ut)),Xe}function ne(H,O){if(!H)return O;let T=Object.keys(H);return T.length===1&&T[0]==="output"?O:H}/*!
	 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
	 *
	 * Permission is hereby granted, free of charge, to any person obtaining a copy
	 * of this software and associated documentation files (the "Software"), to deal
	 * in the Software without restriction, including without limitation the rights
	 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
	 * copies of the Software, and to permit persons to whom the Software is
	 * furnished to do so, subject to the following conditions:
	 *
	 * The above copyright notice and this permission notice shall be included in
	 * all copies or substantial portions of the Software.
	 *
	 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
	 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
	 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
	 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
	 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
	 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
	 * SOFTWARE.
	 */const b=C;function R(H,O,T){let Y=new b(H._value),q=O;return T.isNumbro(O)&&(q=O._value),q=new b(q),H._value=Y.minus(q).toNumber(),H}/*!
	 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
	 *
	 * Permission is hereby granted, free of charge, to any person obtaining a copy
	 * of this software and associated documentation files (the "Software"), to deal
	 * in the Software without restriction, including without limitation the rights
	 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
	 * copies of the Software, and to permit persons to whom the Software is
	 * furnished to do so, subject to the following conditions:
	 *
	 * The above copyright notice and this permission notice shall be included in
	 * all copies or substantial portions of the Software.
	 *
	 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
	 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
	 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
	 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
	 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
	 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
	 * SOFTWARE.
	 */const Z=g(),ie=f(),ve=(H=>({loadLanguagesInNode:O=>v(O,H)}))(P),le=u();let ge=(H=>({format:(...O)=>x(...O,H),getByteUnit:(...O)=>function(T){let Y=_.general;return B(T._value,Y.suffixes,Y.scale).suffix}(...O,H),getBinaryByteUnit:(...O)=>function(T){let Y=_.binary;return B(T._value,Y.suffixes,Y.scale).suffix}(...O,H),getDecimalByteUnit:(...O)=>function(T){let Y=_.decimal;return B(T._value,Y.suffixes,Y.scale).suffix}(...O,H),formatOrDefault:ne}))(P),Se=(H=>({add:(O,T)=>function(Y,q,ae){let he=new b(Y._value),oe=q;return ae.isNumbro(q)&&(oe=q._value),oe=new b(oe),Y._value=he.plus(oe).toNumber(),Y}(O,T,H),subtract:(O,T)=>R(O,T,H),multiply:(O,T)=>function(Y,q,ae){let he=new b(Y._value),oe=q;return ae.isNumbro(q)&&(oe=q._value),oe=new b(oe),Y._value=he.times(oe).toNumber(),Y}(O,T,H),divide:(O,T)=>function(Y,q,ae){let he=new b(Y._value),oe=q;return ae.isNumbro(q)&&(oe=q._value),oe=new b(oe),Y._value=he.dividedBy(oe).toNumber(),Y}(O,T,H),set:(O,T)=>function(Y,q,ae){let he=q;return ae.isNumbro(q)&&(he=q._value),Y._value=he,Y}(O,T,H),difference:(O,T)=>function(Y,q,ae){let he=ae(Y._value);return R(he,q,ae),Math.abs(he._value)}(O,T,H),BigNumber:b}))(P);const Ee=d;class Re{constructor(O){this._value=O}clone(){return P(this._value)}format(O={}){return ge.format(this,O)}formatCurrency(O){return typeof O=="string"&&(O=Ee.parseFormat(O)),(O=ge.formatOrDefault(O,Z.currentCurrencyDefaultFormat())).output="currency",ge.format(this,O)}formatTime(O={}){return O.output="time",ge.format(this,O)}binaryByteUnits(){return ge.getBinaryByteUnit(this)}decimalByteUnits(){return ge.getDecimalByteUnit(this)}byteUnits(){return ge.getByteUnit(this)}difference(O){return Se.difference(this,O)}add(O){return Se.add(this,O)}subtract(O){return Se.subtract(this,O)}multiply(O){return Se.multiply(this,O)}divide(O){return Se.divide(this,O)}set(O){return Se.set(this,ze(O))}value(){return this._value}valueOf(){return this._value}}function ze(H){let O=H;return P.isNumbro(H)?O=H._value:typeof H=="string"?O=P.unformat(H):isNaN(H)&&(O=NaN),O}function P(H){return new Re(ze(H))}return P.version="2.4.0",P.isNumbro=function(H){return H instanceof Re},P.language=Z.currentLanguage,P.registerLanguage=Z.registerLanguage,P.setLanguage=Z.setLanguage,P.languages=Z.languages,P.languageData=Z.languageData,P.zeroFormat=Z.setZeroFormat,P.defaultFormat=Z.currentDefaults,P.setDefaults=Z.setDefaults,P.defaultCurrencyFormat=Z.currentCurrencyDefaultFormat,P.validate=ie.validate,P.loadLanguagesInNode=ve.loadLanguagesInNode,P.unformat=le.unformat,P.BigNumber=Se.BigNumber,n(P)})})($1);var B2=$1.exports;const ka=Ll(B2);function W2(e,r,t,n,i,a,o){var s=a;if(bi(s)){var l=o.numericFormat,u=l&&l.culture||"-",f=l&&l.pattern,c=o.className||"",h=c.length?c.split(" "):[];if(typeof u<"u"&&!ka.languages()[u]){var d=u.replace("-",""),g=ka.allLanguages?ka.allLanguages[u]:ka[d];g&&ka.registerLanguage(g)}ka.setLanguage(u),s=ka(s).format(f||"0"),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),o.className=h.join(" ")}Dr("text")(e,r,t,n,i,s,o)}function $2(e,r,t,n,i,a,o){for(var s=arguments.length,l=new Array(s>7?s-7:0),u=7;u<s;u++)l[u-7]=arguments[u];Dr("text").apply(this,[e,r,t,n,i,a,o].concat(l));var f=o.hashLength||r.innerHTML.length,c=o.hashSymbol||"*",h="";Ke(f-1,function(){h+=c}),ms(r,h)}function U2(e,r,t,n,i,a,o){for(var s=arguments.length,l=new Array(s>7?s-7:0),u=7;u<s;u++)l[u-7]=arguments[u];Dr("base").apply(this,[e,r,t,n,i,a,o].concat(l));var f=a;if(!f&&o.placeholder&&(f=o.placeholder),f=ba(f),e.getSettings().trimWhitespace||(f=f.replace(/ /g," ")),o.rendererTemplate){Gn(r);var c=document.createElement("TEMPLATE");c.setAttribute("bind","{{}}"),c.innerHTML=o.rendererTemplate,HTMLTemplateElement.decorate(c),c.model=e.getSourceDataAtRow(t),r.appendChild(c)}else ps(r,f)}var uc=Bi("renderers"),$i=uc.register,V2=uc.getItem,z2=uc.hasItem,j2=uc.getNames;$i("base",O2);$i("autocomplete",k2);$i("checkbox",M2);$i("html",H2);$i("numeric",W2);$i("password",$2);$i("text",U2);function Dr(e){if(typeof e=="function")return e;if(!z2(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return V2(e)}function Y2(e,r){var t=e;if(t==null&&(t=""),this.allowEmpty&&t===""){r(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(t,ym(t,r)):ym(t,r)(this.source):r(!0)}function ym(e,r){var t=e;return function(n){for(var i=!1,a=0,o=n.length;a<o;a++)if(t===n[a]){i=!0;break}r(i)}}function U1(e){var r=new Date(e);return isNaN(new Date("".concat(e,"T00:00")).getDate())?r:new Date(r.getTime()+r.getTimezoneOffset()*6e4)}const G2=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:U1},Symbol.toStringTag,{value:"Module"}));function X2(e,r){var t=W1("date",this.instance),n=e,i=!0;n==null&&(n="");var a=Pe(new Date(n)).isValid()||Pe(n,this.dateFormat||t.defaultDateFormat,!0).isValid(),o=Pe(n,this.dateFormat||t.defaultDateFormat,!0).isValid();if(this.allowEmpty&&n===""&&(a=!0,o=!0),a||(i=!1),!a&&o&&(i=!0),a&&!o)if(this.correctFormat===!0){var s=K2(n,this.dateFormat),l=this.instance.runHooks("unmodifyRow",this.row),u=this.instance.runHooks("unmodifyCol",this.col);this.instance.setDataAtCell(l,u,s,"dateValidator"),i=!0}else i=!1;r(i)}function K2(e,r){var t=Pe(U1(e)),n=Pe(e,r),i=e.search(/[A-z]/g)>-1,a;return t.isValid()&&t.format("x")===n.format("x")||!n.isValid()||i?a=t:a=n,a.format(r)}function q2(e,r){var t=e;t==null&&(t=""),this.allowEmpty&&t===""?r(!0):r(t===""?!1:bi(e))}var Z2=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];function J2(e,r){var t=this.timeFormat||"h:mm:ss a",n=!0,i=e;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;var a=/^\d{1,2}$/.test(i);a&&(i+=":00");var o=Pe(i,Z2,!0).isValid()?Pe(i):Pe(i,t),s=o.isValid(),l=Pe(i,t,!0).isValid()&&!a;if(this.allowEmpty&&i===""&&(s=!0,l=!0),s||(n=!1),!s&&l&&(n=!0),s&&!l)if(this.correctFormat===!0){var u=o.format(t),f=this.instance.runHooks("unmodifyRow",this.row),c=this.instance.runHooks("unmodifyCol",this.col);this.instance.setDataAtCell(f,c,u,"timeValidator"),n=!0}else n=!1;r(n)}var fc=Bi("validators"),Ss=fc.register,Q2=fc.getItem,eA=fc.hasItem,tA=fc.getNames;Ss("autocomplete",Y2);Ss("date",X2);Ss("numeric",q2);Ss("time",J2);function xa(e){if(typeof e=="function")return e;if(!eA(e))throw Error('No registered validator found under "'.concat(e,'" name'));return Q2(e)}var fh="autocomplete";const rA={editor:Kn(fh),renderer:Dr(fh),validator:xa(fh)};var wm="checkbox";const nA={editor:Kn(wm),renderer:Dr(wm)};var _m="date";const iA={editor:Kn(_m),renderer:Dr("autocomplete"),validator:xa(_m)};var aA="dropdown";const oA={editor:Kn(aA),renderer:Dr("autocomplete"),validator:xa("autocomplete")};var sA="handsontable";const lA={editor:Kn(sA),renderer:Dr("autocomplete")};var ch="numeric";const uA={editor:Kn(ch),renderer:Dr(ch),validator:xa(ch),dataType:"number"};var Cm="password";const fA={editor:Kn(Cm),renderer:Dr(Cm),copyable:!1};var Sm="text";const cA={editor:Kn(Sm),renderer:Dr(Sm)};var hA="time";const dA={editor:Kn("text"),renderer:Dr("text"),validator:xa(hA)};var cc=Bi("cellTypes"),vA=cc.register,gA=cc.getItem,mA=cc.hasItem,pA=cc.getNames;pi("autocomplete",rA);pi("checkbox",nA);pi("date",iA);pi("dropdown",oA);pi("handsontable",lA);pi("numeric",uA);pi("password",fA);pi("text",cA);pi("time",dA);function hc(e){if(!mA(e))throw Error('You declared cell type "'.concat(e,`" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by "Handsontable.cellTypes.registerCellType" method`));return gA(e)}function pi(e,r){var t=r.editor,n=r.renderer,i=r.validator;t&&Tn(e,t),n&&$i(e,n),i&&Ss(e,i),vA(e,r)}function Js(e,r){function t(){}Wi(t,e);for(var n=0,i=r.length;n<i;n++)t.prototype[r[n]]=void 0;return t}const yA=Object.freeze(Object.defineProperty({__proto__:null,columnFactory:Js},Symbol.toStringTag,{value:"Module"}));var V1={};(function(e){(function(r){function t(i){return i.split('"').length-1}var n={parse:function(i){var a,o,s,l=[],u=0,f,c,h,d;for(s=i.replace(/\r\n|\r/g,`
`).split(`
`),s.length>1&&s[s.length-1]===""&&s.pop(),a=0,o=s.length;a<o;a+=1){for(s[a]=s[a].split("	"),f=0,c=s[a].length;f<c;f+=1)l[u]||(l[u]=[]),h&&f===0?(d=l[u].length-1,l[u][d]=l[u][d]+`
`+s[a][0],h&&t(s[a][0])&1&&(h=!1,l[u][d]=l[u][d].substring(0,l[u][d].length-1).replace(/""/g,'"'))):f===c-1&&s[a][f].indexOf('"')===0&&t(s[a][f])&1?(l[u].push(s[a][f].substring(1).replace(/""/g,'"')),h=!0):(l[u].push(s[a][f].replace(/""/g,'"')),h=!1);h||(u+=1)}return l},stringify:function(i){var a,o,s,l,u="",f;for(a=0,o=i.length;a<o;a+=1){for(l=i[a].length,s=0;s<l;s+=1)s>0&&(u+="	"),f=i[a][s],typeof f=="string"?f.indexOf(`
`)>-1?u+='"'+f.replace(/"/g,'""')+'"':u+=f:f==null?u+="":u+=f;a!==o-1&&(u+=`
`)}return u}};e.parse=n.parse,e.stringify=n.stringify})()})(V1);const $o=Ll(V1);var z1="ABCDEFGHIJKLMNOPQRSTUVWXYZ",bd=z1.length;function dc(e){for(var r=e+1,t="",n;r>0;)n=(r-1)%bd,t=String.fromCharCode(65+n)+t,r=parseInt((r-n)/bd,10);return t}function wA(e){var r=0;if(e)for(var t=0,n=e.length-1;t<e.length;t+=1,n-=1)r+=Math.pow(bd,n)*(z1.indexOf(e[t])+1);return r-=1,r}function _A(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,t=[],n,i;for(n=0;n<e;n++){var a=[];for(i=0;i<r;i++)a.push(dc(i)+(n+1));t.push(a)}return t}function CA(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,t=[],n,i;for(n=0;n<e;n++){var a={};for(i=0;i<r;i++)a["prop".concat(i)]=dc(i)+(n+1);t.push(a)}return t}function SA(e,r){for(var t=[],n,i=0;i<e;i++){n=[];for(var a=0;a<r;a++)n.push("");t.push(n)}return t}function j1(e){var r=[],t,n,i,a,o=0;for(t=0,n=e.length;t<n;t++)for(i=0,a=e[t].length;i<a;i++)i===o&&(r.push([]),o+=1),r[i].push(e[t][i]);return r}function Qs(e,r){var t=typeof r>"u"?!0:r;return function(i,a){return function o(s){if(s){if(At(s,e)&&s[e]!==void 0)return s[e];if(At(s,"type")&&s.type){if(typeof s.type!="string")throw new Error("Cell type must be a string ");var l=hc(s.type);if(At(l,e))return l[e];if(t)return}}else return;return o(Object.getPrototypeOf(s))}(typeof i=="number"?this.getCellMeta(i,a):i)}}const bA=Object.freeze(Object.defineProperty({__proto__:null,cellMethodLookupFactory:Qs,createEmptySpreadsheetData:SA,createSpreadsheetData:_A,createSpreadsheetObjectData:CA,spreadsheetColumnIndex:wA,spreadsheetColumnLabel:dc,translateRowsToColumns:j1},Symbol.toStringTag,{value:"Module"}));function xA(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function bm(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function xm(e,r,t){return r&&bm(e.prototype,r),t&&bm(e,t),e}var EA=function(){xm(e,null,[{key:"create",value:function(t,n){return new e(t,n)}}]);function e(r,t){var n=this;xA(this,e),this.timer=null,this.func=r,this.delay=TA(t),this.stopped=!0,this._then=null,this._callback=function(){return n.__callback()}}return xm(e,[{key:"start",value:function(){return this.stopped&&(this._then=Date.now(),this.stopped=!1,this.timer=fl(this._callback)),this}},{key:"stop",value:function(){return this.stopped||(this.stopped=!0,ss(this.timer),this.timer=null),this}},{key:"__callback",value:function(){if(this.timer=fl(this._callback),this.delay){var t=Date.now(),n=t-this._then;n>this.delay&&(this._then=t-n%this.delay,this.func())}else this.func()}}]),e}();function TA(e){var r=e;return typeof r=="string"&&/fps$/.test(r)&&(r=1e3/parseInt(r.replace("fps","")||0,10)),r}function Lu(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Lu=function(t){return typeof t}:Lu=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lu(e)}function OA(){var e={arrayMap:[],weakMap:new WeakMap};return{get:function(a){if(r(a))return e.arrayMap[a];if(t(a))return e.weakMap.get(a)},set:function(a,o){if(r(a))e.arrayMap[a]=o;else if(t(a))e.weakMap.set(a,o);else throw new Error("Invalid key type")},delete:function(a){r(a)?delete e.arrayMap[a]:t(a)&&e.weakMap.delete(a)}};function r(i){return i!==null&&!n(i)&&(typeof i=="string"||typeof i=="number")}function t(i){return i!==null&&(Lu(i)==="object"||typeof i=="function")}function n(i){return i!==i}}function Iu(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Iu=function(t){return typeof t}:Iu=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Iu(e)}function bt(e,r,t){var n=this;this.instance=e,this.priv=r,this.GridSettings=t,this.dataSource=this.instance.getSettings().data,this.cachedLength=null,this.skipCache=!1,this.latestSourceRowsCount=0,this.dataSource&&this.dataSource[0]?this.duckSchema=this.recursiveDuckSchema(this.dataSource[0]):this.duckSchema={},this.createMap(),this.interval=EA.create(function(){return n.clearLengthCache()},"15fps"),this.instance.addHook("skipLengthCache",function(i){return n.onSkipLengthCache(i)}),this.onSkipLengthCache(500)}bt.prototype.DESTINATION_RENDERER=1;bt.prototype.DESTINATION_CLIPBOARD_GENERATOR=2;bt.prototype.recursiveDuckSchema=function(e){return as(e)};bt.prototype.recursiveDuckColumns=function(e,r,t){var n=this,i=r,a=t,o;return typeof i>"u"&&(i=0,a=""),Iu(e)==="object"&&!Array.isArray(e)&&St(e,function(s,l){s===null?(o=a+l,n.colToPropCache.push(o),n.propToColCache.set(o,i),i+=1):i=n.recursiveDuckColumns(s,i,"".concat(l,"."))}),i};bt.prototype.createMap=function(){var e,r=this.getSchema();if(typeof r>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");this.colToPropCache=[],this.propToColCache=new OA;var t=this.instance.getSettings().columns;if(t){var n=this.instance.getSettings().maxCols,i=Math.min(n,t.length),a=0,o=!1,s=E0(r);for(typeof t=="function"&&(i=s>0?s:this.instance.countSourceCols(),o=!0),e=0;e<i;e++){var l=o?t(e):t[e];if(Rt(l)){if(typeof l.data<"u"){var u=o?a:e;this.colToPropCache[u]=l.data,this.propToColCache.set(l.data,u)}a+=1}}}else this.recursiveDuckColumns(r)};bt.prototype.colToProp=function(e){var r=this.instance.runHooks("modifyCol",e);return!isNaN(r)&&this.colToPropCache&&typeof this.colToPropCache[r]<"u"?this.colToPropCache[r]:r};bt.prototype.propToCol=function(e){var r;return typeof this.propToColCache.get(e)>"u"?r=e:r=this.propToColCache.get(e),r=this.instance.runHooks("unmodifyCol",r),r};bt.prototype.getSchema=function(){var e=this.instance.getSettings().dataSchema;return e?typeof e=="function"?e():e:this.duckSchema};bt.prototype.createRow=function(e){var r=this,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,i=0,a=e;(typeof a!="number"||a>=this.instance.countSourceRows())&&(a=this.instance.countSourceRows());var o=this.instance.runHooks("beforeCreateRow",a,t,n);if(o===!1)return 0;for(var s=this.instance.getSettings().maxRows,l=this.instance.countCols(),u=function(){var c=null;r.instance.dataType==="array"?r.instance.getSettings().dataSchema?c=Wr(r.getSchema()):(c=[],Ke(l-1,function(){return c.push(null)})):r.instance.dataType==="function"?c=r.instance.getSettings().dataSchema(a):(c={},Il(c,r.getSchema())),a===r.instance.countSourceRows()?r.dataSource.push(c):r.spliceData(a,0,c),i+=1};i<t&&this.instance.countSourceRows()<s;)u();return this.instance.runHooks("afterCreateRow",a,i,n),this.instance.forceFullRender=!0,i};bt.prototype.createCol=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,t=arguments.length>2?arguments[2]:void 0;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var n=this.instance.countSourceRows(),i=this.dataSource,a=this.instance.countCols(),o=typeof e!="number"||e>=a?a:e,s,l=0,u;this.instance.runHooks("beforeCreateCol",o,r,t),u=o;for(var f=this.instance.getSettings().maxCols;l<r&&this.instance.countCols()<f;){if(s=Js(this.GridSettings,this.priv.columnsSettingConflicts),typeof o!="number"||o>=this.instance.countCols()){if(n>0)for(var c=0;c<n;c++)typeof i[c]>"u"&&(i[c]=[]),i[c].push(null);else i.push([null]);this.priv.columnSettings.push(s)}else{for(var h=0;h<n;h++)i[h].splice(u,0,null);this.priv.columnSettings.splice(u,0,s)}l+=1,u+=1}return this.instance.runHooks("afterCreateCol",o,l,t),this.instance.forceFullRender=!0,l};bt.prototype.removeRow=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,t=arguments.length>2?arguments[2]:void 0,n=typeof e!="number"?-r:e,i=this.instance.runHooks("modifyRemovedAmount",r,n);n=(this.instance.countSourceRows()+n)%this.instance.countSourceRows();var a=this.visualRowsToPhysical(n,i),o=this.instance.runHooks("beforeRemoveRow",n,i,a,t);if(o!==!1){var s=this.dataSource,l=this.filterData(n,i);l&&(s.length=0,Array.prototype.push.apply(s,l)),this.instance.runHooks("afterRemoveRow",n,i,a,t),this.instance.forceFullRender=!0}};bt.prototype.removeCol=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,t=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.instance.getSettings().columns)throw new Error("cannot remove column with object data source or columns option specified");var n=typeof e!="number"?-r:e;n=(this.instance.countCols()+n)%this.instance.countCols();var i=this.visualColumnsToPhysical(n,r),a=i.slice(0).sort(function(C,F){return F-C}),o=this.instance.runHooks("beforeRemoveCol",n,r,i,t);if(o!==!1){for(var s=!0,l=a.length,u=this.dataSource,f=0;f<l;f++)s&&i[0]!==i[f]-f&&(s=!1);if(s)for(var c=0,h=this.instance.countSourceRows();c<h;c++)u[c].splice(i[0],r);else{for(var d=0,g=this.instance.countSourceRows();d<g;d++)for(var v=0;v<l;v++)u[d].splice(a[v],1);for(var p=0;p<l;p++)this.priv.columnSettings.splice(i[p],1)}this.instance.runHooks("afterRemoveCol",n,r,i,t),this.instance.forceFullRender=!0}};bt.prototype.spliceCol=function(e,r,t){for(var n=this.instance.getDataAtCol(e),i=n.slice(r,r+t),a=n.slice(r+t),o=arguments.length,s=new Array(o>3?o-3:0),l=3;l<o;l++)s[l-3]=arguments[l];S0(s,a);for(var u=0;u<t;)s.push(null),u+=1;return pw(s),this.instance.populateFromArray(r,e,s,null,null,"spliceCol"),i};bt.prototype.spliceRow=function(e,r,t){for(var n=this.instance.getSourceDataAtRow(e),i=n.slice(r,r+t),a=n.slice(r+t),o=arguments.length,s=new Array(o>3?o-3:0),l=3;l<o;l++)s[l-3]=arguments[l];S0(s,a);for(var u=0;u<t;)s.push(null),u+=1;return this.instance.populateFromArray(e,r,[s],null,null,"spliceRow"),i};bt.prototype.spliceData=function(e,r,t){var n=this.instance.runHooks("beforeDataSplice",e,r,t);n!==!1&&this.dataSource.splice(e,r,t)};bt.prototype.filterData=function(e,r){var t=this.visualRowsToPhysical(e,r),n=this.instance.runHooks("beforeDataFilter",e,r,t);if(n!==!1){var i=this.dataSource.filter(function(a,o){return t.indexOf(o)===-1});return i}};bt.prototype.get=function(e,r){var t=this.instance.runHooks("modifyRow",e),n=this.dataSource[t],i=this.instance.runHooks("modifyRowData",t);n=isNaN(i)?i:n;var a=null;if(n&&n.hasOwnProperty&&At(n,r))a=n[r];else if(typeof r=="string"&&r.indexOf(".")>-1){var o=r.split("."),s=n;if(!s)return null;for(var l=0,u=o.length;l<u;l++)if(s=s[o[l]],typeof s>"u")return null;a=s}else typeof r=="function"&&(a=r(this.dataSource.slice(t,t+1)[0]));if(this.instance.hasHook("modifyData")){var f=Hl(a);this.instance.runHooks("modifyData",t,this.propToCol(r),f,"get"),f.isTouched()&&(a=f.value)}return a};var RA=Qs("copyable",!1);bt.prototype.getCopyable=function(e,r){return RA.call(this.instance,e,this.propToCol(r))?this.get(e,r):""};bt.prototype.set=function(e,r,t,n){var i=this.instance.runHooks("modifyRow",e,n||"datamapGet"),a=t,o=this.dataSource[i],s=this.instance.runHooks("modifyRowData",i);if(o=isNaN(s)?s:o,this.instance.hasHook("modifyData")){var l=Hl(a);this.instance.runHooks("modifyData",i,this.propToCol(r),l,"set"),l.isTouched()&&(a=l.value)}if(o&&o.hasOwnProperty&&At(o,r))o[r]=a;else if(typeof r=="string"&&r.indexOf(".")>-1){var u=r.split("."),f=o,c=0,h;for(c=0,h=u.length-1;c<h;c++)typeof f[u[c]]>"u"&&(f[u[c]]={}),f=f[u[c]];f[u[c]]=a}else typeof r=="function"?r(this.dataSource.slice(i,i+1)[0],a):o[r]=a};bt.prototype.visualRowsToPhysical=function(e,r){for(var t=this.instance.countSourceRows(),n=[],i=(t+e)%t,a=r,o;i<t&&a;)o=this.instance.runHooks("modifyRow",i),n.push(o),a-=1,i+=1;return n};bt.prototype.visualColumnsToPhysical=function(e,r){for(var t=this.instance.countCols(),n=(t+e)%t,i=[],a=r;n<t&&a;){var o=this.instance.runHooks("modifyCol",n);i.push(o),a-=1,n+=1}return i};bt.prototype.clear=function(){for(var e=0;e<this.instance.countSourceRows();e++)for(var r=0;r<this.instance.countCols();r++)this.set(e,this.colToProp(r),"")};bt.prototype.clearLengthCache=function(){this.cachedLength=null};bt.prototype.getLength=function(){var e=this,r=this.instance.getSettings().maxRows,t;r<0||r===0?t=0:t=r||1/0;var n=this.instance.countSourceRows();if(this.instance.hasHook("modifyRow")){var i=this.skipCache;this.interval.start(),n!==this.latestSourceRowsCount&&(i=!0),this.latestSourceRowsCount=n,this.cachedLength===null||i?(Ke(n-1,function(a){var o=e.instance.runHooks("modifyRow",a);o===null&&(n-=1)}),this.cachedLength=n):n=this.cachedLength}else this.interval.stop();return Math.min(n,t)};bt.prototype.getAll=function(){var e={row:0,col:0},r={row:Math.max(this.instance.countSourceRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return e.row-r.row===0&&!this.instance.countSourceRows()?[]:this.getRange(e,r,bt.prototype.DESTINATION_RENDERER)};bt.prototype.getRange=function(e,r,t){var n=[],i,a,o,s=this.instance.getSettings().maxRows,l=this.instance.getSettings().maxCols;if(s===0||l===0)return[];var u=t===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,f=Math.min(Math.max(s-1,0),Math.max(e.row,r.row)),c=Math.min(Math.max(l-1,0),Math.max(e.col,r.col));for(i=Math.min(e.row,r.row);i<=f;i++){o=[];var h=this.instance.runHooks("modifyRow",i);for(a=Math.min(e.col,r.col);a<=c&&h!==null;a++)o.push(u.call(this,i,this.colToProp(a)));h!==null&&n.push(o)}return n};bt.prototype.getText=function(e,r){return $o.stringify(this.getRange(e,r,this.DESTINATION_RENDERER))};bt.prototype.getCopyableText=function(e,r){return $o.stringify(this.getRange(e,r,this.DESTINATION_CLIPBOARD_GENERATOR))};bt.prototype.onSkipLengthCache=function(e){var r=this;this.skipCache=!0,setTimeout(function(){r.skipCache=!1},e)};bt.prototype.destroy=function(){this.interval.stop(),this.interval=null,this.instance=null,this.priv=null,this.GridSettings=null,this.dataSource=null,this.cachedLength=null,this.duckSchema=null};function xd(e,r,t){var n=this,i=new Ft(e),a=!1,o=!1,s;function l(v){var p=typeof r.settings.enterMoves=="function"?r.settings.enterMoves(event):r.settings.enterMoves;v?t.transformStart(-p.row,-p.col):t.transformStart(p.row,p.col,!0)}function u(v){v?t.transformEnd(-1,0):t.transformStart(-1,0)}function f(v){v?t.transformEnd(1,0):t.transformStart(1,0)}function c(v){v?t.transformEnd(0,1):t.transformStart(0,1)}function h(v){v?t.transformEnd(0,-1):t.transformStart(0,-1)}function d(v){if(e.isListening()&&(e.runHooks("beforeKeyDown",v),!(a||v.keyCode===229)&&!Oi(v)&&(r.lastKeyCode=v.keyCode,!!t.isSelected()))){var p=(v.ctrlKey||v.metaKey)&&!v.altKey;if(s&&!s.isWaiting()&&!Q0(v.keyCode)&&!ev(v.keyCode)&&!p&&!n.isEditorOpened()){n.openEditor("",v);return}var C=v.shiftKey?t.setRangeEnd:t.setRangeStart,F;switch(v.keyCode){case De.A:!n.isEditorOpened()&&p&&(e.selectAll(),v.preventDefault(),Lr(v));break;case De.ARROW_UP:n.isEditorOpened()&&!s.isWaiting()&&n.closeEditorAndSaveChanges(p),u(v.shiftKey),v.preventDefault(),Lr(v);break;case De.ARROW_DOWN:n.isEditorOpened()&&!s.isWaiting()&&n.closeEditorAndSaveChanges(p),f(v.shiftKey),v.preventDefault(),Lr(v);break;case De.ARROW_RIGHT:n.isEditorOpened()&&!s.isWaiting()&&n.closeEditorAndSaveChanges(p),c(v.shiftKey),v.preventDefault(),Lr(v);break;case De.ARROW_LEFT:n.isEditorOpened()&&!s.isWaiting()&&n.closeEditorAndSaveChanges(p),h(v.shiftKey),v.preventDefault(),Lr(v);break;case De.TAB:F=typeof r.settings.tabMoves=="function"?r.settings.tabMoves(v):r.settings.tabMoves,v.shiftKey?t.transformStart(-F.row,-F.col):t.transformStart(F.row,F.col,!0),v.preventDefault(),Lr(v);break;case De.BACKSPACE:case De.DELETE:e.emptySelectedCells(),n.prepareEditor(),v.preventDefault();break;case De.F2:s&&s.enableFullEditMode(),n.openEditor(null,v),v.preventDefault();break;case De.ENTER:n.isEditorOpened()?(s&&s.state!==_r.WAITING&&n.closeEditorAndSaveChanges(p),l(v.shiftKey)):e.getSettings().enterBeginsEditing?(s&&s.enableFullEditMode(),n.openEditor(null,v)):l(v.shiftKey),v.preventDefault(),Hr(v);break;case De.ESCAPE:n.isEditorOpened()&&(n.closeEditorAndRestoreOriginalValue(p),s.focus()),v.preventDefault();break;case De.HOME:v.ctrlKey||v.metaKey?C.call(t,new me(0,t.selectedRange.current().from.col)):C.call(t,new me(t.selectedRange.current().from.row,0)),v.preventDefault(),Lr(v);break;case De.END:v.ctrlKey||v.metaKey?C.call(t,new me(e.countRows()-1,t.selectedRange.current().from.col)):C.call(t,new me(t.selectedRange.current().from.row,e.countCols()-1)),v.preventDefault(),Lr(v);break;case De.PAGE_UP:t.transformStart(-e.countVisibleRows(),0),v.preventDefault(),Lr(v);break;case De.PAGE_DOWN:t.transformStart(e.countVisibleRows(),0),v.preventDefault(),Lr(v);break}}}function g(){e.addHook("afterDocumentKeyDown",d),i.addEventListener(document.documentElement,"keydown",function(p){a||e.runHooks("afterDocumentKeyDown",p)}),i.addEventListener(document.documentElement,"compositionstart",function(p){!a&&s&&!s.isOpened()&&e.isListening()&&n.openEditor("",p)});function v(p,C,F){F.nodeName==="TD"&&(s&&s.enableFullEditMode(),n.openEditor(null,p))}e.view.wt.update("onCellDblClick",v)}this.lockEditor=function(){o=!0},this.unlockEditor=function(){o=!1},this.destroyEditor=function(v){o||this.closeEditor(v)},this.getActiveEditor=function(){return s},this.prepareEditor=function(){if(!o){if(s&&s.isWaiting()){this.closeEditor(!1,!1,function(se){se&&n.prepareEditor()});return}var v=e.selection.selectedRange.current().highlight.row,p=e.selection.selectedRange.current().highlight.col,C=e.colToProp(p),F=e.getCell(v,p),D=e.getSourceDataAtCell(e.runHooks("modifyRow",v),p),ee=e.getCellMeta(v,p),ue=e.getCellEditor(ee);ue?(s=W1(ue,e),s.prepare(v,p,C,F,D,ee)):s=void 0}},this.isEditorOpened=function(){return s&&s.isOpened()},this.openEditor=function(v,p){if(s){var C=s.cellProperties.readOnly;C?p&&p.keyCode===De.ENTER&&l():s.beginEditing(v,p)}},this.closeEditor=function(v,p,C){s?s.finishEditing(v,p,C):C&&C(!1)},this.closeEditorAndSaveChanges=function(v){return this.closeEditor(!1,v)},this.closeEditorAndRestoreOriginalValue=function(v){return this.closeEditor(!0,v)},this.destroy=function(){a=!0},g()}var Em=new WeakMap;xd.getInstance=function(e,r,t,n){var i=Em.get(e);return i||(i=new xd(e,r,t),Em.set(e,i)),i};var yn=new WeakMap;function ur(e,r){var t=va(e);at.getSingleton().add("construct",function(){yn.has(this)||yn.set(this,{});var n=yn.get(this);n[t]||(n[t]=new r(this))}),at.getSingleton().add("afterDestroy",function(){if(yn.has(this)){var n=yn.get(this);St(n,function(i){return i.destroy()}),yn.delete(this)}})}function kA(e,r){if(typeof r!="string")throw Error('Only strings can be passed as "plugin" parameter');var t=va(r);if(!(!yn.has(e)||!yn.get(e)[t]))return yn.get(e)[t]}function AA(e){return yn.has(e)?Object.keys(yn.get(e)):[]}function MA(e,r){var t=null;return yn.has(e)&&St(yn.get(e),function(n,i){n===r&&(t=i)}),t}function Tm(e){var r=e.isShiftKey,t=e.isLeftClick,n=e.isRightClick,i=e.coords,a=e.selection,o=e.controller,s=a.isSelected()?a.getSelectedRange().current():null,l=a.isSelectedByCorner(),u=a.isSelectedByRowHeader();if(r&&s)i.row>=0&&i.col>=0&&!o.cells?a.setRangeEnd(i):(l||u)&&i.row>=0&&i.col>=0&&!o.cells?a.setRangeEnd(new me(i.row,i.col)):l&&i.row<0&&!o.column?a.setRangeEnd(new me(s.to.row,i.col)):u&&i.col<0&&!o.row?a.setRangeEnd(new me(i.row,s.to.col)):(!l&&!u&&i.col<0||l&&i.col<0)&&!o.row?a.selectRows(s.from.row,i.row):(!l&&!u&&i.row<0||u&&i.row<0)&&!o.column&&a.selectColumns(s.from.col,i.col);else{var f=new me(i.row,i.col);f.row<0&&(f.row=0),f.col<0&&(f.col=0);var c=!a.inInSelection(f),h=t||n&&c;i.row<0&&i.col>=0&&!o.column?h&&a.selectColumns(i.col):i.col<0&&i.row>=0&&!o.row?h&&a.selectRows(i.row):i.col>=0&&i.row>=0&&!o.cells?h&&a.setRangeStart(i):i.col<0&&i.row<0&&a.setRangeStart(i)}}function DA(e){var r=e.isLeftClick,t=e.coords,n=e.selection,i=e.controller;if(r){var a=n.isSelectedByRowHeader(),o=n.isSelectedByColumnHeader(),s=n.tableProps.countCols(),l=n.tableProps.countRows();o&&!i.column?n.setRangeEnd(new me(l-1,t.col)):a&&!i.row?n.setRangeEnd(new me(t.row,s-1)):i.cell||n.setRangeEnd(t)}}var PA=new Map([["mousedown",Tm],["mouseover",DA],["touchstart",Tm]]);function Om(e,r){var t=r.coords,n=r.selection,i=r.controller;PA.get(e.type)({coords:t,selection:n,controller:i,isShiftKey:e.shiftKey,isLeftClick:M0(e)||e.type==="touchstart",isRightClick:vl(e)})}function NA(e,r){return IA(e)||LA(e,r)||FA()}function FA(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function LA(e,r){var t=[],n=!0,i=!1,a=void 0;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done)&&(t.push(s.value),!(r&&t.length===r));n=!0);}catch(l){i=!0,a=l}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw a}}return t}function IA(e){if(Array.isArray(e))return e}var Rm=function(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()};function Pr(e){var r=this,t=this;this.eventManager=new Ft(e),this.instance=e,this.settings=e.getSettings(),this.selectionMouseDown=!1;var n=e.rootElement.getAttribute("style");n&&e.rootElement.setAttribute("data-originalstyle",n),$e(e.rootElement,"handsontable");var i=document.createElement("TABLE");$e(i,"htCore"),e.getSettings().tableClassName&&$e(i,e.getSettings().tableClassName),this.THEAD=document.createElement("THEAD"),i.appendChild(this.THEAD),this.TBODY=document.createElement("TBODY"),i.appendChild(this.TBODY),e.table=i,e.container.insertBefore(i,e.container.firstChild),this.eventManager.addEventListener(e.rootElement,"mousedown",function(s){r.selectionMouseDown=!0,t.isTextSelectionAllowed(s.target)||(Rm(),s.preventDefault(),window.focus())}),this.eventManager.addEventListener(e.rootElement,"mouseup",function(){r.selectionMouseDown=!1}),this.eventManager.addEventListener(e.rootElement,"mousemove",function(s){r.selectionMouseDown&&!t.isTextSelectionAllowed(s.target)&&(r.settings.fragmentSelection&&Rm(),s.preventDefault())}),this.eventManager.addEventListener(document.documentElement,"keyup",function(s){e.selection.isInProgress()&&!s.shiftKey&&e.selection.finish()});var a;this.isMouseDown=function(){return a},this.eventManager.addEventListener(document.documentElement,"mouseup",function(s){e.selection.isInProgress()&&M0(s)&&e.selection.finish(),a=!1,(Lw(document.activeElement)||!e.selection.isSelected()&&!vl(s))&&e.unlisten()}),this.eventManager.addEventListener(document.documentElement,"contextmenu",function(s){e.selection.isInProgress()&&vl(s)&&(e.selection.finish(),a=!1)}),this.eventManager.addEventListener(document.documentElement,"touchend",function(){e.selection.isInProgress()&&e.selection.finish(),a=!1}),this.eventManager.addEventListener(document.documentElement,"mousedown",function(s){var l=s.target,u=s.x||s.clientX,f=s.y||s.clientY,c=s.target;if(!(a||!e.rootElement)){if(c===e.view.wt.wtTable.holder){var h=Jt();if(document.elementFromPoint(u+h,f)!==e.view.wt.wtTable.holder||document.elementFromPoint(u,f+h)!==e.view.wt.wtTable.holder)return}else for(;c!==document.documentElement;){if(c===null){if(s.isTargetWebComponent)break;return}if(c===e.rootElement)return;c=c.parentNode}var d=typeof t.settings.outsideClickDeselects=="function"?t.settings.outsideClickDeselects(l):t.settings.outsideClickDeselects;d?e.deselectCell():e.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(i,"selectstart",function(s){t.settings.fragmentSelection||Kf(s.target)||s.preventDefault()});var o={debug:function(){return t.settings.debug},externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:i,preventOverflow:function(){return r.settings.preventOverflow},stretchH:function(){return t.settings.stretchH},data:e.getDataAtCell,totalRows:function(){return e.countRows()},totalColumns:function(){return e.countCols()},fixedColumnsLeft:function(){return t.settings.fixedColumnsLeft},fixedRowsTop:function(){return t.settings.fixedRowsTop},fixedRowsBottom:function(){return t.settings.fixedRowsBottom},minSpareRows:function(){return t.settings.minSpareRows},renderAllRows:t.settings.renderAllRows,rowHeaders:function(){var l=[];return e.hasRowHeaders()&&l.push(function(u,f){return t.appendRowHeader(u,f)}),e.runHooks("afterGetRowHeaderRenderers",l),l},columnHeaders:function(){var l=[];return e.hasColHeaders()&&l.push(function(u,f){t.appendColHeader(u,f)}),e.runHooks("afterGetColumnHeaderRenderers",l),l},columnWidth:e.getColWidth,rowHeight:e.getRowHeight,cellRenderer:function(l,u,f){var c=t.instance.getCellMeta(l,u),h=t.instance.colToProp(u),d=t.instance.getDataAtRowProp(l,h);t.instance.hasHook("beforeValueRender")&&(d=t.instance.runHooks("beforeValueRender",d,c)),t.instance.runHooks("beforeRenderer",f,l,u,h,d,c),t.instance.getCellRenderer(c)(t.instance,f,l,u,h,d,c),t.instance.runHooks("afterRenderer",f,l,u,h,d,c)},selections:t.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return t.settings.fragmentSelection},onCellMouseDown:function(l,u,f,c){var h={row:!1,column:!1,cell:!1};e.listen(),t.activeWt=c,a=!0,e.runHooks("beforeOnCellMouseDown",l,u,f,h),!Oi(l)&&(Om(l,{coords:u,selection:e.selection,controller:h}),e.runHooks("afterOnCellMouseDown",l,u,f),t.activeWt=t.wt)},onCellContextMenu:function(l,u,f,c){t.activeWt=c,a=!1,e.selection.isInProgress()&&e.selection.finish(),e.runHooks("beforeOnCellContextMenu",l,u,f),!Oi(l)&&(e.runHooks("afterOnCellContextMenu",l,u,f),t.activeWt=t.wt)},onCellMouseOut:function(l,u,f,c){t.activeWt=c,e.runHooks("beforeOnCellMouseOut",l,u,f),!Oi(l)&&(e.runHooks("afterOnCellMouseOut",l,u,f),t.activeWt=t.wt)},onCellMouseOver:function(l,u,f,c){var h={row:!1,column:!1,cell:!1};t.activeWt=c,e.runHooks("beforeOnCellMouseOver",l,u,f,h),!Oi(l)&&(a&&Om(l,{coords:u,selection:e.selection,controller:h}),e.runHooks("afterOnCellMouseOver",l,u,f),t.activeWt=t.wt)},onCellMouseUp:function(l,u,f,c){t.activeWt=c,e.runHooks("beforeOnCellMouseUp",l,u,f),e.runHooks("afterOnCellMouseUp",l,u,f),t.activeWt=t.wt},onCellCornerMouseDown:function(l){l.preventDefault(),e.runHooks("afterOnCellCornerMouseDown",l)},onCellCornerDblClick:function(l){l.preventDefault(),e.runHooks("afterOnCellCornerDblClick",l)},beforeDraw:function(l,u){t.beforeRender(l,u)},onDraw:function(l){t.onDraw(l)},onScrollVertically:function(){e.runHooks("afterScrollVertically")},onScrollHorizontally:function(){e.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return e.runHooks("beforeRemoveCellClassNames")},onAfterDrawSelection:function(l,u,f,c){return e.runHooks("afterDrawSelection",l,u,f,c)},onBeforeDrawBorders:function(l,u){e.runHooks("beforeDrawBorders",l,u)},onBeforeTouchScroll:function(){e.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){e.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(l,u){return e.runHooks("beforeStretchingColumnWidth",l,u)},onModifyRowHeaderWidth:function(l){return e.runHooks("modifyRowHeaderWidth",l)},onModifyGetCellCoords:function(l,u,f){return e.runHooks("modifyGetCellCoords",l,u,f)},viewportRowCalculatorOverride:function(l){var u=e.countRows(),f=t.settings.viewportRowRenderingOffset;if(f==="auto"&&t.settings.fixedRowsTop&&(f=10),typeof f=="number"&&(l.startRow=Math.max(l.startRow-f,0),l.endRow=Math.min(l.endRow+f,u-1)),f==="auto"){var c=l.startRow+l.endRow-l.startRow,h=Math.ceil(c/u*12);l.startRow=Math.max(l.startRow-h,0),l.endRow=Math.min(l.endRow+h,u-1)}e.runHooks("afterViewportRowCalculatorOverride",l)},viewportColumnCalculatorOverride:function(l){var u=e.countCols(),f=t.settings.viewportColumnRenderingOffset;if(f==="auto"&&t.settings.fixedColumnsLeft&&(f=10),typeof f=="number"&&(l.startColumn=Math.max(l.startColumn-f,0),l.endColumn=Math.min(l.endColumn+f,u-1)),f==="auto"){var c=l.startColumn+l.endColumn-l.startColumn,h=Math.ceil(c/u*12);l.startRow=Math.max(l.startColumn-h,0),l.endColumn=Math.min(l.endColumn+h,u-1)}e.runHooks("afterViewportColumnCalculatorOverride",l)},rowHeaderWidth:function(){return t.settings.rowHeaderWidth},columnHeaderHeight:function(){var l=e.runHooks("modifyColumnHeaderHeight");return t.settings.columnHeaderHeight||l}};e.runHooks("beforeInitWalkontable",o),this.wt=new M1(o),this.activeWt=this.wt,this.eventManager.addEventListener(t.wt.wtTable.spreader,"mousedown",function(s){s.target===t.wt.wtTable.spreader&&s.which===3&&Lr(s)}),this.eventManager.addEventListener(t.wt.wtTable.spreader,"contextmenu",function(s){s.target===t.wt.wtTable.spreader&&s.which===3&&Lr(s)}),this.eventManager.addEventListener(document.documentElement,"click",function(){t.settings.observeDOMVisibility&&t.wt.drawInterrupted&&(t.instance.forceFullRender=!0,t.render())})}Pr.prototype.isTextSelectionAllowed=function(e){if(Kf(e))return!0;var r=Ti(e,this.instance.view.wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&r||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&r||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())};Pr.prototype.isSelectedOnlyCell=function(){var e=this.instance.getSelectedLast()||[],r=NA(e,4),t=r[0],n=r[1],i=r[2],a=r[3];return t!==void 0&&t===i&&n===a};Pr.prototype.isCellEdited=function(){var e=this.instance.getActiveEditor();return e&&e.isOpened()};Pr.prototype.beforeRender=function(e,r){e&&this.instance.runHooks("beforeRender",this.instance.forceFullRender,r)};Pr.prototype.onDraw=function(e){e&&this.instance.runHooks("afterRender",this.instance.forceFullRender)};Pr.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1};Pr.prototype.getCellAtCoords=function(e,r){var t=this.wt.getCell(e,r);return t<0?null:t};Pr.prototype.scrollViewport=function(e,r,t,n,i){return this.wt.scrollViewport(e,r,t,n,i)};Pr.prototype.scrollViewportHorizontally=function(e,r,t){return this.wt.scrollViewportHorizontally(e,r,t)};Pr.prototype.scrollViewportVertically=function(e,r,t){return this.wt.scrollViewportVertically(e,r,t)};Pr.prototype.appendRowHeader=function(e,r){if(r.firstChild){var t=r.firstChild;if(!gt(t,"relative")){Gn(r),this.appendRowHeader(e,r);return}this.updateCellHeader(t.querySelector(".rowHeader"),e,this.instance.getRowHeader)}else{var n=document.createElement("div"),i=document.createElement("span");n.className="relative",i.className="rowHeader",this.updateCellHeader(i,e,this.instance.getRowHeader),n.appendChild(i),r.appendChild(n)}this.instance.runHooks("afterGetRowHeader",e,r)};Pr.prototype.appendColHeader=function(e,r){if(r.firstChild){var t=r.firstChild;gt(t,"relative")?this.updateCellHeader(t.querySelector(".colHeader"),e,this.instance.getColHeader):(Gn(r),this.appendColHeader(e,r))}else{var n=document.createElement("div"),i=document.createElement("span");n.className="relative",i.className="colHeader",this.updateCellHeader(i,e,this.instance.getColHeader),n.appendChild(i),r.appendChild(n)}this.instance.runHooks("afterGetColHeader",e,r)};Pr.prototype.updateCellHeader=function(e,r,t){var n=r,i=this.wt.wtOverlays.getParentOverlay(e)||this.wt;e.parentNode&&(gt(e,"colHeader")?n=i.wtTable.columnFilter.sourceToRendered(r):gt(e,"rowHeader")&&(n=i.wtTable.rowFilter.sourceToRendered(r))),n>-1?ms(e,t(r)):(ps(e," "),$e(e,"cornerHeader"))};Pr.prototype.maximumVisibleElementWidth=function(e){var r=this.wt.wtViewport.getWorkspaceWidth(),t=r-e;return t>0?t:0};Pr.prototype.maximumVisibleElementHeight=function(e){var r=this.wt.wtViewport.getWorkspaceHeight(),t=r-e;return t>0?t:0};Pr.prototype.mainViewIsActive=function(){return this.wt===this.activeWt};Pr.prototype.destroy=function(){this.wt.destroy(),this.eventManager.destroy()};function HA(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function km(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function BA(e,r,t){return r&&km(e.prototype,r),t&&km(e,t),e}var WA=function(){function e(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];HA(this,e),this.hot=r,this.data=t,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return BA(e,[{key:"getData",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.data;return t&&(n=this.getByRange({row:0,col:0},{row:Math.max(this.countRows()-1,0),col:Math.max(this.countColumns()-1,0)},!0)),n}},{key:"setData",value:function(t){this.data=t}},{key:"getAtColumn",value:function(t){var n=this,i=[];return pe(this.data,function(a){var o=n.colToProp(t),s;typeof o=="string"?s=$h(a,o):typeof o=="function"?s=o(a):s=a[o],i.push(s)}),i}},{key:"getAtRow",value:function(t){return this.data[t]}},{key:"getAtCell",value:function(t,n){var i=null,a=this.hot.runHooks("modifyRowData",t),o=isNaN(a)?a:this.data[t];if(o){var s=this.colToProp(n);typeof s=="string"?i=$h(o,s):typeof s=="function"?i=s(this.data.slice(t,t+1)[0]):i=o[s]}return i}},{key:"getByRange",value:function(t,n){var i=this,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=Math.min(t.row,n.row),s=Math.min(t.col,n.col),l=Math.max(t.row,n.row),u=Math.max(t.col,n.col),f=[];return Ke(o,l,function(c){var h=i.getAtRow(c),d;i.dataType==="array"?d=h.slice(s,u+1):i.dataType==="object"&&(d=a?[]:{},Ke(s,u,function(g){var v=i.colToProp(g);a?d.push(h[v]):d[v]=h[v]})),f.push(d)}),f}},{key:"countRows",value:function(){return Array.isArray(this.data)?this.data.length:0}},{key:"countColumns",value:function(){var t=0;return Array.isArray(this.data)&&(this.dataType==="array"?t=this.data[0].length:this.dataType==="object"&&(t=Object.keys(this.data[0]).length)),t}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),e}();function $A(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Am(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function UA(e,r,t){return r&&Am(e.prototype,r),t&&Am(e,t),e}var VA=function(){function e(r){$A(this,e),this.hot=r}return UA(e,[{key:"toVisualRow",value:function(t){return this.hot.runHooks("unmodifyRow",t)}},{key:"toVisualColumn",value:function(t){return this.hot.runHooks("unmodifyCol",t)}},{key:"toVisual",value:function(t,n){var i;return Rt(t)?i={row:this.toVisualRow(t.row),column:this.toVisualColumn(t.column)}:i=[this.toVisualRow(t),this.toVisualColumn(n)],i}},{key:"toPhysicalRow",value:function(t){return this.hot.runHooks("modifyRow",t)}},{key:"toPhysicalColumn",value:function(t){return this.hot.runHooks("modifyCol",t)}},{key:"toPhysical",value:function(t,n){var i;return Rt(t)?i={row:this.toPhysicalRow(t.row),column:this.toPhysicalColumn(t.column)}:i=[this.toPhysicalRow(t),this.toPhysicalColumn(n)],i}}]),e}(),Mm=new WeakMap,hh=new WeakMap;function Y1(e){var r=e instanceof pc?e:zA(e),t;return hh.has(r)?t=hh.get(r):(t=new VA(r),hh.set(r,t)),t}function zA(e){if(!Mm.has(e))throw Error("Record translator was not registered for this object identity");return Mm.get(e)}var jA=new WeakMap,G1=Symbol("rootInstance");function YA(e){jA.set(e,!0)}function GA(e){return e===G1}function Hu(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Hu=function(t){return typeof t}:Hu=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hu(e)}function av(){}av.prototype={licenseKey:"trial",data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:void 0,colHeaders:null,colWidths:void 0,rowHeights:void 0,columns:void 0,cells:void 0,cell:[],comments:!1,customBorders:!1,minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,allowInsertRow:!0,allowInsertColumn:!0,allowRemoveRow:!0,allowRemoveColumn:!0,selectionMode:"multiple",fillHandle:{autoInsertRow:!1},fixedRowsTop:0,fixedRowsBottom:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!0,autoWrapCol:!0,persistentState:void 0,currentRowClassName:void 0,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",activeHeaderClassName:"ht__active_highlight",className:void 0,tableClassName:void 0,stretchH:"none",isEmptyRow:function(r){var t,n,i,a;for(t=0,n=this.countCols();t<n;t++)if(i=this.getDataAtCell(r,t),i!==""&&i!==null&&ir(i))return Hu(i)==="object"?(a=this.getCellMeta(r,t),x0(this.getSchema()[a.prop],i)):!1;return!0},isEmptyCol:function(r){var t,n,i;for(t=0,n=this.countRows();t<n;t++)if(i=this.getDataAtCell(t,r),i!==""&&i!==null&&ir(i))return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,allowEmpty:!0,invalidCellClassName:"htInvalid",placeholder:void 0,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",renderer:void 0,commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,skipColumnOnPaste:!1,search:!1,type:"text",copyable:!0,editor:void 0,visibleRows:10,trimDropdown:!0,debug:!1,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,copyPaste:!0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:!1,multiColumnSorting:void 0,viewportRowRenderingOffset:"auto",viewportColumnRenderingOffset:"auto",validator:void 0,disableVisualSelection:!1,manualColumnFreeze:void 0,trimWhitespace:!0,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,label:void 0,numericFormat:void 0,language:"en-US",selectOptions:void 0,autoColumnSize:void 0,autoRowSize:void 0,dateFormat:"DD/MM/YYYY",correctFormat:!1,defaultDate:void 0,strict:void 0,allowHtml:!1,renderAllRows:void 0,preventOverflow:!1,bindRowsWithHeaders:void 0,collapsibleColumns:void 0,columnSummary:void 0,dropdownMenu:void 0,filters:void 0,formulas:void 0,ganttChart:void 0,headerTooltips:void 0,hiddenColumns:void 0,hiddenRows:void 0,nestedHeaders:void 0,trimRows:void 0,rowHeaderWidth:void 0,columnHeaderHeight:void 0,observeChanges:void 0,sortByRelevance:!0,filter:!0,filteringCaseSensitive:!1,dragToScroll:!0,nestedRows:void 0};function X1(){var e=XA(['Language with code "',`" was not found. You should register particular language 
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`]);return X1=function(){return e},e}function XA(e,r){return r||(r=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(r)}}))}function KA(e,r){return St(r,function(t,n){Mr(e[n])&&(e[n]=t)}),e}function K1(e){var r=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,t=r.exec(e);return t?"".concat(t[1].toLowerCase(),"-").concat(t[2].toUpperCase()):e}function qA(e,r){var t=K1(r);Wv(t)?e.language=t:(e.language=Ed,q1(r))}function q1(e){ir(e)&&TR(ci(X1(),e))}var ft="ContextMenu:items",ov="".concat(ft,".insertRowAbove"),sv="".concat(ft,".insertRowBelow"),lv="".concat(ft,".insertColumnOnTheLeft"),uv="".concat(ft,".insertColumnOnTheRight"),fv="".concat(ft,".removeRow"),cv="".concat(ft,".removeColumn"),hv="".concat(ft,".undo"),dv="".concat(ft,".redo"),vv="".concat(ft,".readOnly"),gv="".concat(ft,".clearColumn"),mv="".concat(ft,".copy"),pv="".concat(ft,".cut"),yv="".concat(ft,".freezeColumn"),wv="".concat(ft,".unfreezeColumn"),_v="".concat(ft,".mergeCells"),Cv="".concat(ft,".unmergeCells"),Sv="".concat(ft,".addComment"),bv="".concat(ft,".editComment"),xv="".concat(ft,".removeComment"),Ev="".concat(ft,".readOnlyComment"),Tv="".concat(ft,".align"),Ov="".concat(ft,".align.left"),Rv="".concat(ft,".align.center"),kv="".concat(ft,".align.right"),Av="".concat(ft,".align.justify"),Mv="".concat(ft,".align.top"),Dv="".concat(ft,".align.middle"),Pv="".concat(ft,".align.bottom"),Nv="".concat(ft,".borders"),Fv="".concat(ft,".borders.top"),Lv="".concat(ft,".borders.right"),Iv="".concat(ft,".borders.bottom"),Hv="".concat(ft,".borders.left"),Bv="".concat(ft,".borders.remove"),Z1="".concat(ft,".nestedHeaders.insertChildRow"),J1="".concat(ft,".nestedHeaders.detachFromParent"),Q1="".concat(ft,".hideColumn"),e_="".concat(ft,".showColumn"),t_="".concat(ft,".hideRow"),r_="".concat(ft,".showRow"),dn="Filters:",ar="".concat(dn,"conditions"),n_="".concat(ar,".none"),i_="".concat(ar,".isEmpty"),a_="".concat(ar,".isNotEmpty"),o_="".concat(ar,".isEqualTo"),s_="".concat(ar,".isNotEqualTo"),l_="".concat(ar,".beginsWith"),u_="".concat(ar,".endsWith"),f_="".concat(ar,".contains"),c_="".concat(ar,".doesNotContain"),ZA="".concat(ar,".byValue"),h_="".concat(ar,".greaterThan"),d_="".concat(ar,".greaterThanOrEqualTo"),v_="".concat(ar,".lessThan"),g_="".concat(ar,".lessThanOrEqualTo"),m_="".concat(ar,".isBetween"),p_="".concat(ar,".isNotBetween"),y_="".concat(ar,".after"),w_="".concat(ar,".before"),__="".concat(ar,".today"),C_="".concat(ar,".tomorrow"),S_="".concat(ar,".yesterday"),b_="".concat(dn,"labels.filterByCondition"),x_="".concat(dn,"labels.filterByValue"),E_="".concat(dn,"labels.conjunction"),T_="".concat(dn,"labels.disjunction"),O_="".concat(dn,"values.blankCells"),R_="".concat(dn,"buttons.selectAll"),k_="".concat(dn,"buttons.clear"),A_="".concat(dn,"buttons.ok"),M_="".concat(dn,"buttons.cancel"),D_="".concat(dn,"buttons.placeholder.search"),P_="".concat(dn,"buttons.placeholder.value"),N_="".concat(dn,"buttons.placeholder.secondValue");const JA=Object.freeze(Object.defineProperty({__proto__:null,CONTEXTMENU_ITEMS_ADD_COMMENT:Sv,CONTEXTMENU_ITEMS_ALIGNMENT:Tv,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:Pv,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:Rv,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:Av,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:Ov,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:Dv,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:kv,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:Mv,CONTEXTMENU_ITEMS_BORDERS:Nv,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:Iv,CONTEXTMENU_ITEMS_BORDERS_LEFT:Hv,CONTEXTMENU_ITEMS_BORDERS_RIGHT:Lv,CONTEXTMENU_ITEMS_BORDERS_TOP:Fv,CONTEXTMENU_ITEMS_CLEAR_COLUMN:gv,CONTEXTMENU_ITEMS_COPY:mv,CONTEXTMENU_ITEMS_CUT:pv,CONTEXTMENU_ITEMS_EDIT_COMMENT:bv,CONTEXTMENU_ITEMS_FREEZE_COLUMN:yv,CONTEXTMENU_ITEMS_HIDE_COLUMN:Q1,CONTEXTMENU_ITEMS_HIDE_ROW:t_,CONTEXTMENU_ITEMS_INSERT_LEFT:lv,CONTEXTMENU_ITEMS_INSERT_RIGHT:uv,CONTEXTMENU_ITEMS_MERGE_CELLS:_v,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:J1,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:Z1,CONTEXTMENU_ITEMS_READ_ONLY:vv,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:Ev,CONTEXTMENU_ITEMS_REDO:dv,CONTEXTMENU_ITEMS_REMOVE_BORDERS:Bv,CONTEXTMENU_ITEMS_REMOVE_COLUMN:cv,CONTEXTMENU_ITEMS_REMOVE_COMMENT:xv,CONTEXTMENU_ITEMS_REMOVE_ROW:fv,CONTEXTMENU_ITEMS_ROW_ABOVE:ov,CONTEXTMENU_ITEMS_ROW_BELOW:sv,CONTEXTMENU_ITEMS_SHOW_COLUMN:e_,CONTEXTMENU_ITEMS_SHOW_ROW:r_,CONTEXTMENU_ITEMS_UNDO:hv,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:wv,CONTEXTMENU_ITEMS_UNMERGE_CELLS:Cv,CONTEXT_MENU_ITEMS_NAMESPACE:ft,FILTERS_BUTTONS_CANCEL:M_,FILTERS_BUTTONS_CLEAR:k_,FILTERS_BUTTONS_OK:A_,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:D_,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:N_,FILTERS_BUTTONS_PLACEHOLDER_VALUE:P_,FILTERS_BUTTONS_SELECT_ALL:R_,FILTERS_CONDITIONS_AFTER:y_,FILTERS_CONDITIONS_BEFORE:w_,FILTERS_CONDITIONS_BEGINS_WITH:l_,FILTERS_CONDITIONS_BETWEEN:m_,FILTERS_CONDITIONS_BY_VALUE:ZA,FILTERS_CONDITIONS_CONTAINS:f_,FILTERS_CONDITIONS_EMPTY:i_,FILTERS_CONDITIONS_ENDS_WITH:u_,FILTERS_CONDITIONS_EQUAL:o_,FILTERS_CONDITIONS_GREATER_THAN:h_,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:d_,FILTERS_CONDITIONS_LESS_THAN:v_,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:g_,FILTERS_CONDITIONS_NAMESPACE:ar,FILTERS_CONDITIONS_NONE:n_,FILTERS_CONDITIONS_NOT_BETWEEN:p_,FILTERS_CONDITIONS_NOT_CONTAIN:c_,FILTERS_CONDITIONS_NOT_EMPTY:a_,FILTERS_CONDITIONS_NOT_EQUAL:s_,FILTERS_CONDITIONS_TODAY:__,FILTERS_CONDITIONS_TOMORROW:C_,FILTERS_CONDITIONS_YESTERDAY:S_,FILTERS_DIVS_FILTER_BY_CONDITION:b_,FILTERS_DIVS_FILTER_BY_VALUE:x_,FILTERS_LABELS_CONJUNCTION:E_,FILTERS_LABELS_DISJUNCTION:T_,FILTERS_NAMESPACE:dn,FILTERS_VALUES_BLANK_CELLS:O_},Symbol.toStringTag,{value:"Module"}));var Be;function We(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var F_=(Be={languageCode:"en-US"},We(Be,ov,"Insert row above"),We(Be,sv,"Insert row below"),We(Be,lv,"Insert column left"),We(Be,uv,"Insert column right"),We(Be,fv,["Remove row","Remove rows"]),We(Be,cv,["Remove column","Remove columns"]),We(Be,hv,"Undo"),We(Be,dv,"Redo"),We(Be,vv,"Read only"),We(Be,gv,"Clear column"),We(Be,Tv,"Alignment"),We(Be,Ov,"Left"),We(Be,Rv,"Center"),We(Be,kv,"Right"),We(Be,Av,"Justify"),We(Be,Mv,"Top"),We(Be,Dv,"Middle"),We(Be,Pv,"Bottom"),We(Be,yv,"Freeze column"),We(Be,wv,"Unfreeze column"),We(Be,Nv,"Borders"),We(Be,Fv,"Top"),We(Be,Lv,"Right"),We(Be,Iv,"Bottom"),We(Be,Hv,"Left"),We(Be,Bv,"Remove border(s)"),We(Be,Sv,"Add comment"),We(Be,bv,"Edit comment"),We(Be,xv,"Delete comment"),We(Be,Ev,"Read-only comment"),We(Be,_v,"Merge cells"),We(Be,Cv,"Unmerge cells"),We(Be,mv,"Copy"),We(Be,pv,"Cut"),We(Be,Z1,"Insert child row"),We(Be,J1,"Detach from parent"),We(Be,Q1,["Hide column","Hide columns"]),We(Be,e_,["Show column","Show columns"]),We(Be,t_,["Hide row","Hide rows"]),We(Be,r_,["Show row","Show rows"]),We(Be,n_,"None"),We(Be,i_,"Is empty"),We(Be,a_,"Is not empty"),We(Be,o_,"Is equal to"),We(Be,s_,"Is not equal to"),We(Be,l_,"Begins with"),We(Be,u_,"Ends with"),We(Be,f_,"Contains"),We(Be,c_,"Does not contain"),We(Be,h_,"Greater than"),We(Be,d_,"Greater than or equal to"),We(Be,v_,"Less than"),We(Be,g_,"Less than or equal to"),We(Be,m_,"Is between"),We(Be,p_,"Is not between"),We(Be,y_,"After"),We(Be,w_,"Before"),We(Be,__,"Today"),We(Be,C_,"Tomorrow"),We(Be,S_,"Yesterday"),We(Be,O_,"Blank cells"),We(Be,b_,"Filter by condition"),We(Be,x_,"Filter by value"),We(Be,E_,"And"),We(Be,T_,"Or"),We(Be,R_,"Select all"),We(Be,k_,"Clear"),We(Be,A_,"OK"),We(Be,M_,"Cancel"),We(Be,D_,"Search"),We(Be,P_,"Value"),We(Be,N_,"Second value"),Be),Ed=F_.languageCode,vc=Bi("languagesDictionaries"),QA=vc.register,L_=vc.getItem,eM=vc.hasItem,tM=vc.getValues;function I_(e,r){var t=e,n=r;return Rt(e)&&(n=e,t=n.languageCode),rM(t,n),QA(t,Wr(n)),Wr(n)}function H_(e){return Wv(e)?Wr(L_(e)):null}function Wv(e){return eM(e)}function rM(e,r){e!==Ed&&KA(r,L_(Ed))}function nM(){return tM()}I_(F_);function iM(e,r){var t=Array.isArray(e)&&Number.isInteger(r);return t?e[r]:e}var B_=Bi("phraseFormatters"),aM=B_.register,oM=B_.getValues;function sM(e,r){aM(e,r)}function lM(){return oM()}sM("pluralize",iM);function W_(e,r,t){var n=H_(e);if(n===null)return null;var i=n[r];if(Mr(i))return null;var a=uM(i,t);return Array.isArray(a)?a[0]:a}function uM(e,r){var t=e;return pe(lM(),function(n){t=n(e,r)}),t}var Vs=new Ft,Xi=new Set,zo=0;function fM(){zo===0&&(Vs.addEventListener(document,"keydown",function(e){Xi.has(e.keyCode)||Xi.add(e.keyCode)}),Vs.addEventListener(document,"keyup",function(e){Xi.has(e.keyCode)&&Xi.delete(e.keyCode)}),Vs.addEventListener(document,"visibilitychange",function(){document.hidden&&Xi.clear()}),Vs.addEventListener(window,"blur",function(){Xi.clear()})),zo+=1}function cM(){zo>0&&(zo-=1),zo===0&&hM()}function hM(){Vs.clearEvents(),Xi.clear(),zo=0}function Td(){var e=Array.from(Xi.values());return e.some(function(r){return ev(r)})}function dM(e){var r=e.activeHeaderClassName,t=new Cs({highlightHeaderClassName:r});return t}function vM(e){var r=e.layerLevel,t=e.areaCornerVisible,n=new Cs({className:"area",markIntersections:!0,layerLevel:Math.min(r,7),border:{width:1,color:"#4b89ff",cornerVisible:t}});return n}function gM(e){var r=e.cellCornerVisible,t=new Cs({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:r}});return t}function mM(e){var r=e.border,t=e.cellRange,n=new Cs(r,t);return n}function pM(){var e=new Cs({className:"fill",border:{width:1,color:"#ff0000"}});return e}function yM(e){var r=e.headerClassName,t=e.rowClassName,n=e.columnClassName,i=new Cs({className:"highlight",highlightHeaderClassName:r,highlightRowClassName:t,highlightColumnClassName:n});return i}var $_=Bi("highlight/types"),bs=$_.register,wM=$_.getItem;bs("active-header",dM);bs("area",vM);bs("cell",gM);bs("custom-selection",mM);bs("fill",pM);bs("header",yM);function Do(e,r){return wM(e)(r)}function Ui(e){return SM(e)||CM(e)||_M()}function _M(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function CM(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}function SM(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}function Zl(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{},n=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),n.forEach(function(i){bM(e,i,t[i])})}return e}function bM(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function xM(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Dm(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function EM(e,r,t){return r&&Dm(e.prototype,r),t&&Dm(e,t),e}var TM="active-header",U_="area",Od="cell",OM="fill",V_="header",RM="custom-selection",kM=function(){function e(r){xM(this,e),this.options=r,this.layerLevel=0,this.cell=Do(Od,r),this.fill=Do(OM,r),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return EM(e,[{key:"isEnabledFor",value:function(t){var n=t==="current"?Od:t,i=this.options.disableHighlight;return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(n)}},{key:"useLayerLevel",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=t,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var t=this.layerLevel,n;return this.areas.has(t)?n=this.areas.get(t):(n=Do(U_,Zl({layerLevel:t},this.options)),this.areas.set(t,n)),n}},{key:"getAreas",value:function(){return Ui(this.areas.values())}},{key:"createOrGetHeader",value:function(){var t=this.layerLevel,n;return this.headers.has(t)?n=this.headers.get(t):(n=Do(V_,Zl({},this.options)),this.headers.set(t,n)),n}},{key:"getHeaders",value:function(){return Ui(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var t=this.layerLevel,n;return this.activeHeaders.has(t)?n=this.activeHeaders.get(t):(n=Do(TM,Zl({},this.options)),this.activeHeaders.set(t,n)),n}},{key:"getActiveHeaders",value:function(){return Ui(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return Ui(this.customSelections.values())}},{key:"addCustomSelection",value:function(t){this.customSelections.push(Do(RM,Zl({},t)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),pe(this.areas.values(),function(t){return void t.clear()}),pe(this.headers.values(),function(t){return void t.clear()}),pe(this.activeHeaders.values(),function(t){return void t.clear()})}},{key:Symbol.iterator,value:function(){return[this.cell,this.fill].concat(Ui(this.areas.values()),Ui(this.headers.values()),Ui(this.activeHeaders.values()),Ui(this.customSelections))[Symbol.iterator]()}}]),e}();function AM(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Pm(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function MM(e,r,t){return r&&Pm(e.prototype,r),t&&Pm(e,t),e}var DM=function(){function e(){AM(this,e),this.ranges=[]}return MM(e,[{key:"isEmpty",value:function(){return this.size()===0}},{key:"set",value:function(t){return this.clear(),this.ranges.push(new Kr(t)),this}},{key:"add",value:function(t){return this.ranges.push(new Kr(t)),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(t){return this.ranges.some(function(n){return n.includes(t)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=this.size()+t-1,i;return n>=0&&(i=this.ranges[n]),i}},{key:Symbol.iterator,value:function(){return this.ranges[Symbol.iterator]()}}]),e}(),PM="localHooks",Co={_localHooks:Object.create(null),addLocalHook:function(r,t){return this._localHooks[r]||(this._localHooks[r]=[]),this._localHooks[r].push(t),this},runLocalHooks:function(r){for(var t=this,n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];this._localHooks[r]&&pe(this._localHooks[r],function(o){return o.apply(t,i)})},clearLocalHooks:function(){return this._localHooks={},this}};os(Co,"MIXIN_NAME",PM,{writable:!1,enumerable:!1});function NM(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Nm(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function FM(e,r,t){return r&&Nm(e.prototype,r),t&&Nm(e,t),e}var z_=function(){function e(r,t){NM(this,e),this.range=r,this.options=t}return FM(e,[{key:"transformStart",value:function(t,n,i){var a=new me(t,n);this.runLocalHooks("beforeTransformStart",a);var o=this.options.countRows(),s=this.options.countCols(),l=this.options.fixedRowsBottom(),u=this.options.minSpareRows(),f=this.options.minSpareCols(),c=this.options.autoWrapRow(),h=this.options.autoWrapCol(),d=this.range.current().highlight;d.row+t>o-1?i&&u>0&&!(l&&d.row>=o-l-1)?(this.runLocalHooks("insertRowRequire",o),o=this.options.countRows()):h&&(a.row=1-o,a.col=d.col+a.col===s-1?1-s:1):h&&d.row+a.row<0&&d.col+a.col>=0&&(a.row=o-1,a.col=d.col+a.col===0?s-1:-1),d.col+a.col>s-1?i&&f>0?(this.runLocalHooks("insertColRequire",s),s=this.options.countCols()):c&&(a.row=d.row+a.row===o-1?1-o:1,a.col=1-s):c&&d.col+a.col<0&&d.row+a.row>=0&&(a.row=d.row+a.row===0?o-1:-1,a.col=s-1);var g=new me(d.row+a.row,d.col+a.col),v=0,p=0;return g.row<0?(v=-1,g.row=0):g.row>0&&g.row>=o&&(v=1,g.row=o-1),g.col<0?(p=-1,g.col=0):g.col>0&&g.col>=s&&(p=1,g.col=s-1),this.runLocalHooks("afterTransformStart",g,v,p),g}},{key:"transformEnd",value:function(t,n){var i=new me(t,n);this.runLocalHooks("beforeTransformEnd",i);var a=this.options.countRows(),o=this.options.countCols(),s=this.range.current(),l=new me(s.to.row+i.row,s.to.col+i.col),u=0,f=0;return l.row<0?(u=-1,l.row=0):l.row>0&&l.row>=a&&(u=1,l.row=a-1),l.col<0?(f=-1,l.col=0):l.col>0&&l.col>=o&&(f=1,l.col=o-1),this.runLocalHooks("afterTransformEnd",l,u,f),l}}]),e}();vi(z_,Co);function j_(e,r){return HM(e)||IM(e,r)||LM()}function LM(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function IM(e,r){var t=[],n=!0,i=!1,a=void 0;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done)&&(t.push(s.value),!(r&&t.length===r));n=!0);}catch(l){i=!0,a=l}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw a}}return t}function HM(e){if(Array.isArray(e))return e}function Bu(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Bu=function(t){return typeof t}:Bu=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bu(e)}var gc=0,mc=1,Y_=2,$v=3,BM=[$v,Y_],WM=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],dh=Symbol("root"),Fm=Symbol("child");function cs(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:dh;if(r!==dh&&r!==Fm)throw new Error("The second argument is used internally only and cannot be overwritten.");var t=Array.isArray(e),n=r===dh,i=gc;if(t){var a=e[0];if(e.length===0)i=mc;else if(n&&a instanceof Kr)i=$v;else if(n&&Array.isArray(a))i=cs(a,Fm);else if(e.length>=2&&e.length<=4){var o=!e.some(function(s,l){return!WM[l].includes(Bu(s))});o&&(i=Y_)}}return i}function wl(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=r.keepDirection,n=t===void 0?!1:t,i=r.propToCol;if(!BM.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(a){var o=e===$v,s=o?a.from.row:a[0],l=o?a.from.col:a[1],u=o?a.to.row:a[2],f=o?a.to.col:a[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof f=="string"&&(f=i(f))),Mr(u)&&(u=s),Mr(f)&&(f=l),!n){var c=s,h=l,d=u,g=f;s=Math.min(c,d),l=Math.min(h,g),u=Math.max(c,d),f=Math.max(h,g)}return[s,l,u,f]}}function $M(e){var r=cs(e);if(r===gc||r===mc)return[];var t=wl(r),n=new Set;pe(e,function(o){var s=t(o),l=j_(s,4),u=l[1],f=l[3],c=f-u+1;pe(Array.from(new Array(c),function(h,d){return u+d}),function(h){n.has(h)||n.add(h)})});var i=Array.from(n).sort(function(o,s){return o-s}),a=hn(i,function(o,s,l,u){return l!==0&&s===u[l-1]+1?o[o.length-1][1]+=1:o.push([s,1]),o},[]);return a}function UM(e){var r=cs(e);if(r===gc||r===mc)return[];var t=wl(r),n=new Set;pe(e,function(o){var s=t(o),l=j_(s,3),u=l[0],f=l[2],c=f-u+1;pe(Array.from(new Array(c),function(h,d){return u+d}),function(h){n.has(h)||n.add(h)})});var i=Array.from(n).sort(function(o,s){return o-s}),a=hn(i,function(o,s,l,u){return l!==0&&s===u[l-1]+1?o[o.length-1][1]+=1:o.push([s,1]),o},[]);return a}function Vi(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof e=="number"&&e>=0&&e<r}function Lm(e,r){return jM(e)||zM(e,r)||VM()}function VM(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function zM(e,r){var t=[],n=!0,i=!1,a=void 0;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done)&&(t.push(s.value),!(r&&t.length===r));n=!0);}catch(l){i=!0,a=l}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw a}}return t}function jM(e){if(Array.isArray(e))return e}function G_(){var e=YM([`Unsupported format of the selection ranges was passed. To select cells pass 
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, columnEnd/columnPropEnd]]) 
        or as an array of CellRange objects.`]);return G_=function(){return e},e}function YM(e,r){return r||(r=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(r)}}))}function GM(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Im(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function XM(e,r,t){return r&&Im(e.prototype,r),t&&Im(e,t),e}var X_=function(){function e(r,t){var n=this;GM(this,e),this.settings=r,this.tableProps=t,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new DM,this.highlight=new kM({headerClassName:r.currentHeaderClassName,activeHeaderClassName:r.activeHeaderClassName,rowClassName:r.currentRowClassName,columnClassName:r.currentColClassName,disableHighlight:this.settings.disableVisualSelection,cellCornerVisible:function(){return n.isCellCornerVisible.apply(n,arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible.apply(n,arguments)}}),this.transformation=new z_(this.selectedRange,{countRows:function(){return n.tableProps.countRows()},countCols:function(){return n.tableProps.countCols()},fixedRowsBottom:function(){return r.fixedRowsBottom},minSpareRows:function(){return r.minSpareRows},minSpareCols:function(){return r.minSpareCols},autoWrapRow:function(){return r.autoWrapRow},autoWrapCol:function(){return r.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n.runLocalHooks.apply(n,["beforeModifyTransformStart"].concat(a))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n.runLocalHooks.apply(n,["afterModifyTransformStart"].concat(a))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n.runLocalHooks.apply(n,["beforeModifyTransformEnd"].concat(a))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n.runLocalHooks.apply(n,["afterModifyTransformEnd"].concat(a))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n.runLocalHooks.apply(n,["insertRowRequire"].concat(a))}),this.transformation.addLocalHook("insertColRequire",function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n.runLocalHooks.apply(n,["insertColRequire"].concat(a))})}return XM(e,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=this.settings.selectionMode==="multiple",o=Mr(n)?Td():n,s=t.row<0,l=t.col<0,u=s&&l;s&&(t.row=0),l&&(t.col=0),this.selectedByCorner=u,this.runLocalHooks("beforeSetRangeStart".concat(i?"Only":""),t),(!a||a&&!o&&Mr(n))&&this.selectedRange.clear(),this.selectedRange.add(t),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!u&&l&&this.selectedByRowHeader.add(this.getLayerLevel()),!u&&s&&this.selectedByColumnHeader.add(this.getLayerLevel()),i||this.setRangeEnd(t)}},{key:"setRangeStartOnly",value:function(t,n){this.setRangeStart(t,n,!0)}},{key:"setRangeEnd",value:function(t){if(!this.selectedRange.isEmpty()){this.runLocalHooks("beforeSetRangeEnd",t),this.begin();var n=this.selectedRange.current();this.settings.selectionMode!=="single"&&n.setTo(new me(t.row,t.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(Od)&&this.highlight.getCell().add(this.selectedRange.current().highlight);var i=this.getLayerLevel();i<this.highlight.layerLevel&&(pe(this.highlight.getAreas(),function(f){return void f.clear()}),pe(this.highlight.getHeaders(),function(f){return void f.clear()}),pe(this.highlight.getActiveHeaders(),function(f){return void f.clear()})),this.highlight.useLayerLevel(i);var a=this.highlight.createOrGetArea(),o=this.highlight.createOrGetHeader(),s=this.highlight.createOrGetActiveHeader();if(a.clear(),o.clear(),s.clear(),this.highlight.isEnabledFor(U_)&&(this.isMultiple()||i>=1)&&(a.add(n.from).add(n.to),i===1&&(this.highlight.useLayerLevel(i-1).createOrGetArea().add(this.selectedRange.previous().from),this.highlight.useLayerLevel(i))),this.highlight.isEnabledFor(V_)&&(this.settings.selectionMode==="single"?o.add(n.highlight):o.add(n.from).add(n.to)),this.isSelectedByRowHeader()){var l=this.tableProps.countCols()===n.getWidth();l&&s.add(new me(n.from.row,-1)).add(new me(n.to.row,-1))}if(this.isSelectedByColumnHeader()){var u=this.tableProps.countRows()===n.getHeight();u&&s.add(new me(-1,n.from.col)).add(new me(-1,n.to.col))}this.runLocalHooks("afterSetRangeEnd",t)}}},{key:"isMultiple",value:function(){var t=Hl(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",t),t.value}},{key:"transformStart",value:function(t,n,i){this.setRangeStart(this.transformation.transformStart(t,n,i))}},{key:"transformEnd",value:function(t,n){this.setRangeEnd(this.transformation.transformEnd(t,n))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return t===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(t)}},{key:"isSelectedByColumnHeader",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return t===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(t)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(t){return this.selectedRange.includes(t)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(t){return Number.isInteger(t)&&t!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){this.clear(),this.setRangeStart(new me(-1,-1)),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(new me(this.tableProps.countRows()-1,this.tableProps.countCols()-1))}},{key:"selectCells",value:function(t){var n=this,i=cs(t);if(i===mc)return!1;if(i===gc)throw new Error(ci(G_()));var a=wl(i,{propToCol:function(f){return n.tableProps.propToCol(f)},keepDirection:!0}),o=this.tableProps.countRows(),s=this.tableProps.countCols(),l=!t.some(function(u){var f=a(u),c=Lm(f,4),h=c[0],d=c[1],g=c[2],v=c[3],p=Vi(h,o)&&Vi(d,s)&&Vi(g,o)&&Vi(v,s);return!p});return l&&(this.clear(),pe(t,function(u){var f=a(u),c=Lm(f,4),h=c[0],d=c[1],g=c[2],v=c[3];n.setRangeStartOnly(new me(h,d),!1),n.setRangeEnd(new me(g,v)),n.finish()})),l}},{key:"selectColumns",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,i=typeof t=="string"?this.tableProps.propToCol(t):t,a=typeof n=="string"?this.tableProps.propToCol(n):n,o=this.tableProps.countCols(),s=Vi(i,o)&&Vi(a,o);return s&&(this.setRangeStartOnly(new me(-1,i)),this.setRangeEnd(new me(this.tableProps.countRows()-1,a)),this.finish()),s}},{key:"selectRows",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,i=this.tableProps.countRows(),a=Vi(t,i)&&Vi(n,i);return a&&(this.setRangeStartOnly(new me(t,-1)),this.setRangeEnd(new me(n,this.tableProps.countCols()-1)),this.finish()),a}}]),e}();vi(X_,Co);function K_(){var e=KM(["Deprecation warning: This method is going to be removed in the next release.\n      If you want to select a cell using props, please use the `selectCell` method."],["Deprecation warning: This method is going to be removed in the next release.\n      If you want to select a cell using props, please use the \\`selectCell\\` method."]);return K_=function(){return e},e}function KM(e,r){return r||(r=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(r)}}))}function pr(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?pr=function(t){return typeof t}:pr=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pr(e)}function Zn(e,r){return JM(e)||ZM(e,r)||qM()}function qM(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function ZM(e,r){var t=[],n=!0,i=!1,a=void 0;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done)&&(t.push(s.value),!(r&&t.length===r));n=!0);}catch(l){i=!0,a=l}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw a}}return t}function JM(e){if(Array.isArray(e))return e}function zi(e){return tD(e)||eD(e)||QM()}function QM(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function eD(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}function tD(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}var vh=null;function pc(e,r){var t=this,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,a=this,o=function(){},s=new Ft(a),l,u,f,c,h;pn(o.prototype,av.prototype),pn(o.prototype,r),pn(o.prototype,ue(r)),qA(o.prototype,r.language),GA(n)&&YA(this),fM(),this.isDestroyed=!1,this.rootElement=e,this.isHotTableEnv=Rw(this.rootElement),Ft.isHotTableEnv=this.isHotTableEnv,this.container=document.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),this.guid="ht_".concat(X0());var d=Y1(a);f=new WA(a),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid),l={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width","language"],settings:new o,selRange:null,isPopulated:null,scrollable:null,firstRun:!0};var g=new X_(l.settings,{countCols:function(){return a.countCols()},countRows:function(){return a.countRows()},propToCol:function(_){return u.propToCol(_)},isEditorOpened:function(){return a.getActiveEditor()?a.getActiveEditor().isOpened():!1}});this.selection=g,this.selection.addLocalHook("beforeSetRangeStart",function(m){t.runHooks("beforeSetRangeStart",m)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(m){t.runHooks("beforeSetRangeStartOnly",m)}),this.selection.addLocalHook("beforeSetRangeEnd",function(m){t.runHooks("beforeSetRangeEnd",m),m.row<0&&(m.row=t.view.wt.wtTable.getFirstVisibleRow()),m.col<0&&(m.col=t.view.wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(m){var _=Hl(!1),x=t.selection.getSelectedRange(),B=x.current(),Q=B.from,A=B.to,W=x.size()-1;t.runHooks("afterSelection",Q.row,Q.col,A.row,A.col,_,W),t.runHooks("afterSelectionByProp",Q.row,a.colToProp(Q.col),A.row,a.colToProp(A.col),_,W);var ne=t.selection.isSelectedByAnyHeader(),b=t.selection.selectedRange.current(),R=!0;i&&(R=!1),_.isTouched()&&(R=!_.value);var Z=t.selection.isSelectedByRowHeader(),ie=t.selection.isSelectedByColumnHeader();R!==!1&&(ne?Z?t.view.scrollViewportVertically(m.row):ie&&t.view.scrollViewportHorizontally(m.col):b&&!t.selection.isMultiple()?t.view.scrollViewport(b.from):t.view.scrollViewport(m)),Z&&ie?$e(t.rootElement,["ht__selection--rows","ht__selection--columns"]):Z?(pt(t.rootElement,"ht__selection--columns"),$e(t.rootElement,"ht__selection--rows")):ie?(pt(t.rootElement,"ht__selection--rows"),$e(t.rootElement,"ht__selection--columns")):pt(t.rootElement,["ht__selection--rows","ht__selection--columns"]),t._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(m){var _=m.length-1,x=m[_],B=x.from,Q=x.to;t.runHooks("afterSelectionEnd",B.row,B.col,Q.row,Q.col,_),t.runHooks("afterSelectionEndByProp",B.row,a.colToProp(B.col),Q.row,a.colToProp(Q.col),_)}),this.selection.addLocalHook("afterIsMultipleSelection",function(m){var _=t.runHooks("afterIsMultipleSelection",m.value);m.value&&(m.value=_)}),this.selection.addLocalHook("beforeModifyTransformStart",function(m){t.runHooks("modifyTransformStart",m)}),this.selection.addLocalHook("afterModifyTransformStart",function(m,_,x){t.runHooks("afterModifyTransformStart",m,_,x)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(m){t.runHooks("modifyTransformEnd",m)}),this.selection.addLocalHook("afterModifyTransformEnd",function(m,_,x){t.runHooks("afterModifyTransformEnd",m,_,x)}),this.selection.addLocalHook("afterDeselect",function(){h.destroyEditor(),t._refreshBorders(),pt(t.rootElement,["ht__selection--rows","ht__selection--columns"]),t.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(m){t.alter("insert_row",m,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(m){t.alter("insert_col",m,1,"auto")}),c={alter:function(_,x){var B=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,Q=arguments.length>3?arguments[3]:void 0,A=arguments.length>4?arguments[4]:void 0,W;function ne(Se,Ee,Re,ze){var P=function(){var T;return ze==="array"?T=[]:ze==="object"&&(T={}),T},H=Zt(new Array(Re),function(){return P()});H.unshift(Ee,0),Se.splice.apply(Se,zi(H))}var b=function(Ee){if(Ee.length===0)return[];var Re=zi(Ee);Re.sort(function(P,H){var O=Zn(P,1),T=O[0],Y=Zn(H,1),q=Y[0];return T===q?0:T>q?1:-1});var ze=hn(Re,function(P,H){var O=Zn(H,2),T=O[0],Y=O[1],q=P[P.length-1],ae=Zn(q,2),he=ae[0],oe=ae[1],be=he+oe;if(T<=be){var ce=Math.max(Y-(be-T),0);q[1]+=ce}else P.push([T,Y]);return P},[Re[0]]);return ze};switch(_){case"insert_row":var R=a.countSourceRows();if(a.getSettings().maxRows===R)return;x=ir(x)?x:R,W=u.createRow(x,B,Q),ne(l.cellSettings,x,B,"array"),W&&(g.isSelected()&&g.selectedRange.current().from.row>=x?(g.selectedRange.current().from.row+=W,g.transformEnd(W,0)):a._refreshBorders());break;case"insert_col":W=u.createCol(x,B,Q);for(var Z=0,ie=a.countSourceRows();Z<ie;Z++)l.cellSettings[Z]&&ne(l.cellSettings[Z],x,B);if(W){if(Array.isArray(a.getSettings().colHeaders)){var ve=[x,0];ve.length+=W,Array.prototype.splice.apply(a.getSettings().colHeaders,ve)}g.isSelected()&&g.selectedRange.current().from.col>=x?(g.selectedRange.current().from.col+=W,g.transformEnd(0,W)):a._refreshBorders()}break;case"remove_row":var le=function(Ee){var Re=0;pe(Ee,function(ze){var P=Zn(ze,2),H=P[0],O=P[1],T=bn(H)?a.countRows()-1:Math.max(H-Re,0);Number.isInteger(H)&&(H=Math.max(H-Re,0)),u.removeRow(H,O,Q),l.cellSettings.splice(T,B);var Y=a.countRows(),q=a.getSettings().fixedRowsTop;q>=T+1&&(a.getSettings().fixedRowsTop-=Math.min(O,q-T));var ae=a.getSettings().fixedRowsBottom;ae&&T>=Y-ae&&(a.getSettings().fixedRowsBottom-=Math.min(O,ae)),Re+=O})};Array.isArray(x)?le(b(x)):le([[x,B]]),c.adjustRowsAndCols(),a._refreshBorders();break;case"remove_col":var ge=function(Ee){var Re=0;pe(Ee,function(ze){var P=Zn(ze,2),H=P[0],O=P[1],T=bn(H)?a.countCols()-1:Math.max(H-Re,0),Y=d.toPhysicalColumn(T);Number.isInteger(H)&&(H=Math.max(H-Re,0)),u.removeCol(H,O,Q);for(var q=0,ae=a.countSourceRows();q<ae;q++)l.cellSettings[q]&&l.cellSettings[q].splice(Y,O);var he=a.getSettings().fixedColumnsLeft;he>=T+1&&(a.getSettings().fixedColumnsLeft-=Math.min(O,he-T)),Array.isArray(a.getSettings().colHeaders)&&(typeof Y>"u"&&(Y=-1),a.getSettings().colHeaders.splice(Y,O)),Re+=O})};Array.isArray(x)?ge(b(x)):ge([[x,B]]),c.adjustRowsAndCols(),a._refreshBorders();break;default:throw new Error('There is no such action "'.concat(_,'"'))}A||c.adjustRowsAndCols()},adjustRowsAndCols:function(){if(l.settings.minRows){var _=a.countRows();if(_<l.settings.minRows)for(var x=0,B=l.settings.minRows;x<B-_;x++)u.createRow(a.countRows(),1,"auto")}if(l.settings.minSpareRows){var Q=a.countEmptyRows(!0);if(Q<l.settings.minSpareRows)for(;Q<l.settings.minSpareRows&&a.countSourceRows()<l.settings.maxRows;Q++)u.createRow(a.countRows(),1,"auto")}{var A;if((l.settings.minCols||l.settings.minSpareCols)&&(A=a.countEmptyCols(!0)),l.settings.minCols&&!l.settings.columns&&a.countCols()<l.settings.minCols)for(;a.countCols()<l.settings.minCols;A++)u.createCol(a.countCols(),1,"auto");if(l.settings.minSpareCols&&!l.settings.columns&&a.dataType==="array"&&A<l.settings.minSpareCols)for(;A<l.settings.minSpareCols&&a.countCols()<l.settings.maxCols;A++)u.createCol(a.countCols(),1,"auto")}var W=a.countRows(),ne=a.countCols();(W===0||ne===0)&&g.deselect(),g.isSelected()&&pe(g.selectedRange,function(b){var R=!1,Z=b.from.row,ie=b.from.col,ve=b.to.row,le=b.to.col;Z>W-1?(Z=W-1,R=!0,ve>Z&&(ve=Z)):ve>W-1&&(ve=W-1,R=!0,Z>ve&&(Z=ve)),ie>ne-1?(ie=ne-1,R=!0,le>ie&&(le=ie)):le>ne-1&&(le=ne-1,R=!0,ie>le&&(ie=le)),R&&a.selectCell(Z,ie,ve,le)}),a.view&&a.view.wt.wtOverlays.adjustElementsSize()},populateFromArray:function(_,x,B,Q,A,W,ne){var b,R,Z,ie,ve=[],le={};if(R=x.length,R===0)return!1;var ge,Se,Ee,Re;switch(A){case"shift_down":for(ge=B?B.col-_.col+1:0,Se=B?B.row-_.row+1:0,x=j1(x),Z=0,ie=x.length,Ee=Math.max(ie,ge);Z<Ee;Z++)if(Z<ie){var ze;for(b=0,R=x[Z].length;b<Se-R;b++)x[Z].push(x[Z][b%R]);x[Z].unshift(_.col+Z,_.row,0),(ze=a).spliceCol.apply(ze,zi(x[Z]))}else{var P;x[Z%ie][0]=_.col+Z,(P=a).spliceCol.apply(P,zi(x[Z%ie]))}break;case"shift_right":for(ge=B?B.col-_.col+1:0,Se=B?B.row-_.row+1:0,b=0,R=x.length,Re=Math.max(R,Se);b<Re;b++)if(b<R){var H;for(Z=0,ie=x[b].length;Z<ge-ie;Z++)x[b].push(x[b][Z%ie]);x[b].unshift(_.row+b,_.col,0),(H=a).spliceRow.apply(H,zi(x[b]))}else{var O;x[b%R][0]=_.row+b,(O=a).spliceRow.apply(O,zi(x[b%R]))}break;case"overwrite":default:le.row=_.row,le.col=_.col;var T={row:B&&_?B.row-_.row+1:1,col:B&&_?B.col-_.col+1:1},Y=0,q=0,ae=!0,he,oe=function(Ve){var Ie=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,Xe=x[Ve%x.length];return Ie!==null?Xe[Ie%Xe.length]:Xe},be=x.length,ce=B?B.row-_.row+1:0;for(B?R=ce:R=Math.max(be,ce),b=0;b<R&&!(B&&le.row>B.row&&ce>be||!l.settings.allowInsertRow&&le.row>a.countRows()-1||le.row>=l.settings.maxRows);b++){var Ce=b-Y,Me=oe(Ce).length,Fe=B?B.col-_.col+1:0;if(B?ie=Fe:ie=Math.max(Me,Fe),le.col=_.col,he=a.getCellMeta(le.row,le.col),(Q==="CopyPaste.paste"||Q==="Autofill.autofill")&&he.skipRowOnPaste){Y+=1,le.row+=1,R+=1;continue}for(q=0,Z=0;Z<ie&&!(B&&le.col>B.col&&Fe>Me||!l.settings.allowInsertColumn&&le.col>a.countCols()-1||le.col>=l.settings.maxCols);Z++){if(he=a.getCellMeta(le.row,le.col),(Q==="CopyPaste.paste"||Q==="Autofill.fill")&&he.skipColumnOnPaste){q+=1,le.col+=1,ie+=1;continue}if(he.readOnly){le.col+=1;continue}var ke=Z-q,de=oe(Ce,ke),Oe=a.getDataAtCell(le.row,le.col),we={row:Ce,col:ke};if(Q==="Autofill.fill"){var et=a.runHooks("beforeAutofillInsidePopulate",we,W,x,ne,{},T);et&&(de=Mr(et.value)?de:et.value)}if(de!==null&&pr(de)==="object")if(Oe===null||pr(Oe)!=="object")ae=!1;else{var ut=as(Oe[0]||Oe),nt=as(de[0]||de);x0(ut,nt)?de=Wr(de):ae=!1}else Oe!==null&&pr(Oe)==="object"&&(ae=!1);ae&&ve.push([le.row,le.col,de]),ae=!0,le.col+=1}le.row+=1}a.setDataAtCell(ve,null,null,Q||"populateFromArray");break}}};function v(m){var _=K1(m);Wv(_)?(a.runHooks("beforeLanguageChange",_),o.prototype.language=_,a.runHooks("afterLanguageChange",_)):q1(m)}this.init=function(){f.setData(l.settings.data),a.runHooks("beforeInit"),ui()&&$e(a.rootElement,"mobile"),this.updateSettings(l.settings,!0),this.view=new Pr(this),h=xd.getInstance(a,l,g,u),this.forceFullRender=!0,a.runHooks("init"),this.view.render(),pr(l.firstRun)==="object"&&(a.runHooks("afterChange",l.firstRun[0],l.firstRun[1]),l.firstRun=!1),a.runHooks("afterInit")};function p(){var m=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,m=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){this.validatorsInQueue===0&&m===!1&&(m=!0,this.onQueueEmpty(this.valid))}}}function C(m){var _=m.replace(",",".");return isNaN(parseFloat(_))===!1?parseFloat(_):m}function F(m,_,x){var B=new p,Q=function(ge){return ge.length>0&&/^\s*[+-.]?\s*(?:(?:\d+(?:(\.|,)\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/.test(ge)};B.onQueueEmpty=ve;for(var A=m.length-1;A>=0;A--)if(m[A]===null)m.splice(A,1);else{var W=Zn(m[A],4),ne=W[0],b=W[1],R=W[3],Z=u.propToCol(b),ie=a.getCellMeta(ne,Z);ie.type==="numeric"&&typeof R=="string"&&Q(R)&&(m[A][3]=C(R)),a.getCellValidator(ie)&&(B.addValidatorToQueue(),a.validateCell(m[A][3],ie,function(le,ge){return function(Se){if(typeof Se!="boolean")throw new Error("Validation error: result is not boolean");if(Se===!1&&ge.allowInvalid===!1){m.splice(le,1),ge.valid=!0;var Ee=a.getCell(ge.visualRow,ge.visualCol);Ee!==null&&pt(Ee,a.getSettings().invalidCellClassName)}B.removeValidatorFormQueue()}}(A,ie),_))}B.checkIfQueueIsEmpty();function ve(){var le;m.length&&(le=a.runHooks("beforeChange",m,_||"edit"),Or(le)?fa("Your beforeChange callback returns a function. It's not supported since Handsontable 0.12.1 (and the returned function will not be executed)."):le===!1&&m.splice(0,m.length)),x()}}function D(m,_){var x=m.length-1;if(!(x<0)){for(;x>=0;x--){var B=!1;if(m[x]===null){m.splice(x,1);continue}if(!((m[x][2]===null||m[x][2]===void 0)&&(m[x][3]===null||m[x][3]===void 0))){if(l.settings.allowInsertRow)for(;m[x][0]>a.countRows()-1;){var Q=u.createRow(void 0,void 0,_);if(Q===0){B=!0;break}}if(!B){if(a.dataType==="array"&&(!l.settings.columns||l.settings.columns.length===0)&&l.settings.allowInsertColumn)for(;u.propToCol(m[x][1])>a.countCols()-1;)u.createCol(void 0,void 0,_);u.set(m[x][0],m[x][1],m[x][3])}}}a.forceFullRender=!0,c.adjustRowsAndCols(),a.runHooks("beforeChangeRender",m,_),h.lockEditor(),a._refreshBorders(null),h.unlockEditor(),a.view.wt.wtOverlays.adjustElementsSize(),a.runHooks("afterChange",m,_||"edit");var A=a.getActiveEditor();A&&ir(A.refreshValue)&&A.refreshValue()}}this.validateCell=function(m,_,x,B){var Q=a.getCellValidator(_);function A(W){var ne=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!ne||_.hidden===!0){x(W);return}var b=_.visualCol,R=_.visualRow,Z=a.getCell(R,b,!0);Z&&Z.nodeName!=="TH"&&a.view.wt.wtSettings.settings.cellRenderer(R,b,Z),x(W)}O1(Q)&&(Q=function(W){return function(ne,b){b(W.test(ne))}}(Q)),Or(Q)?(m=a.runHooks("beforeValidate",m,_.visualRow,_.prop,B),a._registerTimeout(setTimeout(function(){Q.call(_,m,function(W){W=a.runHooks("afterValidate",W,m,_.visualRow,_.prop,B),_.valid=W,A(W),a.runHooks("postAfterValidate",W,m,_.visualRow,_.prop,B)})},0))):a._registerTimeout(setTimeout(function(){_.valid=!0,A(_.valid,!1)},0))};function ee(m,_,x){return pr(m)==="object"?m:[[m,_,x]]}this.setDataAtCell=function(m,_,x,B){var Q=ee(m,_,x),A=[],W=B,ne,b,R;for(ne=0,b=Q.length;ne<b;ne++){if(pr(Q[ne])!=="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof Q[ne][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");R=u.colToProp(Q[ne][1]),A.push([Q[ne][0],R,f.getAtCell(d.toPhysicalRow(Q[ne][0]),Q[ne][1]),Q[ne][2]])}!W&&pr(m)==="object"&&(W=_),a.runHooks("afterSetDataAtCell",A,W),F(A,W,function(){D(A,W)})},this.setDataAtRowProp=function(m,_,x,B){var Q=ee(m,_,x),A=[],W=B,ne,b;for(ne=0,b=Q.length;ne<b;ne++)A.push([Q[ne][0],Q[ne][1],f.getAtCell(d.toPhysicalRow(Q[ne][0]),Q[ne][1]),Q[ne][2]]);!W&&pr(m)==="object"&&(W=_),a.runHooks("afterSetDataAtRowProp",A,W),F(A,W,function(){D(A,W)})},this.listen=function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(m){var _=!document.activeElement||document.activeElement&&document.activeElement.nodeName===void 0;document.activeElement&&document.activeElement!==document.body&&!_?document.activeElement.blur():_&&document.body.focus()}a&&!a.isListening()&&(vh=a.guid,a.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(vh=null,a.runHooks("afterUnlisten"))},this.isListening=function(){return vh===a.guid},this.destroyEditor=function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;a._refreshBorders(m,_)},this.populateFromArray=function(m,_,x,B,Q,A,W,ne,b){if(!(pr(x)==="object"&&pr(x[0])==="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");var R=typeof B=="number"?new me(B,Q):null;return c.populateFromArray(new me(m,_),x,R,A,W,ne,b)},this.spliceCol=function(m,_,x){for(var B,Q=arguments.length,A=new Array(Q>3?Q-3:0),W=3;W<Q;W++)A[W-3]=arguments[W];return(B=u).spliceCol.apply(B,[m,_,x].concat(A))},this.spliceRow=function(m,_,x){for(var B,Q=arguments.length,A=new Array(Q>3?Q-3:0),W=3;W<Q;W++)A[W-3]=arguments[W];return(B=u).spliceRow.apply(B,[m,_,x].concat(A))},this.getSelected=function(){if(g.isSelected())return Zt(g.getSelectedRange(),function(m){var _=m.from,x=m.to;return[_.row,_.col,x.row,x.col]})},this.getSelectedLast=function(){var m=this.getSelected(),_;return m&&m.length>0&&(_=m[m.length-1]),_},this.getSelectedRange=function(){if(g.isSelected())return Array.from(g.getSelectedRange())},this.getSelectedRangeLast=function(){var m=this.getSelectedRange(),_;return m&&m.length>0&&(_=m[m.length-1]),_},this.emptySelectedCells=function(){var m=this;if(g.isSelected()){var _=[];pe(g.getSelectedRange(),function(x){var B=x.getTopLeftCorner(),Q=x.getBottomRightCorner();Ke(B.row,Q.row,function(A){Ke(B.col,Q.col,function(W){m.getCellMeta(A,W).readOnly||_.push([A,W,""])})})}),_.length>0&&this.setDataAtCell(_)}},this.render=function(){a.view&&(a.renderCall=!0,a.forceFullRender=!0,h.lockEditor(),a._refreshBorders(null),h.unlockEditor())},this.loadData=function(m){if(Array.isArray(l.settings.dataSchema)?a.dataType="array":Or(l.settings.dataSchema)?a.dataType="function":a.dataType="object",u&&u.destroy(),u=new bt(a,l,o),pr(m)==="object"&&m!==null)m.push&&m.splice||(m=[m]);else if(m===null){var _=u.getSchema();m=[];var x,B=0,Q=0;for(B=0,Q=l.settings.startRows;B<Q;B++)if((a.dataType==="object"||a.dataType==="function")&&l.settings.dataSchema)x=Wr(_),m.push(x);else if(a.dataType==="array")x=Wr(_[0]),m.push(x);else{x=[];for(var A=0,W=l.settings.startCols;A<W;A++)x.push(null);m.push(x)}}else throw new Error("loadData only accepts array of objects or array of arrays (".concat(pr(m)," given)"));l.isPopulated=!1,o.prototype.data=m,Array.isArray(m[0])&&(a.dataType="array"),u.dataSource=m,f.data=m,f.dataType=a.dataType,f.colToProp=u.colToProp.bind(u),f.propToCol=u.propToCol.bind(u),ne(),c.adjustRowsAndCols(),a.runHooks("afterLoadData",l.firstRun),l.firstRun?l.firstRun=[null,"loadData"]:(a.runHooks("afterChange",null,"loadData"),a.render()),l.isPopulated=!0;function ne(){l.cellSettings.length=0}},this.getData=function(m,_,x,B){return Mr(m)?u.getAll():u.getRange(new me(m,_),new me(x,B),u.DESTINATION_RENDERER)},this.getCopyableText=function(m,_,x,B){return u.getCopyableText(new me(m,_),new me(x,B))},this.getCopyableData=function(m,_){return u.getCopyable(m,u.colToProp(_))},this.getSchema=function(){return u.getSchema()},this.updateSettings=function(m){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,x=!1,B,Q,A;if(ir(m.rows))throw new Error('"rows" setting is no longer supported. do you mean startRows, minRows or maxRows?');if(ir(m.cols))throw new Error('"cols" setting is no longer supported. do you mean startCols, minCols or maxCols?');for(B in m)if(B!=="data")if(B==="language"){v(m.language);continue}else at.getSingleton().getRegistered().indexOf(B)>-1?(Or(m[B])||Array.isArray(m[B]))&&(m[B].initialHook=!0,a.addHook(B,m[B])):!_&&At(m,B)&&(o.prototype[B]=m[B]);m.data===void 0&&l.settings.data===void 0?a.loadData(null):m.data!==void 0?a.loadData(m.data):m.columns!==void 0&&u.createMap(),A=a.countCols();var W=m.columns||o.prototype.columns;if(W&&Or(W)&&(A=a.countSourceCols(),x=!0),(m.cell!==void 0||m.cells!==void 0||m.columns!==void 0)&&(l.cellSettings.length=0),A>0){var ne,b;for(B=0,Q=0;B<A;B++)x&&!W(B)||(l.columnSettings[Q]=Js(o,l.columnsSettingConflicts),ne=l.columnSettings[Q].prototype,W&&(x?b=W(B):b=W[Q],b&&(pn(ne,b),pn(ne,ue(b)))),Q+=1)}ir(m.cell)&&St(m.cell,function(ge){a.setCellMetaObject(ge.row,ge.col,ge)}),a.runHooks("afterCellMetaReset"),ir(m.className)&&(o.prototype.className&&pt(a.rootElement,o.prototype.className),m.className&&$e(a.rootElement,m.className));var R=a.rootElement.style.height;R!==""&&(R=parseInt(a.rootElement.style.height,10));var Z=m.height;if(Or(Z)&&(Z=Z()),_){var ie=a.rootElement.getAttribute("style");ie&&a.rootElement.setAttribute("data-initialstyle",a.rootElement.getAttribute("style"))}if(Z===null){var ve=a.rootElement.getAttribute("data-initialstyle");ve&&(ve.indexOf("height")>-1||ve.indexOf("overflow")>-1)?a.rootElement.setAttribute("style",ve):(a.rootElement.style.height="",a.rootElement.style.overflow="")}else Z!==void 0&&(a.rootElement.style.height="".concat(Z,"px"),a.rootElement.style.overflow="hidden");if(typeof m.width<"u"){var le=m.width;Or(le)&&(le=le()),a.rootElement.style.width="".concat(le,"px")}_||(u.clearLengthCache(),a.view&&a.view.wt.wtViewport.resetHasOversizedColumnHeadersMarked(),a.runHooks("afterUpdateSettings",m)),c.adjustRowsAndCols(),a.view&&!l.firstRun&&(a.forceFullRender=!0,h.lockEditor(),a._refreshBorders(null),h.unlockEditor()),!_&&a.view&&(R===""||Z===""||Z===void 0)&&R!==Z&&a.view.wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var m=a.getSelectedLast();if(o.prototype.getValue){if(Or(o.prototype.getValue))return o.prototype.getValue.call(a);if(m)return a.getData()[m[0][0]][o.prototype.getValue]}else if(m)return a.getDataAtCell(m[0],m[1])};function ue(m){if(At(m,"type")){var _={},x;pr(m.type)==="object"?x=m.type:typeof m.type=="string"&&(x=hc(m.type));for(var B in x)At(x,B)&&!At(m,B)&&(_[B]=x[B]);return _}}this.getSettings=function(){return l.settings},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(m,_,x,B,Q){c.alter(m,_,x,B,Q)},this.getCell=function(m,_){var x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return a.view.getCellAtCoords(new me(m,_),x)},this.getCoords=function(m){return this.view.wt.wtTable.getCoords.call(this.view.wt.wtTable,m)},this.colToProp=function(m){return u.colToProp(m)},this.propToCol=function(m){return u.propToCol(m)},this.toVisualRow=function(m){return d.toVisualRow(m)},this.toVisualColumn=function(m){return d.toVisualColumn(m)},this.toPhysicalRow=function(m){return d.toPhysicalRow(m)},this.toPhysicalColumn=function(m){return d.toPhysicalColumn(m)},this.getDataAtCell=function(m,_){return u.get(m,u.colToProp(_))},this.getDataAtRowProp=function(m,_){return u.get(m,_)},this.getDataAtCol=function(m){var _;return(_=[]).concat.apply(_,zi(u.getRange(new me(0,m),new me(l.settings.data.length-1,m),u.DESTINATION_RENDERER)))},this.getDataAtProp=function(m){var _,x=u.getRange(new me(0,u.propToCol(m)),new me(l.settings.data.length-1,u.propToCol(m)),u.DESTINATION_RENDERER);return(_=[]).concat.apply(_,zi(x))},this.getSourceData=function(m,_,x,B){var Q;return m===void 0?Q=f.getData():Q=f.getByRange(new me(m,_),new me(x,B)),Q},this.getSourceDataArray=function(m,_,x,B){var Q;return m===void 0?Q=f.getData(!0):Q=f.getByRange(new me(m,_),new me(x,B),!0),Q},this.getSourceDataAtCol=function(m){return f.getAtColumn(m)},this.getSourceDataAtRow=function(m){return f.getAtRow(m)},this.getSourceDataAtCell=function(m,_){return f.getAtCell(m,_)},this.getDataAtRow=function(m){var _=u.getRange(new me(m,0),new me(m,this.countCols()-1),u.DESTINATION_RENDERER);return _[0]||[]},this.getDataType=function(m,_,x,B){var Q=this,A=m===void 0?[0,0,this.countRows(),this.countCols()]:[m,_,x,B],W=A[0],ne=A[1],b=A[2],R=A[3],Z=null,ie=null;b===void 0&&(b=W),R===void 0&&(R=ne);var ve="mixed";return Ke(Math.min(W,b),Math.max(W,b),function(le){var ge=!0;return Ke(Math.min(ne,R),Math.max(ne,R),function(Se){var Ee=Q.getCellMeta(le,Se);return ie=Ee.type,Z?ge=Z===ie:Z=ie,ge}),ve=ge?ie:"mixed",ge}),ve},this.removeCellMeta=function(m,_,x){var B=d.toPhysical(m,_),Q=Zn(B,2),A=Q[0],W=Q[1],ne=l.cellSettings[A][W][x],b=a.runHooks("beforeRemoveCellMeta",m,_,x,ne);b!==!1&&(delete l.cellSettings[A][W][x],a.runHooks("afterRemoveCellMeta",m,_,x,ne)),ne=null},this.spliceCellsMeta=function(m,_){for(var x,B=arguments.length,Q=new Array(B>2?B-2:0),A=2;A<B;A++)Q[A-2]=arguments[A];(x=l.cellSettings).splice.apply(x,[m,_].concat(Q))},this.setCellMetaObject=function(m,_,x){var B=this;pr(x)==="object"&&St(x,function(Q,A){B.setCellMeta(m,_,A,Q)})},this.setCellMeta=function(m,_,x,B){var Q=d.toPhysical(m,_),A=Zn(Q,2),W=A[0],ne=A[1];l.columnSettings[ne]||(l.columnSettings[ne]=Js(o,l.columnsSettingConflicts)),l.cellSettings[W]||(l.cellSettings[W]=[]),l.cellSettings[W][ne]||(l.cellSettings[W][ne]=new l.columnSettings[ne]),l.cellSettings[W][ne][x]=B,a.runHooks("afterSetCellMeta",m,_,x,B)},this.getCellsMeta=function(){return b0(l.cellSettings)},this.getCellMeta=function(m,_){var x=u.colToProp(_),B=d.toPhysical(m,_),Q=Zn(B,2),A=Q[0],W=Q[1],ne=A;ne===null&&(ne=m),l.columnSettings[W]||(l.columnSettings[W]=Js(o,l.columnsSettingConflicts)),l.cellSettings[ne]||(l.cellSettings[ne]=[]),l.cellSettings[ne][W]||(l.cellSettings[ne][W]=new l.columnSettings[W]);var b=l.cellSettings[ne][W];if(b.row=ne,b.col=W,b.visualRow=m,b.visualCol=_,b.prop=x,b.instance=a,a.runHooks("beforeGetCellMeta",m,_,b),pn(b,ue(b)),b.cells){var R=b.cells.call(b,ne,W,x);R&&(pn(b,R),pn(b,ue(R)))}return a.runHooks("afterGetCellMeta",m,_,b),b},this.getCellMetaAtRow=function(m){return l.cellSettings[m]},this.isColumnModificationAllowed=function(){return!(a.dataType==="object"||a.getSettings().columns)};var se=Qs("renderer");this.getCellRenderer=function(m,_){return Dr(se.call(this,m,_))},this.getCellEditor=Qs("editor");var U=Qs("validator");this.getCellValidator=function(m,_){var x=U.call(this,m,_);return typeof x=="string"&&(x=xa(x)),x},this.validateCells=function(m){this._validateCells(m)},this.validateRows=function(m,_){if(!Array.isArray(m))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(_,m)},this.validateColumns=function(m,_){if(!Array.isArray(m))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(_,void 0,m)},this._validateCells=function(m,_,x){var B=new p;m&&(B.onQueueEmpty=m);for(var Q=a.countRows()-1;Q>=0;){if(_!==void 0&&_.indexOf(Q)===-1){Q-=1;continue}for(var A=a.countCols()-1;A>=0;){if(x!==void 0&&x.indexOf(A)===-1){A-=1;continue}B.addValidatorToQueue(),a.validateCell(a.getDataAtCell(Q,A),a.getCellMeta(Q,A),function(W){if(typeof W!="boolean")throw new Error("Validation error: result is not boolean");W===!1&&(B.valid=!1),B.removeValidatorFormQueue()},"validateCells"),A-=1}Q-=1}B.checkIfQueueIsEmpty()},this.getRowHeader=function(m){var _=l.settings.rowHeaders,x=m;return x!==void 0&&(x=a.runHooks("modifyRowHeader",x)),x===void 0?(_=[],Ke(a.countRows()-1,function(B){_.push(a.getRowHeader(B))})):Array.isArray(_)&&_[x]!==void 0?_=_[x]:Or(_)?_=_(x):_&&typeof _!="string"&&typeof _!="number"&&(_=x+1),_},this.hasRowHeaders=function(){return!!l.settings.rowHeaders},this.hasColHeaders=function(){if(l.settings.colHeaders!==void 0&&l.settings.colHeaders!==null)return!!l.settings.colHeaders;for(var m=0,_=a.countCols();m<_;m++)if(a.getColHeader(m))return!0;return!1},this.getColHeader=function(m){var _=l.settings.columns&&Or(l.settings.columns),x=a.runHooks("modifyColHeader",m),B=l.settings.colHeaders;if(x===void 0){for(var Q=[],A=_?a.countSourceCols():a.countCols(),W=0;W<A;W++)Q.push(a.getColHeader(W));B=Q}else{var ne=function(ve){for(var le=[],ge=a.countSourceCols(),Se=0;Se<ge;Se++)Or(a.getSettings().columns)&&a.getSettings().columns(Se)&&le.push(Se);return le[ve]},b=x,R=a.runHooks("modifyCol",b),Z=ne(R);l.settings.colHeaders===!1?B=null:l.settings.columns&&Or(l.settings.columns)&&l.settings.columns(Z)&&l.settings.columns(Z).title?B=l.settings.columns(Z).title:l.settings.columns&&l.settings.columns[R]&&l.settings.columns[R].title?B=l.settings.columns[R].title:Array.isArray(l.settings.colHeaders)&&l.settings.colHeaders[R]!==void 0?B=l.settings.colHeaders[R]:Or(l.settings.colHeaders)?B=l.settings.colHeaders(R):l.settings.colHeaders&&typeof l.settings.colHeaders!="string"&&typeof l.settings.colHeaders!="number"&&(B=dc(b))}return B},this._getColWidthFromSettings=function(m){var _=a.getCellMeta(0,m),x=_.width;if((x===void 0||x===l.settings.width)&&(x=_.colWidths),x!=null){switch(pr(x)){case"object":x=x[m];break;case"function":x=x(m);break}typeof x=="string"&&(x=parseInt(x,10))}return x},this.getColWidth=function(m){var _=a._getColWidthFromSettings(m);return _=a.runHooks("modifyColWidth",_,m),_===void 0&&(_=T0.DEFAULT_WIDTH),_},this._getRowHeightFromSettings=function(m){var _=l.settings.rowHeights;if(_!=null){switch(pr(_)){case"object":_=_[m];break;case"function":_=_(m);break}typeof _=="string"&&(_=parseInt(_,10))}return _},this.getRowHeight=function(m){var _=a._getRowHeightFromSettings(m);return _=a.runHooks("modifyRowHeight",_,m),_},this.countSourceRows=function(){var m=a.runHooks("modifySourceLength");return m||(a.getSourceData()?a.getSourceData().length:0)},this.countSourceCols=function(){var m=0,_=a.getSourceData()&&a.getSourceData()[0]?a.getSourceData()[0]:[];return Rt(_)?m=E0(_):m=_.length||0,m},this.countRows=function(){return u.getLength()},this.countCols=function(){var m=this.getSettings().maxCols,_=!1,x=0;if(a.dataType==="array"&&(_=l.settings.data&&l.settings.data[0]&&l.settings.data[0].length),_&&(x=l.settings.data[0].length),l.settings.columns){var B=Or(l.settings.columns);if(B)if(a.dataType==="array"){for(var Q=0,A=0;A<x;A++)l.settings.columns(A)&&(Q+=1);x=Q}else(a.dataType==="object"||a.dataType==="function")&&(x=u.colToPropCache.length);else x=l.settings.columns.length}else(a.dataType==="object"||a.dataType==="function")&&(x=u.colToPropCache.length);return Math.min(m,x)},this.rowOffset=function(){return a.view.wt.wtTable.getFirstRenderedRow()},this.colOffset=function(){return a.view.wt.wtTable.getFirstRenderedColumn()},this.countRenderedRows=function(){return a.view.wt.drawn?a.view.wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return a.view.wt.drawn?a.view.wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return a.view.wt.drawn?a.view.wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return a.view.wt.drawn?a.view.wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,_=0;return fs(a.countRows()-1,function(x){if(a.isEmptyRow(x))_+=1;else if(m===!0)return!1}),_},this.countEmptyCols=function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(a.countRows()<1)return 0;var _=0;return fs(a.countCols()-1,function(x){if(a.isEmptyCol(x))_+=1;else if(m===!0)return!1}),_},this.isEmptyRow=function(m){return l.settings.isEmptyRow.call(a,m)},this.isEmptyCol=function(m){return l.settings.isEmptyCol.call(a,m)},this.selectCell=function(m,_,x,B){var Q=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,A=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Mr(m)||Mr(_)?!1:this.selectCells([[m,_,x,B]],Q,A)},this.selectCells=function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;_===!1&&(i=!0);var B=g.selectCells(m);return B&&x&&a.listen(),i=!1,B},this.selectCellByProp=function(m,_,x,B){var Q=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,A=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return fa(ci(K_())),this.selectCells([[m,_,x,B]],Q,A)},this.selectColumns=function(m){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m;return g.selectColumns(m,_)},this.selectRows=function(m){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m;return g.selectRows(m,_)},this.deselectCell=function(){g.deselect()},this.selectAll=function(){i=!0,g.selectAll(),i=!1},this.scrollViewportTo=function(m,_){var x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,B=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,Q=!x,A=!B,W=!1;return m!==void 0&&_!==void 0&&(W=a.view.scrollViewport(new me(m,_),Q,B,x,A)),typeof m=="number"&&typeof _!="number"&&(W=a.view.scrollViewportVertically(m,Q,x)),typeof _=="number"&&typeof m!="number"&&(W=a.view.scrollViewportHorizontally(_,B,A)),W},this.destroy=function(){a._clearTimeouts(),a._clearImmediates(),a.view&&a.view.destroy(),f&&f.destroy(),f=null,cM(),Gn(a.rootElement),s.destroy(),h&&h.destroy(),a.runHooks("afterDestroy"),at.getSingleton().destroy(a),St(a,function(m,_,x){Or(m)?x[_]=re(_):_!=="guid"&&(x[_]=null)}),a.isDestroyed=!0,u&&u.destroy(),u=null,l=null,c=null,g=null,h=null,a=null,o=null};function re(m){return function(){throw new Error('The "'.concat(m,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.getActiveEditor=function(){return h.getActiveEditor()},this.getPlugin=function(m){return kA(this,m)},this.getInstance=function(){return a},this.addHook=function(m,_){at.getSingleton().add(m,_,a)},this.hasHook=function(m){return at.getSingleton().has(m,a)},this.addHookOnce=function(m,_){at.getSingleton().once(m,_,a)},this.removeHook=function(m,_){at.getSingleton().remove(m,_,a)},this.runHooks=function(m,_,x,B,Q,A,W){return at.getSingleton().run(a,m,_,x,B,Q,A,W)},this.getTranslatedPhrase=function(m,_){return W_(l.settings.language,m,_)},this.timeouts=[],this._registerTimeout=function(m){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,x=m;typeof x=="function"&&(x=setTimeout(x,_)),this.timeouts.push(x)},this._clearTimeouts=function(){pe(this.timeouts,function(m){clearTimeout(m)})},this.immediates=[],this._registerImmediate=function(m){this.immediates.push(setImmediate(m))},this._clearImmediates=function(){pe(this.immediates,function(m){clearImmediate(m)})},this._refreshBorders=function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;h.destroyEditor(m),a.view.render(),_&&g.isSelected()&&h.prepareEditor()},at.getSingleton().run(a,"construct")}function rD(e){var r=typeof window>"u"?!1:window.jQuery;r&&(r.fn.handsontable=function(t){var n=this.first(),i=n.data("handsontable");if(typeof t!="string"){var a=t||{};return i?i.updateSettings(a):(i=new e.Core(n[0],a),n.data("handsontable",i),i.init()),n}var o;if(i)if(typeof i[t]<"u"){for(var s,l=arguments.length,u=new Array(l>1?l-1:0),f=1;f<l;f++)u[f-1]=arguments[f];o=(s=i[t]).call.apply(s,[i].concat(u)),t==="destroy"&&n.removeData()}else throw new Error("Handsontable do not provide action: ".concat(t));return o})}function nD(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Hm(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function iD(e,r,t){return r&&Hm(e.prototype,r),t&&Hm(e,t),e}var Uv=function(){function e(r){nD(this,e),this.hot=r,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return iD(e,[{key:"addRow",value:function(t,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var i={row:t};this.rows.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(t)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}},{key:"addColumnHeadersRow",value:function(t){var n=this.hot.getColHeader(0);if(n!=null){var i={row:-1};this.rows.push(i),this.container=this.createContainer(this.hot.rootElement.className),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tHead.appendChild(this.createColumnHeadersRow()),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}}},{key:"addColumn",value:function(t,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var i={col:t};this.columns.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(t)!==null&&this.hot.view.appendColHeader(t,this.table.th),this.table.tBody.appendChild(this.createCol(t)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}},{key:"getHeights",value:function(t){this.injected||this.injectTable(),pe(this.rows,function(n){t(n.row,sr(n.table)-1)})}},{key:"getWidths",value:function(t){this.injected||this.injectTable(),pe(this.columns,function(n){t(n.col,Gt(n.table))})}},{key:"setSettings",value:function(t){this.settings=t}},{key:"setSetting",value:function(t,n){this.settings||(this.settings={}),this.settings[t]=n}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(t){return this.settings?this.settings[t]:null}},{key:"createColGroupsCol",value:function(){var t=this,n=document,i=n.createDocumentFragment();return this.hot.hasRowHeaders()&&i.appendChild(this.createColElement(-1)),this.samples.forEach(function(a){pe(a.strings,function(o){i.appendChild(t.createColElement(o.col))})}),i}},{key:"createRow",value:function(t){var n=this,i=document,a=i.createDocumentFragment(),o=i.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(t,o),a.appendChild(o)),this.samples.forEach(function(s){pe(s.strings,function(l){var u=l.col,f=n.hot.getCellMeta(t,u);f.col=u,f.row=t;var c=n.hot.getCellRenderer(f),h=i.createElement("td");c(n.hot,h,t,u,n.hot.colToProp(u),l.value,f),a.appendChild(h)})}),a}},{key:"createColumnHeadersRow",value:function(){var t=this,n=document,i=n.createDocumentFragment();if(this.hot.hasRowHeaders()){var a=n.createElement("th");this.hot.view.appendColHeader(-1,a),i.appendChild(a)}return this.samples.forEach(function(o){pe(o.strings,function(s){var l=s.col,u=n.createElement("th");t.hot.view.appendColHeader(l,u),i.appendChild(u)})}),i}},{key:"createCol",value:function(t){var n=this,i=document,a=i.createDocumentFragment();return this.samples.forEach(function(o){pe(o.strings,function(s){var l=s.row,u=n.hot.getCellMeta(l,t);u.col=t,u.row=l;var f=n.hot.getCellRenderer(u),c=i.createElement("td"),h=i.createElement("tr");c.setAttribute("ghost-table",1),f(n.hot,c,l,t,n.hot.colToProp(t),s.value,u),h.appendChild(c),a.appendChild(h)})}),a}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((t||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(t){var n=document,i=n.createElement("col");return i.style.width="".concat(this.hot.view.wt.wtTable.getStretchedColumnWidth(t),"px"),i}},{key:"createTable",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=document,i=n.createDocumentFragment(),a=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),l=n.createElement("colgroup"),u=n.createElement("tr"),f=n.createElement("th");return this.isVertical()&&a.appendChild(l),this.isHorizontal()&&(u.appendChild(f),o.appendChild(u),a.style.tableLayout="auto",a.style.width="auto"),a.appendChild(o),this.isVertical()&&s.appendChild(u),a.appendChild(s),$e(a,t),i.appendChild(a),{fragment:i,table:a,tHead:o,tBody:s,colGroup:l,tr:u,th:f}}},{key:"createContainer",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=document,i=n.createDocumentFragment(),a=n.createElement("div"),o="htGhostTable htAutoSize ".concat(t.trim());return $e(a,o),i.appendChild(a),{fragment:i,container:a}}},{key:"isVertical",value:function(){return!!(this.rows.length&&!this.columns.length)}},{key:"isHorizontal",value:function(){return!!(this.columns.length&&!this.rows.length)}}]),e}();function aD(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Bm(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function oD(e,r,t){return r&&Bm(e.prototype,r),t&&Bm(e,t),e}var Aa=new WeakMap,Ma=null,fr=function(){function e(r){var t=this;aD(this,e),os(this,"hot",r,{writable:!1}),os(this,"t",Y1(r),{writable:!1}),Aa.set(this,{hooks:{}}),Ma=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return t.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(n){return t.onUpdateSettings(n)}),this.hot.addHook("beforeInit",function(){return t.init()})}return oD(e,[{key:"init",value:function(){this.pluginName=MA(this.hot,this),this.isEnabled&&this.isEnabled()&&this.enablePlugin(),Ma||(Ma=AA(this.hot)),Ma.indexOf(this.pluginName)>=0&&Ma.splice(Ma.indexOf(this.pluginName),1),Ma.length||this.hot.runHooks("afterPluginsInitialized"),this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(t,n){Aa.get(this).hooks[t]=Aa.get(this).hooks[t]||[];var i=Aa.get(this).hooks[t];this.hot.addHook(t,n),i.push(n),Aa.get(this).hooks[t]=i}},{key:"removeHooks",value:function(t){var n=this;pe(Aa.get(this).hooks[t]||[],function(i){n.hot.removeHook(t,i)})}},{key:"clearHooks",value:function(){var t=this,n=Aa.get(this).hooks;St(n,function(i,a){return t.removeHooks(a)}),n.length=0}},{key:"callOnPluginsReady",value:function(t){this.isPluginsReady?t():this.pluginsInitializedCallbacks.push(t)}},{key:"onAfterPluginsInitialized",value:function(){pe(this.pluginsInitializedCallbacks,function(t){return t()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(){this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&this.updatePlugin())}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var t=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),St(this,function(n,i){i!=="hot"&&i!=="t"&&(t[i]=null)}),delete this.t,delete this.hot}}]),e}();function sD(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Wm(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function lD(e,r,t){return r&&Wm(e.prototype,r),t&&Wm(e,t),e}var uD=function(){function e(r){sD(this,e),this.prefix=r,this.savedKeys=[],this.loadSavedKeys()}return lD(e,[{key:"saveValue",value:function(t,n){window.localStorage.setItem("".concat(this.prefix,"_").concat(t),JSON.stringify(n)),this.savedKeys.indexOf(t)===-1&&(this.savedKeys.push(t),this.saveSavedKeys())}},{key:"loadValue",value:function(t,n){var i=typeof t>"u"?n:t,a=window.localStorage.getItem("".concat(this.prefix,"_").concat(i));return a===null?void 0:JSON.parse(a)}},{key:"reset",value:function(t){window.localStorage.removeItem("".concat(this.prefix,"_").concat(t))}},{key:"resetAll",value:function(){var t=this;pe(this.savedKeys,function(n,i){window.localStorage.removeItem("".concat(t.prefix,"_").concat(t.savedKeys[i]))}),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var t=window.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),n=typeof t=="string"?JSON.parse(t):void 0;this.savedKeys=n||[]}},{key:"saveSavedKeys",value:function(){window.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),e}();function Wu(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Wu=function(t){return typeof t}:Wu=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wu(e)}function fD(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function $m(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function cD(e,r,t){return r&&$m(e.prototype,r),t&&$m(e,t),e}function hD(e,r){return r&&(Wu(r)==="object"||typeof r=="function")?r:dD(e)}function dD(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $a(e,r,t){return typeof Reflect<"u"&&Reflect.get?$a=Reflect.get:$a=function(i,a,o){var s=vD(i,a);if(s){var l=Object.getOwnPropertyDescriptor(s,a);return l.get?l.get.call(o):l.value}},$a(e,r,t||e)}function vD(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=Ki(e),e!==null););return e}function Ki(e){return Ki=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ki(e)}function gD(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&Rd(e,r)}function Rd(e,r){return Rd=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Rd(e,r)}at.getSingleton().register("persistentStateSave");at.getSingleton().register("persistentStateLoad");at.getSingleton().register("persistentStateReset");var q_=function(e){gD(r,e);function r(t){var n;return fD(this,r),n=hD(this,Ki(r).call(this,t)),n.storage=void 0,n}return cD(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().persistentState}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.storage||(this.storage=new uD(this.hot.rootElement.id)),this.addHook("persistentStateSave",function(i,a){return n.saveValue(i,a)}),this.addHook("persistentStateLoad",function(i,a){return n.loadValue(i,a)}),this.addHook("persistentStateReset",function(){return n.resetValue()}),$a(Ki(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,$a(Ki(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),$a(Ki(r.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(n,i){i.value=this.storage.loadValue(n)}},{key:"saveValue",value:function(n,i){this.storage.saveValue(n,i)}},{key:"resetValue",value:function(n){typeof n>"u"?this.storage.resetAll():this.storage.reset(n)}},{key:"destroy",value:function(){$a(Ki(r.prototype),"destroy",this).call(this)}}]),r}(fr);ur("persistentState",q_);function mD(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function pD(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Um(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Vm(e,r,t){return r&&Um(e.prototype,r),t&&Um(e,t),e}var Z_=function(){Vm(e,null,[{key:"SAMPLE_COUNT",get:function(){return 3}}]);function e(r){pD(this,e),this.samples=null,this.dataFactory=r,this.customSampleCount=null,this.allowDuplicates=!1}return Vm(e,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:e.SAMPLE_COUNT}},{key:"setSampleCount",value:function(t){this.customSampleCount=t}},{key:"setAllowDuplicates",value:function(t){this.allowDuplicates=t}},{key:"generateRowSamples",value:function(t,n){return this.generateSamples("row",n,t)}},{key:"generateColumnSamples",value:function(t,n){return this.generateSamples("col",n,t)}},{key:"generateSamples",value:function(t,n,i){var a=this,o=new Map,s=typeof i=="number"?{from:i,to:i}:i,l=s.from,u=s.to;return Ke(l,u,function(f){var c=a.generateSample(t,n,f);o.set(f,c)}),o}},{key:"generateSample",value:function(t,n,i){var a=this;if(t!=="row"&&t!=="col")throw new Error("Unsupported sample type");var o=new Map,s=t==="row"?"col":"row",l=[];return Ke(n.from,n.to,function(u){var f=t==="row"?a.dataFactory(i,u):a.dataFactory(u,i),c=f.value,h=f.bundleCountSeed,d=h>0,g;Rt(c)?g=Object.keys(c).length:Array.isArray(c)?g=c.length:g=ba(c).length,d&&(g+=h),o.has(g)||o.set(g,{needed:a.getSampleCount(),strings:[]});var v=o.get(g);if(v.needed){var p=l.indexOf(c)>-1;(!p||a.allowDuplicates||d)&&(v.strings.push(mD({value:c},s,u)),l.push(c),v.needed-=1)}}),o}}]),e}();function $u(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?$u=function(t){return typeof t}:$u=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$u(e)}function zm(e,r){return _D(e)||wD(e,r)||yD()}function yD(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function wD(e,r){var t=[],n=!0,i=!1,a=void 0;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done)&&(t.push(s.value),!(r&&t.length===r));n=!0);}catch(l){i=!0,a=l}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw a}}return t}function _D(e){if(Array.isArray(e))return e}function CD(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function SD(e,r){return r&&($u(r)==="object"||typeof r=="function")?r:Ad(e)}function Ua(e,r,t){return typeof Reflect<"u"&&Reflect.get?Ua=Reflect.get:Ua=function(i,a,o){var s=bD(i,a);if(s){var l=Object.getOwnPropertyDescriptor(s,a);return l.get?l.get.call(o):l.value}},Ua(e,r,t||e)}function bD(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=qi(e),e!==null););return e}function qi(e){return qi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},qi(e)}function jm(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ym(e,r,t){return r&&jm(e.prototype,r),t&&jm(e,t),e}function xD(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&kd(e,r)}function kd(e,r){return kd=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},kd(e,r)}function Ad(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var gh=new WeakMap,J_=function(e){xD(r,e),Ym(r,null,[{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]);function r(t){var n;return CD(this,r),n=SD(this,qi(r).call(this,t)),gh.set(Ad(Ad(n)),{cachedColumnHeaders:[]}),n.widths=[],n.ghostTable=new Uv(n.hot),n.samplesGenerator=new Z_(function(i,a){var o=n.hot.getCellMeta(i,a),s="";o.spanned||(s=n.hot.getDataAtCell(i,a));var l=0;if(o.label){var u=o.label,f=u.value,c=u.property,h="";f?h=typeof f=="function"?f(i,a,n.hot.colToProp(a),s):f:c&&(h=n.hot.getDataAtRowProp(i,c)),l=h.length}return{value:s,bundleCountSeed:l}}),n.firstCalculation=!0,n.inProgress=!1,n.addHook("beforeColumnResize",function(i,a,o){return n.onBeforeColumnResize(i,a,o)}),n}return Ym(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().autoColumnSize!==!1&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){var i=this.hot.getSettings().autoColumnSize;i&&i.useHeaders!==null&&i.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",i.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return n.onAfterLoadData()}),this.addHook("beforeChange",function(a){return n.onBeforeChange(a)}),this.addHook("beforeRender",function(a){return n.onBeforeRender(a)}),this.addHook("modifyColWidth",function(a,o){return n.getColumnWidth(o,a)}),this.addHook("afterInit",function(){return n.onAfterInit()}),Ua(qi(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var n=this.findColumnsWhereHeaderWasChanged();n.length&&this.clearCache(n),Ua(qi(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Ua(qi(r.prototype),"disablePlugin",this).call(this)}},{key:"calculateColumnsWidth",value:function(){var n=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=typeof i=="number"?{from:i,to:i}:i,l=typeof a=="number"?{from:a,to:a}:a;Ke(s.from,s.to,function(u){if(o||n.widths[u]===void 0&&!n.hot._getColWidthFromSettings(u)){var f=n.samplesGenerator.generateColumnSamples(u,l);pe(f,function(c){var h=zm(c,2),d=h[0],g=h[1];return n.ghostTable.addColumn(d,g)})}}),this.ghostTable.columns.length&&(this.ghostTable.getWidths(function(u,f){n.widths[u]=f}),this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var n=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=0,o=this.hot.countCols()-1,s=null;this.inProgress=!0;var l=function f(){if(!n.hot){ss(s),n.inProgress=!1;return}n.calculateColumnsWidth({from:a,to:Math.min(a+r.CALCULATION_STEP,o)},i),a=a+r.CALCULATION_STEP+1,a<o?s=fl(f):(ss(s),n.inProgress=!1,n.hot.view.wt.wtOverlays.adjustElementsSize(!0),n.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&n.hot.view.wt.wtOverlays.leftOverlay.clone.draw())},u=this.getSyncCalculationLimit();this.firstCalculation&&u>=0&&(this.calculateColumnsWidth({from:0,to:u},i),this.firstCalculation=!1,a=u+1),a<o?l():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var n=this.hot.getSettings().autoColumnSize,i=n&&At(n,"samplingRatio")?this.hot.getSettings().autoColumnSize.samplingRatio:void 0,a=n&&At(n,"allowSampleDuplicates")?this.hot.getSettings().autoColumnSize.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&ls(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var n=r.SYNC_CALCULATION_LIMIT,i=this.hot.countCols()-1;return Rt(this.hot.getSettings().autoColumnSize)&&(n=this.hot.getSettings().autoColumnSize.syncLimit,K0(n)?n=rv(i,n):n>>=0),Math.min(n,i)}},{key:"getColumnWidth",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=i;return o===void 0&&(o=this.widths[n],a&&typeof o=="number"&&(o=Math.max(o,T0.DEFAULT_WIDTH))),o}},{key:"getFirstVisibleColumn",value:function(){var n=this.hot.view.wt;return n.wtViewport.columnsVisibleCalculator?n.wtTable.getFirstVisibleColumn():n.wtViewport.columnsRenderCalculator?n.wtTable.getFirstRenderedColumn():-1}},{key:"getLastVisibleColumn",value:function(){var n=this.hot.view.wt;return n.wtViewport.columnsVisibleCalculator?n.wtTable.getLastVisibleColumn():n.wtViewport.columnsRenderCalculator?n.wtTable.getLastRenderedColumn():-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var n=this.hot.getColHeader(),i=gh.get(this),a=i.cachedColumnHeaders,o=hn(n,function(s,l,u){var f=a.length;return(f-1<u||a[u]!==l)&&s.push(u),f-1<u?a.push(l):a[u]=l,s},[]);return o}},{key:"clearCache",value:function(){var n=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];i.length?pe(i,function(a){n.widths[a]=void 0}):this.widths.length=0}},{key:"isNeedRecalculate",value:function(){return!!da(this.widths,function(n){return n===void 0}).length}},{key:"onBeforeRender",value:function(){var n=this.hot.renderCall,i=this.hot.countRows(),a=this.getFirstVisibleColumn(),o=this.getLastVisibleColumn();a===null||o===null||i&&(this.calculateColumnsWidth({from:a,to:o},void 0,n),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth())}},{key:"onAfterLoadData",value:function(){var n=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){n.hot&&n.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(n){var i=this,a=Zt(n,function(o){var s=zm(o,2),l=s[1];return i.hot.propToCol(l)});this.clearCache(a)}},{key:"onBeforeColumnResize",value:function(n,i,a){var o=i;return a&&(this.calculateColumnsWidth(n,void 0,!0),o=this.getColumnWidth(n,void 0,!1)),o}},{key:"onAfterInit",value:function(){gh.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"destroy",value:function(){this.ghostTable.clean(),Ua(qi(r.prototype),"destroy",this).call(this)}}]),r}(fr);ur("autoColumnSize",J_);var el={horizontal:"horizontal",vertical:"vertical"};function ED(e,r,t,n){var i=t.length,a=t?t[0].length:0,o=[],s=r.row-e.row,l=r.col-e.col;if(["down","up"].indexOf(n)!==-1){for(var u=[],f=0;f<=l;f++){var c=parseInt(t[0][f],10),h=parseInt(t[i-1][f],10),d=(n==="down"?h-c:c-h)/(i-1)||0;u.push(d)}o.push(u)}if(["right","left"].indexOf(n)!==-1)for(var g=0;g<=s;g++){var v=parseInt(t[g][0],10),p=parseInt(t[g][a-1],10),C=(n==="right"?p-v:v-p)/(a-1)||0;o.push([C])}return o}function TD(e,r){var t,n,i;return r[0]===e[0]&&r[1]<e[1]?(i="left",t=new me(r[0],r[1]),n=new me(r[2],e[1]-1)):r[2]===e[2]&&r[0]===e[0]&&r[3]>e[3]?(i="right",t=new me(r[0],e[3]+1),n=new me(r[2],r[3])):r[0]<e[0]&&r[1]===e[1]?(i="up",t=new me(r[0],r[1]),n=new me(e[0]-1,r[3])):r[2]>e[2]&&r[1]===e[1]&&(i="down",t=new me(e[2]+1,r[1]),n=new me(r[2],r[3])),{directionOfDrag:i,startOfDragCoords:t,endOfDragCoords:n}}function OD(e){var r={};return e===!0?(r.directions=Object.keys(el),r.autoInsertRow=!0):Rt(e)?(ir(e.autoInsertRow)?e.direction===el.horizontal?r.autoInsertRow=!1:r.autoInsertRow=e.autoInsertRow:r.autoInsertRow=!1,ir(e.direction)?r.directions=[e.direction]:r.directions=Object.keys(el)):typeof e=="string"?(r.directions=[e],r.autoInsertRow=!0):(r.directions=[],r.autoInsertRow=!1),r}function Uu(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Uu=function(t){return typeof t}:Uu=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uu(e)}function RD(e){return MD(e)||AD(e)||kD()}function kD(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function AD(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}function MD(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}function DD(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Gm(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function PD(e,r,t){return r&&Gm(e.prototype,r),t&&Gm(e,t),e}function ND(e,r){return r&&(Uu(r)==="object"||typeof r=="function")?r:Dd(e)}function Va(e,r,t){return typeof Reflect<"u"&&Reflect.get?Va=Reflect.get:Va=function(i,a,o){var s=FD(i,a);if(s){var l=Object.getOwnPropertyDescriptor(s,a);return l.get?l.get.call(o):l.value}},Va(e,r,t||e)}function FD(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=Zi(e),e!==null););return e}function Zi(e){return Zi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Zi(e)}function LD(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&Md(e,r)}function Md(e,r){return Md=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Md(e,r)}function Dd(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}at.getSingleton().register("modifyAutofillRange");at.getSingleton().register("beforeAutofill");var ID="insert_row",HD=200,Q_=function(e){LD(r,e);function r(t){var n;return DD(this,r),n=ND(this,Zi(r).call(this,t)),n.eventManager=new Ft(Dd(Dd(n))),n.addingStarted=!1,n.mouseDownOnCellCorner=!1,n.mouseDragOutside=!1,n.handleDraggedCells=0,n.directions=[],n.autoInsertRow=!1,n}return PD(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(i){return n.onAfterCellCornerMouseDown(i)}),this.addHook("afterOnCellCornerDblClick",function(i){return n.onCellCornerDblClick(i)}),this.addHook("beforeOnCellMouseOver",function(i,a){return n.onBeforeCellMouseOver(a)}),Va(Zi(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Va(Zi(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),Va(Zi(r.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var n={from:this.hot.getSelectedRangeLast().from,to:this.hot.getSelectedRangeLast().to};return this.hot.getData(n.from.row,n.from.col,n.to.row,n.to.col)}},{key:"fillIn",value:function(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;var n=this.hot.selection.highlight.getFill().getCorners();this.resetSelectionOfDraggedArea();var i=this.getCornersOfSelectedCells();n=this.hot.runHooks("modifyAutofillRange",n,i);var a=TD(i,n),o=a.directionOfDrag,s=a.startOfDragCoords,l=a.endOfDragCoords;if(s&&s.row>-1&&s.col>-1){var u=this.getSelectionData();this.hot.runHooks("beforeAutofill",s,l,u);var f=ED(s,l,u,o),c=u;if(["up","left"].indexOf(o)>-1){c=[];var h=null,d=null;if(o==="up"){h=l.row-s.row+1,d=h%u.length;for(var g=0;g<h;g++)c.push(u[(g+(u.length-d))%u.length])}else{h=l.col-s.col+1,d=h%u[0].length;for(var v=0;v<u.length;v++){c.push([]);for(var p=0;p<h;p++)c[v].push(u[v][(p+(u[v].length-d))%u[v].length])}}}this.hot.populateFromArray(s.row,s.col,c,l.row,l.col,"".concat(this.pluginName,".fill"),null,o,f),this.setSelection(n)}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(n){return n.row<0&&(n.row=0),n.col<0&&(n.col=0),n}},{key:"getCoordsOfDragAndDropBorders",value:function(n){var i=this.hot.getSelectedRangeLast().getTopLeftCorner(),a=this.hot.getSelectedRangeLast().getBottomRightCorner(),o;if(this.directions.includes(el.vertical)&&(a.row<n.row||i.row>n.row))o=new me(n.row,a.col);else if(this.directions.includes(el.horizontal))o=new me(a.row,n.col);else return;return this.reduceSelectionAreaIfNeeded(o)}},{key:"showBorder",value:function(n){var i=this.getCoordsOfDragAndDropBorders(n);i&&this.redrawBorders(i)}},{key:"addRow",value:function(){var n=this;this.hot._registerTimeout(setTimeout(function(){n.hot.alter(ID,void 0,1,"".concat(n.pluginName,".fill")),n.addingStarted=!1},HD))}},{key:"addNewRowIfNeeded",value:function(){if(this.hot.selection.highlight.getFill().cellRange&&this.addingStarted===!1&&this.autoInsertRow){var n=this.hot.getSelectedLast(),i=this.hot.selection.highlight.getFill().getCorners(),a=this.hot.countRows();n[2]<a-1&&i[2]===a-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getCornersOfSelectedCells",value:function(){return this.hot.selection.isMultiple()?this.hot.selection.highlight.createOrGetArea().getCorners():this.hot.selection.highlight.getCell().getCorners()}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(n){for(var i=this.hot.getData(),a=this.hot.countRows(),o,s=n[2]+1;s<a;s++){for(var l=n[1];l<=n[3];l++){var u=i[s][l];if(u)return-1}var f=i[s][n[1]-1],c=i[s][n[3]+1];(f||c)&&(o=s)}return o}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(n,i){this.hot.selection.highlight.getFill().clear().add(new me(n[0],n[1])).add(new me(i,n[3]))}},{key:"setSelection",value:function(n){var i;(i=this.hot).selectCell.apply(i,RD(n).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var n=this.getCornersOfSelectedCells(),i=this.getIndexOfLastAdjacentFilledInRow(n);return i===-1||i===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(n,i),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(n){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(n),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(n){var i=Xt(this.hot.table).top-(window.pageYOffset||document.documentElement.scrollTop)+sr(this.hot.table),a=Xt(this.hot.table).left-(window.pageXOffset||document.documentElement.scrollLeft)+Gt(this.hot.table);return n.clientY>i&&n.clientX<=a}},{key:"registerEvents",value:function(){var n=this;this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return n.onMouseUp()}),this.eventManager.addEventListener(document.documentElement,"mousemove",function(i){return n.onMouseMove(i)})}},{key:"onCellCornerDblClick",value:function(){var n=this.selectAdjacent();n&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(n){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(n),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(n){var i=this.getIfMouseWasDraggedOutside(n);this.addingStarted===!1&&this.handleDraggedCells>0&&i?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var n=OD(this.hot.getSettings().fillHandle);this.directions=n.directions,this.autoInsertRow=n.autoInsertRow}},{key:"destroy",value:function(){Va(Zi(r.prototype),"destroy",this).call(this)}}]),r}(fr);ur("autofill",Q_);function Vu(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Vu=function(t){return typeof t}:Vu=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vu(e)}function BD(e,r){return UD(e)||$D(e,r)||WD()}function WD(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function $D(e,r){var t=[],n=!0,i=!1,a=void 0;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done)&&(t.push(s.value),!(r&&t.length===r));n=!0);}catch(l){i=!0,a=l}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw a}}return t}function UD(e){if(Array.isArray(e))return e}function VD(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function zD(e,r){return r&&(Vu(r)==="object"||typeof r=="function")?r:jD(e)}function jD(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jo(e,r,t){return typeof Reflect<"u"&&Reflect.get?jo=Reflect.get:jo=function(i,a,o){var s=YD(i,a);if(s){var l=Object.getOwnPropertyDescriptor(s,a);return l.get?l.get.call(o):l.value}},jo(e,r,t||e)}function YD(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=za(e),e!==null););return e}function za(e){return za=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},za(e)}function Xm(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Km(e,r,t){return r&&Xm(e.prototype,r),t&&Xm(e,t),e}function GD(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&Pd(e,r)}function Pd(e,r){return Pd=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Pd(e,r)}var eC=function(e){GD(r,e),Km(r,null,[{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]);function r(t){var n;return VD(this,r),n=zD(this,za(r).call(this,t)),n.heights=[],n.ghostTable=new Uv(n.hot),n.samplesGenerator=new Z_(function(i,a){var o;return i>=0?o=n.hot.getDataAtCell(i,a):i===-1&&(o=n.hot.getColHeader(a)),{value:o}}),n.firstCalculation=!0,n.inProgress=!1,n.addHook("beforeRowResize",function(i,a,o){return n.onBeforeRowResize(i,a,o)}),n}return Km(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().autoRowSize===!0||Rt(this.hot.getSettings().autoRowSize)}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return n.onAfterLoadData()}),this.addHook("beforeChange",function(i){return n.onBeforeChange(i)}),this.addHook("beforeColumnMove",function(){return n.recalculateAllRowsHeight()}),this.addHook("beforeColumnResize",function(){return n.recalculateAllRowsHeight()}),this.addHook("beforeColumnSort",function(){return n.clearCache()}),this.addHook("beforeRender",function(i){return n.onBeforeRender(i)}),this.addHook("beforeRowMove",function(i,a){return n.onBeforeRowMove(i,a)}),this.addHook("modifyRowHeight",function(i,a){return n.getRowHeight(a,i)}),this.addHook("modifyColumnHeaderHeight",function(){return n.getColumnHeaderHeight()}),jo(za(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){jo(za(r.prototype),"disablePlugin",this).call(this)}},{key:"calculateRowsHeight",value:function(){var n=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=typeof i=="number"?{from:i,to:i}:i,l=typeof a=="number"?{from:a,to:a}:a;if(this.hot.getColHeader(0)!==null){var u=this.samplesGenerator.generateRowSamples(-1,l);this.ghostTable.addColumnHeadersRow(u.get(-1))}Ke(s.from,s.to,function(f){if(o||n.heights[f]===void 0){var c=n.samplesGenerator.generateRowSamples(f,l);pe(c,function(h){var d=BD(h,2),g=d[0],v=d[1];return n.ghostTable.addRow(g,v)})}}),this.ghostTable.rows.length&&(this.ghostTable.getHeights(function(f,c){n.heights[f]=c}),this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var n=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=0,o=this.hot.countRows()-1,s=null;this.inProgress=!0;var l=function f(){if(!n.hot){ss(s),n.inProgress=!1;return}n.calculateRowsHeight({from:a,to:Math.min(a+r.CALCULATION_STEP,o)},i),a=a+r.CALCULATION_STEP+1,a<o?s=fl(f):(ss(s),n.inProgress=!1,n.hot.view.wt.wtOverlays.adjustElementsSize(!0),n.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&n.hot.view.wt.wtOverlays.leftOverlay.clone.draw())},u=this.getSyncCalculationLimit();this.firstCalculation&&u>=0&&(this.calculateRowsHeight({from:0,to:u},i),this.firstCalculation=!1,a=u+1),a<o?l():(this.inProgress=!1,this.hot.view.wt.wtOverlays.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var n=this.hot.getSettings().autoRowSize,i=n&&At(n,"samplingRatio")?this.hot.getSettings().autoRowSize.samplingRatio:void 0,a=n&&At(n,"allowSampleDuplicates")?this.hot.getSettings().autoRowSize.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllRowsHeight",value:function(){ls(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var n=r.SYNC_CALCULATION_LIMIT,i=this.hot.countRows()-1;return Rt(this.hot.getSettings().autoRowSize)&&(n=this.hot.getSettings().autoRowSize.syncLimit,K0(n)?n=rv(i,n):n>>=0),Math.min(n,i)}},{key:"getRowHeight",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=i;return this.heights[n]!==void 0&&this.heights[n]>(i||0)&&(a=this.heights[n]),a}},{key:"getColumnHeaderHeight",value:function(){return this.heights[-1]}},{key:"getFirstVisibleRow",value:function(){var n=this.hot.view.wt;return n.wtViewport.rowsVisibleCalculator?n.wtTable.getFirstVisibleRow():n.wtViewport.rowsRenderCalculator?n.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var n=this.hot.view.wt;return n.wtViewport.rowsVisibleCalculator?n.wtTable.getLastVisibleRow():n.wtViewport.rowsRenderCalculator?n.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.heights.length=0,this.heights[-1]=void 0}},{key:"clearCacheByRange",value:function(n){var i=this,a=typeof n=="number"?{from:n,to:n}:n,o=a.from,s=a.to;Ke(Math.min(o,s),Math.max(o,s),function(l){i.heights[l]=void 0})}},{key:"isNeedRecalculate",value:function(){return!!da(this.heights,function(n){return n===void 0}).length}},{key:"onBeforeRender",value:function(){var n=this.hot.renderCall,i=this.hot.getSettings().fixedRowsBottom,a=this.getFirstVisibleRow(),o=this.getLastVisibleRow();if(!(a===null||o===null)){if(this.calculateRowsHeight({from:a,to:o},void 0,n),i){var s=this.hot.countRows()-1;this.calculateRowsHeight({from:s-i,to:s})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(n,i){this.clearCacheByRange({from:n,to:i}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(n,i,a){var o=i;return a&&(this.calculateRowsHeight(n,void 0,!0),o=this.getRowHeight(n)),o}},{key:"onAfterLoadData",value:function(){var n=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){n.hot&&n.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(n){var i=null;n.length===1?i=n[0][0]:n.length>1&&(i={from:n[0][0],to:n[n.length-1][0]}),i!==null&&this.clearCacheByRange(i)}},{key:"destroy",value:function(){this.ghostTable.clean(),jo(za(r.prototype),"destroy",this).call(this)}}]),r}(fr);ur("autoRowSize",eC);function XD(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function qm(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function KD(e,r,t){return r&&qm(e.prototype,r),t&&qm(e,t),e}var qD=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],ZD=!1,JD=!0,QD=!0,eP=function(){function e(){XD(this,e),this.sortedColumnsStates=[],this.sortEmptyCells=ZD,this.indicator=JD,this.headerAction=QD,this.compareFunctionFactory=void 0}return KD(e,[{key:"updateAllColumnsProperties",value:function(t){var n=this;Rt(t)&&St(t,function(i,a){qD.includes(a)&&(n[a]=i)})}},{key:"getAllColumnsProperties",value:function(){var t={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(t.compareFunctionFactory=this.compareFunctionFactory),t}},{key:"getFirstSortedColumn",value:function(){var t;return this.getNumberOfSortedColumns()>0&&(t=this.sortedColumnsStates[0].column),t}},{key:"getSortOrderOfColumn",value:function(t){var n=this.sortedColumnsStates.find(function(a){var o=a.column;return t===o}),i;return Rt(n)&&(i=n.sortOrder),i}},{key:"getSortedColumns",value:function(){return Zt(this.sortedColumnsStates,function(t){var n=t.column;return n})}},{key:"getIndexOfColumnInSortQueue",value:function(t){return this.getSortedColumns().indexOf(t)}},{key:"getNumberOfSortedColumns",value:function(){return this.sortedColumnsStates.length}},{key:"isListOfSortedColumnsEmpty",value:function(){return this.getNumberOfSortedColumns()===0}},{key:"isColumnSorted",value:function(t){return this.getSortedColumns().includes(t)}},{key:"getSortStates",value:function(){return Wr(this.sortedColumnsStates)}},{key:"getColumnSortState",value:function(t){if(this.isColumnSorted(t))return Wr(this.sortedColumnsStates[this.getIndexOfColumnInSortQueue(t)])}},{key:"setSortStates",value:function(t){this.sortedColumnsStates=t}},{key:"destroy",value:function(){this.sortedColumnsStates.length=0,this.sortedColumnsStates=null}}]),e}(),Tf="asc",Of="desc",tP="colHeader";function rP(e){if(Mr(e))return!1;var r=e.column,t=e.sortOrder;return Number.isInteger(r)&&[Tf,Of].includes(t)}function nP(e){if(Array.isArray(e)===!1||e.every(function(n){return Rt(n)})===!1)return!1;var r=e.map(function(n){var i=n.column;return i}),t=new Set(r).size===r.length;return t&&e.every(rP)}function Zm(e){if(e!==Of)return e===Tf?Of:Tf}function Jm(e){var r=e.querySelector(".".concat(tP));return r}function Qm(e,r){if(e<0||!r.parentNode)return!1;var t=r.parentNode.parentNode.childNodes,n=Array.from(t).indexOf(r.parentNode)-t.length;return n===-1}function ep(e,r,t){return e===-1&&r>=0&&vl(t)===!1}var iP="ascending",aP="descending",tC="indicatorDisabled",rC="columnSorting",nC="sortAction",iC=new Map([[Tf,iP],[Of,aP]]);function oP(e,r,t,n){var i=[rC];if(n&&i.push(nC),t===!1)i.push(tC);else if(e.isColumnSorted(r)){var a=e.getSortOrderOfColumn(r);i.push(iC.get(a))}return i}function sP(){return Array.from(iC.values()).concat(nC,tC,rC)}function lP(e){return cP(e)||fP(e)||uP()}function uP(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function fP(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}function cP(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}var hP="arrayMapper",yc={_arrayMap:[],getValueByIndex:function(r){var t=this._arrayMap.length,n=null;return r<t&&(n=this._arrayMap[r]),n},getIndexByValue:function(r){var t;return(t=this._arrayMap.indexOf(r))===-1?null:t},insertItems:function(r){var t=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=_w(this._arrayMap)+1,a=[];return Ke(n-1,function(o){a.push(t._arrayMap.splice(r+o,0,i+o))}),a},removeItems:function(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=[];if(Array.isArray(r)){var i=[].concat(this._arrayMap);r.sort(function(l,u){return u-l});for(var a=0,o=r.length;a<o;a++){var s=r[a];this._arrayMap.splice(s,1),n.push(i[s])}}else n=this._arrayMap.splice(r,t);return n},unshiftItems:function(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=this.removeItems(r,t);function i(a){return hn(n,function(o,s){var l=o;return a>s&&(l+=1),l},0)}this._arrayMap=Zt(this._arrayMap,function(a){var o=a,s=i(o);return s&&(o-=s),o})},shiftItems:function(r){var t=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this._arrayMap=Zt(this._arrayMap,function(i){var a=i;return a>=r&&(a+=n),a}),Ke(n-1,function(i){t._arrayMap.splice(r+i,0,r+i)})},swapIndexes:function(r,t){var n;(n=this._arrayMap).splice.apply(n,[t,0].concat(lP(this._arrayMap.splice(r,1))))},clearMap:function(){this._arrayMap.length=0}};os(yc,"MIXIN_NAME",hP,{writable:!1,enumerable:!1});function dP(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function tp(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function vP(e,r,t){return r&&tp(e.prototype,r),t&&tp(e,t),e}var aC=function(){function e(){dP(this,e)}return vP(e,[{key:"createMap",value:function(t){var n=this,i=t===void 0?this._arrayMap.length:t;this._arrayMap.length=0,Ke(i-1,function(a){n._arrayMap[a]=a})}},{key:"destroy",value:function(){this._arrayMap=null}}]),e}();vi(aC,yc);function gP(e,r,t){return function(n,i){var a=t.sortEmptyCells;return typeof n=="string"&&(n=n.toLowerCase()),typeof i=="string"&&(i=i.toLowerCase()),n===i?ha:bn(n)?bn(i)?ha:a&&e==="asc"?Rr:kr:bn(i)?a&&e==="asc"?kr:Rr:isNaN(n)&&!isNaN(i)?e==="asc"?kr:Rr:!isNaN(n)&&isNaN(i)||(isNaN(n)||isNaN(i)||(n=parseFloat(n),i=parseFloat(i)),n<i)?e==="asc"?Rr:kr:n>i?e==="asc"?kr:Rr:ha}}var oC="default";function mP(e,r,t){return function(n,i){var a=parseFloat(n),o=parseFloat(i),s=t.sortEmptyCells;if(a===o||isNaN(a)&&isNaN(o))return ha;if(s){if(bn(n))return e==="asc"?Rr:kr;if(bn(i))return e==="asc"?kr:Rr}return isNaN(a)?kr:isNaN(o)?Rr:a<o?e==="asc"?Rr:kr:a>o?e==="asc"?kr:Rr:ha}}var pP="numeric";function yP(e,r,t){return function(n,i){var a=t.sortEmptyCells;if(n===i)return ha;if(bn(n))return bn(i)?ha:a&&e==="asc"?Rr:kr;if(bn(i))return a&&e==="asc"?kr:Rr;var o=r.dateFormat,s=Pe(n,o),l=Pe(i,o);return s.isValid()?l.isValid()?l.isAfter(s)?e==="asc"?Rr:kr:l.isBefore(s)?e==="asc"?kr:Rr:ha:Rr:kr}}var wP="date",Vv=Bi("sorting.compareFunctionFactory"),zv=Vv.register,rp=Vv.getItem,_P=Vv.hasItem,sC=Bi("sorting.mainSortComparator"),CP=sC.register,SP=sC.getItem;function bP(e){return _P(e)?rp(e):rp(oC)}zv(pP,mP);zv(wP,yP);zv(oC,gP);function np(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function xP(e,r,t){return r&&np(e.prototype,r),t&&np(e,t),e}function lC(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var ip=function e(r){lC(this,e),this.data=r,this.next=null,this.prev=null},ap=function(){function e(){lC(this,e),this.first=null,this.last=null}return xP(e,[{key:"push",value:function(t){var n=new ip(t);if(this.first===null)this.first=n,this.last=n;else{var i=this.last;this.last=n,n.prev=i,i.next=n}}},{key:"unshift",value:function(t){var n=new ip(t);if(this.first===null)this.first=n,this.last=n;else{var i=this.first;this.first=n,n.next=i,i.prev=n}}},{key:"inorder",value:function(t){for(var n=this.first;n;)t(n),n=n.next}},{key:"remove",value:function(t){if(this.first===null)return!1;for(var n=this.first,i,a;n;){if(n.data===t)return i=n.next,a=n.prev,i&&(i.prev=a),a&&(a.next=i),n===this.first&&(this.first=i),n===this.last&&(this.last=a),!0;n=n.next}return!1}},{key:"hasCycle",value:function(){for(var t=this.first,n=this.first;;){if(t===null||(t=t.next,t===null))return!1;if(t=t.next,n=n.next,t===n)return!0}}},{key:"pop",value:function(){if(this.last===null)return null;var t=this.last;return this.last=this.last.prev,t}},{key:"shift",value:function(){if(this.first===null)return null;var t=this.first;return this.first=this.first.next,t}},{key:"recursiveReverse",value:function(){function t(i,a){a&&(t(a,a.next),a.next=i)}if(this.first){t(this.first,this.first.next),this.first.next=null;var n=this.first;this.first=this.last,this.last=n}}},{key:"reverse",value:function(){if(!(!this.first||!this.first.next)){for(var t=this.first.next,n=this.first,i;t;)i=t.next,t.next=n,n.prev=t,n=t,t=i;this.first.next=null,this.last.prev=null,i=this.first,this.first=n,this.last=i}}}]),e}(),EP=function(r,t){var n=r.toString(),i=t.toString();return n===i?0:n<i?-1:1};function Nd(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:EP,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e.length;if(Math.abs(n-t)<=1)return[];var i=Math.ceil((t+n)/2);return Nd(e,r,t,i),Nd(e,r,i,n),TP(e,r,t,i,n)}function TP(e,r,t,n,i){for(var a=new ap,o=new ap,s=n-t,l=i-n,u=Math.max(s,l),f=i-t,c=0;c<u;c+=1)c<s&&a.push(e[t+c]),c<l&&o.push(e[n+c]);for(var h=0;h<f;)a.first&&o.first?r(a.first.data,o.first.data)>0?e[t+h]=o.shift().data:e[t+h]=a.shift().data:a.first?e[t+h]=a.shift().data:e[t+h]=o.shift().data,h+=1;return e}var ha=0,Rr=-1,kr=1;function OP(e,r){for(var t=SP(r),n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a];Nd(e,t.apply(void 0,i))}function op(e){return AP(e)||kP(e)||RP()}function RP(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function kP(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}function AP(e){if(Array.isArray(e))return e}function MP(e,r){return function(t,n){var i=op(t),a=i.slice(1),o=op(n),s=o.slice(1);return function(u){var f=e[u],c=r[u],h=a[u],d=s[u],g=c.columnSorting,v=g.compareFunctionFactory?g.compareFunctionFactory:bP(c.type),p=v(f,c,g)(h,d);return p}(0)}}function zu(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?zu=function(t){return typeof t}:zu=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zu(e)}function Po(e){return NP(e)||PP(e)||DP()}function DP(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function PP(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}function NP(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}function Jl(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{},n=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),n.forEach(function(i){FP(e,i,t[i])})}return e}function FP(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Ql(e,r){if(e==null)return{};var t=LP(e,r),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(t[n]=e[n])}return t}function LP(e,r){if(e==null)return{};var t={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(r.indexOf(i)>=0)&&(t[i]=e[i]);return t}function IP(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function sp(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function HP(e,r,t){return r&&sp(e.prototype,r),t&&sp(e,t),e}function BP(e,r){return r&&(zu(r)==="object"||typeof r=="function")?r:Ld(e)}function ja(e,r,t){return typeof Reflect<"u"&&Reflect.get?ja=Reflect.get:ja=function(i,a,o){var s=WP(i,a);if(s){var l=Object.getOwnPropertyDescriptor(s,a);return l.get?l.get.call(o):l.value}},ja(e,r,t||e)}function WP(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=Ji(e),e!==null););return e}function Ji(e){return Ji=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ji(e)}function $P(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&Fd(e,r)}function Fd(e,r){return Fd=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Fd(e,r)}function Ld(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var lp="append",UP="replace",jv="columnSorting";CP(jv,MP);at.getSingleton().register("beforeColumnSort");at.getSingleton().register("afterColumnSort");var uC=function(e){$P(r,e);function r(t){var n;return IP(this,r),n=BP(this,Ji(r).call(this,t)),n.columnStatesManager=new eP,n.rowsMapper=new aC(Ld(Ld(n))),n.blockPluginTranslation=!0,n.columnMetaCache=new Map,n.pluginKey=jv,n}return HP(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(Mr(this.hot.getSettings().observeChanges)&&this.enableObserveChangesPlugin(),this.addHook("afterTrimRow",function(){return n.sortByPresetSortStates()}),this.addHook("afterUntrimRow",function(){return n.sortByPresetSortStates()}),this.addHook("modifyRow",function(i,a){return n.onModifyRow(i,a)}),this.addHook("unmodifyRow",function(i,a){return n.onUnmodifyRow(i,a)}),this.addHook("afterGetColHeader",function(i,a){return n.onAfterGetColHeader(i,a)}),this.addHook("beforeOnCellMouseDown",function(i,a,o,s){return n.onBeforeOnCellMouseDown(i,a,o,s)}),this.addHook("afterOnCellMouseDown",function(i,a){return n.onAfterOnCellMouseDown(i,a)}),this.addHook("afterCreateRow",function(i,a){return n.onAfterCreateRow(i,a)}),this.addHook("afterRemoveRow",function(i,a){return n.onAfterRemoveRow(i,a)}),this.addHook("afterInit",function(){return n.loadOrSortBySettings()}),this.addHook("afterLoadData",function(i){return n.onAfterLoadData(i)}),this.addHook("afterCreateCol",function(){return n.onAfterCreateCol()}),this.addHook("afterRemoveCol",function(){return n.onAfterRemoveCol()}),this.hot.view&&this.loadOrSortBySettings(),ja(Ji(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var n=this,i=function(o,s){var l=Jm(s);Qm(o,s)===!1||l===null||n.updateHeaderClasses(l)};this.hot.addHook("afterGetColHeader",i),this.hot.addHookOnce("afterRender",function(){n.hot.removeHook("afterGetColHeader",i)}),this.rowsMapper.clearMap(),ja(Ji(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(n){var i=this,a=this.getSortConfig(),o=this.getNormalizedSortConfigs(n),s=this.areValidSortConfigs(o),l=this.hot.runHooks("beforeColumnSort",a,o,s);if(l!==!1){if(s){var u=function(h){var d=h.column,g=Ql(h,["column"]);return Jl({column:i.hot.toPhysicalColumn(d)},g)},f=Zt(o,function(c){return u(c)});this.columnStatesManager.setSortStates(f),this.sortByPresetSortStates(),this.saveAllSortSettings(),this.hot.render(),this.hot.view.wt.draw(!0)}this.hot.runHooks("afterColumnSort",a,this.getSortConfig(),s)}}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(n){var i=this,a=function(f){var c=f.column,h=Ql(f,["column"]);return Jl({column:i.hot.toVisualColumn(c)},h)};if(ir(n)){var o=this.hot.toPhysicalColumn(n),s=this.columnStatesManager.getColumnSortState(o);return ir(s)?a(s):void 0}var l=this.columnStatesManager.getSortStates();return Zt(l,function(u){return a(u)})}},{key:"setSortConfig",value:function(n){var i=this,a=this.getNormalizedSortConfigs(n);if(this.areValidSortConfigs(a)){var o=function(u){var f=u.column,c=Ql(u,["column"]);return Jl({column:i.hot.toPhysicalColumn(f)},c)},s=Zt(a,function(l){return o(l)});this.columnStatesManager.setSortStates(s)}}},{key:"getNormalizedSortConfigs",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(n)?n.slice(0,1):[n].slice(0,1)}},{key:"areValidSortConfigs",value:function(n){if(Array.isArray(n)===!1)return!1;var i=n.map(function(s){var l=s.column;return l}),a=this.hot.countCols(),o=i.every(function(s){return s<=a&&s>=0});return nP(n)&&o}},{key:"saveAllSortSettings",value:function(){var n=this.columnStatesManager.getAllColumnsProperties();n.initialConfig=this.columnStatesManager.getSortStates(),this.hot.runHooks("persistentStateSave","columnSorting",n)}},{key:"getAllSavedSortSettings",value:function(){var n=this,i={};this.hot.runHooks("persistentStateLoad","columnSorting",i);var a=i.value,o=function(l){var u=l.column,f=Ql(l,["column"]);return Jl({column:n.hot.toVisualColumn(u)},f)};return ir(a)&&Array.isArray(a.initialConfig)&&(a.initialConfig=Zt(a.initialConfig,o)),a}},{key:"getColumnNextConfig",value:function(n){var i=this.hot.toPhysicalColumn(n);if(this.columnStatesManager.isColumnSorted(i)){var a=this.getSortConfig(n),o=Zm(a.sortOrder);return ir(o)?(a.sortOrder=o,a):void 0}var s=this.hot.countCols();if(Number.isInteger(n)&&n>=0&&n<s)return{column:n,sortOrder:Zm()}}},{key:"getNextSortConfig",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:lp,a=this.hot.toPhysicalColumn(n),o=this.columnStatesManager.getIndexOfColumnInSortQueue(a),s=this.columnStatesManager.isColumnSorted(a),l=this.getSortConfig(),u=this.getColumnNextConfig(n);if(s){if(Mr(u))return[].concat(Po(l.slice(0,o)),Po(l.slice(o+1)));if(i===lp)return[].concat(Po(l.slice(0,o)),Po(l.slice(o+1)),[u]);if(i===UP)return[].concat(Po(l.slice(0,o)),[u],Po(l.slice(o+1)))}return ir(u)?l.concat(u):l}},{key:"setMergedPluginSettings",value:function(n){var i=this.hot.toPhysicalColumn(n),a=this.hot.getSettings()[this.pluginKey],o=this.columnStatesManager.getAllColumnsProperties(),s=this.hot.getCellMeta(0,n),l=Object.getPrototypeOf(s),u=Object.hasOwnProperty.call(l,this.pluginKey),f=u?l[this.pluginKey]:{};this.columnMetaCache.set(i,Object.assign(o,a,f))}},{key:"getFirstCellSettings",value:function(n){var i=this.blockPluginTranslation;this.blockPluginTranslation=!0,(this.columnMetaCache.size===0||this.columnMetaCache.size<this.hot.countCols())&&this.rebuildColumnMetaCache();var a=this.hot.getCellMeta(0,n);this.blockPluginTranslation=i;var o=Object.create(a);return o[this.pluginKey]=this.columnMetaCache.get(this.hot.toPhysicalColumn(n)),o}},{key:"rebuildColumnMetaCache",value:function(){var n=this,i=this.hot.countCols();i===0?this.columnMetaCache.clear():Ke(i-1,function(a){return n.setMergedPluginSettings(a)})}},{key:"getNumberOfRowsToSort",value:function(n){var i=this.hot.getSettings();return i.maxRows<=n?i.maxRows:n-i.minSpareRows}},{key:"sortByPresetSortStates",value:function(){var n=this;if(this.columnStatesManager.isListOfSortedColumnsEmpty()){this.rowsMapper.clearMap();return}var i=[],a=this.columnStatesManager.getSortedColumns(),o=this.hot.countRows();this.blockPluginTranslation=!0;for(var s=function(c){return Zt(a,function(h){return n.hot.getDataAtCell(c,n.hot.toVisualColumn(h))})},l=0;l<this.getNumberOfRowsToSort(o);l+=1)i.push([l].concat(s(l)));OP(i,this.pluginKey,Zt(a,function(f){return n.columnStatesManager.getSortOrderOfColumn(f)}),Zt(a,function(f){return n.getFirstCellSettings(n.hot.toVisualColumn(f))}));for(var u=i.length;u<o;u+=1)i.push([u].concat(s(u)));this.blockPluginTranslation=!1,this.rowsMapper._arrayMap=Zt(i,function(f){return f[0]})}},{key:"loadOrSortBySettings",value:function(){this.columnMetaCache.clear();var n=this.getAllSavedSortSettings();if(Rt(n))this.sortBySettings(n);else{var i=this.hot.getSettings()[this.pluginKey];this.sortBySettings(i)}}},{key:"sortBySettings",value:function(n){if(Rt(n)){this.columnStatesManager.updateAllColumnsProperties(n);var i=n.initialConfig;(Array.isArray(i)||Rt(i))&&this.sort(i)}else this.hot.render()}},{key:"enableObserveChangesPlugin",value:function(){var n=this;this.hot._registerTimeout(setTimeout(function(){n.hot.updateSettings({observeChanges:!0})},0))}},{key:"onModifyRow",value:function(n,i){if(this.blockPluginTranslation===!1&&i!==this.pluginName&&this.isSorted()){var a=this.rowsMapper.getValueByIndex(n);n=a===null?n:a}return n}},{key:"onUnmodifyRow",value:function(n,i){return this.blockPluginTranslation===!1&&i!==this.pluginName&&this.isSorted()&&(n=this.rowsMapper.getIndexByValue(n)),n}},{key:"onAfterGetColHeader",value:function(n,i){var a=Jm(i);if(!(Qm(n,i)===!1||a===null)){var o=this.hot.toPhysicalColumn(n),s=this.getFirstCellSettings(n)[this.pluginKey],l=s.indicator,u=s.headerAction;this.updateHeaderClasses(a,this.columnStatesManager,o,l,u)}}},{key:"updateHeaderClasses",value:function(n){if(pt(n,sP()),this.enabled!==!1){for(var i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];$e(n,oP.apply(void 0,a))}}},{key:"onUpdateSettings",value:function(n){ja(Ji(r.prototype),"onUpdateSettings",this).call(this),this.columnMetaCache.clear(),ir(n[this.pluginKey])&&this.sortBySettings(n[this.pluginKey])}},{key:"onAfterLoadData",value:function(n){this.rowsMapper.clearMap(),this.columnMetaCache.clear(),n===!0&&this.hot.view&&this.loadOrSortBySettings()}},{key:"onAfterCreateRow",value:function(n,i){this.rowsMapper.shiftItems(n,i)}},{key:"onAfterRemoveRow",value:function(n,i){this.rowsMapper.unshiftItems(n,i)}},{key:"onAfterCreateCol",value:function(){this.columnMetaCache.clear()}},{key:"onAfterRemoveCol",value:function(){this.columnMetaCache.clear()}},{key:"wasClickableHeaderClicked",value:function(n,i){var a=this.getFirstCellSettings(i)[this.pluginKey],o=a.headerAction;return o&&n.realTarget.nodeName==="SPAN"}},{key:"onBeforeOnCellMouseDown",value:function(n,i,a,o){ep(i.row,i.col,n)!==!1&&this.wasClickableHeaderClicked(n,i.col)&&Td()&&(o.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(n,i){ep(i.row,i.col,n)!==!1&&this.wasClickableHeaderClicked(n,i.col)&&(Td()&&(this.hot.deselectCell(),this.hot.selectColumns(i.col)),this.sort(this.getColumnNextConfig(i.col)))}},{key:"destroy",value:function(){this.rowsMapper.destroy(),this.columnStatesManager.destroy(),ja(Ji(r.prototype),"destroy",this).call(this)}}]),r}(fr);ur(jv,uC);function VP(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function up(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function fp(e,r,t){return r&&up(e.prototype,r),t&&up(e,t),e}var zP=function(){fp(e,null,[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]);function e(){VP(this,e),this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return fp(e,[{key:"setPosition",value:function(t,n){this.editorStyle.left="".concat(t,"px"),this.editorStyle.top="".concat(n,"px")}},{key:"setSize",value:function(t,n){if(t&&n){var i=this.getInputElement();i.style.width="".concat(t,"px"),i.style.height="".concat(n,"px")}}},{key:"resetSize",value:function(){var t=this.getInputElement();t.style.width="",t.style.height=""}},{key:"setReadOnlyState",value:function(t){var n=this.getInputElement();n.readOnly=t}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.editorStyle.display="none",this.hidden=!0}},{key:"isVisible",value:function(){return this.editorStyle.display==="block"}},{key:"setValue",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=t||"";this.getInputElement().value=n}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return document.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var t=document.createElement("div"),n=document.createElement("textarea"),i=document.querySelector(".".concat(e.CLASS_EDITOR_CONTAINER));return i||(i=document.createElement("div"),$e(i,e.CLASS_EDITOR_CONTAINER),document.body.appendChild(i)),$e(t,e.CLASS_EDITOR),$e(n,e.CLASS_INPUT),t.appendChild(n),i.appendChild(t),t}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(e.CLASS_INPUT))}},{key:"destroy",value:function(){this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null}}]),e}(),Cr="---------";function jP(){return{name:Cr}}function YP(e){return Zt(e,function(r){return{start:r.getTopLeftCorner(),end:r.getBottomRightCorner()}})}function eu(e){return gt(e,"htSeparator")}function GP(e){return gt(e,"htSubmenu")}function tu(e){return gt(e,"htDisabled")}function ru(e){return gt(e,"htSelectionDisabled")}function So(e){var r=e.getSelected();return!r||r[0]<0?null:r}function XP(e,r){if(e.indexOf(r)!==-1)return e;var t=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(t," ").concat(r)}function KP(e,r){if(e.indexOf(r)!==-1)return e;var t=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(t," ").concat(r)}function Da(e,r){var t={};return pe(e,function(n){for(var i=n.from,a=n.to,o=i.row;o<=a.row;o++)for(var s=i.col;s<=a.col;s++)t[o]||(t[o]=[]),t[o][s]=r(o,s)}),t}function Yi(e,r,t,n,i){pe(e,function(a){var o=a.from,s=a.to;if(o.row===s.row&&o.col===s.col)cp(o.row,o.col,r,t,n,i);else for(var l=o.row;l<=s.row;l++)for(var u=o.col;u<=s.col;u++)cp(l,u,r,t,n,i)})}function cp(e,r,t,n,i,a){var o=i(e,r),s=n;o.className&&(t==="vertical"?s=XP(o.className,n):s=KP(o.className,n)),a(e,r,"className",s)}function ni(e,r){var t=!1;return Array.isArray(e)&&pe(e,function(n){return n.forAll(function(i,a){if(r(i,a))return t=!0,!1}),t}),t}function Si(e){return'<span class="selected">'.concat("✓","</span>").concat(e)}function qP(e,r){return!e.hidden||!(typeof e.hidden=="function"&&e.hidden.call(r))}function fC(e,r){for(var t=e.slice(0),n=0;n<t.length&&t[n].name===r;)t.shift();return t}function ZP(e,r){var t=e.slice(0);return t.reverse(),t=fC(t,r),t.reverse(),t}function JP(e){var r=[];return pe(e,function(t,n){n>0?r[r.length-1].name!==t.name&&r.push(t):r.push(t)}),r}function QP(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Cr,t=e.slice(0);return t=fC(t,r),t=ZP(t,r),t=JP(t),t}function eN(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function hp(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function tN(e,r,t){return r&&hp(e.prototype,r),t&&hp(e,t),e}var rN=250,nN=250,cC=function(){function e(r){eN(this,e),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(r)}return tN(e,[{key:"hide",value:function(){var t=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout(function(){t.wasLastActionShow===!1&&t.runLocalHooks("hide")},nN)}},{key:"show",value:function(t){this.wasLastActionShow=!0,this.showDebounced(t)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var t=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:rN;this.showDebounced=Z0(function(i){t.wasLastActionShow&&t.runLocalHooks("show",i.from.row,i.from.col)},n)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),e}();vi(cC,Co);function ju(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ju=function(t){return typeof t}:ju=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ju(e)}function mh(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function iN(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function dp(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function aN(e,r,t){return r&&dp(e.prototype,r),t&&dp(e,t),e}function oN(e,r){return r&&(ju(r)==="object"||typeof r=="function")?r:Hd(e)}function Ya(e,r,t){return typeof Reflect<"u"&&Reflect.get?Ya=Reflect.get:Ya=function(i,a,o){var s=sN(i,a);if(s){var l=Object.getOwnPropertyDescriptor(s,a);return l.get?l.get.call(o):l.value}},Ya(e,r,t||e)}function sN(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=Qi(e),e!==null););return e}function Qi(e){return Qi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Qi(e)}function lN(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&Id(e,r)}function Id(e,r){return Id=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Id(e,r)}function Hd(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var nu=new WeakMap,Jn="comment",No="value",vp="style",iu="readOnly",hC=function(e){lN(r,e);function r(t){var n;return iN(this,r),n=oN(this,Qi(r).call(this,t)),n.editor=null,n.displaySwitch=null,n.eventManager=null,n.range={},n.mouseDown=!1,n.contextMenuEvent=!1,n.timer=null,nu.set(Hd(Hd(n)),{tempEditorDimensions:{},cellBelowCursor:null}),n}return aN(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().comments}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.editor||(this.editor=new zP),this.eventManager||(this.eventManager=new Ft(this)),this.displaySwitch||(this.displaySwitch=new cC(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(i){return n.addToContextMenu(i)}),this.addHook("afterRenderer",function(i,a,o,s,l,u){return n.onAfterRenderer(i,u)}),this.addHook("afterScrollHorizontally",function(){return n.hide()}),this.addHook("afterScrollVertically",function(){return n.hide()}),this.addHook("afterBeginEditing",function(){return n.onAfterBeginEditing()}),this.displaySwitch.addLocalHook("hide",function(){return n.hide()}),this.displaySwitch.addLocalHook("show",function(i,a){return n.showAtCell(i,a)}),this.registerListeners(),Ya(Qi(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ya(Qi(r.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){Ya(Qi(r.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var n=this;this.eventManager.addEventListener(document,"mouseover",function(i){return n.onMouseOver(i)}),this.eventManager.addEventListener(document,"mousedown",function(i){return n.onMouseDown(i)}),this.eventManager.addEventListener(document,"mouseup",function(){return n.onMouseUp()}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(){return n.onEditorBlur()}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(i){return n.onEditorMouseDown(i)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(i){return n.onEditorMouseUp(i)})}},{key:"setRange",value:function(n){this.range=n}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(n){var i=ao(n.target,"TD","TBODY");return!!(i&&gt(i,"htCommentCell")&&ao(i,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(n){return this.editor.getInputElement()===n.target}},{key:"setComment",value:function(n){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var i=this.editor.getValue(),a="";n!=null?a=n:i!=null&&(a=i);var o=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(o,s,mh({},No,a)),this.hot.render()}},{key:"setCommentAtCell",value:function(n,i,a){this.setRange({from:new me(n,i)}),this.setComment(a)}},{key:"removeComment",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Jn,void 0),n&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(n,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:new me(n,i)}),this.removeComment(a)}},{key:"getComment",value:function(){var n=this.range.from.row,i=this.range.from.col;return this.getCommentMeta(n,i,No)}},{key:"getCommentAtCell",value:function(n,i){return this.getCommentMeta(n,i,No)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var n=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.refreshEditor(!0),this.editor.setValue(n[Jn]?n[Jn][No]:""),this.editor.hidden&&this.editor.show(),!0}},{key:"showAtCell",value:function(n,i){return this.setRange({from:new me(n,i)}),this.show()}},{key:"hide",value:function(){this.editor.hidden||this.editor.hide()}},{key:"refreshEditor",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!n&&(!this.range.from||!this.editor.isVisible()))){var i=co(this.hot.view.wt.wtTable.TABLE),a=this.hot.view.wt.wtTable.getCell(this.range.from),o=this.range.from.row,s=this.range.from.col,l=Xt(a),u=this.hot.view.wt.wtTable.getStretchedColumnWidth(s),f=l.top<0?0:l.top,c=l.left;this.hot.view.wt.wtViewport.hasVerticalScroll()&&i!==window&&(f-=this.hot.view.wt.wtOverlays.topOverlay.getScrollPosition()),this.hot.view.wt.wtViewport.hasHorizontalScroll()&&i!==window&&(c-=this.hot.view.wt.wtOverlays.leftOverlay.getScrollPosition());var h=c+u,d=f,g=this.getCommentMeta(o,s,vp),v=this.getCommentMeta(o,s,iu);g?this.editor.setSize(g.width,g.height):this.editor.resetSize(),this.editor.setReadOnlyState(v),this.editor.setPosition(h,d)}}},{key:"checkSelectionCommentsConsistency",value:function(){var n=this.hot.getSelectedRangeLast();if(!n)return!1;var i=!1,a=n.from;return this.getCommentMeta(a.row,a.col,No)&&(i=!0),i}},{key:"updateCommentMeta",value:function(n,i,a){var o=this.hot.getCellMeta(n,i)[Jn],s;o?(s=Wr(o),Il(s,a)):s=a,this.hot.setCellMeta(n,i,Jn,s)}},{key:"getCommentMeta",value:function(n,i,a){var o=this.hot.getCellMeta(n,i);if(o[Jn])return o[Jn][a]}},{key:"onMouseDown",value:function(n){if(this.mouseDown=!0,!(!this.hot.view||!this.hot.view.wt)){if(!this.contextMenuEvent&&!this.targetIsCommentTextArea(n)){var i=ao(n.target,"TD","TBODY"),a=null;i&&(a=this.hot.view.wt.wtTable.getCoords(i)),(!i||this.range.from&&a&&(this.range.from.row!==a.row||this.range.from.col!==a.col))&&this.hide()}this.contextMenuEvent=!1}}},{key:"onMouseOver",value:function(n){var i=nu.get(this);if(i.cellBelowCursor=document.elementFromPoint(n.clientX,n.clientY),!(this.mouseDown||this.editor.isFocused()||gt(n.target,"wtBorder")||i.cellBelowCursor!==n.target||!this.editor))if(this.targetIsCellWithComment(n)){var a=this.hot.view.wt.wtTable.getCoords(n.target),o={from:new me(a.row,a.col)};this.displaySwitch.show(o)}else Ti(n.target,document)&&!this.targetIsCommentTextArea(n)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onAfterRenderer",value:function(n,i){i[Jn]&&i[Jn][No]&&$e(n,i.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(n){var i=nu.get(this);i.tempEditorDimensions={width:Gt(n.target),height:sr(n.target)}}},{key:"onEditorMouseUp",value:function(n){var i=nu.get(this),a=Gt(n.target),o=sr(n.target);(a!==i.tempEditorDimensions.width+1||o!==i.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,mh({},vp,{width:a,height:o}))}},{key:"onContextMenuAddComment",value:function(){var n=this;this.displaySwitch.cancelHiding();var i=this.hot.getSelectedRangeLast();this.contextMenuEvent=!0,this.setRange({from:i.from}),this.show(),setTimeout(function(){n.hot&&(n.hot.deselectCell(),n.editor.focus())},10)}},{key:"onContextMenuRemoveComment",value:function(){var n=this.hot.getSelectedRangeLast(),i=n.from,a=n.to;this.contextMenuEvent=!0;for(var o=i.row;o<=a.row;o++)for(var s=i.col;s<=a.col;s++)this.removeCommentAtCell(o,s,!1);this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var n=this.hot.getSelectedRangeLast(),i=n.from,a=n.to;this.contextMenuEvent=!0;for(var o=i.row;o<=a.row;o++)for(var s=i.col;s<=a.col;s++){var l=!!this.getCommentMeta(o,s,iu);this.updateCommentMeta(o,s,mh({},iu,!l))}}},{key:"addToContextMenu",value:function(n){var i=this;n.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return i.checkSelectionCommentsConsistency()?i.hot.getTranslatedPhrase(bv):i.hot.getTranslatedPhrase(Sv)},callback:function(){return i.onContextMenuAddComment()},disabled:function(){return!(this.getSelectedLast()&&!this.selection.isSelectedByCorner())}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(xv)},callback:function(){return i.onContextMenuRemoveComment()},disabled:function(){return i.hot.selection.isSelectedByCorner()}},{key:"commentsReadOnly",name:function(){var o=this,s=this.getTranslatedPhrase(Ev),l=ni(this.getSelectedRangeLast(),function(u,f){var c=o.getCellMeta(u,f)[Jn];if(c&&(c=c[iu]),c)return!0});return l&&(s=Si(s)),s},callback:function(){return i.onContextMenuMakeReadOnly()},disabled:function(){return i.hot.selection.isSelectedByCorner()||!i.checkSelectionCommentsConsistency()}})}},{key:"getDisplayDelaySetting",value:function(){var n=this.hot.getSettings().comments;if(Rt(n))return n.displayDelay}},{key:"onAfterBeginEditing",value:function(){this.hide()}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),Ya(Qi(r.prototype),"destroy",this).call(this)}}]),r}(fr);ur("comments",hC);function uN(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function gp(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function fN(e,r,t){return r&&gp(e.prototype,r),t&&gp(e,t),e}var cN=function(){function e(r){uN(this,e),this.hot=r,this.commands={},this.commonCallback=null}return fN(e,[{key:"registerCommand",value:function(t,n){this.commands[t]=n}},{key:"setCommonCallback",value:function(t){this.commonCallback=t}},{key:"execute",value:function(t){for(var n=this,i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];var s=t.split(":"),l=s[0],u=s.length===2?s[1]:null,f=this.commands[l];if(!f)throw new Error("Menu command '".concat(l,"' not exists."));if(u&&f.submenu&&(f=hN(u,f.submenu.items)),f.disabled!==!0&&!(typeof f.disabled=="function"&&f.disabled.call(this.hot)===!0)&&!At(f,"submenu")){var c=[];typeof f.callback=="function"&&c.push(f.callback),typeof this.commonCallback=="function"&&c.push(this.commonCallback),a.unshift(s.join(":")),pe(c,function(h){return h.apply(n.hot,a)})}}}]),e}();function hN(e,r){var t;return pe(r,function(n){var i=n.key?n.key.split(":"):null;if(Array.isArray(i)&&i[1]===e)return t=n,!1}),t}var Wn="alignment";function dN(){return{key:Wn,name:function(){return this.getTranslatedPhrase(Tv)},disabled:function(){return!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(Wn,":left"),name:function(){var r=this,t=this.getTranslatedPhrase(Ov),n=ni(this.getSelectedRange(),function(i,a){var o=r.getCellMeta(i,a).className;if(o&&o.indexOf("htLeft")!==-1)return!0});return n&&(t=Si(t)),t},callback:function(){var r=this,t=this.getSelectedRange(),n=Da(t,function(o,s){return r.getCellMeta(o,s).className}),i="horizontal",a="htLeft";this.runHooks("beforeCellAlignment",n,t,i,a),Yi(t,i,a,function(o,s){return r.getCellMeta(o,s)},function(o,s,l,u){return r.setCellMeta(o,s,l,u)}),this.render()},disabled:!1},{key:"".concat(Wn,":center"),name:function(){var r=this,t=this.getTranslatedPhrase(Rv),n=ni(this.getSelectedRange(),function(i,a){var o=r.getCellMeta(i,a).className;if(o&&o.indexOf("htCenter")!==-1)return!0});return n&&(t=Si(t)),t},callback:function(){var r=this,t=this.getSelectedRange(),n=Da(t,function(o,s){return r.getCellMeta(o,s).className}),i="horizontal",a="htCenter";this.runHooks("beforeCellAlignment",n,t,i,a),Yi(t,i,a,function(o,s){return r.getCellMeta(o,s)},function(o,s,l,u){return r.setCellMeta(o,s,l,u)}),this.render()},disabled:!1},{key:"".concat(Wn,":right"),name:function(){var r=this,t=this.getTranslatedPhrase(kv),n=ni(this.getSelectedRange(),function(i,a){var o=r.getCellMeta(i,a).className;if(o&&o.indexOf("htRight")!==-1)return!0});return n&&(t=Si(t)),t},callback:function(){var r=this,t=this.getSelectedRange(),n=Da(t,function(o,s){return r.getCellMeta(o,s).className}),i="horizontal",a="htRight";this.runHooks("beforeCellAlignment",n,t,i,a),Yi(t,i,a,function(o,s){return r.getCellMeta(o,s)},function(o,s,l,u){return r.setCellMeta(o,s,l,u)}),this.render()},disabled:!1},{key:"".concat(Wn,":justify"),name:function(){var r=this,t=this.getTranslatedPhrase(Av),n=ni(this.getSelectedRange(),function(i,a){var o=r.getCellMeta(i,a).className;if(o&&o.indexOf("htJustify")!==-1)return!0});return n&&(t=Si(t)),t},callback:function(){var r=this,t=this.getSelectedRange(),n=Da(t,function(o,s){return r.getCellMeta(o,s).className}),i="horizontal",a="htJustify";this.runHooks("beforeCellAlignment",n,t,i,a),Yi(t,i,a,function(o,s){return r.getCellMeta(o,s)},function(o,s,l,u){return r.setCellMeta(o,s,l,u)}),this.render()},disabled:!1},{name:Cr},{key:"".concat(Wn,":top"),name:function(){var r=this,t=this.getTranslatedPhrase(Mv),n=ni(this.getSelectedRange(),function(i,a){var o=r.getCellMeta(i,a).className;if(o&&o.indexOf("htTop")!==-1)return!0});return n&&(t=Si(t)),t},callback:function(){var r=this,t=this.getSelectedRange(),n=Da(t,function(o,s){return r.getCellMeta(o,s).className}),i="vertical",a="htTop";this.runHooks("beforeCellAlignment",n,t,i,a),Yi(t,i,a,function(o,s){return r.getCellMeta(o,s)},function(o,s,l,u){return r.setCellMeta(o,s,l,u)}),this.render()},disabled:!1},{key:"".concat(Wn,":middle"),name:function(){var r=this,t=this.getTranslatedPhrase(Dv),n=ni(this.getSelectedRange(),function(i,a){var o=r.getCellMeta(i,a).className;if(o&&o.indexOf("htMiddle")!==-1)return!0});return n&&(t=Si(t)),t},callback:function(){var r=this,t=this.getSelectedRange(),n=Da(t,function(o,s){return r.getCellMeta(o,s).className}),i="vertical",a="htMiddle";this.runHooks("beforeCellAlignment",n,t,i,a),Yi(t,i,a,function(o,s){return r.getCellMeta(o,s)},function(o,s,l,u){return r.setCellMeta(o,s,l,u)}),this.render()},disabled:!1},{key:"".concat(Wn,":bottom"),name:function(){var r=this,t=this.getTranslatedPhrase(Pv),n=ni(this.getSelectedRange(),function(i,a){var o=r.getCellMeta(i,a).className;if(o&&o.indexOf("htBottom")!==-1)return!0});return n&&(t=Si(t)),t},callback:function(){var r=this,t=this.getSelectedRange(),n=Da(t,function(o,s){return r.getCellMeta(o,s).className}),i="vertical",a="htBottom";this.runHooks("beforeCellAlignment",n,t,i,a),Yi(t,i,a,function(o,s){return r.getCellMeta(o,s)},function(o,s,l,u){return r.setCellMeta(o,s,l,u)}),this.render()},disabled:!1}]}}}function vN(e,r){return pN(e)||mN(e,r)||gN()}function gN(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function mN(e,r){var t=[],n=!0,i=!1,a=void 0;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done)&&(t.push(s.value),!(r&&t.length===r));n=!0);}catch(l){i=!0,a=l}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw a}}return t}function pN(e){if(Array.isArray(e))return e}var Yv="clear_column";function yN(){return{key:Yv,name:function(){return this.getTranslatedPhrase(gv)},callback:function(r,t){var n=t[0].start.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(t[0].start.row,t[0].end.row),n,"ContextMenu.clearColumn")},disabled:function(){var r=So(this);if(!r)return!0;var t=vN(r[0],3),n=t[0],i=t[1],a=t[2],o=[n,0,a,this.countCols()-1],s=o.join(",")===r.join(",");return i<0||this.countCols()>=this.getSettings().maxCols||s}}}function wN(e,r){return SN(e)||CN(e,r)||_N()}function _N(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function CN(e,r){var t=[],n=!0,i=!1,a=void 0;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done)&&(t.push(s.value),!(r&&t.length===r));n=!0);}catch(l){i=!0,a=l}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw a}}return t}function SN(e){if(Array.isArray(e))return e}var wc="col_left";function bN(){return{key:wc,name:function(){return this.getTranslatedPhrase(lv)},callback:function(r,t){var n=t[Math.max(t.length-1,0)];this.alter("insert_col",n.start.col,1,"ContextMenu.columnLeft")},disabled:function(){var r=So(this);if(!r||!this.isColumnModificationAllowed())return!0;var t=wN(r[0],3),n=t[0],i=t[1],a=t[2],o=[n,0,a,this.countCols()-1],s=o.join(",")===r.join(","),l=this.countCols()===1;return i<0||this.countCols()>=this.getSettings().maxCols||!l&&s},hidden:function(){return!this.getSettings().allowInsertColumn}}}function xN(e,r){return ON(e)||TN(e,r)||EN()}function EN(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function TN(e,r){var t=[],n=!0,i=!1,a=void 0;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done)&&(t.push(s.value),!(r&&t.length===r));n=!0);}catch(l){i=!0,a=l}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw a}}return t}function ON(e){if(Array.isArray(e))return e}var _c="col_right";function RN(){return{key:_c,name:function(){return this.getTranslatedPhrase(uv)},callback:function(r,t){var n=t[Math.max(t.length-1,0)];this.alter("insert_col",n.end.col+1,1,"ContextMenu.columnRight")},disabled:function(){var r=So(this);if(!r||!this.isColumnModificationAllowed())return!0;var t=xN(r[0],3),n=t[0],i=t[1],a=t[2],o=[n,0,a,this.countCols()-1],s=o.join(",")===r.join(","),l=this.countCols()===1;return i<0||this.countCols()>=this.getSettings().maxCols||!l&&s},hidden:function(){return!this.getSettings().allowInsertColumn}}}var Cc="make_read_only";function kN(){return{key:Cc,name:function(){var r=this,t=this.getTranslatedPhrase(vv),n=ni(this.getSelectedRange(),function(i,a){return r.getCellMeta(i,a).readOnly});return n&&(t=Si(t)),t},callback:function(){var r=this,t=this.getSelectedRange(),n=ni(t,function(i,a){return r.getCellMeta(i,a).readOnly});pe(t,function(i){i.forAll(function(a,o){r.setCellMeta(a,o,"readOnly",!n)})}),this.render()},disabled:function(){return!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())}}}var Sc="redo";function AN(){return{key:Sc,name:function(){return this.getTranslatedPhrase(dv)},callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}}}function MN(e,r){return NN(e)||PN(e,r)||DN()}function DN(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function PN(e,r){var t=[],n=!0,i=!1,a=void 0;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done)&&(t.push(s.value),!(r&&t.length===r));n=!0);}catch(l){i=!0,a=l}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw a}}return t}function NN(e){if(Array.isArray(e))return e}var bc="remove_col";function FN(){return{key:bc,name:function(){var r=this.getSelected(),t=0;if(r)if(r.length>1)t=1;else{var n=MN(r[0],4),i=n[1],a=n[3];i-a!==0&&(t=1)}return this.getTranslatedPhrase(cv,t)},callback:function(){this.alter("remove_col",$M(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){var r=So(this),t=this.countCols();return r?this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner()||!this.isColumnModificationAllowed()||!t:!0},hidden:function(){return!this.getSettings().allowRemoveColumn}}}function LN(e,r){return BN(e)||HN(e,r)||IN()}function IN(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function HN(e,r){var t=[],n=!0,i=!1,a=void 0;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done)&&(t.push(s.value),!(r&&t.length===r));n=!0);}catch(l){i=!0,a=l}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw a}}return t}function BN(e){if(Array.isArray(e))return e}var xc="remove_row";function WN(){return{key:xc,name:function(){var r=this.getSelected(),t=0;if(r)if(r.length>1)t=1;else{var n=LN(r[0],3),i=n[0],a=n[2];i-a!==0&&(t=1)}return this.getTranslatedPhrase(fv,t)},callback:function(){this.alter("remove_row",UM(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var r=So(this),t=this.countRows();return r?this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner()||!t:!0},hidden:function(){return!this.getSettings().allowRemoveRow}}}var Ec="row_above";function $N(){return{key:Ec,name:function(){return this.getTranslatedPhrase(ov)},callback:function(r,t){var n=t[Math.max(t.length-1,0)];this.alter("insert_row",n.start.row,1,"ContextMenu.rowAbove")},disabled:function(){var r=So(this);return r?this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden:function(){return!this.getSettings().allowInsertRow}}}var Tc="row_below";function UN(){return{key:Tc,name:function(){return this.getTranslatedPhrase(sv)},callback:function(r,t){var n=t[Math.max(t.length-1,0)];this.alter("insert_row",n.end.row+1,1,"ContextMenu.rowBelow")},disabled:function(){var r=So(this);return r?this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden:function(){return!this.getSettings().allowInsertRow}}}var Oc="undo";function VN(){return{key:Oc,name:function(){return this.getTranslatedPhrase(hv)},callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}}}var un;function Mn(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var zN=[Ec,Tc,wc,_c,Yv,xc,bc,Oc,Sc,Cc,Wn,Cr],jN=(un={},Mn(un,Cr,jP),Mn(un,Ec,$N),Mn(un,Tc,UN),Mn(un,wc,bN),Mn(un,_c,RN),Mn(un,Yv,yN),Mn(un,xc,WN),Mn(un,bc,FN),Mn(un,Oc,VN),Mn(un,Sc,AN),Mn(un,Cc,kN),Mn(un,Wn,dN),un);function YN(){var e={};return St(jN,function(r,t){e[t]=r()}),e}function GN(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function mp(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function XN(e,r,t){return r&&mp(e.prototype,r),t&&mp(e,t),e}var KN=function(){function e(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;GN(this,e),this.hot=r,this.predefinedItems=YN(),this.defaultOrderPattern=t}return XN(e,[{key:"setPredefinedItems",value:function(t){var n=this,i={};this.defaultOrderPattern.length=0,St(t,function(a,o){var s="";a.name===Cr?(i[Cr]=a,s=Cr):isNaN(parseInt(o,10))?(a.key=a.key===void 0?o:a.key,i[o]=a,s=a.key):(i[a.key]=a,s=a.key),n.defaultOrderPattern.push(s)}),this.predefinedItems=i}},{key:"getItems",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return qN(t,this.defaultOrderPattern,this.predefinedItems)}}]),e}();function qN(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=[],i=e;return i&&i.items?i=i.items:Array.isArray(i)||(i=r),Rt(i)?St(i,function(a,o){var s=t[typeof a=="string"?a:o];s||(s=a),Rt(a)?pn(s,a):typeof s=="string"&&(s={name:s}),s.key===void 0&&(s.key=o),n.push(s)}):pe(i,function(a,o){var s=t[a];!s&&zN.indexOf(a)>=0||(s||(s={name:a,key:"".concat(o)}),Rt(a)&&pn(s,a),s.key===void 0&&(s.key=o),n.push(s))}),n}function ZN(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function pp(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function JN(e,r,t){return r&&pp(e.prototype,r),t&&pp(e,t),e}var QN=function(){function e(r){ZN(this,e);var t=wo(),n=ya(),i,a,o,s,l,u;this.type=this.getSourceType(r),this.type==="literal"?(i=parseInt(r.top,10),o=parseInt(r.left,10),l=r.height||0,u=r.width||0,a=i,s=o,i+=t,o+=n):this.type==="event"&&(i=parseInt(dl(r),10),o=parseInt(hl(r),10),l=r.target.clientHeight,u=r.target.clientWidth,a=i-t,s=o-n),this.top=i,this.topRelative=a,this.left=o,this.leftRelative=s,this.scrollTop=t,this.scrollLeft=n,this.cellHeight=l,this.cellWidth=u}return JN(e,[{key:"getSourceType",value:function(t){var n="literal";return t instanceof Event&&(n="event"),n}},{key:"fitsAbove",value:function(t){return this.topRelative>=t.offsetHeight}},{key:"fitsBelow",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window.innerHeight;return this.topRelative+t.offsetHeight<=n}},{key:"fitsOnRight",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window.innerWidth;return this.leftRelative+this.cellWidth+t.offsetWidth<=n}},{key:"fitsOnLeft",value:function(t){return this.leftRelative>=t.offsetWidth}}]),e}();function eF(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function yp(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function tF(e,r,t){return r&&yp(e.prototype,r),t&&yp(e,t),e}var wp=215,dC=function(){function e(r,t){eF(this,e),this.hot=r,this.options=t||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:wp},this.eventManager=new Ft(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return tF(e,[{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(document.documentElement,"mousedown",function(n){return t.onDocumentMouseDown(n)})}},{key:"setMenuItems",value:function(t){this.menuItems=t}},{key:"setOffset",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[t]=n}},{key:"isSubMenu",value:function(){return this.parentMenu!==null}},{key:"open",value:function(){var t=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var n=Z0(function(s){return t.openSubMenu(s)},300),i=this.options.minWidth||wp,a=da(this.menuItems,function(s){return qP(s,t.hot)});a=QP(a,Cr);var o={data:a,colHeaders:!1,autoColumnSize:!0,modifyColWidth:function(l){return ir(l)&&l<i?i:l},autoRowSize:!1,readOnly:!0,copyPaste:!1,columns:[{data:"name",renderer:function(l,u,f,c,h,d){return t.menuItemRenderer(l,u,f,c,h,d)}}],renderAllRows:!0,fragmentSelection:"cell",disableVisualSelection:"area",beforeKeyDown:function(l){return t.onBeforeKeyDown(l)},afterOnCellMouseOver:function(l,u){t.isAllSubMenusClosed()?n(u.row):t.openSubMenu(u.row)},rowHeights:function(l){return a[l].name===Cr?1:23}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new pc(this.container,o),this.hotMenu.addHook("afterInit",function(){return t.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(){return t.onAfterSelection.apply(t,arguments)}),this.hotMenu.init(),this.hotMenu.listen(),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.isOpened()&&(t&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(t){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(t,0);if(this.closeAllSubMenus(),!n||!GP(n))return!1;var i=this.hotMenu.getSourceDataAtRow(t),a=new e(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0});return a.setMenuItems(i.submenu.items),a.open(),a.setPosition(n.getBoundingClientRect()),this.hotSubMenus[i.key]=a,a}},{key:"closeSubMenu",value:function(t){var n=this.hotMenu.getSourceDataAtRow(t),i=this.hotSubMenus[n.key];i&&(i.destroy(),delete this.hotSubMenus[n.key])}},{key:"closeAllSubMenus",value:function(){var t=this;pe(this.hotMenu.getData(),function(n,i){return t.closeSubMenu(i)})}},{key:"isAllSubMenusClosed",value:function(){return Object.keys(this.hotSubMenus).length===0}},{key:"destroy",value:function(){this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy()}},{key:"isOpened",value:function(){return this.hotMenu!==null}},{key:"executeCommand",value:function(t){if(!(!this.isOpened()||!this.hotMenu.getSelectedLast())){var n=this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]);if(this.runLocalHooks("select",n,t),!(n.isCommand===!1||n.name===Cr)){var i=this.hot.getSelectedRange(),a=i?YP(i):[],o=!0;(n.disabled===!0||typeof n.disabled=="function"&&n.disabled.call(this.hot)===!0||n.submenu)&&(o=!1),this.runLocalHooks("executeCommand",n.key,a,t),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,a,t),o&&this.close(!0)}}}},{key:"setPosition",value:function(t){var n=new QN(t);this.options.keepInViewport?(n.fitsBelow(this.container)?this.setPositionBelowCursor(n):n.fitsAbove(this.container)?this.setPositionAboveCursor(n):this.setPositionBelowCursor(n),n.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(n):this.setPositionOnLeftOfCursor(n)):(this.setPositionBelowCursor(n),this.setPositionOnRightOfCursor(n))}},{key:"setPositionAboveCursor",value:function(t){var n=this.offset.above+t.top-this.container.offsetHeight;this.isSubMenu()&&(n=t.top+t.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(n,"px")}},{key:"setPositionBelowCursor",value:function(t){var n=this.offset.below+t.top;this.isSubMenu()&&(n=t.top-1),this.container.style.top="".concat(n,"px")}},{key:"setPositionOnRightOfCursor",value:function(t){var n;this.isSubMenu()?n=1+t.left+t.cellWidth:n=this.offset.right+1+t.left,this.container.style.left="".concat(n,"px")}},{key:"setPositionOnLeftOfCursor",value:function(t){var n=this.offset.left+t.left-this.container.offsetWidth+Jt()+4;this.container.style.left="".concat(n,"px")}},{key:"selectFirstCell",value:function(){var t=this.hotMenu.getCell(0,0);eu(t)||tu(t)||ru(t)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var t=this.hotMenu.countRows()-1,n=this.hotMenu.getCell(t,0);eu(n)||tu(n)||ru(n)?this.selectPrevCell(t,0):this.hotMenu.selectCell(t,0)}},{key:"selectNextCell",value:function(t,n){var i=t+1,a=i<this.hotMenu.countRows()?this.hotMenu.getCell(i,n):null;a&&(eu(a)||tu(a)||ru(a)?this.selectNextCell(i,n):this.hotMenu.selectCell(i,n))}},{key:"selectPrevCell",value:function(t,n){var i=t-1,a=i>=0?this.hotMenu.getCell(i,n):null;a&&(eu(a)||tu(a)||ru(a)?this.selectPrevCell(i,n):this.hotMenu.selectCell(i,n))}},{key:"menuItemRenderer",value:function(t,n,i,a,o,s){var l=this,u=t.getSourceDataAtRow(i),f=document.createElement("div"),c=function(C){return At(C,"submenu")},h=function(C){return new RegExp(Cr,"i").test(C.name)},d=function(C){return C.disabled===!0||typeof C.disabled=="function"&&C.disabled.call(l.hot)===!0},g=function(C){return C.disableSelection},v=s;typeof v=="function"&&(v=v.call(this.hot)),Gn(n),$e(f,"htItemWrapper"),n.appendChild(f),h(u)?$e(n,"htSeparator"):typeof u.renderer=="function"?($e(n,"htCustomMenuRenderer"),n.appendChild(u.renderer(t,f,i,a,o,v))):ms(f,v),d(u)?($e(n,"htDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return t.deselectCell()})):g(u)?($e(n,"htSelectionDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return t.deselectCell()})):c(u)?($e(n,"htSubmenu"),g(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return t.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return t.selectCell(i,a,void 0,void 0,!1,!1)})):(pt(n,"htSubmenu"),pt(n,"htDisabled"),g(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return t.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return t.selectCell(i,a,void 0,void 0,!1,!1)}))}},{key:"createContainer",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=t,i;return n?(Or(n)&&(n=n.call(this.hot),n===null||Mr(n)?n="":n=n.toString()),n=n.replace(/[^A-z0-9]/g,"_"),n="".concat(this.options.className,"Sub_").concat(n),i=document.querySelector(".".concat(this.options.className,".").concat(n))):i=document.querySelector(".".concat(this.options.className)),i||(i=document.createElement("div"),$e(i,"htMenu ".concat(this.options.className)),n&&$e(i,n),document.getElementsByTagName("body")[0].appendChild(i)),i}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onBeforeKeyDown",value:function(t){var n=this.hotMenu.getSelectedLast(),i=!1;switch(this.keyEvent=!0,t.keyCode){case De.ESCAPE:this.close(),i=!0;break;case De.ENTER:n&&(this.hotMenu.getSourceDataAtRow(n[0]).submenu?i=!0:(this.executeCommand(t),this.close(!0)));break;case De.ARROW_DOWN:n?this.selectNextCell(n[0],n[1]):this.selectFirstCell(),i=!0;break;case De.ARROW_UP:n?this.selectPrevCell(n[0],n[1]):this.selectLastCell(),i=!0;break;case De.ARROW_RIGHT:if(n){var a=this.openSubMenu(n[0]);a&&a.selectFirstCell()}i=!0;break;case De.ARROW_LEFT:n&&this.isSubMenu()&&(this.close(),this.parentMenu&&this.parentMenu.hotMenu.listen(),i=!0);break}i&&(t.preventDefault(),Hr(t)),this.keyEvent=!1}},{key:"onAfterInit",value:function(){var t=this.hotMenu.getSettings().data,n=this.hotMenu.view.wt.wtTable.hider.style,i=this.hotMenu.view.wt.wtTable.holder.style,a=parseInt(n.width,10),o=hn(t,function(s,l){return s+(l.name===Cr?1:26)},0);i.width="".concat(a+22,"px"),i.height="".concat(o+4,"px"),n.height=i.height}},{key:"onAfterSelection",value:function(t,n,i,a,o){this.keyEvent===!1&&(o.value=!0)}},{key:"onDocumentMouseDown",value:function(t){this.isOpened()&&(this.container&&Ti(t.target,this.container)&&this.executeCommand(t),this.options.standalone&&this.hotMenu&&!Ti(t.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Ti(t.target,".htMenu")&&Ti(t.target,document)&&this.close(!0))}}]),e}();vi(dC,Co);function Yu(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Yu=function(t){return typeof t}:Yu=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yu(e)}function rF(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function nF(e,r){return r&&(Yu(r)==="object"||typeof r=="function")?r:Wd(e)}function Ga(e,r,t){return typeof Reflect<"u"&&Reflect.get?Ga=Reflect.get:Ga=function(i,a,o){var s=iF(i,a);if(s){var l=Object.getOwnPropertyDescriptor(s,a);return l.get?l.get.call(o):l.value}},Ga(e,r,t||e)}function iF(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=ea(e),e!==null););return e}function ea(e){return ea=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ea(e)}function _p(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Cp(e,r,t){return r&&_p(e.prototype,r),t&&_p(e,t),e}function aF(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&Bd(e,r)}function Bd(e,r){return Bd=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Bd(e,r)}function Wd(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}at.getSingleton().register("afterContextMenuDefaultOptions");at.getSingleton().register("beforeContextMenuShow");at.getSingleton().register("afterContextMenuShow");at.getSingleton().register("afterContextMenuHide");at.getSingleton().register("afterContextMenuExecute");var Gv=function(e){aF(r,e),Cp(r,null,[{key:"DEFAULT_ITEMS",get:function(){return[Ec,Tc,Cr,wc,_c,Cr,xc,bc,Cr,Oc,Sc,Cr,Cc,Cr,Wn]}}]);function r(t){var n;return rF(this,r),n=nF(this,ea(r).call(this,t)),n.eventManager=new Ft(Wd(Wd(n))),n.commandExecutor=new cN(n.hot),n.itemsFactory=null,n.menu=null,n}return Cp(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().contextMenu}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){this.itemsFactory=new KN(this.hot,r.DEFAULT_ITEMS);var i=this.hot.getSettings().contextMenu,a={items:this.itemsFactory.getItems(i)};typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),Ga(ea(r.prototype),"enablePlugin",this).call(this);var o=function(){if(n.hot){n.hot.runHooks("afterContextMenuDefaultOptions",a),n.itemsFactory.setPredefinedItems(a.items);var l=n.itemsFactory.getItems(i);n.menu=new dC(n.hot,{className:"htContextMenu",keepInViewport:!0}),n.hot.runHooks("beforeContextMenuSetItems",l),n.menu.setMenuItems(l),n.menu.addLocalHook("beforeOpen",function(){return n.onMenuBeforeOpen()}),n.menu.addLocalHook("afterOpen",function(){return n.onMenuAfterOpen()}),n.menu.addLocalHook("afterClose",function(){return n.onMenuAfterClose()}),n.menu.addLocalHook("executeCommand",function(){for(var u,f=arguments.length,c=new Array(f),h=0;h<f;h++)c[h]=arguments[h];return(u=n.executeCommand).call.apply(u,[n].concat(c))}),n.addHook("afterOnCellContextMenu",function(u){return n.onAfterOnCellContextMenu(u)}),pe(l,function(u){return n.commandExecutor.registerCommand(u.key,u)})}};this.callOnPluginsReady(function(){n.isPluginsReady?setTimeout(o,0):o()})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ga(ea(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),Ga(ea(r.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(n){this.menu&&(this.menu.open(),this.menu.setPosition({top:parseInt(dl(n),10)-wo(),left:parseInt(hl(n),10)-ya()}),this.menu.hotMenu.isHotTableEnv=this.hot.isHotTableEnv)}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(n){for(var i,a=arguments.length,o=new Array(a>1?a-1:0),s=1;s<a;s++)o[s-1]=arguments[s];(i=this.commandExecutor).execute.apply(i,[n].concat(o))}},{key:"onAfterOnCellContextMenu",value:function(n){var i=this.hot.getSettings(),a=i.rowHeaders,o=i.colHeaders;function s(u){return u.nodeName==="TD"||u.parentNode.nodeName==="TD"}var l=n.realTarget;this.close(),!gt(l,"handsontableInput")&&(n.preventDefault(),Lr(n),!(!(a||o)&&!s(l)&&!(gt(l,"current")&&gt(l,"wtBorder")))&&this.open(n))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),Ga(ea(r.prototype),"destroy",this).call(this)}}]),r}(fr);Gv.SEPARATOR={name:Cr};ur("contextMenu",Gv);function oF(e){return{key:"copy",name:function(){return this.getTranslatedPhrase(mv)},callback:function(){e.copy()},disabled:function(){var t=this.getSelected();return!t||t.length>1},hidden:!1}}function sF(e){return{key:"cut",name:function(){return this.getTranslatedPhrase(pv)},callback:function(){e.cut()},disabled:function(){var t=this.getSelected();return!t||t.length>1},hidden:!1}}function lF(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Sp(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function uF(e,r,t){return r&&Sp(e.prototype,r),t&&Sp(e,t),e}var fF=function(){function e(){lF(this,e),this.data={}}return uF(e,[{key:"setData",value:function(t,n){this.data[t]=n}},{key:"getData",value:function(t){return this.data[t]||void 0}}]),e}();function cF(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var hF=function e(){cF(this,e),this.clipboardData=new fF};function dF(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function bp(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function vF(e,r,t){return r&&bp(e.prototype,r),t&&bp(e,t),e}var Xv=function(){function e(){dF(this,e),this.mainElement=null,this.eventManager=new Ft(this),this.listenersCount=new WeakSet}return vF(e,[{key:"useSecondaryElement",value:function(){var t=pF();this.listenersCount.has(t)||(this.listenersCount.add(t),xp(this.eventManager,t,this)),this.mainElement=t}},{key:"setFocusableElement",value:function(t){this.listenersCount.has(t)||(this.listenersCount.add(t),xp(this.eventManager,t,this)),this.mainElement=t}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",ui()||this.mainElement.select()}}]),e}();vi(Xv,Co);var zs=0;function gF(){var e=new Xv;return zs+=1,e}function mF(e){e.eventManager.clear()}var ph=function(r,t){return function(n){return t.runLocalHooks(r,n)}};function xp(e,r,t){e.addEventListener(r,"copy",ph("copy",t)),e.addEventListener(r,"cut",ph("cut",t)),e.addEventListener(r,"paste",ph("paste",t))}var li;function pF(){if(li)return li.parentElement||document.body.appendChild(li),li;var e=document.createElement("textarea");return li=e,e.id="HandsontableCopyPaste",e.className="copyPaste",e.tabIndex=-1,e.autocomplete="off",e.wrap="hard",e.value=" ",document.body.appendChild(e),e}function Ep(e){e instanceof Xv&&(zs>0&&(zs-=1),mF(e),zs<=0&&(zs=0,li&&li.parentNode&&(li.parentNode.removeChild(li),li=null),e.mainElement=null))}function Tp(e){var r=e.length,t=["<table>"],n=document.createElement("div");document.documentElement.appendChild(n);for(var i=0;i<r;i+=1){var a=e[i],o=a.length,s=[];i===0&&t.push("<tbody>");for(var l=0;l<o;l+=1)n.innerText="".concat(bn(a[l])?"":a[l]),s.push("<td>".concat(n.innerHTML,"</td>"));t.push.apply(t,["<tr>"].concat(s,["</tr>"])),i+1===r&&t.push("</tbody>")}return document.documentElement.removeChild(n),t.push("</table>"),t.join("")}function yF(e){return(e&&e.nodeName||"").toLowerCase()==="table"}function wF(e){var r=[],t=e;if(typeof t=="string"){var n=document.createElement("div");n.innerHTML=t.replace(/\n/g,""),t=n.querySelector("table")}if(t&&yF(t)){for(var i=t.rows,a=i&&i.length,o=[],s=0;s<a;s+=1){for(var l=i[s].cells,u=l.length,f=[],c=0;c<u;c+=1){var h=l[c];h.innerHTML=h.innerHTML.trim().replace(/<br(.|)>(\n?)/,`
`);var d=h.innerText;f.push(d)}o.push(f)}r.push.apply(r,o)}return r}function _F(e,r){return bF(e)||SF(e,r)||CF()}function CF(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function SF(e,r){var t=[],n=!0,i=!1,a=void 0;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done)&&(t.push(s.value),!(r&&t.length===r));n=!0);}catch(l){i=!0,a=l}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw a}}return t}function bF(e){if(Array.isArray(e))return e}function tl(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?tl=function(t){return typeof t}:tl=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tl(e)}function xF(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Op(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function EF(e,r,t){return r&&Op(e.prototype,r),t&&Op(e,t),e}function TF(e,r){return r&&(tl(r)==="object"||typeof r=="function")?r:Ud(e)}function Xa(e,r,t){return typeof Reflect<"u"&&Reflect.get?Xa=Reflect.get:Xa=function(i,a,o){var s=OF(i,a);if(s){var l=Object.getOwnPropertyDescriptor(s,a);return l.get?l.get.call(o):l.value}},Xa(e,r,t||e)}function OF(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=ta(e),e!==null););return e}function ta(e){return ta=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ta(e)}function RF(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&$d(e,r)}function $d(e,r){return $d=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},$d(e,r)}function Ud(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}at.getSingleton().register("afterCopyLimit");at.getSingleton().register("modifyCopyableRange");at.getSingleton().register("beforeCut");at.getSingleton().register("afterCut");at.getSingleton().register("beforePaste");at.getSingleton().register("afterPaste");at.getSingleton().register("beforeCopy");at.getSingleton().register("afterCopy");var kF=1e3,AF=1e3,Pa=new WeakMap,vC=function(e){RF(r,e);function r(t){var n;return xF(this,r),n=TF(this,ta(r).call(this,t)),n.columnsLimit=AF,n.copyableRanges=[],n.pasteMode="overwrite",n.rowsLimit=kF,Pa.set(Ud(Ud(n)),{isTriggeredByCopy:!1,isTriggeredByCut:!1,isBeginEditing:!1,isFragmentSelectionEnabled:!1}),n}return EF(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().copyPaste}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){var i=this.hot.getSettings(),a=Pa.get(this);a.isFragmentSelectionEnabled=i.fragmentSelection,tl(i.copyPaste)==="object"&&(this.pasteMode=i.copyPaste.pasteMode||this.pasteMode,this.rowsLimit=i.copyPaste.rowsLimit||this.rowsLimit,this.columnsLimit=i.copyPaste.columnsLimit||this.columnsLimit),this.addHook("afterContextMenuDefaultOptions",function(o){return n.onAfterContextMenuDefaultOptions(o)}),this.addHook("afterOnCellMouseUp",function(){return n.onAfterOnCellMouseUp()}),this.addHook("afterSelectionEnd",function(){return n.onAfterSelectionEnd()}),this.addHook("beforeKeyDown",function(){return n.onBeforeKeyDown()}),this.focusableElement=gF(),this.focusableElement.addLocalHook("copy",function(o){return n.onCopy(o)}).addLocalHook("cut",function(o){return n.onCut(o)}).addLocalHook("paste",function(o){return n.onPaste(o)}),Xa(ta(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),Xa(ta(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&Ep(this.focusableElement),Xa(ta(r.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){var n=Pa.get(this);n.isTriggeredByCopy=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),document.execCommand("copy")}},{key:"cut",value:function(){var n=Pa.get(this);n.isTriggeredByCut=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),document.execCommand("cut")}},{key:"getRangedCopyableData",value:function(n){var i=this,a=[],o=[],s=[];return pe(n,function(l){Ke(l.startRow,l.endRow,function(u){o.indexOf(u)===-1&&o.push(u)}),Ke(l.startCol,l.endCol,function(u){s.indexOf(u)===-1&&s.push(u)})}),pe(o,function(l){var u=[];pe(s,function(f){u.push(i.hot.getCopyableData(l,f))}),a.push(u)}),$o.stringify(a)}},{key:"getRangedData",value:function(n){var i=this,a=[],o=[],s=[];return pe(n,function(l){Ke(l.startRow,l.endRow,function(u){o.indexOf(u)===-1&&o.push(u)}),Ke(l.startCol,l.endCol,function(u){s.indexOf(u)===-1&&s.push(u)})}),pe(o,function(l){var u=[];pe(s,function(f){u.push(i.hot.getCopyableData(l,f))}),a.push(u)}),a}},{key:"paste",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n;if(!(!n&&!i)){var a=new hF;n&&a.clipboardData.setData("text/plain",n),i&&a.clipboardData.setData("text/html",i),this.getOrCreateFocusableElement(),this.onPaste(a)}}},{key:"setCopyableText",value:function(){var n=this.hot.getSelectedRangeLast();if(n){var i=n.getTopLeftCorner(),a=n.getBottomRightCorner(),o=i.row,s=i.col,l=a.row,u=a.col,f=Math.min(l,o+this.rowsLimit-1),c=Math.min(u,s+this.columnsLimit-1);this.copyableRanges.length=0,this.copyableRanges.push({startRow:o,startCol:s,endRow:f,endCol:c}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges),(l!==f||u!==c)&&this.hot.runHooks("afterCopyLimit",l-o+1,u-s+1,this.rowsLimit,this.columnsLimit)}}},{key:"getOrCreateFocusableElement",value:function(){var n=this.hot.getActiveEditor(),i=n?n.TEXTAREA:void 0;i?this.focusableElement.setFocusableElement(i):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var n=this.hot.getActiveEditor();return n&&n.isOpened()}},{key:"populateValues",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedLast();if(n.length){for(var a=n.length-1,o=n[0].length-1,s=Math.min(i[0],i[2]),l=Math.max(i[0],i[2],a+s),u=Math.min(i[1],i[3]),f=Math.max(i[1],i[3],o+u),c=[],h=s,d=0;h<=l;h+=1){for(var g=[],v=u,p=0;v<=f;v+=1)g.push(n[d][p]),p=p===o?0:p+=1;c.push(g),d=d===a?0:d+=1}return this.hot.populateFromArray(s,u,c,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,u,l,f]}}},{key:"onCopy",value:function(n){var i=Pa.get(this);if(!(!this.hot.isListening()&&!i.isTriggeredByCopy||this.isEditorOpened())){this.setCopyableText(),i.isTriggeredByCopy=!1;var a=this.getRangedData(this.copyableRanges),o=!!this.hot.runHooks("beforeCopy",a,this.copyableRanges);if(o){var s=$o.stringify(a);if(n&&n.clipboardData){var l=Tp(a);n.clipboardData.setData("text/plain",s),n.clipboardData.setData("text/html",l)}else typeof ClipboardEvent>"u"&&window.clipboardData.setData("Text",s);this.hot.runHooks("afterCopy",a,this.copyableRanges)}n.preventDefault()}}},{key:"onCut",value:function(n){var i=Pa.get(this);if(!(!this.hot.isListening()&&!i.isTriggeredByCut||this.isEditorOpened())){this.setCopyableText(),i.isTriggeredByCut=!1;var a=this.getRangedData(this.copyableRanges),o=!!this.hot.runHooks("beforeCut",a,this.copyableRanges);if(o){var s=$o.stringify(a);if(n&&n.clipboardData){var l=Tp(a);n.clipboardData.setData("text/plain",s),n.clipboardData.setData("text/html",l)}else typeof ClipboardEvent>"u"&&window.clipboardData.setData("Text",s);this.hot.emptySelectedCells(),this.hot.runHooks("afterCut",a,this.copyableRanges)}n.preventDefault()}}},{key:"onPaste",value:function(n){if(!(!this.hot.isListening()||this.isEditorOpened())){n&&n.preventDefault&&n.preventDefault();var i;if(n&&typeof n.clipboardData<"u"){var a=n.clipboardData.getData("text/html");a&&/(<table)|(<TABLE)/.test(a)?i=wF(a):i=n.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof window.clipboardData<"u"&&(i=window.clipboardData.getData("Text"));var o=typeof i!="string"?i:$o.parse(i);if(o.length!==0&&this.hot.runHooks("beforePaste",o,this.copyableRanges)!==!1){var s=this.populateValues(o),l=_F(s,4),u=l[0],f=l[1],c=l[2],h=l[3];this.hot.selectCell(u,f,Math.min(this.hot.countRows()-1,c),Math.min(this.hot.countCols()-1,h)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(n){n.items.push({name:"---------"},oF(this),sF(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){var n=Pa.get(this),i=n.isFragmentSelectionEnabled;this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(i&&this.focusableElement.getFocusableElement()!==document.activeElement&&Pw())&&(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(!(!this.hot.isListening()||this.isEditorOpened())){var n=document.activeElement,i=this.hot.getActiveEditor();!i||n!==this.focusableElement.getFocusableElement()&&n!==i.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(Ep(this.focusableElement),this.focusableElement=null),Xa(ta(r.prototype),"destroy",this).call(this)}}]),r}(fr);ur("CopyPaste",vC);function gC(e,r){return"border_row".concat(e,"col").concat(r)}function js(){return{width:1,color:"#000"}}function Ai(){return{hide:!0}}function MF(){return{width:1,color:"#000",cornerVisible:!1}}function yh(e,r){return{id:gC(e,r),border:MF(),row:e,col:r,top:Ai(),right:Ai(),bottom:Ai(),left:Ai()}}function DF(e,r){return At(r,"border")&&(e.border=r.border),At(r,"top")&&(r.top?(Rt(r.top)||(r.top=js()),e.top=r.top):(r.top=Ai(),e.top=r.top)),At(r,"right")&&(r.right?(Rt(r.right)||(r.right=js()),e.right=r.right):(r.right=Ai(),e.right=r.right)),At(r,"bottom")&&(r.bottom?(Rt(r.bottom)||(r.bottom=js()),e.bottom=r.bottom):(r.bottom=Ai(),e.bottom=r.bottom)),At(r,"left")&&(r.left?(Rt(r.left)||(r.left=js()),e.left=r.left):(r.left=Ai(),e.left=r.left)),e}function Li(e,r){var t=!1;return pe(e.getSelectedRange(),function(n){n.forAll(function(i,a){var o=e.getCellMeta(i,a).borders;if(o)if(r){if(!At(o[r],"hide")||o[r].hide===!1)return t=!0,!1}else return t=!0,!1})}),t}function Rc(e){return'<span class="selected">'.concat("✓","</span>").concat(e)}function PF(e){return{key:"borders:bottom",name:function(){var t=this.getTranslatedPhrase(Iv),n=Li(this,"bottom");return n&&(t=Rc(t)),t},callback:function(t,n){var i=Li(this,"bottom");e.prepareBorder(n,"bottom",i)}}}function NF(e){return{key:"borders:left",name:function(){var t=this.getTranslatedPhrase(Hv),n=Li(this,"left");return n&&(t=Rc(t)),t},callback:function(t,n){var i=Li(this,"left");e.prepareBorder(n,"left",i)}}}function FF(e){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(Bv)},callback:function(t,n){e.prepareBorder(n,"noBorders")},disabled:function(){return!Li(this)}}}function LF(e){return{key:"borders:right",name:function(){var t=this.getTranslatedPhrase(Lv),n=Li(this,"right");return n&&(t=Rc(t)),t},callback:function(t,n){var i=Li(this,"right");e.prepareBorder(n,"right",i)}}}function IF(e){return{key:"borders:top",name:function(){var t=this.getTranslatedPhrase(Fv),n=Li(this,"top");return n&&(t=Rc(t)),t},callback:function(t,n){var i=Li(this,"top");e.prepareBorder(n,"top",i)}}}function Gu(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Gu=function(t){return typeof t}:Gu=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gu(e)}function Rp(e,r){return WF(e)||BF(e,r)||HF()}function HF(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function BF(e,r){var t=[],n=!0,i=!1,a=void 0;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done)&&(t.push(s.value),!(r&&t.length===r));n=!0);}catch(l){i=!0,a=l}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw a}}return t}function WF(e){if(Array.isArray(e))return e}function $F(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function kp(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function UF(e,r,t){return r&&kp(e.prototype,r),t&&kp(e,t),e}function VF(e,r){return r&&(Gu(r)==="object"||typeof r=="function")?r:zF(e)}function zF(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ka(e,r,t){return typeof Reflect<"u"&&Reflect.get?Ka=Reflect.get:Ka=function(i,a,o){var s=jF(i,a);if(s){var l=Object.getOwnPropertyDescriptor(s,a);return l.get?l.get.call(o):l.value}},Ka(e,r,t||e)}function jF(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=ra(e),e!==null););return e}function ra(e){return ra=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ra(e)}function YF(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&Vd(e,r)}function Vd(e,r){return Vd=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Vd(e,r)}var mC=function(e){YF(r,e);function r(t){var n;return $F(this,r),n=VF(this,ra(r).call(this,t)),n.savedBorders=[],n}return UF(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().customBorders}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(i){return n.onAfterContextMenuDefaultOptions(i)}),this.addHook("afterInit",function(){return n.onAfterInit()}),Ka(ra(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),Ka(ra(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),Ka(ra(r.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(n,i){var a=this,o=["top","right","bottom","left"],s=i?Object.keys(i):o,l=cs(n),u=wl(l);pe(n,function(f){for(var c=u(f),h=Rp(c,4),d=h[0],g=h[1],v=h[2],p=h[3],C=function(ee){for(var ue=function(re){pe(s,function(m){a.prepareBorderFromCustomAdded(ee,re,i,m)})},se=g;se<=p;se+=1)ue(se)},F=d;F<=v;F+=1)C(F)})}},{key:"getBorders",value:function(n){var i=this;if(!Array.isArray(n))return this.savedBorders;var a=cs(n),o=wl(a),s=[];return pe(n,function(l){for(var u=o(l),f=Rp(u,4),c=f[0],h=f[1],d=f[2],g=f[3],v=function(F){for(var D=function(se){pe(i.savedBorders,function(U){U.row===F&&U.col===se&&s.push(U)})},ee=h;ee<=g;ee+=1)D(ee)},p=c;p<=d;p+=1)v(p)}),s}},{key:"clearBorders",value:function(n){var i=this;n?this.setBorders(n):(pe(this.savedBorders,function(a){i.clearBordersFromSelectionSettings(a.id),i.clearNullCellRange(),i.hot.removeCellMeta(a.row,a.col,"borders")}),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(n,i){var a=this.checkSavedBorders(n);a||this.savedBorders.push(n);var o={row:n.row,col:n.col},s=new Kr(o,o,o),l=this.checkCustomSelections(n,s,i);l||(this.hot.selection.highlight.addCustomSelection({border:n,cellRange:s}),this.hot.view.wt.draw(!0))}},{key:"prepareBorderFromCustomAdded",value:function(n,i,a,o){var s=yh(n,i);a&&(s=DF(s,a),pe(this.hot.selection.highlight.customSelections,function(l){if(s.id===l.settings.id)return Object.assign(l.settings,a),s=l.settings,!1})),this.hot.setCellMeta(n,i,"borders",s),this.insertBorderIntoSettings(s,o)}},{key:"prepareBorderFromCustomAddedRange",value:function(n){var i=this,a=n.range;Ke(a.from.row,a.to.row,function(o){Ke(a.from.col,a.to.col,function(s){var l=yh(o,s),u=0;o===a.from.row&&(u+=1,At(n,"top")&&(l.top=n.top)),o===a.to.row&&(u+=1,At(n,"bottom")&&(l.bottom=n.bottom)),s===a.from.col&&(u+=1,At(n,"left")&&(l.left=n.left)),s===a.to.col&&(u+=1,At(n,"right")&&(l.right=n.right)),u>0&&(i.hot.setCellMeta(o,s,"borders",l),i.insertBorderIntoSettings(l))})})}},{key:"removeAllBorders",value:function(n,i){var a=gC(n,i);this.spliceBorder(a),this.clearBordersFromSelectionSettings(a),this.clearNullCellRange(),this.hot.removeCellMeta(n,i,"borders")}},{key:"setBorder",value:function(n,i,a,o){var s=this.hot.getCellMeta(n,i).borders;if((!s||s.border===void 0)&&(s=yh(n,i)),o){s[a]=Ai();var l=this.countHide(s);if(l===4)this.removeAllBorders(n,i);else{var u=this.checkCustomSelectionsFromContextMenu(s,a,o);u||this.insertBorderIntoSettings(s),this.hot.setCellMeta(n,i,"borders",s)}}else{s[a]=js();var f=this.checkCustomSelectionsFromContextMenu(s,a,o);f||this.insertBorderIntoSettings(s),this.hot.setCellMeta(n,i,"borders",s)}}},{key:"prepareBorder",value:function(n,i,a){var o=this;pe(n,function(s){var l=s.start,u=s.end;if(l.row===u.row&&l.col===u.col)i==="noBorders"?o.removeAllBorders(l.row,l.col):o.setBorder(l.row,l.col,i,a);else switch(i){case"noBorders":Ke(l.col,u.col,function(f){Ke(l.row,u.row,function(c){o.removeAllBorders(c,f)})});break;case"top":Ke(l.col,u.col,function(f){o.setBorder(l.row,f,i,a)});break;case"right":Ke(l.row,u.row,function(f){o.setBorder(f,u.col,i,a)});break;case"bottom":Ke(l.col,u.col,function(f){o.setBorder(u.row,f,i,a)});break;case"left":Ke(l.row,u.row,function(f){o.setBorder(f,l.col,i,a)});break}})}},{key:"createCustomBorders",value:function(n){var i=this;pe(n,function(a){a.range?i.prepareBorderFromCustomAddedRange(a):i.prepareBorderFromCustomAdded(a.row,a.col,a)})}},{key:"countHide",value:function(n){var i=Object.values(n);return hn(i,function(a,o){var s=a;return o.hide&&(s+=1),s},0)}},{key:"clearBordersFromSelectionSettings",value:function(n){var i=Zt(this.hot.selection.highlight.customSelections,function(a){return a.settings.id}).indexOf(n);i>-1&&this.hot.selection.highlight.customSelections[i].clear(),this.hot.view.wt.draw(!0)}},{key:"clearNullCellRange",value:function(){var n=this;pe(this.hot.selection.highlight.customSelections,function(i,a){if(i.cellRange===null)return n.hot.selection.highlight.customSelections.splice(a,1),!1})}},{key:"hideBorders",value:function(){var n=this;pe(this.savedBorders,function(i){n.clearBordersFromSelectionSettings(i.id)})}},{key:"spliceBorder",value:function(n){var i=Zt(this.savedBorders,function(a){return a.id}).indexOf(n);i>-1&&this.savedBorders.splice(i,1)}},{key:"checkSavedBorders",value:function(n){var i=this,a=!1,o=this.countHide(n);return o===4?(this.spliceBorder(n.id),a=!0):pe(this.savedBorders,function(s,l){if(n.id===s.id)return i.savedBorders[l]=n,a=!0,!1}),a}},{key:"checkCustomSelectionsFromContextMenu",value:function(n,i,a){var o=!1;return pe(this.hot.selection.highlight.customSelections,function(s){if(n.id===s.settings.id)return St(s.instanceBorders,function(l){l.toggleHiddenClass(i,a)}),o=!0,!1}),o}},{key:"checkCustomSelections",value:function(n,i,a){var o=this.countHide(n),s=!1;return o===4?(this.removeAllBorders(n.row,n.col),this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),s=!0):pe(this.hot.selection.highlight.customSelections,function(l){if(n.id===l.settings.id)return l.cellRange=i,a&&St(l.instanceBorders,function(u){u.changeBorderStyle(a,n)}),s=!0,!1}),s}},{key:"changeBorderSettings",value:function(){var n=this.hot.getSettings().customBorders;Array.isArray(n)?(n.length||(this.savedBorders=n),this.createCustomBorders(n)):n!==void 0&&this.createCustomBorders(this.savedBorders)}},{key:"onAfterContextMenuDefaultOptions",value:function(n){this.hot.getSettings().customBorders&&n.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(Nv)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[IF(this),LF(this),PF(this),NF(this),FF(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){Ka(ra(r.prototype),"destroy",this).call(this)}}]),r}(fr);ur("customBorders",mC);function Xu(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Xu=function(t){return typeof t}:Xu=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xu(e)}function GF(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Ap(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function XF(e,r,t){return r&&Ap(e.prototype,r),t&&Ap(e,t),e}function KF(e,r){return r&&(Xu(r)==="object"||typeof r=="function")?r:jd(e)}function qa(e,r,t){return typeof Reflect<"u"&&Reflect.get?qa=Reflect.get:qa=function(i,a,o){var s=qF(i,a);if(s){var l=Object.getOwnPropertyDescriptor(s,a);return l.get?l.get.call(o):l.value}},qa(e,r,t||e)}function qF(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=na(e),e!==null););return e}function na(e){return na=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},na(e)}function ZF(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&zd(e,r)}function zd(e,r){return zd=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},zd(e,r)}function jd(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var pC=function(e){ZF(r,e);function r(t){var n;return GF(this,r),n=KF(this,na(r).call(this,t)),n.eventManager=new Ft(jd(jd(n))),n.boundaries=null,n.callback=null,n.listening=!1,n}return XF(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().dragToScroll}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(){return n.setupListening()}),this.addHook("afterOnCellCornerMouseDown",function(){return n.setupListening()}),this.registerEvents(),qa(na(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),qa(na(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),qa(na(r.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(n){this.boundaries=n}},{key:"setCallback",value:function(n){this.callback=n}},{key:"check",value:function(n,i){var a=0,o=0;i<this.boundaries.top?o=i-this.boundaries.top:i>this.boundaries.bottom&&(o=i-this.boundaries.bottom),n<this.boundaries.left?a=n-this.boundaries.left:n>this.boundaries.right&&(a=n-this.boundaries.right),this.callback(a,o)}},{key:"registerEvents",value:function(){var n=this;this.eventManager.addEventListener(document,"mouseup",function(){return n.onMouseUp()}),this.eventManager.addEventListener(document,"mousemove",function(i){return n.onMouseMove(i)})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(){var n=this.hot.view.wt.wtTable.holder;n!==window&&(this.setBoundaries(n.getBoundingClientRect()),this.setCallback(function(i,a){i<0?n.scrollLeft-=50:i>0&&(n.scrollLeft+=50),a<0?n.scrollTop-=20:a>0&&(n.scrollTop+=20)}),this.listening=!0)}},{key:"onMouseMove",value:function(n){this.listening&&this.check(n.clientX,n.clientY)}},{key:"onMouseUp",value:function(){this.listening=!1}},{key:"destroy",value:function(){qa(na(r.prototype),"destroy",this).call(this)}}]),r}(fr);ur("dragToScroll",pC);function JF(e,r){return tL(e)||eL(e,r)||QF()}function QF(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function eL(e,r){var t=[],n=!0,i=!1,a=void 0;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done)&&(t.push(s.value),!(r&&t.length===r));n=!0);}catch(l){i=!0,a=l}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw a}}return t}function tL(e){if(Array.isArray(e))return e}function rL(e){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(yv)},callback:function(t,n){var i=JF(n,1),a=i[0].start.col;e.freezeColumn(a),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},hidden:function(){var t=this.getSelectedRange(),n=!1;return(t===void 0||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col<=this.getSettings().fixedColumnsLeft-1)&&(n=!0),n}}}function nL(e,r){return oL(e)||aL(e,r)||iL()}function iL(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function aL(e,r){var t=[],n=!0,i=!1,a=void 0;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done)&&(t.push(s.value),!(r&&t.length===r));n=!0);}catch(l){i=!0,a=l}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw a}}return t}function oL(e){if(Array.isArray(e))return e}function sL(e){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(wv)},callback:function(t,n){var i=nL(n,1),a=i[0].start.col;e.unfreezeColumn(a),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},hidden:function(){var t=this.getSelectedRange(),n=!1;return(t===void 0||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col>=this.getSettings().fixedColumnsLeft)&&(n=!0),n}}}function Ku(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ku=function(t){return typeof t}:Ku=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ku(e)}function lL(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Mp(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function uL(e,r,t){return r&&Mp(e.prototype,r),t&&Mp(e,t),e}function fL(e,r){return r&&(Ku(r)==="object"||typeof r=="function")?r:Gd(e)}function Za(e,r,t){return typeof Reflect<"u"&&Reflect.get?Za=Reflect.get:Za=function(i,a,o){var s=cL(i,a);if(s){var l=Object.getOwnPropertyDescriptor(s,a);return l.get?l.get.call(o):l.value}},Za(e,r,t||e)}function cL(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=ia(e),e!==null););return e}function ia(e){return ia=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ia(e)}function hL(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&Yd(e,r)}function Yd(e,r){return Yd=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Yd(e,r)}function Gd(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Is=new WeakMap,yC=function(e){hL(r,e);function r(t){var n;return lL(this,r),n=fL(this,ia(r).call(this,t)),Is.set(Gd(Gd(n)),{moveByFreeze:!1,afterFirstUse:!1}),n.frozenColumnsBasePositions=[],n.manualColumnMovePlugin=void 0,n}return uL(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualColumnFreeze}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(i){return n.addContextMenuEntry(i)}),this.addHook("afterInit",function(){return n.onAfterInit()}),this.addHook("beforeColumnMove",function(i,a){return n.onBeforeColumnMove(i,a)}),Za(ia(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var n=Is.get(this);n.afterFirstUse=!1,n.moveByFreeze=!1,Za(ia(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Za(ia(r.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(n){var i=Is.get(this),a=this.hot.getSettings();i.afterFirstUse||(i.afterFirstUse=!0),!(a.fixedColumnsLeft===this.hot.countCols()||n<=a.fixedColumnsLeft-1)&&(i.moveByFreeze=!0,n!==this.getMovePlugin().columnsMapper.getValueByIndex(n)&&(this.frozenColumnsBasePositions[a.fixedColumnsLeft]=n),this.getMovePlugin().moveColumn(n,a.fixedColumnsLeft),a.fixedColumnsLeft+=1)}},{key:"unfreezeColumn",value:function(n){var i=Is.get(this),a=this.hot.getSettings();if(i.afterFirstUse||(i.afterFirstUse=!0),!(a.fixedColumnsLeft<=0||n>a.fixedColumnsLeft-1)){var o=this.getBestColumnReturnPosition(n);i.moveByFreeze=!0,a.fixedColumnsLeft-=1,this.getMovePlugin().moveColumn(n,o+1)}}},{key:"getMovePlugin",value:function(){return this.manualColumnMovePlugin||(this.manualColumnMovePlugin=this.hot.getPlugin("manualColumnMove")),this.manualColumnMovePlugin}},{key:"getBestColumnReturnPosition",value:function(n){var i=this.getMovePlugin(),a=this.hot.getSettings(),o=a.fixedColumnsLeft,s=i.columnsMapper.getValueByIndex(o),l;if(this.frozenColumnsBasePositions[n]===null||this.frozenColumnsBasePositions[n]===void 0)for(l=i.columnsMapper.getValueByIndex(n);s!==null&&s<=l;)o+=1,s=i.columnsMapper.getValueByIndex(o);else{for(l=this.frozenColumnsBasePositions[n],this.frozenColumnsBasePositions[n]=void 0;s!==null&&s<=l;)o+=1,s=i.columnsMapper.getValueByIndex(o);o=s}return o-1}},{key:"addContextMenuEntry",value:function(n){n.items.push({name:"---------"},rL(this),sL(this))}},{key:"onAfterInit",value:function(){this.getMovePlugin().isEnabled()||this.getMovePlugin().enablePlugin()}},{key:"onBeforeColumnMove",value:function(n,i){var a=Is.get(this);if(a.afterFirstUse&&!a.moveByFreeze){var o=this.hot.getSettings().fixedColumnsLeft,s=i<o;if(s||pe(n,function(l){if(l<o)return s=!0,!1}),s)return!1}a.moveByFreeze&&(a.moveByFreeze=!1)}},{key:"destroy",value:function(){Za(ia(r.prototype),"destroy",this).call(this)}}]),r}(fr);ur("manualColumnFreeze",yC);function dL(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Dp(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function vL(e,r,t){return r&&Dp(e.prototype,r),t&&Dp(e,t),e}var wC=function(){function e(r){dL(this,e),this.manualColumnMove=r}return vL(e,[{key:"createMap",value:function(t){var n=this,i=t===void 0?this._arrayMap.length:t;this._arrayMap.length=0,Ke(i-1,function(a){n._arrayMap[a]=a})}},{key:"destroy",value:function(){this._arrayMap=null}},{key:"moveColumn",value:function(t,n){var i=this._arrayMap[t];this._arrayMap[t]=null,this._arrayMap.splice(n,0,i)}},{key:"clearNull",value:function(){this._arrayMap=da(this._arrayMap,function(t){return t!==null})}}]),e}();vi(wC,yc);function gL(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Pp(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function mL(e,r,t){return r&&Pp(e.prototype,r),t&&Pp(e,t),e}var Np=0,Fp=1,Lp=2,Fo="px",_C=function(){function e(r){gL(this,e),this.hot=r,this._element=null,this.state=Np}return mL(e,[{key:"appendTo",value:function(t){t.appendChild(this._element),this.state=Lp}},{key:"build",value:function(){this._element=document.createElement("div"),this.state=Fp}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Np}},{key:"isAppended",value:function(){return this.state===Lp}},{key:"isBuilt",value:function(){return this.state>=Fp}},{key:"setPosition",value:function(t,n){bi(t)&&(this._element.style.top=t+Fo),bi(n)&&(this._element.style.left=n+Fo)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(t,n){bi(t)&&(this._element.style.width=t+Fo),bi(n)&&(this._element.style.height=n+Fo)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(t,n){bi(t)&&(this._element.style.marginTop=t+Fo),bi(n)&&(this._element.style.marginLeft=n+Fo)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),e}();function qu(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?qu=function(t){return typeof t}:qu=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qu(e)}function pL(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Ip(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function yL(e,r,t){return r&&Ip(e.prototype,r),t&&Ip(e,t),e}function wL(e,r){return r&&(qu(r)==="object"||typeof r=="function")?r:_L(e)}function _L(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zu(e,r,t){return typeof Reflect<"u"&&Reflect.get?Zu=Reflect.get:Zu=function(i,a,o){var s=CL(i,a);if(s){var l=Object.getOwnPropertyDescriptor(s,a);return l.get?l.get.call(o):l.value}},Zu(e,r,t||e)}function CL(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=_l(e),e!==null););return e}function _l(e){return _l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},_l(e)}function SL(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&Xd(e,r)}function Xd(e,r){return Xd=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Xd(e,r)}var bL="ht__manualColumnMove--backlight",xL=function(e){SL(r,e);function r(){return pL(this,r),wL(this,_l(r).apply(this,arguments))}return yL(r,[{key:"build",value:function(){Zu(_l(r.prototype),"build",this).call(this),$e(this._element,bL)}}]),r}(_C);function Ju(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ju=function(t){return typeof t}:Ju=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ju(e)}function EL(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Hp(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function TL(e,r,t){return r&&Hp(e.prototype,r),t&&Hp(e,t),e}function OL(e,r){return r&&(Ju(r)==="object"||typeof r=="function")?r:RL(e)}function RL(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qu(e,r,t){return typeof Reflect<"u"&&Reflect.get?Qu=Reflect.get:Qu=function(i,a,o){var s=kL(i,a);if(s){var l=Object.getOwnPropertyDescriptor(s,a);return l.get?l.get.call(o):l.value}},Qu(e,r,t||e)}function kL(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=Cl(e),e!==null););return e}function Cl(e){return Cl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Cl(e)}function AL(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&Kd(e,r)}function Kd(e,r){return Kd=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Kd(e,r)}var ML="ht__manualColumnMove--guideline",DL=function(e){AL(r,e);function r(){return EL(this,r),OL(this,Cl(r).apply(this,arguments))}return TL(r,[{key:"build",value:function(){Qu(Cl(r.prototype),"build",this).call(this),$e(this._element,ML)}}]),r}(_C);function ef(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ef=function(t){return typeof t}:ef=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ef(e)}function PL(e){return LL(e)||FL(e)||NL()}function NL(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function FL(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}function LL(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}function IL(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Bp(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function HL(e,r,t){return r&&Bp(e.prototype,r),t&&Bp(e,t),e}function BL(e,r){return r&&(ef(r)==="object"||typeof r=="function")?r:Ia(e)}function Ja(e,r,t){return typeof Reflect<"u"&&Reflect.get?Ja=Reflect.get:Ja=function(i,a,o){var s=WL(i,a);if(s){var l=Object.getOwnPropertyDescriptor(s,a);return l.get?l.get.call(o):l.value}},Ja(e,r,t||e)}function WL(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=aa(e),e!==null););return e}function aa(e){return aa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},aa(e)}function $L(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&qd(e,r)}function qd(e,r){return qd=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},qd(e,r)}function Ia(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}at.getSingleton().register("beforeColumnMove");at.getSingleton().register("afterColumnMove");at.getSingleton().register("unmodifyCol");var Na=new WeakMap,Wp="ht__manualColumnMove",au="show-ui",wh="on-moving--columns",_h="after-selection--columns",CC=function(e){$L(r,e);function r(t){var n;return IL(this,r),n=BL(this,aa(r).call(this,t)),Na.set(Ia(Ia(n)),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,disallowMoving:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0}}),n.removedColumns=[],n.columnsMapper=new wC(Ia(Ia(n))),n.eventManager=new Ft(Ia(Ia(n))),n.backlight=new xL(t),n.guideline=new DL(t),n}return HL(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualColumnMove}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(i,a,o,s){return n.onBeforeOnCellMouseDown(i,a,o,s)}),this.addHook("beforeOnCellMouseOver",function(i,a,o,s){return n.onBeforeOnCellMouseOver(i,a,o,s)}),this.addHook("afterScrollVertically",function(){return n.onAfterScrollVertically()}),this.addHook("modifyCol",function(i,a){return n.onModifyCol(i,a)}),this.addHook("beforeRemoveCol",function(i,a){return n.onBeforeRemoveCol(i,a)}),this.addHook("afterRemoveCol",function(){return n.onAfterRemoveCol()}),this.addHook("afterCreateCol",function(i,a){return n.onAfterCreateCol(i,a)}),this.addHook("afterLoadData",function(){return n.onAfterLoadData()}),this.addHook("unmodifyCol",function(i){return n.onUnmodifyCol(i)}),this.registerEvents(),$e(this.hot.rootElement,Wp),Ja(aa(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.onAfterPluginsInitialized(),Ja(aa(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var n=this.hot.getSettings().manualColumnMove;Array.isArray(n)&&this.columnsMapper.clearMap(),pt(this.hot.rootElement,Wp),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),Ja(aa(r.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(n,i){this.moveColumns([n],i)}},{key:"moveColumns",value:function(n,i){var a=this,o=PL(n),s=Na.get(this),l=this.hot.runHooks("beforeColumnMove",o,i);s.disallowMoving=!l,l!==!1&&(pe(n,function(u,f,c){c[f]=a.columnsMapper.getValueByIndex(u)}),pe(n,function(u,f){var c=a.columnsMapper.getIndexByValue(u);c!==i&&a.columnsMapper.moveColumn(c,i+f)}),this.columnsMapper.clearNull()),this.hot.runHooks("afterColumnMove",o,i)}},{key:"changeSelection",value:function(n,i){this.hot.selectColumns(n,i)}},{key:"getColumnsWidth",value:function(n,i){for(var a=0,o=n;o<i;o++){var s=0;o<0?s=this.hot.view.wt.wtViewport.getRowHeaderWidth()||0:s=this.hot.view.wt.wtTable.getStretchedColumnWidth(o)||0,a+=s}return a}},{key:"initialSettings",value:function(){var n=this.hot.getSettings().manualColumnMove;Array.isArray(n)?this.moveColumns(n,0):n!==void 0&&this.persistentStateLoad()}},{key:"isFixedColumnsLeft",value:function(n){return n<this.hot.getSettings().fixedColumnsLeft}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.columnsMapper._arrayMap)}},{key:"persistentStateLoad",value:function(){var n={};this.hot.runHooks("persistentStateLoad","manualColumnMove",n),n.value&&(this.columnsMapper._arrayMap=n.value)}},{key:"prepareColumnsToMoving",value:function(n,i){var a=[];return Ke(n,i,function(o){a.push(o)}),a}},{key:"refreshPositions",value:function(){var n=Na.get(this),i=this.hot.view.wt.wtTable.getFirstVisibleColumn(),a=this.hot.view.wt.wtTable.getLastVisibleColumn(),o=this.hot.view.wt.wtTable,s=this.hot.view.wt.wtOverlays.scrollableElement,l=typeof s.scrollX=="number"?s.scrollX:s.scrollLeft,u=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,n.coordsColumn),f=n.target.eventPageX-(n.rootElementOffset-(s.scrollX===void 0?l:0)),c=o.hider.offsetWidth,h=o.TBODY.offsetLeft,d=this.backlight.getOffset().left,g=this.backlight.getSize().width,v=0;if(n.rootElementOffset+o.holder.offsetWidth+l<n.target.eventPageX&&n.coordsColumn<n.countCols&&(n.coordsColumn+=1),n.hasRowHeaders&&(v=this.hot.view.wt.wtOverlays.leftOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsLeft(n.coordsColumn)&&(u+=l),u+=v,n.coordsColumn<0)n.fixedColumns>0?n.target.col=0:n.target.col=i>0?i-1:i;else if(n.target.TD.offsetWidth/2+u<=f){var p=n.coordsColumn>=n.countCols?n.countCols-1:n.coordsColumn;n.target.col=p+1,u+=n.target.TD.offsetWidth,n.target.col>a&&a<n.countCols&&this.hot.scrollViewportTo(void 0,a+1,void 0,!0)}else n.target.col=n.coordsColumn,n.target.col<=i&&n.target.col>=n.fixedColumns&&i>0&&this.hot.scrollViewportTo(void 0,i-1);n.target.col<=i&&n.target.col>=n.fixedColumns&&i>0&&this.hot.scrollViewportTo(void 0,i-1);var C=f,F=u;f+g+d>=c?C=c-g-d:f+d<h+v&&(C=h+v+Math.abs(d)),u>=c-1?F=c-1:F===0?F=1:s.scrollX!==void 0&&n.coordsColumn<n.fixedColumns&&(F-=n.rootElementOffset<=s.scrollX?n.rootElementOffset:0),this.backlight.setPosition(null,C),this.guideline.setPosition(null,F)}},{key:"updateColumnsMapper",value:function(){var n=this.hot.countSourceCols(),i=this.columnsMapper._arrayMap.length;if(i===0)this.columnsMapper.createMap(n||this.hot.getSettings().startCols);else if(i<n){var a=n-i;this.columnsMapper.insertItems(i,a)}else if(i>n){var o=n-1,s=[];pe(this.columnsMapper._arrayMap,function(l,u){l>o&&s.push(u)}),this.columnsMapper.removeItems(s)}}},{key:"registerEvents",value:function(){var n=this;this.eventManager.addEventListener(document.documentElement,"mousemove",function(i){return n.onMouseMove(i)}),this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return n.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(n,i,a,o){var s=this.hot.view.wt.wtTable,l=this.hot.selection.isSelectedByColumnHeader(),u=this.hot.getSelectedRangeLast(),f=Na.get(this),c=n.realTarget.className.indexOf("sortAction")>-1;if(!u||!l||f.pressed||n.button!==0||c){f.pressed=!1,f.columnsToMove.length=0,pt(this.hot.rootElement,[wh,au]);return}var h=this.guideline.isBuilt()&&!this.guideline.isAppended(),d=this.backlight.isBuilt()&&!this.backlight.isAppended();h&&d&&(this.guideline.appendTo(s.hider),this.backlight.appendTo(s.hider));var g=u.from,v=u.to,p=Math.min(g.col,v.col),C=Math.max(g.col,v.col);if(i.row<0&&i.col>=p&&i.col<=C){o.column=!0,f.pressed=!0,f.target.eventPageX=n.pageX,f.coordsColumn=i.col,f.target.TD=a,f.target.col=i.col,f.columnsToMove=this.prepareColumnsToMoving(p,C),f.hasRowHeaders=!!this.hot.getSettings().rowHeaders,f.countCols=this.hot.countCols(),f.fixedColumns=this.hot.getSettings().fixedColumnsLeft,f.rootElementOffset=Xt(this.hot.rootElement).left;var F=f.hasRowHeaders?-1:0,D=s.holder.scrollTop+s.getColumnHeaderHeight(0)+1,ee=i.col<f.fixedColumns,ue=this.hot.view.wt.wtOverlays.scrollableElement,se=ue.scrollX?ue.scrollX-f.rootElementOffset:0,U=n.layerX-(ee?se:0),re=Math.abs(this.getColumnsWidth(p,i.col)+U);this.backlight.setPosition(D,this.getColumnsWidth(F,p)+re),this.backlight.setSize(this.getColumnsWidth(p,C+1),s.hider.offsetHeight-D),this.backlight.setOffset(null,re*-1),$e(this.hot.rootElement,wh)}else pt(this.hot.rootElement,_h),f.pressed=!1,f.columnsToMove.length=0}},{key:"onMouseMove",value:function(n){var i=Na.get(this);if(i.pressed){if(n.realTarget===this.backlight.element){var a=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(a)})}i.target.eventPageX=n.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(n,i,a,o){var s=this.hot.getSelectedRangeLast(),l=Na.get(this);!s||!l.pressed||(l.columnsToMove.indexOf(i.col)>-1?pt(this.hot.rootElement,au):$e(this.hot.rootElement,au),o.row=!0,o.column=!0,o.cell=!0,l.coordsColumn=i.col,l.target.TD=a)}},{key:"onMouseUp",value:function(){var n=Na.get(this);if(n.coordsColumn=void 0,n.pressed=!1,n.backlightWidth=0,pt(this.hot.rootElement,[wh,au,_h]),this.hot.selection.isSelectedByColumnHeader()&&$e(this.hot.rootElement,_h),!(n.columnsToMove.length<1||n.target.col===void 0||n.columnsToMove.indexOf(n.target.col)>-1)){if(this.moveColumns(n.columnsToMove,n.target.col),this.persistentStateSave(),this.hot.render(),this.hot.view.wt.wtOverlays.adjustElementsSize(!0),!n.disallowMoving){var i=this.columnsMapper.getIndexByValue(n.columnsToMove[0]),a=this.columnsMapper.getIndexByValue(n.columnsToMove[n.columnsToMove.length-1]);this.changeSelection(i,a)}n.columnsToMove.length=0}}},{key:"onAfterScrollVertically",value:function(){var n=this.hot.view.wt.wtTable,i=n.getColumnHeaderHeight(0)+1,a=n.holder.scrollTop,o=i+a;this.backlight.setPosition(o),this.backlight.setSize(null,n.hider.offsetHeight-o)}},{key:"onAfterCreateCol",value:function(n,i){this.columnsMapper.shiftItems(n,i)}},{key:"onBeforeRemoveCol",value:function(n,i){var a=this;this.removedColumns.length=0,n!==!1&&Ke(n,n+i-1,function(o){a.removedColumns.push(a.hot.runHooks("modifyCol",o,a.pluginName))})}},{key:"onAfterRemoveCol",value:function(){this.columnsMapper.unshiftItems(this.removedColumns)}},{key:"onAfterLoadData",value:function(){this.updateColumnsMapper()}},{key:"onModifyCol",value:function(n,i){var a=n;if(i!==this.pluginName){var o=this.columnsMapper.getValueByIndex(a);a=o===null?a:o}return a}},{key:"onUnmodifyCol",value:function(n){var i=this.columnsMapper.getIndexByValue(n);return i===null?n:i}},{key:"onAfterPluginsInitialized",value:function(){this.updateColumnsMapper(),this.initialSettings(),this.backlight.build(),this.guideline.build()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),Ja(aa(r.prototype),"destroy",this).call(this)}}]),r}(fr);ur("ManualColumnMove",CC);function tf(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?tf=function(t){return typeof t}:tf=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tf(e)}function UL(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function $p(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function VL(e,r,t){return r&&$p(e.prototype,r),t&&$p(e,t),e}function zL(e,r){return r&&(tf(r)==="object"||typeof r=="function")?r:Jd(e)}function rl(e,r,t){return typeof Reflect<"u"&&Reflect.get?rl=Reflect.get:rl=function(i,a,o){var s=jL(i,a);if(s){var l=Object.getOwnPropertyDescriptor(s,a);return l.get?l.get.call(o):l.value}},rl(e,r,t||e)}function jL(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=Yo(e),e!==null););return e}function Yo(e){return Yo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Yo(e)}function YL(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&Zd(e,r)}function Zd(e,r){return Zd=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Zd(e,r)}function Jd(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var SC=function(e){YL(r,e);function r(t){var n;return UL(this,r),n=zL(this,Yo(r).call(this,t)),n.currentTH=null,n.currentCol=null,n.selectedCols=[],n.currentWidth=null,n.newSize=null,n.startY=null,n.startWidth=null,n.startOffset=null,n.handle=document.createElement("DIV"),n.guide=document.createElement("DIV"),n.eventManager=new Ft(Jd(Jd(n))),n.pressed=null,n.dblclick=0,n.autoresizeTimeout=null,n.manualColumnWidths=[],$e(n.handle,"manualColumnResizer"),$e(n.guide,"manualColumnResizerGuide"),n}return VL(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().manualColumnResize}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){this.manualColumnWidths=[];var i=this.hot.getSettings().manualColumnResize,a=this.loadManualColumnWidths();this.addHook("modifyColWidth",function(o,s){return n.onModifyColWidth(o,s)}),this.addHook("beforeStretchingColumnWidth",function(o,s){return n.onBeforeStretchingColumnWidth(o,s)}),this.addHook("beforeColumnResize",function(o,s,l){return n.onBeforeColumnResize(o,s,l)}),typeof a<"u"?this.manualColumnWidths=a:Array.isArray(i)?this.manualColumnWidths=i:this.manualColumnWidths=[],this.bindEvents(),rl(Yo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var n=this.hot.getSettings().manualColumnResize;Array.isArray(n)?this.manualColumnWidths=n:n||(this.manualColumnWidths=[])}},{key:"disablePlugin",value:function(){rl(Yo(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave","manualColumnWidths",this.manualColumnWidths)}},{key:"loadManualColumnWidths",value:function(){var n={};return this.hot.runHooks("persistentStateLoad","manualColumnWidths",n),n.value}},{key:"setupHandlePosition",value:function(n){var i=this;if(!n.parentNode)return!1;this.currentTH=n;var a=this.hot.view.wt.wtTable.getCoords(n).col,o=sr(this.currentTH);if(a>=0){var s=this.currentTH.getBoundingClientRect();if(this.currentCol=a,this.selectedCols=[],this.hot.selection.isSelected()&&this.hot.selection.isSelectedByColumnHeader()){var l=this.hot.getSelectedRangeLast(),u=l.from,f=l.to,c=u.col,h=f.col;c>=h&&(c=f.col,h=u.col),this.currentCol>=c&&this.currentCol<=h?Ke(c,h,function(d){return i.selectedCols.push(d)}):this.selectedCols.push(this.currentCol)}else this.selectedCols.push(this.currentCol);this.startOffset=s.left-6,this.startWidth=parseInt(s.width,10),this.handle.style.top="".concat(s.top,"px"),this.handle.style.left="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(o,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.left="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var n=parseInt(sr(this.handle),10),i=parseInt(this.handle.style.top,10)+n,a=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);$e(this.handle,"active"),$e(this.guide,"active"),this.guide.style.top="".concat(i,"px"),this.guide.style.left=this.handle.style.left,this.guide.style.height="".concat(a-n,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.left=this.handle.style.left}},{key:"hideHandleAndGuide",value:function(){pt(this.handle,"active"),pt(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(n){if(n!==this.hot.rootElement){var i=n.parentNode;return i.tagName==="THEAD"?!0:this.checkIfColumnHeader(i)}return!1}},{key:"getTHFromTargetElement",value:function(n){return n.tagName!=="TABLE"?n.tagName==="TH"?n:this.getTHFromTargetElement(n.parentNode):null}},{key:"onMouseOver",value:function(n){if(this.checkIfColumnHeader(n.target)){var i=this.getTHFromTargetElement(n.target);if(!i)return;var a=i.getAttribute("colspan");i&&(a===null||a===1)&&(this.pressed||this.setupHandlePosition(i))}}},{key:"afterMouseDownTimeout",value:function(){var n=this,i=function(){n.hot.forceFullRender=!0,n.hot.view.render(),n.hot.view.wt.wtOverlays.adjustElementsSize(!0)},a=function(l,u){var f=n.hot.runHooks("beforeColumnResize",l,n.newSize,!0);f!==void 0&&(n.newSize=f),n.hot.getSettings().stretchH==="all"?n.clearManualSize(l):n.setManualSize(l,n.newSize),u&&i(),n.saveManualColumnWidths(),n.hot.runHooks("afterColumnResize",l,n.newSize,!0)};if(this.dblclick>=2){var o=this.selectedCols.length;o>1?(pe(this.selectedCols,function(s){a(s)}),i()):pe(this.selectedCols,function(s){a(s,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(n){var i=this;gt(n.target,"manualColumnResizer")&&(this.setupGuidePosition(),this.pressed=this.hot,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return i.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=hl(n),this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(n){var i=this;this.pressed&&(this.currentWidth=this.startWidth+(hl(n)-this.startX),pe(this.selectedCols,function(a){i.newSize=i.setManualSize(a,i.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var n=this,i=function(){n.hot.forceFullRender=!0,n.hot.view.render(),n.hot.view.wt.wtOverlays.adjustElementsSize(!0)},a=function(l,u){n.hot.runHooks("beforeColumnResize",l,n.newSize,!1),u&&i(),n.saveManualColumnWidths(),n.hot.runHooks("afterColumnResize",l,n.newSize)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){var o=this.selectedCols.length;o>1?(pe(this.selectedCols,function(s){a(s)}),i()):pe(this.selectedCols,function(s){a(s,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var n=this;this.eventManager.addEventListener(this.hot.rootElement,"mouseover",function(i){return n.onMouseOver(i)}),this.eventManager.addEventListener(this.hot.rootElement,"mousedown",function(i){return n.onMouseDown(i)}),this.eventManager.addEventListener(window,"mousemove",function(i){return n.onMouseMove(i)}),this.eventManager.addEventListener(window,"mouseup",function(){return n.onMouseUp()})}},{key:"setManualSize",value:function(n,i){var a=Math.max(i,20),o=this.hot.runHooks("modifyCol",n);return this.manualColumnWidths[o]=a,a}},{key:"clearManualSize",value:function(n){var i=this.hot.runHooks("modifyCol",n);this.manualColumnWidths[i]=void 0}},{key:"onModifyColWidth",value:function(n,i){var a=n;if(this.enabled){var o=this.hot.runHooks("modifyCol",i),s=this.manualColumnWidths[o];this.hot.getSettings().manualColumnResize&&s&&(a=s)}return a}},{key:"onBeforeStretchingColumnWidth",value:function(n,i){var a=this.manualColumnWidths[i];return a===void 0&&(a=n),a}},{key:"onBeforeColumnResize",value:function(){this.hot.view.wt.wtViewport.hasOversizedColumnHeadersMarked={}}}]),r}(fr);ur("manualColumnResize",SC);function GL(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Up(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function XL(e,r,t){return r&&Up(e.prototype,r),t&&Up(e,t),e}var bC=function(){function e(r){GL(this,e),this.manualRowMove=r}return XL(e,[{key:"createMap",value:function(t){var n=this,i=t===void 0?this._arrayMap.length:t;this._arrayMap.length=0,Ke(i-1,function(a){n._arrayMap[a]=a})}},{key:"destroy",value:function(){this._arrayMap=null}},{key:"moveRow",value:function(t,n){var i=this._arrayMap[t];this._arrayMap[t]=null,this._arrayMap.splice(n,0,i)}},{key:"clearNull",value:function(){this._arrayMap=da(this._arrayMap,function(t){return t!==null})}}]),e}();vi(bC,yc);function KL(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Vp(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function qL(e,r,t){return r&&Vp(e.prototype,r),t&&Vp(e,t),e}var zp=0,jp=1,Yp=2,Lo="px",xC=function(){function e(r){KL(this,e),this.hot=r,this._element=null,this.state=zp}return qL(e,[{key:"appendTo",value:function(t){t.appendChild(this._element),this.state=Yp}},{key:"build",value:function(){this._element=document.createElement("div"),this.state=jp}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=zp}},{key:"isAppended",value:function(){return this.state===Yp}},{key:"isBuilt",value:function(){return this.state>=jp}},{key:"setPosition",value:function(t,n){t!==void 0&&(this._element.style.top=t+Lo),n!==void 0&&(this._element.style.left=n+Lo)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(t,n){t&&(this._element.style.width=t+Lo),n&&(this._element.style.height=n+Lo)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(t,n){t&&(this._element.style.marginTop=t+Lo),n&&(this._element.style.marginLeft=n+Lo)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),e}();function rf(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?rf=function(t){return typeof t}:rf=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rf(e)}function ZL(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Gp(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function JL(e,r,t){return r&&Gp(e.prototype,r),t&&Gp(e,t),e}function QL(e,r){return r&&(rf(r)==="object"||typeof r=="function")?r:e4(e)}function e4(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nf(e,r,t){return typeof Reflect<"u"&&Reflect.get?nf=Reflect.get:nf=function(i,a,o){var s=t4(i,a);if(s){var l=Object.getOwnPropertyDescriptor(s,a);return l.get?l.get.call(o):l.value}},nf(e,r,t||e)}function t4(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=Sl(e),e!==null););return e}function Sl(e){return Sl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Sl(e)}function r4(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&Qd(e,r)}function Qd(e,r){return Qd=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Qd(e,r)}var n4="ht__manualRowMove--backlight",i4=function(e){r4(r,e);function r(){return ZL(this,r),QL(this,Sl(r).apply(this,arguments))}return JL(r,[{key:"build",value:function(){nf(Sl(r.prototype),"build",this).call(this),$e(this._element,n4)}}]),r}(xC);function af(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?af=function(t){return typeof t}:af=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},af(e)}function a4(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Xp(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o4(e,r,t){return r&&Xp(e.prototype,r),t&&Xp(e,t),e}function s4(e,r){return r&&(af(r)==="object"||typeof r=="function")?r:l4(e)}function l4(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function of(e,r,t){return typeof Reflect<"u"&&Reflect.get?of=Reflect.get:of=function(i,a,o){var s=u4(i,a);if(s){var l=Object.getOwnPropertyDescriptor(s,a);return l.get?l.get.call(o):l.value}},of(e,r,t||e)}function u4(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=bl(e),e!==null););return e}function bl(e){return bl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},bl(e)}function f4(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&e0(e,r)}function e0(e,r){return e0=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},e0(e,r)}var c4="ht__manualRowMove--guideline",h4=function(e){f4(r,e);function r(){return a4(this,r),s4(this,bl(r).apply(this,arguments))}return o4(r,[{key:"build",value:function(){of(bl(r.prototype),"build",this).call(this),$e(this._element,c4)}}]),r}(xC);function sf(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?sf=function(t){return typeof t}:sf=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sf(e)}function d4(e){return m4(e)||g4(e)||v4()}function v4(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function g4(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}function m4(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}function p4(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Kp(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y4(e,r,t){return r&&Kp(e.prototype,r),t&&Kp(e,t),e}function w4(e,r){return r&&(sf(r)==="object"||typeof r=="function")?r:Ha(e)}function Qa(e,r,t){return typeof Reflect<"u"&&Reflect.get?Qa=Reflect.get:Qa=function(i,a,o){var s=_4(i,a);if(s){var l=Object.getOwnPropertyDescriptor(s,a);return l.get?l.get.call(o):l.value}},Qa(e,r,t||e)}function _4(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=oa(e),e!==null););return e}function oa(e){return oa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},oa(e)}function C4(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&t0(e,r)}function t0(e,r){return t0=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},t0(e,r)}function Ha(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}at.getSingleton().register("beforeRowMove");at.getSingleton().register("afterRowMove");at.getSingleton().register("unmodifyRow");var ji=new WeakMap,qp="ht__manualRowMove",ou="show-ui",Ch="on-moving--rows",Sh="after-selection--rows",EC=function(e){C4(r,e);function r(t){var n;return p4(this,r),n=w4(this,oa(r).call(this,t)),ji.set(Ha(Ha(n)),{rowsToMove:[],pressed:void 0,disallowMoving:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0}}),n.removedRows=[],n.rowsMapper=new bC(Ha(Ha(n))),n.eventManager=new Ft(Ha(Ha(n))),n.backlight=new i4(t),n.guideline=new h4(t),n}return y4(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualRowMove}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(i,a,o,s){return n.onBeforeOnCellMouseDown(i,a,o,s)}),this.addHook("beforeOnCellMouseOver",function(i,a,o,s){return n.onBeforeOnCellMouseOver(i,a,o,s)}),this.addHook("afterScrollHorizontally",function(){return n.onAfterScrollHorizontally()}),this.addHook("modifyRow",function(i,a){return n.onModifyRow(i,a)}),this.addHook("beforeRemoveRow",function(i,a){return n.onBeforeRemoveRow(i,a)}),this.addHook("afterRemoveRow",function(){return n.onAfterRemoveRow()}),this.addHook("afterCreateRow",function(i,a){return n.onAfterCreateRow(i,a)}),this.addHook("afterLoadData",function(){return n.onAfterLoadData()}),this.addHook("beforeColumnSort",function(i,a){return n.onBeforeColumnSort(i,a)}),this.addHook("unmodifyRow",function(i){return n.onUnmodifyRow(i)}),this.registerEvents(),$e(this.hot.rootElement,qp),Qa(oa(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.onAfterPluginsInitialized(),Qa(oa(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var n=this.hot.getSettings().manualRowMove;Array.isArray(n)&&this.rowsMapper.clearMap(),pt(this.hot.rootElement,qp),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),Qa(oa(r.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(n,i){this.moveRows([n],i)}},{key:"moveRows",value:function(n,i){var a=this,o=d4(n),s=ji.get(this),l=this.hot.runHooks("beforeRowMove",o,i);s.disallowMoving=l===!1,s.disallowMoving||(pe(n,function(u,f,c){c[f]=a.rowsMapper.getValueByIndex(u)}),pe(n,function(u,f){var c=a.rowsMapper.getIndexByValue(u);c!==i&&a.rowsMapper.moveRow(c,i+f)}),this.rowsMapper.clearNull()),this.hot.runHooks("afterRowMove",o,i)}},{key:"changeSelection",value:function(n,i){this.hot.selectRows(n,i)}},{key:"getRowsHeight",value:function(n,i){for(var a=0,o=n;o<i;o++){var s=this.hot.view.wt.wtTable.getRowHeight(o)||23;a+=s}return a}},{key:"initialSettings",value:function(){var n=this.hot.getSettings().manualRowMove;if(Array.isArray(n))this.moveRows(n,0);else if(n!==void 0){var i=this.persistentStateLoad();i.length&&this.moveRows(i,0)}}},{key:"isFixedRowTop",value:function(n){return n<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(n){return n>this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.rowsMapper._arrayMap)}},{key:"persistentStateLoad",value:function(){var n={};return this.hot.runHooks("persistentStateLoad","manualRowMove",n),n.value?n.value:[]}},{key:"prepareRowsToMoving",value:function(){var n=this.hot.getSelectedRangeLast(),i=[];if(!n)return i;var a=n.from,o=n.to,s=Math.min(a.row,o.row),l=Math.max(a.row,o.row);return Ke(s,l,function(u){i.push(u)}),i}},{key:"refreshPositions",value:function(){var n=ji.get(this),i=n.target.coords,a=this.hot.view.wt.wtTable.getFirstVisibleRow(),o=this.hot.view.wt.wtTable.getLastVisibleRow(),s=this.hot.getSettings().fixedRowsTop,l=this.hot.countRows();i.row<s&&a>0&&this.hot.scrollViewportTo(a-1),i.row>=o&&o<l&&this.hot.scrollViewportTo(o+1,void 0,!0);var u=this.hot.view.wt.wtTable,f=n.target.TD,c=Xt(this.hot.rootElement),h=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,i.row),d=n.target.eventPageY-c.top+u.holder.scrollTop,g=u.hider.offsetHeight,v=u.TBODY.offsetTop,p=this.backlight.getOffset().top,C=this.backlight.getSize().height;this.isFixedRowTop(i.row)&&(h+=u.holder.scrollTop),i.row<0?n.target.row=a>0?a-1:a:f.offsetHeight/2+h<=d?(n.target.row=i.row+1,h+=i.row===0?f.offsetHeight-1:f.offsetHeight):n.target.row=i.row;var F=d,D=h;d+C+p>=g?F=g-C-p:d+p<v&&(F=v+Math.abs(p)),h>=g-1&&(D=g-1);var ee=0;this.hot.view.wt.wtOverlays.topOverlay&&(ee=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.TABLE.offsetHeight),i.row>=s&&D-u.holder.scrollTop<ee&&this.hot.scrollViewportTo(i.row),this.backlight.setPosition(F),this.guideline.setPosition(D)}},{key:"updateRowsMapper",value:function(){var n=this.hot.countSourceRows(),i=this.rowsMapper._arrayMap.length;if(i===0)this.rowsMapper.createMap(n||this.hot.getSettings().startRows);else if(i<n){var a=n-i;this.rowsMapper.insertItems(i,a)}else if(i>n){var o=n-1,s=[];pe(this.rowsMapper._arrayMap,function(l,u){l>o&&s.push(u)}),this.rowsMapper.removeItems(s)}}},{key:"registerEvents",value:function(){var n=this;this.eventManager.addEventListener(document.documentElement,"mousemove",function(i){return n.onMouseMove(i)}),this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return n.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeColumnSort",value:function(n,i){var a=ji.get(this);a.disallowMoving=i!==void 0}},{key:"onBeforeOnCellMouseDown",value:function(n,i,a,o){var s=this.hot.view.wt.wtTable,l=this.hot.selection.isSelectedByRowHeader(),u=this.hot.getSelectedRangeLast(),f=ji.get(this);if(!u||!l||f.pressed||n.button!==0){f.pressed=!1,f.rowsToMove.length=0,pt(this.hot.rootElement,[Ch,ou]);return}var c=this.guideline.isBuilt()&&!this.guideline.isAppended(),h=this.backlight.isBuilt()&&!this.backlight.isAppended();c&&h&&(this.guideline.appendTo(s.hider),this.backlight.appendTo(s.hider));var d=u.from,g=u.to,v=Math.min(d.row,g.row),p=Math.max(d.row,g.row);if(i.col<0&&i.row>=v&&i.row<=p){o.row=!0,f.pressed=!0,f.target.eventPageY=n.pageY,f.target.coords=i,f.target.TD=a,f.rowsToMove=this.prepareRowsToMoving();var C=s.holder.scrollLeft+this.hot.view.wt.wtViewport.getRowHeaderWidth();this.backlight.setPosition(null,C),this.backlight.setSize(s.hider.offsetWidth-C,this.getRowsHeight(v,p+1)),this.backlight.setOffset((this.getRowsHeight(v,i.row)+n.layerY)*-1,null),$e(this.hot.rootElement,Ch),this.refreshPositions()}else pt(this.hot.rootElement,Sh),f.pressed=!1,f.rowsToMove.length=0}},{key:"onMouseMove",value:function(n){var i=ji.get(this);if(i.pressed){if(n.realTarget===this.backlight.element){var a=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,a)})}i.target.eventPageY=n.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(n,i,a,o){var s=this.hot.getSelectedRangeLast(),l=ji.get(this);!s||!l.pressed||(l.rowsToMove.indexOf(i.row)>-1?pt(this.hot.rootElement,ou):$e(this.hot.rootElement,ou),o.row=!0,o.column=!0,o.cell=!0,l.target.coords=i,l.target.TD=a)}},{key:"onMouseUp",value:function(){var n=ji.get(this),i=n.target.row,a=n.rowsToMove.length;if(n.pressed=!1,n.backlightHeight=0,pt(this.hot.rootElement,[Ch,ou,Sh]),this.hot.selection.isSelectedByRowHeader()&&$e(this.hot.rootElement,Sh),!(a<1||i===void 0||n.rowsToMove.indexOf(i)>-1||n.rowsToMove[a-1]===i-1)){if(this.moveRows(n.rowsToMove,i),this.persistentStateSave(),this.hot.render(),!n.disallowMoving){var o=this.rowsMapper.getIndexByValue(n.rowsToMove[0]),s=this.rowsMapper.getIndexByValue(n.rowsToMove[a-1]);this.changeSelection(o,s)}n.rowsToMove.length=0}}},{key:"onAfterScrollHorizontally",value:function(){var n=this.hot.view.wt.wtTable,i=this.hot.view.wt.wtViewport.getRowHeaderWidth(),a=n.holder.scrollLeft,o=i+a;this.backlight.setPosition(null,o),this.backlight.setSize(n.hider.offsetWidth-o)}},{key:"onAfterCreateRow",value:function(n,i){this.rowsMapper.shiftItems(n,i)}},{key:"onBeforeRemoveRow",value:function(n,i){var a=this;this.removedRows.length=0,n!==!1&&Ke(n,n+i-1,function(o){a.removedRows.push(a.hot.runHooks("modifyRow",o,a.pluginName))})}},{key:"onAfterRemoveRow",value:function(){this.rowsMapper.unshiftItems(this.removedRows)}},{key:"onAfterLoadData",value:function(){this.updateRowsMapper()}},{key:"onModifyRow",value:function(n,i){var a=n;if(i!==this.pluginName){var o=this.rowsMapper.getValueByIndex(a);a=o===null?a:o}return a}},{key:"onUnmodifyRow",value:function(n){var i=this.rowsMapper.getIndexByValue(n);return i===null?n:i}},{key:"onAfterPluginsInitialized",value:function(){this.updateRowsMapper(),this.initialSettings(),this.backlight.build(),this.guideline.build()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),this.rowsMapper.destroy(),Qa(oa(r.prototype),"destroy",this).call(this)}}]),r}(fr);ur("ManualRowMove",EC);function lf(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?lf=function(t){return typeof t}:lf=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lf(e)}function S4(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Zp(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function b4(e,r,t){return r&&Zp(e.prototype,r),t&&Zp(e,t),e}function x4(e,r){return r&&(lf(r)==="object"||typeof r=="function")?r:n0(e)}function nl(e,r,t){return typeof Reflect<"u"&&Reflect.get?nl=Reflect.get:nl=function(i,a,o){var s=E4(i,a);if(s){var l=Object.getOwnPropertyDescriptor(s,a);return l.get?l.get.call(o):l.value}},nl(e,r,t||e)}function E4(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=Go(e),e!==null););return e}function Go(e){return Go=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Go(e)}function T4(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&r0(e,r)}function r0(e,r){return r0=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},r0(e,r)}function n0(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var TC=function(e){T4(r,e);function r(t){var n;return S4(this,r),n=x4(this,Go(r).call(this,t)),n.currentTH=null,n.currentRow=null,n.selectedRows=[],n.currentHeight=null,n.newSize=null,n.startY=null,n.startHeight=null,n.startOffset=null,n.handle=document.createElement("DIV"),n.guide=document.createElement("DIV"),n.eventManager=new Ft(n0(n0(n))),n.pressed=null,n.dblclick=0,n.autoresizeTimeout=null,n.manualRowHeights=[],$e(n.handle,"manualRowResizer"),$e(n.guide,"manualRowResizerGuide"),n}return b4(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().manualRowResize}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){this.manualRowHeights=[];var i=this.hot.getSettings().manualRowResize,a=this.loadManualRowHeights();typeof a<"u"?this.manualRowHeights=a:Array.isArray(i)?this.manualRowHeights=i:this.manualRowHeights=[],this.addHook("modifyRowHeight",function(o,s){return n.onModifyRowHeight(o,s)}),this.bindEvents(),nl(Go(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var n=this.hot.getSettings().manualRowResize;Array.isArray(n)?this.manualRowHeights=n:n||(this.manualRowHeights=[])}},{key:"disablePlugin",value:function(){nl(Go(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave","manualRowHeights",this.manualRowHeights)}},{key:"loadManualRowHeights",value:function(){var n={};return this.hot.runHooks("persistentStateLoad","manualRowHeights",n),n.value}},{key:"setupHandlePosition",value:function(n){var i=this;this.currentTH=n;var a=this.hot.view.wt.wtTable.getCoords(n).row,o=Gt(this.currentTH);if(a>=0){var s=this.currentTH.getBoundingClientRect();if(this.currentRow=a,this.selectedRows=[],this.hot.selection.isSelected()&&this.hot.selection.isSelectedByRowHeader()){var l=this.hot.getSelectedRangeLast(),u=l.from,f=l.to,c=u.row,h=f.row;c>=h&&(c=f.row,h=u.row),this.currentRow>=c&&this.currentRow<=h?Ke(c,h,function(d){return i.selectedRows.push(d)}):this.selectedRows.push(this.currentRow)}else this.selectedRows.push(this.currentRow);this.startOffset=s.top-6,this.startHeight=parseInt(s.height,10),this.handle.style.left="".concat(s.left,"px"),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style.width="".concat(o,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var n=parseInt(Gt(this.handle),10),i=parseInt(this.handle.style.left,10)+n,a=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);$e(this.handle,"active"),$e(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style.left="".concat(i,"px"),this.guide.style.width="".concat(a-n,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){pt(this.handle,"active"),pt(this.guide,"active")}},{key:"checkIfRowHeader",value:function(n){if(n!==this.hot.rootElement){var i=n.parentNode;return i.tagName==="TBODY"?!0:this.checkIfRowHeader(i)}return!1}},{key:"getTHFromTargetElement",value:function(n){return n.tagName!=="TABLE"?n.tagName==="TH"?n:this.getTHFromTargetElement(n.parentNode):null}},{key:"onMouseOver",value:function(n){if(this.checkIfRowHeader(n.target)){var i=this.getTHFromTargetElement(n.target);i&&(this.pressed||this.setupHandlePosition(i))}}},{key:"afterMouseDownTimeout",value:function(){var n=this,i=function(){n.hot.forceFullRender=!0,n.hot.view.render(),n.hot.view.wt.wtOverlays.adjustElementsSize(!0)},a=function(l,u){var f=n.hot.runHooks("beforeRowResize",l,n.newSize,!0);f!==void 0&&(n.newSize=f),n.setManualSize(l,n.newSize),u&&i(),n.hot.runHooks("afterRowResize",l,n.newSize,!0)};if(this.dblclick>=2){var o=this.selectedRows.length;o>1?(pe(this.selectedRows,function(s){a(s)}),i()):pe(this.selectedRows,function(s){a(s,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(n){var i=this;gt(n.target,"manualRowResizer")&&(this.setupGuidePosition(),this.pressed=this.hot,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return i.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=dl(n),this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(n){var i=this;this.pressed&&(this.currentHeight=this.startHeight+(dl(n)-this.startY),pe(this.selectedRows,function(a){i.newSize=i.setManualSize(a,i.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var n=this,i=function(){n.hot.forceFullRender=!0,n.hot.view.render(),n.hot.view.wt.wtOverlays.adjustElementsSize(!0)},a=function(l,u){n.hot.runHooks("beforeRowResize",l,n.newSize),u&&i(),n.saveManualRowHeights(),n.hot.runHooks("afterRowResize",l,n.newSize,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){var o=this.selectedRows.length;o>1?(pe(this.selectedRows,function(s){a(s)}),i()):pe(this.selectedRows,function(s){a(s,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var n=this;this.eventManager.addEventListener(this.hot.rootElement,"mouseover",function(i){return n.onMouseOver(i)}),this.eventManager.addEventListener(this.hot.rootElement,"mousedown",function(i){return n.onMouseDown(i)}),this.eventManager.addEventListener(window,"mousemove",function(i){return n.onMouseMove(i)}),this.eventManager.addEventListener(window,"mouseup",function(){return n.onMouseUp()})}},{key:"setManualSize",value:function(n,i){var a=this.hot.runHooks("modifyRow",n);return this.manualRowHeights[a]=i,i}},{key:"onModifyRowHeight",value:function(n,i){if(this.enabled){var a=this.hot.getPlugin("autoRowSize"),o=a?a.heights[i]:null,s=this.hot.runHooks("modifyRow",i),l=this.manualRowHeights[s];if(l!==void 0&&(l===o||l>(n||0)))return l}return n}}]),r}(fr);ur("manualRowResize",TC);function OC(){var e=kc(["The merged cell declared at [",", ",`] has "rowspan" or "colspan" declared as 
      "0", which is not supported. It cannot be added to the collection.`]);return OC=function(){return e},e}function RC(){var e=kc(["The merged cell declared at [",", ",`] has both "rowspan" 
     and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`]);return RC=function(){return e},e}function kC(){var e=kc(["The merged cell declared at [",", ",`] is positioned (or positioned partially) 
       outside of the table range. It was not added to the table, please fix your setup.`]);return kC=function(){return e},e}function AC(){var e=kc(["The merged cell declared with {row: ",", col: ",`, rowspan: 
    `,", colspan: ",`} contains negative values, which is not supported. It 
    will not be added to the collection.`]);return AC=function(){return e},e}function kc(e,r){return r||(r=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(r)}}))}function O4(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Jp(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function R4(e,r,t){return r&&Jp(e.prototype,r),t&&Jp(e,t),e}var ti=function(){function e(r,t,n,i){O4(this,e),this.row=r,this.col=t,this.rowspan=n,this.colspan=i,this.removed=!1}return R4(e,[{key:"normalize",value:function(t){var n=t.countRows(),i=t.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col)}},{key:"includes",value:function(t,n){return this.row<=t&&this.col<=n&&this.row+this.rowspan-1>=t&&this.col+this.colspan-1>=n}},{key:"includesHorizontally",value:function(t){return this.col<=t&&this.col+this.colspan-1>=t}},{key:"includesVertically",value:function(t){return this.row<=t&&this.row+this.rowspan-1>=t}},{key:"shift",value:function(t,n){var i=t[0]||t[1],a=n+Math.abs(t[0]||t[1])-1,o=t[0]?"colspan":"rowspan",s=t[0]?"col":"row",l=Math.min(n,a),u=Math.max(n,a),f=this[s],c=this[s]+this[o]-1;if(f>=n&&(this[s]+=i),i>0)n<=c&&n>f&&(this[o]+=i);else if(i<0){if(l<=f&&u>=c)return this.removed=!0,!1;if(f>=l&&f<=u){var h=u-f+1,d=Math.abs(i)-h;this[s]-=d+i,this[o]-=h}else if(f<=l&&c>=u)this[o]+=i;else if(f<=l&&c>=l&&c<u){var g=c-l+1;this[o]-=g}}return!0}},{key:"isFarther",value:function(t,n){return t?n==="down"?t.row+t.rowspan-1<this.row+this.rowspan-1:n==="up"?t.row>this.row:n==="right"?t.col+t.colspan-1<this.col+this.colspan-1:n==="left"?t.col>this.col:null:!0}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return new Kr(new me(this.row,this.col),new me(this.row,this.col),new me(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(t){return ci(AC(),t.row,t.col,t.rowspan,t.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(t){return ci(kC(),t.row,t.col)}},{key:"IS_SINGLE_CELL",value:function(t){return ci(RC(),t.row,t.col)}},{key:"ZERO_SPAN_WARNING",value:function(t){return ci(OC(),t.row,t.col)}},{key:"containsNegativeValues",value:function(t){return t.row<0||t.col<0||t.rowspan<0||t.colspan<0}},{key:"isSingleCell",value:function(t){return t.colspan===1&&t.rowspan===1}},{key:"containsZeroSpan",value:function(t){return t.colspan===0||t.rowspan===0}},{key:"isOutOfBounds",value:function(t,n,i){return t.row<0||t.col<0||t.row>=n||t.row+t.rowspan-1>=n||t.col>=i||t.col+t.colspan-1>=i}}]),e}();function i0(e,r,t,n){r?r.row===t&&r.col===n?(e.setAttribute("rowspan",r.rowspan.toString()),e.setAttribute("colspan",r.colspan.toString())):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}function MC(){var e=k4(["The merged cell declared at [",", ",`], overlaps with the other declared merged 
    cell. The overlapping merged cell was not added to the table, please fix your setup.`]);return MC=function(){return e},e}function k4(e,r){return r||(r=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(r)}}))}function Qp(e){return D4(e)||M4(e)||A4()}function A4(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function M4(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}function D4(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}function P4(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function ey(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function N4(e,r,t){return r&&ey(e.prototype,r),t&&ey(e,t),e}var F4=function(){function e(r){P4(this,e),this.plugin=r,this.mergedCells=[],this.hot=r.hot}return N4(e,[{key:"get",value:function(t,n){var i=this.mergedCells,a=!1;return pe(i,function(o){return o.row<=t&&o.row+o.rowspan-1>=t&&o.col<=n&&o.col+o.colspan-1>=n?(a=o,!1):!0}),a}},{key:"getByRange",value:function(t){var n=this.mergedCells,i=!1;return pe(n,function(a){return a.row<=t.from.row&&a.row+a.rowspan-1>=t.to.row&&a.col<=t.from.col&&a.col+a.colspan-1>=t.to.col?(i=a,i):!0}),i}},{key:"getWithinRange",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.mergedCells,a=[],o=t;if(!o.includesRange){var s=new me(o.from.row,o.from.col),l=new me(o.to.row,o.to.col);o=new Kr(s,s,l)}return pe(i,function(u){var f=new me(u.row,u.col),c=new me(u.row+u.rowspan-1,u.col+u.colspan-1),h=new Kr(f,f,c);n?o.overlaps(h)&&a.push(u):o.includesRange(h)&&a.push(u)}),a.length?a:!1}},{key:"add",value:function(t){var n=this.mergedCells,i=t.row,a=t.col,o=t.rowspan,s=t.colspan,l=new ti(i,a,o,s),u=this.get(i,a),f=this.isOverlapping(l);return!u&&!f?(this.hot&&l.normalize(this.hot),n.push(l),l):(fa(e.IS_OVERLAPPING_WARNING(l)),!1)}},{key:"remove",value:function(t,n){var i=this.mergedCells,a=this.get(t,n),o=a?this.mergedCells.indexOf(a):null;return a&&o!==!1?(i.splice(o,1),a):!1}},{key:"clear",value:function(){var t=this,n=this.mergedCells,i=[],a=[];pe(n,function(o){var s=t.hot.getCell(o.row,o.col);s&&i.push([s,t.get(o.row,o.col),o.row,o.col])}),this.mergedCells.length=0,pe(i,function(o,s){Ke(0,o.rowspan-1,function(l){Ke(0,o.colspan-1,function(u){if(u!==0||l!==0){var f=t.hot.getCell(o.row+l,o.col+u);f&&a.push([f,null,null,null])}})}),i[s][1]=null}),pe(i,function(o){i0.apply(void 0,Qp(o))}),pe(a,function(o){i0.apply(void 0,Qp(o))})}},{key:"isOverlapping",value:function(t){var n=new Kr(null,new me(t.row,t.col),new me(t.row+t.rowspan-1,t.col+t.colspan-1)),i=!1;return pe(this.mergedCells,function(a){var o=new Kr(null,new me(a.row,a.col),new me(a.row+a.rowspan-1,a.col+a.colspan-1));return o.overlaps(n)?(i=!0,!1):!0}),i}},{key:"isMergedParent",value:function(t,n){var i=this.mergedCells,a=!1;return pe(i,function(o){return o.row===t&&o.col===n?(a=!0,!1):!0}),a}},{key:"shiftCollections",value:function(t,n,i){var a=this,o=[0,0];switch(t){case"right":o[0]+=i;break;case"left":o[0]-=i;break;case"down":o[1]+=i;break;case"up":o[1]-=i;break}pe(this.mergedCells,function(s){s.shift(o,n)}),fs(this.mergedCells.length-1,0,function(s){var l=a.mergedCells[s];l&&l.removed&&a.mergedCells.splice(a.mergedCells.indexOf(l),1)})}}],[{key:"IS_OVERLAPPING_WARNING",value:function(t){return ci(MC(),t.row,t.col)}}]),e}();function Fa(e,r){return H4(e)||I4(e,r)||L4()}function L4(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function I4(e,r){var t=[],n=!0,i=!1,a=void 0;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done)&&(t.push(s.value),!(r&&t.length===r));n=!0);}catch(l){i=!0,a=l}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw a}}return t}function H4(e){if(Array.isArray(e))return e}function B4(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function ty(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function W4(e,r,t){return r&&ty(e.prototype,r),t&&ty(e,t),e}var $4=function(){function e(r){B4(this,e),this.plugin=r,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return W4(e,[{key:"correctSelectionAreaSize",value:function(t){if(t[0]===t[2]&&t[1]===t[3]){var n=this.mergedCellsCollection.get(t[0],t[1]);n&&(t[2]=t[0]+n.rowspan-1,t[3]=t[1]+n.colspan-1)}}},{key:"getDirection",value:function(t,n){var i=null;return n[0]===t[0]&&n[1]===t[1]&&n[3]===t[3]?i="down":n[2]===t[2]&&n[1]===t[1]&&n[3]===t[3]?i="up":n[1]===t[1]&&n[2]===t[2]?i="right":i="left",i}},{key:"snapDragArea",value:function(t,n,i,a){var o=n.slice(0),s=this.getAutofillSize(t,n,i),l=Fa(t,4),u=l[0],f=l[1],c=l[2],h=l[3],d=["up","down"].indexOf(i)>-1,g=d?c-u+1:h-f+1,v=Math.floor(s/g)*g,p=s-v,C=this.getFarthestCollection(t,n,i,a);if(C){if(i==="down"){var F=C.row+C.rowspan-u-p,D=o[2]+F;D>=this.plugin.hot.countRows()?o[2]-=p:o[2]+=p?F:0}else if(i==="right"){var ee=C.col+C.colspan-f-p,ue=o[3]+ee;ue>=this.plugin.hot.countCols()?o[3]-=p:o[3]+=p?ee:0}else if(i==="up"){var se=c-p-C.row+1,U=o[0]+se;U<0?o[0]+=p:o[0]-=p?se:0}else if(i==="left"){var re=h-p-C.col+1,m=o[1]+re;m<0?o[1]+=p:o[1]-=p?re:0}}return this.updateCurrentFillCache({baseArea:t,dragDirection:i,foundMergedCells:a,fillSize:s,dragArea:o,cycleLength:g}),o}},{key:"updateCurrentFillCache",value:function(t){this.currentFillData||(this.currentFillData={}),pn(this.currentFillData,t)}},{key:"getAutofillSize",value:function(t,n,i){var a=Fa(t,4),o=a[0],s=a[1],l=a[2],u=a[3],f=Fa(n,4),c=f[0],h=f[1],d=f[2],g=f[3];switch(i){case"up":return o-c;case"down":return d-l;case"left":return s-h;case"right":return g-u;default:return null}}},{key:"getDragArea",value:function(t,n,i){var a=Fa(t,4),o=a[0],s=a[1],l=a[2],u=a[3],f=Fa(n,4),c=f[0],h=f[1],d=f[2],g=f[3];switch(i){case"up":return[c,h,o-1,u];case"down":return[l+1,s,d,u];case"left":return[c,h,l,s-1];case"right":return[o,u+1,d,g];default:return null}}},{key:"getFarthestCollection",value:function(t,n,i,a){var o=Fa(t,4),s=o[0],l=o[1],u=o[2],f=o[3],c=["up","down"].indexOf(i)>-1,h=c?u:f,d=c?s:l,g=this.getAutofillSize(t,n,i),v=c?u-s+1:f-l+1,p=Math.floor(g/v)*v,C=g-p,F=null,D=null,ee=null;switch(i){case"up":F="includesVertically",ee=h-C+1;break;case"left":F="includesHorizontally",ee=h-C+1;break;case"down":F="includesVertically",ee=d+C-1;break;case"right":F="includesHorizontally",ee=d+C-1;break}return pe(a,function(ue){ue[F](ee)&&ue.isFarther(D,i)&&(D=ue)}),D}},{key:"recreateAfterDataPopulation",value:function(t){if(this.currentFillData){var n=this.getRangeFromChanges(t),i=this.currentFillData.foundMergedCells,a=this.currentFillData.dragDirection,o=function(h,d){switch(a){case"up":return h.row-d>=n.from.row;case"down":return h.row+h.rowspan-1+d<=n.to.row;case"left":return h.col-d>=n.from.column;case"right":return h.col+h.colspan-1+d<=n.to.column;default:return null}},s=0,l=null,u=1;do for(var f=0;f<i.length;f+=1){if(l=i[f],s=u*this.currentFillData.cycleLength,o(l,s))switch(a){case"up":this.plugin.mergedCellsCollection.add({row:l.row-s,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:l.row+s,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col-s,colspan:l.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col+s,colspan:l.colspan});break}f===i.length-1&&(u+=1)}while(o(l,s));this.currentFillData=null,this.plugin.hot.render()}}},{key:"getRangeFromChanges",value:function(t){var n=this,i={min:null,max:null},a={min:null,max:null};return pe(t,function(o){var s=o[0],l=n.plugin.hot.propToCol(o[1]);(i.min===null||s<i.min)&&(i.min=s),(i.max===null||s>i.max)&&(i.max=s),(a.min===null||l<a.min)&&(a.min=l),(a.max===null||l>a.max)&&(a.max=l)}),{from:{row:i.min,column:a.min},to:{row:i.max,column:a.max}}}},{key:"dragAreaOverlapsCollections",value:function(t,n,i){var a=this.getDragArea(t,n,i),o=Fa(a,4),s=o[0],l=o[1],u=o[2],f=o[3],c=new me(s,l),h=new me(u,f),d=new Kr(c,c,h);return!!this.mergedCellsCollection.getWithinRange(d,!0)}}]),e}();function U4(e,r){return j4(e)||z4(e,r)||V4()}function V4(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function z4(e,r){var t=[],n=!0,i=!1,a=void 0;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done)&&(t.push(s.value),!(r&&t.length===r));n=!0);}catch(l){i=!0,a=l}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw a}}return t}function j4(e){if(Array.isArray(e))return e}function Y4(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function ry(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function G4(e,r,t){return r&&ry(e.prototype,r),t&&ry(e,t),e}var X4=function(){function e(r){Y4(this,e),this.plugin=r,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}return G4(e,[{key:"snapDelta",value:function(t,n,i){var a=n.to,o=a.row+t.row,s=a.col+t.col;t.row?this.jumpOverMergedCell(t,i,o):t.col&&this.jumpOverMergedCell(t,i,s)}},{key:"jumpOverMergedCell",value:function(t,n,i){var a=t.row||t.col,o=null,s=null,l=null;t.row?(o=n.includesVertically(i),s=n.row,l=n.getLastRow()):t.col&&(o=n.includesHorizontally(i),s=n.col,l=n.getLastColumn()),a!==0&&(a>0?o&&i!==s&&(a+=l-i+1):o&&i!==l&&(a-=i-s+1),t.row?t.row=a:t.col&&(t.col=a))}},{key:"getUpdatedSelectionRange",value:function(t,n){return new Kr(t.highlight,t.from,new me(t.to.row+n.row,t.to.col+n.col))}},{key:"getSelectedMergedCellClassName",value:function(t,n,i,a){var o=U4(i,4),s=o[0],l=o[1],u=o[2],f=o[3];if(a!==void 0&&t>=s&&t<=u&&n>=l&&n<=f){var c=this.plugin.mergedCellsCollection.isMergedParent(t,n);if(!c)return;var h=this.plugin.mergedCellsCollection.get(t,n);if(!h)return;if(h.row+h.rowspan-1<=u&&h.col+h.colspan-1<=f)return"".concat(this.fullySelectedMergedCellClassName,"-").concat(a);if(this.plugin.selectionCalculations.isMergeCellFullySelected(h,this.plugin.hot.getSelectedRange()))return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}},{key:"isMergeCellFullySelected",value:function(t,n){var i=[];if(!n||!t)return!1;for(var a=0;a<t.rowspan;a+=1)for(var o=0;o<t.colspan;o+=1)i.push(new me(t.row+a,t.col+o));for(var s=0;s<i.length;s+=1){for(var l=[],u=0;u<n.length;u+=1)l[u]=n[u].includes(i[s]);if(!l.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var t=[],n=0;n<=7;n+=1)t.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(n));return t.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),t}}]),e}();function K4(e){return{key:"mergeCells",name:function(){var t=this.getSelectedLast();if(t){var n=e.mergedCellsCollection.get(t[0],t[1]);if(n.row===t[0]&&n.col===t[1]&&n.row+n.rowspan-1===t[2]&&n.col+n.colspan-1===t[3])return this.getTranslatedPhrase(Cv)}return this.getTranslatedPhrase(_v)},callback:function(){e.toggleMergeOnSelection()},disabled:function(){var t=this.getSelectedLast();if(!t)return!0;var n=ti.isSingleCell({row:t[0],col:t[1],rowspan:t[2]-t[0]+1,colspan:t[3]-t[1]+1});return n||this.selection.isSelectedByCorner()},hidden:!1}}function uf(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?uf=function(t){return typeof t}:uf=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uf(e)}function q4(e,r){return Q4(e)||J4(e,r)||Z4()}function Z4(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function J4(e,r){var t=[],n=!0,i=!1,a=void 0;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done)&&(t.push(s.value),!(r&&t.length===r));n=!0);}catch(l){i=!0,a=l}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw a}}return t}function Q4(e){if(Array.isArray(e))return e}function ny(e){return rI(e)||tI(e)||eI()}function eI(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function tI(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}function rI(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}function nI(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function iy(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function iI(e,r,t){return r&&iy(e.prototype,r),t&&iy(e,t),e}function aI(e,r){return r&&(uf(r)==="object"||typeof r=="function")?r:o0(e)}function Xo(e,r,t){return typeof Reflect<"u"&&Reflect.get?Xo=Reflect.get:Xo=function(i,a,o){var s=oI(i,a);if(s){var l=Object.getOwnPropertyDescriptor(s,a);return l.get?l.get.call(o):l.value}},Xo(e,r,t||e)}function oI(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=eo(e),e!==null););return e}function eo(e){return eo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},eo(e)}function sI(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&a0(e,r)}function a0(e,r){return a0=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},a0(e,r)}function o0(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}at.getSingleton().register("beforeMergeCells");at.getSingleton().register("afterMergeCells");at.getSingleton().register("beforeUnmergeCells");at.getSingleton().register("afterUnmergeCells");var ay=new WeakMap,DC=function(e){sI(r,e);function r(t){var n;return nI(this,r),n=aI(this,eo(r).call(this,t)),ay.set(o0(o0(n)),{lastDesiredCoords:null}),n.mergedCellsCollection=null,n.autofillCalculations=null,n.selectionCalculations=null,n}return iI(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().mergeCells}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.mergedCellsCollection=new F4(this),this.autofillCalculations=new $4(this),this.selectionCalculations=new X4(this),this.addHook("afterInit",function(){return n.onAfterInit.apply(n,arguments)}),this.addHook("beforeKeyDown",function(){return n.onBeforeKeyDown.apply(n,arguments)}),this.addHook("modifyTransformStart",function(){return n.onModifyTransformStart.apply(n,arguments)}),this.addHook("afterModifyTransformStart",function(){return n.onAfterModifyTransformStart.apply(n,arguments)}),this.addHook("modifyTransformEnd",function(){return n.onModifyTransformEnd.apply(n,arguments)}),this.addHook("modifyGetCellCoords",function(){return n.onModifyGetCellCoords.apply(n,arguments)}),this.addHook("beforeSetRangeEnd",function(){return n.onBeforeSetRangeEnd.apply(n,arguments)}),this.addHook("afterIsMultipleSelection",function(){return n.onAfterIsMultipleSelection.apply(n,arguments)}),this.addHook("afterRenderer",function(){return n.onAfterRenderer.apply(n,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return n.addMergeActionsToContextMenu.apply(n,arguments)}),this.addHook("afterGetCellMeta",function(){return n.onAfterGetCellMeta.apply(n,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return n.onAfterViewportRowCalculatorOverride.apply(n,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return n.onAfterViewportColumnCalculatorOverride.apply(n,arguments)}),this.addHook("modifyAutofillRange",function(){return n.onModifyAutofillRange.apply(n,arguments)}),this.addHook("afterCreateCol",function(){return n.onAfterCreateCol.apply(n,arguments)}),this.addHook("afterRemoveCol",function(){return n.onAfterRemoveCol.apply(n,arguments)}),this.addHook("afterCreateRow",function(){return n.onAfterCreateRow.apply(n,arguments)}),this.addHook("afterRemoveRow",function(){return n.onAfterRemoveRow.apply(n,arguments)}),this.addHook("afterChange",function(){return n.onAfterChange.apply(n,arguments)}),this.addHook("beforeDrawBorders",function(){return n.onBeforeDrawAreaBorders.apply(n,arguments)}),this.addHook("afterDrawSelection",function(){return n.onAfterDrawSelection.apply(n,arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return n.onBeforeRemoveCellClassNames.apply(n,arguments)}),Xo(eo(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.hot.render(),Xo(eo(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var n=this.hot.getSettings().mergeCells;this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(n),Xo(eo(r.prototype),"updatePlugin",this).call(this)}},{key:"validateSetting",value:function(n){var i=!0;return n?(ti.containsNegativeValues(n)?(fa(ti.NEGATIVE_VALUES_WARNING(n)),i=!1):ti.isOutOfBounds(n,this.hot.countRows(),this.hot.countCols())?(fa(ti.IS_OUT_OF_BOUNDS_WARNING(n)),i=!1):ti.isSingleCell(n)?(fa(ti.IS_SINGLE_CELL(n)),i=!1):ti.containsZeroSpan(n)&&(fa(ti.ZERO_SPAN_WARNING(n)),i=!1),i):!1}},{key:"generateFromSettings",value:function(n){var i=this;if(Array.isArray(n)){var a,o=[];pe(n,function(l){if(i.validateSetting(l)){var u=new me(l.row,l.col),f=new me(l.row+l.rowspan-1,l.col+l.colspan-1),c=new Kr(u,u,f);o.push(i.mergeRange(c,!0,!0))}}),o=o.filter(function(l){return l!==!0});var s=this.getBulkCollectionData(o);(a=this.hot).populateFromArray.apply(a,ny(s))}}},{key:"getBulkCollectionData",value:function(n){var i,a=this.getBulkCollectionDataRange(n),o=(i=this.hot).getData.apply(i,ny(a)),s=o.splice(0);return pe(n,function(l){var u=q4(l,3),f=u[0],c=u[1],h=u[2];pe(h,function(d,g){pe(d,function(v,p){s[f-a[0]+g][c-a[1]+p]=v})})}),[a[0],a[1],s]}},{key:"getBulkCollectionDataRange",value:function(n){var i=[0,0],a=[0,0],o=null,s=null,l=null;return pe(n,function(u){o=u[0],s=u[1],l=u[2],i[0]=Math.min(o,i[0]),i[1]=Math.min(s,i[1]),a[0]=Math.max(o+l.length-1,a[0]),a[1]=Math.max(s+l[0].length-1,a[1])}),[].concat(i,a)}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return i?!0:this.validateSetting(n)}},{key:"toggleMergeOnSelection",value:function(){var n=this.hot.getSelectedRangeLast();if(n){n.setDirection("NW-SE");var i=n.from,a=n.to;this.toggleMerge(n),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"mergeSelection",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(n){n.setDirection("NW-SE");var i=n.from,a=n.to;this.unmergeRange(n,!0),this.mergeRange(n),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"unmergeSelection",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(n){var i=n.from,a=n.to;this.unmergeRange(n,!0),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"mergeRange",value:function(n){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=n.getTopLeftCorner(),l=n.getBottomRightCorner(),u={row:s.row,col:s.col,rowspan:l.row-s.row+1,colspan:l.col-s.col+1},f=[],c=null;if(!this.canMergeRange(u,a))return!1;this.hot.runHooks("beforeMergeCells",n,a),Ke(0,u.rowspan-1,function(d){Ke(0,u.colspan-1,function(g){var v=null;f[d]||(f[d]=[]),d===0&&g===0?v=i.hot.getDataAtCell(u.row,u.col):i.hot.setCellMeta(u.row+d,u.col+g,"hidden",!0),f[d][g]=v})}),this.hot.setCellMeta(u.row,u.col,"spanned",!0);var h=this.mergedCellsCollection.add(u);return h?(o?c=[u.row,u.col,f]:this.hot.populateFromArray(u.row,u.col,f,void 0,void 0,this.pluginName),this.hot.runHooks("afterMergeCells",n,u,a),c):!0}},{key:"unmergeRange",value:function(n){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=this.mergedCellsCollection.getWithinRange(n);o&&(this.hot.runHooks("beforeUnmergeCells",n,a),pe(o,function(s){i.mergedCellsCollection.remove(s.row,s.col),Ke(0,s.rowspan-1,function(l){Ke(0,s.colspan-1,function(u){i.hot.removeCellMeta(s.row+l,s.col+u,"hidden")})}),i.hot.removeCellMeta(s.row,s.col,"spanned")}),this.hot.render(),this.hot.runHooks("afterUnmergeCells",n,a))}},{key:"toggleMerge",value:function(n){var i=this.mergedCellsCollection.get(n.from.row,n.from.col),a=i.row===n.from.row&&i.col===n.from.col&&i.row+i.rowspan-1===n.to.row&&i.col+i.colspan-1===n.to.col;a?this.unmergeRange(n):this.mergeSelection(n)}},{key:"merge",value:function(n,i,a,o){var s=new me(n,i),l=new me(a,o);this.mergeRange(new Kr(s,s,l))}},{key:"unmerge",value:function(n,i,a,o){var s=new me(n,i),l=new me(a,o);this.unmergeRange(new Kr(s,s,l))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings().mergeCells),this.hot.render()}},{key:"onBeforeKeyDown",value:function(n){var i=(n.ctrlKey||n.metaKey)&&!n.altKey;i&&n.keyCode===77&&(this.toggleMerge(this.hot.getSelectedRangeLast()),this.hot.render(),Hr(n))}},{key:"onAfterIsMultipleSelection",value:function(n){if(n){for(var i=this.mergedCellsCollection.mergedCells,a=this.hot.getSelectedRangeLast(),o=0;o<i.length;o+=1)if(a.highlight.row===i[o].row&&a.highlight.col===i[o].col&&a.to.row===i[o].row+i[o].rowspan-1&&a.to.col===i[o].col+i[o].colspan-1)return!1}return n}},{key:"onModifyTransformStart",value:function(n){var i=ay.get(this),a=this.hot.getSelectedRangeLast(),o={row:n.row,col:n.col},s=null,l=new me(a.highlight.row,a.highlight.col),u=this.mergedCellsCollection.get(l.row,l.col);if(i.lastDesiredCoords||(i.lastDesiredCoords=new me(null,null)),u){var f=new me(u.row,u.col),c=new me(u.row+u.rowspan-1,u.col+u.colspan-1),h=new Kr(f,f,c);h.includes(i.lastDesiredCoords)||(i.lastDesiredCoords=new me(null,null)),o.row=i.lastDesiredCoords.row?i.lastDesiredCoords.row-l.row:o.row,o.col=i.lastDesiredCoords.col?i.lastDesiredCoords.col-l.col:o.col,n.row>0?o.row=u.row+u.rowspan-1-l.row+n.row:n.row<0&&(o.row=l.row-u.row+n.row),n.col>0?o.col=u.col+u.colspan-1-l.col+n.col:n.col<0&&(o.col=l.col-u.col+n.col)}s=new me(a.highlight.row+o.row,a.highlight.col+o.col);var d=this.mergedCellsCollection.get(s.row,s.col);d&&(i.lastDesiredCoords=s,o={row:d.row-l.row,col:d.col-l.col}),o.row!==0&&(n.row=o.row),o.col!==0&&(n.col=o.col)}},{key:"onModifyTransformEnd",value:function(n){var i=this,a=this.hot.getSelectedRangeLast(),o=gu(n),s=this.selectionCalculations.getUpdatedSelectionRange(a,n),l=gu(o),u=this.mergedCellsCollection.getWithinRange(s,!0);do l=gu(o),this.selectionCalculations.getUpdatedSelectionRange(a,o),pe(u,function(f){i.selectionCalculations.snapDelta(o,a,f)});while(o.row!==l.row||o.col!==l.col);n.row=o.row,n.col=o.col}},{key:"onModifyGetCellCoords",value:function(n,i){var a=this.mergedCellsCollection.get(n,i);return a?[a.row,a.col,a.row+a.rowspan-1,a.col+a.colspan-1]:void 0}},{key:"addMergeActionsToContextMenu",value:function(n){n.items.push({name:"---------"},K4(this))}},{key:"onAfterRenderer",value:function(n,i,a){var o=this.mergedCellsCollection.get(i,a);i0(n,o,i,a)}},{key:"onBeforeSetRangeEnd",value:function(n){var i=this.hot.getSelectedRangeLast();i.highlight=new me(i.highlight.row,i.highlight.col),i.to=n;var a=!1;if(!(i.from.row===0&&i.to.row===this.hot.countRows()-1||i.from.col===0&&i.to.col===this.hot.countCols()-1))do{a=!1;for(var o=0;o<this.mergedCellsCollection.mergedCells.length;o+=1){var s=this.mergedCellsCollection.mergedCells[o],l=s.getRange();i.expandByRange(l)&&(n.row=i.to.row,n.col=i.to.col,a=!0)}}while(a)}},{key:"onAfterGetCellMeta",value:function(n,i,a){var o=this.mergedCellsCollection.get(n,i);o&&(o.row!==n||o.col!==i)&&(a.copyable=!1)}},{key:"onAfterViewportRowCalculatorOverride",value:function(n){var i=this,a=this.hot.countCols(),o;Ke(0,a-1,function(s){if(o=i.mergedCellsCollection.get(n.startRow,s),o&&o.row<n.startRow)return n.startRow=o.row,i.onAfterViewportRowCalculatorOverride.call(i,n);if(o=i.mergedCellsCollection.get(n.endRow,s),o){var l=o.row+o.rowspan-1;if(l>n.endRow)return n.endRow=l,i.onAfterViewportRowCalculatorOverride.call(i,n)}return!0})}},{key:"onAfterViewportColumnCalculatorOverride",value:function(n){var i=this,a=this.hot.countRows(),o;Ke(0,a-1,function(s){if(o=i.mergedCellsCollection.get(s,n.startColumn),o&&o.col<n.startColumn)return n.startColumn=o.col,i.onAfterViewportColumnCalculatorOverride.call(i,n);if(o=i.mergedCellsCollection.get(s,n.endColumn),o){var l=o.col+o.colspan-1;if(l>n.endColumn)return n.endColumn=l,i.onAfterViewportColumnCalculatorOverride.call(i,n)}return!0})}},{key:"onModifyAutofillRange",value:function(n,i){this.autofillCalculations.correctSelectionAreaSize(i);var a=this.autofillCalculations.getDirection(i,n),o=n;if(this.autofillCalculations.dragAreaOverlapsCollections(i,o,a))return o=i,o;var s=this.mergedCellsCollection.getWithinRange({from:{row:i[0],col:i[1]},to:{row:i[2],col:i[3]}});return s&&(o=this.autofillCalculations.snapDragArea(i,o,a,s)),o}},{key:"onAfterCreateCol",value:function(n,i){this.mergedCellsCollection.shiftCollections("right",n,i)}},{key:"onAfterRemoveCol",value:function(n,i){this.mergedCellsCollection.shiftCollections("left",n,i)}},{key:"onAfterCreateRow",value:function(n,i,a){a!=="auto"&&this.mergedCellsCollection.shiftCollections("down",n,i)}},{key:"onAfterRemoveRow",value:function(n,i){this.mergedCellsCollection.shiftCollections("up",n,i)}},{key:"onAfterChange",value:function(n,i){i==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(n)}},{key:"onBeforeDrawAreaBorders",value:function(n,i){if(i&&i==="area"){var a=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getWithinRange(a);pe(o,function(s){a.getBottomRightCorner().row===s.getLastRow()&&a.getBottomRightCorner().col===s.getLastColumn()&&(n[2]=s.row,n[3]=s.col)})}}},{key:"onAfterModifyTransformStart",value:function(n,i,a){if(this.enabled){var o=this.mergedCellsCollection.get(n.row,n.col);if(o){var s=i>0,l=i<0,u=a<0,f=a>0,c=o.row+o.rowspan-1===this.hot.countRows()-1,h=o.row===0,d=o.col+o.colspan-1===this.hot.countCols()-1,g=o.col===0;(s&&c||l&&h||f&&d||u&&g)&&(n.row=o.row,n.col=o.col)}}}},{key:"onAfterDrawSelection",value:function(n,i,a,o){return this.selectionCalculations.getSelectedMergedCellClassName(n,i,a,o)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}]),r}(fr);ur("mergeCells",DC);function ff(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ff=function(t){return typeof t}:ff=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ff(e)}function lI(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function oy(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function uI(e,r,t){return r&&oy(e.prototype,r),t&&oy(e,t),e}function fI(e,r){return r&&(ff(r)==="object"||typeof r=="function")?r:cI(e)}function cI(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cf(e,r,t){return typeof Reflect<"u"&&Reflect.get?cf=Reflect.get:cf=function(i,a,o){var s=hI(i,a);if(s){var l=Object.getOwnPropertyDescriptor(s,a);return l.get?l.get.call(o):l.value}},cf(e,r,t||e)}function hI(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=xl(e),e!==null););return e}function xl(e){return xl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},xl(e)}function dI(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&s0(e,r)}function s0(e,r){return s0=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},s0(e,r)}var PC=function(e){dI(r,e);function r(t){var n;return lI(this,r),n=fI(this,xl(r).call(this,t)),n.dragged=[],n.eventManager=null,n.lastSetCell=null,n}return uI(r,[{key:"isEnabled",value:function(){return ui()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new Ft(this)),this.registerListeners(),cf(xl(r.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var n=this;function i(a){if(n.dragged.length===1)return n.dragged.splice(0,n.dragged.length),!0;var o=n.dragged.indexOf(a);if(o===-1)return!1;o===0?n.dragged=n.dragged.slice(0,1):o===1&&(n.dragged=n.dragged.slice(-1))}this.eventManager.addEventListener(this.hot.rootElement,"touchstart",function(a){var o;if(gt(a.target,"topLeftSelectionHandle-HitArea"))return o=n.hot.getSelectedRangeLast(),n.dragged.push("topLeft"),n.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},a.preventDefault(),!1;if(gt(a.target,"bottomRightSelectionHandle-HitArea"))return o=n.hot.getSelectedRangeLast(),n.dragged.push("bottomRight"),n.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},a.preventDefault(),!1}),this.eventManager.addEventListener(this.hot.rootElement,"touchend",function(a){if(gt(a.target,"topLeftSelectionHandle-HitArea"))return i.call(n,"topLeft"),n.touchStartRange=void 0,a.preventDefault(),!1;if(gt(a.target,"bottomRightSelectionHandle-HitArea"))return i.call(n,"bottomRight"),n.touchStartRange=void 0,a.preventDefault(),!1}),this.eventManager.addEventListener(this.hot.rootElement,"touchmove",function(a){var o=wo(),s=ya(),l,u,f,c,h,d;if(n.dragged.length!==0){var g=document.elementFromPoint(a.touches[0].screenX-s,a.touches[0].screenY-o);!g||g===n.lastSetCell||((g.nodeName==="TD"||g.nodeName==="TH")&&(l=n.hot.getCoords(g),l.col===-1&&(l.col=0),u=n.hot.getSelectedRangeLast(),f=u.getWidth(),c=u.getHeight(),h=u.getDirection(),f===1&&c===1&&n.hot.selection.setRangeEnd(l),d=n.getCurrentRangeCoords(u,l,n.touchStartRange.direction,h,n.dragged[0]),d.start!==null&&n.hot.selection.setRangeStart(d.start),n.hot.selection.setRangeEnd(d.end),n.lastSetCell=g),a.preventDefault())}})}},{key:"getCurrentRangeCoords",value:function(n,i,a,o,s){var l=n.getTopLeftCorner(),u=n.getBottomRightCorner(),f=n.getBottomLeftCorner(),c=n.getTopRightCorner(),h={start:null,end:null};switch(a){case"NE-SW":switch(o){case"NE-SW":case"NW-SE":s==="topLeft"?h={start:new me(i.row,n.highlight.col),end:new me(f.row,i.col)}:h={start:new me(n.highlight.row,i.col),end:new me(i.row,l.col)};break;case"SE-NW":s==="bottomRight"&&(h={start:new me(u.row,i.col),end:new me(i.row,l.col)});break}break;case"NW-SE":switch(o){case"NE-SW":s==="topLeft"?h={start:i,end:f}:h.end=i;break;case"NW-SE":s==="topLeft"?h={start:i,end:u}:h.end=i;break;case"SE-NW":s==="topLeft"?h={start:i,end:l}:h.end=i;break;case"SW-NE":s==="topLeft"?h={start:i,end:c}:h.end=i;break}break;case"SW-NE":switch(o){case"NW-SE":s==="bottomRight"?h={start:new me(i.row,l.col),end:new me(f.row,i.col)}:h={start:new me(l.row,i.col),end:new me(i.row,u.col)};break;case"SW-NE":s==="topLeft"?h={start:new me(n.highlight.row,i.col),end:new me(i.row,u.col)}:h={start:new me(i.row,l.col),end:new me(l.row,i.col)};break;case"SE-NW":s==="bottomRight"?h={start:new me(i.row,c.col),end:new me(l.row,i.col)}:s==="topLeft"&&(h={start:f,end:i});break}break;case"SE-NW":switch(o){case"NW-SE":case"NE-SW":case"SW-NE":s==="topLeft"&&(h.end=i);break;case"SE-NW":s==="topLeft"?h.end=i:h={start:i,end:l};break}break}return h}},{key:"isDragged",value:function(){return this.dragged.length>0}}]),r}(fr);ur("multipleSelectionHandles",PC);var NC={};/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * json-patch-duplex.js version: 0.5.7
 * (c) 2013 Joachim Wester
 * MIT license
 */(function(e){var r=Uo&&Uo.__extends||function(i,a){for(var o in a)a.hasOwnProperty(o)&&(i[o]=a[o]);function s(){this.constructor=i}i.prototype=a===null?Object.create(a):(s.prototype=a.prototype,new s)},t=Error,n;(function(i){var a=function(A){if(se(A)){for(var ne=new Array(A.length),W=0;W<ne.length;W++)ne[W]=""+W;return ne}if(Object.keys)return Object.keys(A);var ne=[];for(var b in A)A.hasOwnProperty(b)&&ne.push(b);return ne};function o(A,W){switch(typeof A){case"undefined":case"boolean":case"string":case"number":return A===W;case"object":if(A===null)return W===null;if(se(A)){if(!se(W)||A.length!==W.length)return!1;for(var ne=0,b=A.length;ne<b;ne++)if(!o(A[ne],W[ne]))return!1;return!0}var R=a(W),Z=R.length;if(a(A).length!==Z)return!1;for(var ne=0;ne<Z;ne++)if(!o(A[ne],W[ne]))return!1;return!0;default:return!1}}var s={add:function(A,W){return A[W]=this.value,!0},remove:function(A,W){return delete A[W],!0},replace:function(A,W){return A[W]=this.value,!0},move:function(A,W,ne){var b={op:"_get",path:this.from};return re(ne,[b]),re(ne,[{op:"remove",path:this.from}]),re(ne,[{op:"add",path:this.path,value:b.value}]),!0},copy:function(A,W,ne){var b={op:"_get",path:this.from};return re(ne,[b]),re(ne,[{op:"add",path:this.path,value:b.value}]),!0},test:function(A,W){return o(A[W],this.value)},_get:function(A,W){this.value=A[W]}},l={add:function(A,W){return A.splice(W,0,this.value),!0},remove:function(A,W){return A.splice(W,1),!0},replace:function(A,W){return A[W]=this.value,!0},move:s.move,copy:s.copy,test:s.test,_get:s._get},u={add:function(A){u.remove.call(this,A);for(var W in this.value)this.value.hasOwnProperty(W)&&(A[W]=this.value[W]);return!0},remove:function(A){for(var W in A)A.hasOwnProperty(W)&&s.remove.call(this,A,W);return!0},replace:function(A){return re(A,[{op:"remove",path:this.path}]),re(A,[{op:"add",path:this.path,value:this.value}]),!0},move:s.move,copy:s.copy,test:function(A){return JSON.stringify(A)===JSON.stringify(this.value)},_get:function(A){this.value=A}};function f(A){return A.indexOf("/")===-1&&A.indexOf("~")===-1?A:A.replace(/~/g,"~0").replace(/\//g,"~1")}var c=[],h=function(){function A(W){this.observers=[],this.obj=W}return A}(),d=function(){function A(W,ne){this.callback=W,this.observer=ne}return A}();function g(A){for(var W=0,ne=c.length;W<ne;W++)if(c[W].obj===A)return c[W]}function v(A,W){for(var ne=0,b=A.observers.length;ne<b;ne++)if(A.observers[ne].callback===W)return A.observers[ne].observer}function p(A,W){for(var ne=0,b=A.observers.length;ne<b;ne++)if(A.observers[ne].observer===W){A.observers.splice(ne,1);return}}function C(A,W){W.unobserve()}i.unobserve=C;function F(A){return typeof A=="object"?JSON.parse(JSON.stringify(A)):A}function D(A,W){var ne=[],b,R=g(A);if(R?b=v(R,W):(R=new h(A),c.push(R)),b)return b;if(b={},R.value=F(A),W){b.callback=W,b.next=null;var Z=this.intervals||[100,1e3,1e4,6e4];if(Z.push===void 0)throw new t("jsonpatch.intervals must be an array");var ie=0,ve=function(){ee(b)},le=function(){clearTimeout(b.next),b.next=setTimeout(function(){ve(),ie=0,b.next=setTimeout(ge,Z[ie++])},0)},ge=function(){ve(),ie==Z.length&&(ie=Z.length-1),b.next=setTimeout(ge,Z[ie++])};typeof window<"u"&&(window.addEventListener?(window.addEventListener("mousedown",le),window.addEventListener("mouseup",le),window.addEventListener("keydown",le)):(document.documentElement.attachEvent("onmousedown",le),document.documentElement.attachEvent("onmouseup",le),document.documentElement.attachEvent("onkeydown",le))),b.next=setTimeout(ge,Z[ie++])}return b.patches=ne,b.object=A,b.unobserve=function(){ee(b),clearTimeout(b.next),p(R,b),R.observers.length===0&&c.splice(c.indexOf(R),1),typeof window<"u"&&(window.removeEventListener?(window.removeEventListener("mousedown",le),window.removeEventListener("mouseup",le),window.removeEventListener("keydown",le)):(document.documentElement.detachEvent("onmousedown",le),document.documentElement.detachEvent("onmouseup",le),document.documentElement.detachEvent("onkeydown",le)))},R.observers.push(new d(W,b)),b}i.observe=D;function ee(A){for(var W,ne=0,b=c.length;ne<b;ne++)if(c[ne].obj===A.object){W=c[ne];break}ue(W.value,A.object,A.patches,""),A.patches.length&&re(W.value,A.patches);var R=A.patches;return R.length>0&&(A.patches=[],A.callback&&A.callback(R)),R}i.generate=ee;function ue(A,W,ne,b){for(var R=a(W),Z=a(A),ie=!1,ve=Z.length-1;ve>=0;ve--){var le=Z[ve],ge=A[le];if(W.hasOwnProperty(le)){var Se=W[le];typeof ge=="object"&&ge!=null&&typeof Se=="object"&&Se!=null?ue(ge,Se,ne,b+"/"+f(le)):ge!=Se&&ne.push({op:"replace",path:b+"/"+f(le),value:F(Se)})}else ne.push({op:"remove",path:b+"/"+f(le)}),ie=!0}if(!(!ie&&R.length==Z.length))for(var ve=0;ve<R.length;ve++){var le=R[ve];A.hasOwnProperty(le)||ne.push({op:"add",path:b+"/"+f(le),value:F(W[le])})}}var se;Array.isArray?se=Array.isArray:se=function(A){return A.push&&typeof A.length=="number"};function U(A){for(var W=0,ne=A.length,b;W<ne;){if(b=A.charCodeAt(W),b>=48&&b<=57){W++;continue}return!1}return!0}function re(A,W,ne){for(var b=!1,R=0,Z=W.length,ie,ve;R<Z;){ie=W[R],R++;for(var le=ie.path||"",ge=le.split("/"),Se=A,Ee=1,Re=ge.length,ze=void 0;;){if(ve=ge[Ee],ne&&ze===void 0&&(Se[ve]===void 0?ze=ge.slice(0,Ee).join("/"):Ee==Re-1&&(ze=ie.path),ze!==void 0&&this.validator(ie,R-1,A,ze)),Ee++,ve===void 0&&Ee>=Re){b=u[ie.op].call(ie,Se,ve,A);break}if(se(Se)){if(ve==="-")ve=Se.length;else{if(ne&&!U(ve))throw new _("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",R-1,ie.path,ie);ve=parseInt(ve,10)}if(Ee>=Re){if(ne&&ie.op==="add"&&ve>Se.length)throw new _("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",R-1,ie.path,ie);b=l[ie.op].call(ie,Se,ve,A);break}}else if(ve&&ve.indexOf("~")!=-1&&(ve=ve.replace(/~1/g,"/").replace(/~0/g,"~")),Ee>=Re){b=s[ie.op].call(ie,Se,ve,A);break}Se=Se[ve]}}return b}i.apply=re;function m(A,W){var ne=[];return ue(A,W,ne,""),ne}i.compare=m;var _=function(A){r(W,A);function W(ne,b,R,Z,ie){A.call(this,ne),this.message=ne,this.name=b,this.index=R,this.operation=Z,this.tree=ie}return W}(t);i.JsonPatchError=_,i.Error=_;function x(A){if(A===void 0)return!0;if(typeof A=="array"||typeof A=="object"){for(var W in A)if(x(A[W]))return!0}return!1}function B(A,W,ne,b){if(typeof A!="object"||A===null||se(A))throw new _("Operation is not an object","OPERATION_NOT_AN_OBJECT",W,A,ne);if(s[A.op]){if(typeof A.path!="string")throw new _("Operation `path` property is not a string","OPERATION_PATH_INVALID",W,A,ne);if((A.op==="move"||A.op==="copy")&&typeof A.from!="string")throw new _("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",W,A,ne);if((A.op==="add"||A.op==="replace"||A.op==="test")&&A.value===void 0)throw new _("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",W,A,ne);if((A.op==="add"||A.op==="replace"||A.op==="test")&&x(A.value))throw new _("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",W,A,ne);if(ne){if(A.op=="add"){var R=A.path.split("/").length,Z=b.split("/").length;if(R!==Z+1&&R!==Z)throw new _("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",W,A,ne)}else if(A.op==="replace"||A.op==="remove"||A.op==="_get"){if(A.path!==b)throw new _("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",W,A,ne)}else if(A.op==="move"||A.op==="copy"){var ie={op:"_get",path:A.from,value:void 0},ve=i.validate([ie],ne);if(ve&&ve.name==="OPERATION_PATH_UNRESOLVABLE")throw new _("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",W,A,ne)}}}else throw new _("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",W,A,ne)}i.validator=B;function Q(A,W){try{if(!se(A))throw new _("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(W)W=JSON.parse(JSON.stringify(W)),re.call(this,W,A,!0);else for(var ne=0;ne<A.length;ne++)this.validator(A[ne],ne)}catch(b){if(b instanceof _)return b;throw b}}i.validate=Q})(n||(n={})),e.apply=n.apply,e.observe=n.observe,e.unobserve=n.unobserve,e.generate=n.generate,e.compare=n.compare,e.validate=n.validate,e.validator=n.validator,e.JsonPatchError=n.JsonPatchError,e.Error=n.Error})(NC);const bh=Ll(NC);function vI(e,r){return pI(e)||mI(e,r)||gI()}function gI(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function mI(e,r){var t=[],n=!0,i=!1,a=void 0;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done)&&(t.push(s.value),!(r&&t.length===r));n=!0);}catch(l){i=!0,a=l}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw a}}return t}function pI(e){if(Array.isArray(e))return e}function yI(e){var r=[],t=da(e,function(n){return!(/[/]length/ig.test(n.path)||!sy(n.path))});return t=Zt(t,function(n){var i=sy(n.path);return n.row=i.row,n.col=i.col,n}),t=da(t,function(n){if(["add","remove"].indexOf(n.op)!==-1&&!isNaN(n.col)){if(r.indexOf(n.col)!==-1)return!1;r.push(n.col)}return!0}),r.length=0,t}function sy(e){var r=e.match(/^\/(\d+)\/?(.*)?$/);if(!r)return null;var t=vI(r,3),n=t[1],i=t[2];return{row:parseInt(n,10),col:/^\d*$/.test(i)?parseInt(i,10):i}}function wI(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function ly(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _I(e,r,t){return r&&ly(e.prototype,r),t&&ly(e,t),e}var FC=function(){function e(r){wI(this,e),this.observedData=null,this.observer=null,this.paused=!1,this.setObservedData(r)}return _I(e,[{key:"setObservedData",value:function(t){var n=this;this.observer&&bh.unobserve(this.observedData,this.observer),this.observedData=t,this.observer=bh.observe(this.observedData,function(i){return n.onChange(i)})}},{key:"isPaused",value:function(){return this.paused}},{key:"pause",value:function(){this.paused=!0}},{key:"resume",value:function(){this.paused=!1}},{key:"onChange",value:function(t){this.runLocalHooks("change",yI(t))}},{key:"destroy",value:function(){bh.unobserve(this.observedData,this.observer),this.observedData=null,this.observer=null}}]),e}();vi(FC,Co);function hf(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?hf=function(t){return typeof t}:hf=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hf(e)}function CI(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function uy(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function SI(e,r,t){return r&&uy(e.prototype,r),t&&uy(e,t),e}function bI(e,r){return r&&(hf(r)==="object"||typeof r=="function")?r:xI(e)}function xI(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ko(e,r,t){return typeof Reflect<"u"&&Reflect.get?Ko=Reflect.get:Ko=function(i,a,o){var s=EI(i,a);if(s){var l=Object.getOwnPropertyDescriptor(s,a);return l.get?l.get.call(o):l.value}},Ko(e,r,t||e)}function EI(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=to(e),e!==null););return e}function to(e){return to=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},to(e)}function TI(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&l0(e,r)}function l0(e,r){return l0=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},l0(e,r)}var LC=function(e){TI(r,e);function r(t){var n;return CI(this,r),n=bI(this,to(r).call(this,t)),n.observer=null,n}return SI(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().observeChanges}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.observer||(this.observer=new FC(this.hot.getSourceData()),this._exposePublicApi()),this.observer.addLocalHook("change",function(i){return n.onDataChange(i)}),this.addHook("afterCreateRow",function(){return n.onAfterTableAlter()}),this.addHook("afterRemoveRow",function(){return n.onAfterTableAlter()}),this.addHook("afterCreateCol",function(){return n.onAfterTableAlter()}),this.addHook("afterRemoveCol",function(){return n.onAfterTableAlter()}),this.addHook("afterChange",function(i,a){return n.onAfterTableAlter(a)}),this.addHook("afterLoadData",function(i){return n.onAfterLoadData(i)}),Ko(to(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.observer&&(this.observer.destroy(),this.observer=null,this._deletePublicApi()),Ko(to(r.prototype),"disablePlugin",this).call(this)}},{key:"onDataChange",value:function(n){var i=this;if(!this.observer.isPaused()){var a="".concat(this.pluginName,".change"),o={add:function(l){isNaN(l.col)?i.hot.runHooks("afterCreateRow",l.row,1,a):i.hot.runHooks("afterCreateCol",l.col,1,a)},remove:function(l){isNaN(l.col)?i.hot.runHooks("afterRemoveRow",l.row,1,a):i.hot.runHooks("afterRemoveCol",l.col,1,a)},replace:function(l){i.hot.runHooks("afterChange",[[l.row,l.col,null,l.value]],a)}};pe(n,function(s){o[s.op]&&o[s.op](s)}),this.hot.render()}this.hot.runHooks("afterChangesObserved")}},{key:"onAfterTableAlter",value:function(n){var i=this;n!=="loadData"&&(this.observer.pause(),this.hot.addHookOnce("afterChangesObserved",function(){return i.observer.resume()}))}},{key:"onAfterLoadData",value:function(n){n||this.observer.setObservedData(this.hot.getSourceData())}},{key:"destroy",value:function(){this.observer&&(this.observer.destroy(),this._deletePublicApi()),Ko(to(r.prototype),"destroy",this).call(this)}},{key:"_exposePublicApi",value:function(){var n=this,i=this.hot;i.pauseObservingChanges=function(){return n.observer.pause()},i.resumeObservingChanges=function(){return n.observer.resume()},i.isPausedObservingChanges=function(){return n.observer.isPaused()}}},{key:"_deletePublicApi",value:function(){var n=this.hot;delete n.pauseObservingChanges,delete n.resumeObservingChanges,delete n.isPausedObservingChanges}}]),r}(fr);ur("observeChanges",LC);function df(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?df=function(t){return typeof t}:df=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},df(e)}function OI(e){return AI(e)||kI(e)||RI()}function RI(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function kI(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}function AI(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}function MI(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function fy(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function DI(e,r,t){return r&&fy(e.prototype,r),t&&fy(e,t),e}function PI(e,r){return r&&(df(r)==="object"||typeof r=="function")?r:NI(e)}function NI(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ro(e,r,t){return typeof Reflect<"u"&&Reflect.get?ro=Reflect.get:ro=function(i,a,o){var s=FI(i,a);if(s){var l=Object.getOwnPropertyDescriptor(s,a);return l.get?l.get.call(o):l.value}},ro(e,r,t||e)}function FI(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=sa(e),e!==null););return e}function sa(e){return sa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},sa(e)}function LI(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&u0(e,r)}function u0(e,r){return u0=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},u0(e,r)}var II="htSearchResult",HI=function(r,t,n,i,a){r.getCellMeta(t,n).isSearchResult=a},BI=function(r,t){return Mr(r)||r===null||!r.toLowerCase||r.length===0||Mr(t)||t===null?!1:t.toString().toLowerCase().indexOf(r.toLowerCase())!==-1},IC=function(e){LI(r,e);function r(t){var n;return MI(this,r),n=PI(this,sa(r).call(this,t)),n.callback=HI,n.queryMethod=BI,n.searchResultClass=II,n}return DI(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().search}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){var i=this.hot.getSettings().search;this.updatePluginSettings(i),this.addHook("beforeRenderer",function(){return n.onBeforeRenderer.apply(n,arguments)}),ro(sa(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var n=this,i=function(){return n.onBeforeRenderer.apply(n,arguments)};this.hot.addHook("beforeRenderer",i),this.hot.addHookOnce("afterRender",function(){n.hot.removeHook("beforeRenderer",i)}),ro(sa(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ro(sa(r.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(n){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod(),s=this.hot.countRows(),l=this.hot.countCols(),u=[],f=this.hot;return Ke(0,s-1,function(c){Ke(0,l-1,function(h){var d=i.hot.getDataAtCell(c,h),g=i.hot.getCellMeta(c,h),v=g.search.callback||a,p=g.search.queryMethod||o,C=p(n,d);if(C){var F={row:c,col:h,data:d};u.push(F)}v&&v(f,c,h,d,C)})}),u}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(n){this.callback=n}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(n){this.queryMethod=n}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(n){this.searchResultClass=n}},{key:"updatePluginSettings",value:function(n){Rt(n)&&(n.searchResultClass&&this.setSearchResultClass(n.searchResultClass),n.queryMethod&&this.setQueryMethod(n.queryMethod),n.callback&&this.setCallback(n.callback))}},{key:"onBeforeRenderer",value:function(n,i,a,o,s,l){var u=l.className||[],f=[];if(typeof u=="string")f=u.split(" ");else{var c;(c=f).push.apply(c,OI(u))}this.isEnabled()&&l.isSearchResult?f.includes(this.searchResultClass)||f.push("".concat(this.searchResultClass)):f.includes(this.searchResultClass)&&f.splice(f.indexOf(this.searchResultClass),1),l.className=f.join(" ")}},{key:"destroy",value:function(){ro(sa(r.prototype),"destroy",this).call(this)}}]),r}(fr);ur("search",IC);function vf(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?vf=function(t){return typeof t}:vf=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vf(e)}function WI(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function cy(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function $I(e,r,t){return r&&cy(e.prototype,r),t&&cy(e,t),e}function UI(e,r){return r&&(vf(r)==="object"||typeof r=="function")?r:VI(e)}function VI(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qo(e,r,t){return typeof Reflect<"u"&&Reflect.get?qo=Reflect.get:qo=function(i,a,o){var s=zI(i,a);if(s){var l=Object.getOwnPropertyDescriptor(s,a);return l.get?l.get.call(o):l.value}},qo(e,r,t||e)}function zI(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=no(e),e!==null););return e}function no(e){return no=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},no(e)}function jI(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&f0(e,r)}function f0(e,r){return f0=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},f0(e,r)}var HC=function(e){jI(r,e);function r(t){var n;return WI(this,r),n=UI(this,no(r).call(this,t)),n.scrollbars=[],n.clones=[],n.lockedCollection=!1,n.freezeOverlays=!1,n}return $I(r,[{key:"isEnabled",value:function(){return O0()}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.addHook("afterRender",function(){return n.onAfterRender()}),this.registerEvents(),qo(no(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,qo(no(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){qo(no(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var n=this;this.addHook("beforeTouchScroll",function(){return n.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return n.onAfterMomentumScroll()})}},{key:"onAfterRender",value:function(){if(!this.lockedCollection){var n=this.hot.view.wt.wtOverlays,i=n.topOverlay,a=n.bottomOverlay,o=n.leftOverlay,s=n.topLeftCornerOverlay,l=n.bottomLeftCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(i),a.clone&&this.scrollbars.push(a),this.scrollbars.push(o),s&&this.scrollbars.push(s),l&&l.clone&&this.scrollbars.push(l),this.clones.length=0,i.needFullRender&&this.clones.push(i.clone.wtTable.holder.parentNode),a.needFullRender&&this.clones.push(a.clone.wtTable.holder.parentNode),o.needFullRender&&this.clones.push(o.clone.wtTable.holder.parentNode),s&&this.clones.push(s.clone.wtTable.holder.parentNode),l&&l.clone&&this.clones.push(l.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,pe(this.clones,function(n){$e(n,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var n=this;this.freezeOverlays=!1,pe(this.clones,function(i){pt(i,"hide-tween"),$e(i,"show-tween")}),setTimeout(function(){pe(n.clones,function(i){pt(i,"show-tween")})},400),pe(this.scrollbars,function(i){i.refresh(),i.resetFixedPosition()}),this.hot.view.wt.wtOverlays.syncScrollWithMaster()}}]),r}(fr);ur("touchScroll",HC);function gf(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?gf=function(t){return typeof t}:gf=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gf(e)}function BC(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function hy(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function WC(e,r,t){return r&&hy(e.prototype,r),t&&hy(e,t),e}function $C(e,r){return r&&(gf(r)==="object"||typeof r=="function")?r:YI(e)}function YI(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rf(e){return Rf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Rf(e)}function UC(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&c0(e,r)}function c0(e,r){return c0=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},c0(e,r)}function Ye(e){var r=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,e.addHook("afterChange",function(t,n){t&&n!=="UndoRedo.undo"&&n!=="UndoRedo.redo"&&n!=="MergeCells"&&r.done(new Ye.ChangeAction(t))}),e.addHook("afterCreateRow",function(t,n,i){if(!(i==="UndoRedo.undo"||i==="UndoRedo.undo"||i==="auto")){var a=new Ye.CreateRowAction(t,n);r.done(a)}}),e.addHook("beforeRemoveRow",function(t,n,i,a){if(!(a==="UndoRedo.undo"||a==="UndoRedo.redo"||a==="auto")){var o=r.instance.getSourceDataArray(),s=(o.length+t)%o.length,l=e.toPhysicalRow(s),u=Wr(o.slice(l,l+n));r.done(new Ye.RemoveRowAction(s,u))}}),e.addHook("afterCreateCol",function(t,n,i){i==="UndoRedo.undo"||i==="UndoRedo.redo"||i==="auto"||r.done(new Ye.CreateColumnAction(t,n))}),e.addHook("beforeRemoveCol",function(t,n,i,a){if(!(a==="UndoRedo.undo"||a==="UndoRedo.redo"||a==="auto")){var o=r.instance.getSourceDataArray(),s=(r.instance.countCols()+t)%r.instance.countCols(),l=[],u=[],f=[];Ke(o.length-1,function(g){var v=[],p=o[g];Ke(s,s+(n-1),function(C){v.push(p[e.runHooks("modifyCol",C)])}),l.push(v)}),Ke(n-1,function(g){f.push(e.runHooks("modifyCol",s+g))}),Array.isArray(e.getSettings().colHeaders)&&Ke(n-1,function(g){u.push(e.getSettings().colHeaders[e.runHooks("modifyCol",s+g)]||null)});var c=r.instance.getPlugin("manualColumnMove"),h=c.isEnabled()?c.columnsMapper.__arrayMap:[],d=new Ye.RemoveColumnAction(s,f,l,u,h);r.done(d)}}),e.addHook("beforeCellAlignment",function(t,n,i,a){var o=new Ye.CellAlignmentAction(t,n,i,a);r.done(o)}),e.addHook("beforeFilter",function(t){r.done(new Ye.FiltersAction(t))}),e.addHook("beforeRowMove",function(t,n){t!==!1&&r.done(new Ye.RowMoveAction(t,n))}),e.addHook("beforeMergeCells",function(t,n){n||r.done(new Ye.MergeCellsAction(e,t))}),e.addHook("afterUnmergeCells",function(t,n){n||r.done(new Ye.UnmergeCellsAction(e,t))})}Ye.prototype.done=function(e){this.ignoreNewActions||(this.doneActions.push(e),this.undoneActions.length=0)};Ye.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.pop(),r=Wr(e),t=this.instance,n=t.runHooks("beforeUndo",r);if(n===!1)return;this.ignoreNewActions=!0;var i=this;e.undo(this.instance,function(){i.ignoreNewActions=!1,i.undoneActions.push(e)}),t.runHooks("afterUndo",r)}};Ye.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.pop(),r=Wr(e),t=this.instance,n=t.runHooks("beforeRedo",r);if(n===!1)return;this.ignoreNewActions=!0;var i=this;e.redo(this.instance,function(){i.ignoreNewActions=!1,i.doneActions.push(e)}),t.runHooks("afterRedo",r)}};Ye.prototype.isUndoAvailable=function(){return this.doneActions.length>0};Ye.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};Ye.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};Ye.Action=function(){};Ye.Action.prototype.undo=function(){};Ye.Action.prototype.redo=function(){};Ye.ChangeAction=function(e){this.changes=e,this.actionType="change"};Wi(Ye.ChangeAction,Ye.Action);Ye.ChangeAction.prototype.undo=function(e,r){for(var t=Wr(this.changes),n=e.countEmptyRows(!0),i=e.countEmptyCols(!0),a=0,o=t.length;a<o;a++)t[a].splice(3,1);e.addHookOnce("afterChange",r),e.setDataAtRowProp(t,null,null,"UndoRedo.undo");for(var s=0,l=t.length;s<l;s++)e.getSettings().minSpareRows&&t[s][0]+1+e.getSettings().minSpareRows===e.countRows()&&n===e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(t[s][0]+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&t[s][1]+1+e.getSettings().minSpareCols===e.countCols()&&i===e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(t[s][1]+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())};Ye.ChangeAction.prototype.redo=function(e,r){for(var t=Wr(this.changes),n=0,i=t.length;n<i;n++)t[n].splice(2,1);e.addHookOnce("afterChange",r),e.setDataAtRowProp(t,null,null,"UndoRedo.redo")};Ye.CreateRowAction=function(e,r){this.index=e,this.amount=r,this.actionType="insert_row"};Wi(Ye.CreateRowAction,Ye.Action);Ye.CreateRowAction.prototype.undo=function(e,r){var t=e.countRows(),n=e.getSettings().minSpareRows;this.index>=t&&this.index-n<t&&(this.index-=n),e.addHookOnce("afterRemoveRow",r),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};Ye.CreateRowAction.prototype.redo=function(e,r){e.addHookOnce("afterCreateRow",r),e.alter("insert_row",this.index,this.amount,"UndoRedo.redo")};Ye.RemoveRowAction=function(e,r){this.index=e,this.data=r,this.actionType="remove_row"};Wi(Ye.RemoveRowAction,Ye.Action);Ye.RemoveRowAction.prototype.undo=function(e,r){e.alter("insert_row",this.index,this.data.length,"UndoRedo.undo"),e.addHookOnce("afterRender",r),e.populateFromArray(this.index,0,this.data,void 0,void 0,"UndoRedo.undo")};Ye.RemoveRowAction.prototype.redo=function(e,r){e.addHookOnce("afterRemoveRow",r),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};Ye.CreateColumnAction=function(e,r){this.index=e,this.amount=r,this.actionType="insert_col"};Wi(Ye.CreateColumnAction,Ye.Action);Ye.CreateColumnAction.prototype.undo=function(e,r){e.addHookOnce("afterRemoveCol",r),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};Ye.CreateColumnAction.prototype.redo=function(e,r){e.addHookOnce("afterCreateCol",r),e.alter("insert_col",this.index,this.amount,"UndoRedo.redo")};Ye.RemoveColumnAction=function(e,r,t,n,i){this.index=e,this.indexes=r,this.data=t,this.amount=this.data[0].length,this.headers=n,this.columnPositions=i.slice(0),this.actionType="remove_col"};Wi(Ye.RemoveColumnAction,Ye.Action);Ye.RemoveColumnAction.prototype.undo=function(e,r){var t=this,n,i=this.indexes.slice(0).sort(),a=function(f,c,h){return h[t.indexes.indexOf(i[c])]},o=[];Ke(this.data.length-1,function(u){o[u]=Zt(t.data[u],a)});var s=[];s=Zt(this.headers,a);var l=[];e.runHooks("beforeCreateCol",this.indexes[0],this.indexes.length,"UndoRedo.undo"),Ke(this.data.length-1,function(u){n=e.getSourceDataAtRow(u),Ke(i.length-1,function(f){n.splice(i[f],0,o[u][f]),l.push([u,i[f],null,o[u][f]])})}),e.getPlugin("formulas")&&e.getPlugin("formulas").onAfterSetDataAtCell(l),typeof this.headers<"u"&&Ke(s.length-1,function(u){e.getSettings().colHeaders.splice(i[u],0,s[u])}),e.getPlugin("manualColumnMove")&&(e.getPlugin("manualColumnMove").columnsMapper.__arrayMap=this.columnPositions),e.addHookOnce("afterRender",r),e.runHooks("afterCreateCol",this.indexes[0],this.indexes.length,"UndoRedo.undo"),e.getPlugin("formulas")&&e.getPlugin("formulas").recalculateFull(),e.render()};Ye.RemoveColumnAction.prototype.redo=function(e,r){e.addHookOnce("afterRemoveCol",r),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};Ye.CellAlignmentAction=function(e,r,t,n){this.stateBefore=e,this.range=r,this.type=t,this.alignment=n};Ye.CellAlignmentAction.prototype.undo=function(e,r){var t=this;pe(this.range,function(n){for(var i=n.from,a=n.to,o=i.row;o<=a.row;o+=1)for(var s=i.col;s<=a.col;s+=1)e.setCellMeta(o,s,"className",t.stateBefore[o][s]||" htLeft")}),e.addHookOnce("afterRender",r),e.render()};Ye.CellAlignmentAction.prototype.redo=function(e,r){Yi(this.range,this.type,this.alignment,function(t,n){return e.getCellMeta(t,n)},function(t,n,i,a){return e.setCellMeta(t,n,i,a)}),e.addHookOnce("afterRender",r),e.render()};Ye.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"};Wi(Ye.FiltersAction,Ye.Action);Ye.FiltersAction.prototype.undo=function(e,r){var t=e.getPlugin("filters");e.addHookOnce("afterRender",r),t.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),t.filter()};Ye.FiltersAction.prototype.redo=function(e,r){var t=e.getPlugin("filters");e.addHookOnce("afterRender",r),t.conditionCollection.importAllConditions(this.conditionsStack),t.filter()};var GI=function(e){UC(r,e);function r(t,n){var i;return BC(this,r),i=$C(this,Rf(r).call(this)),i.cellRange=n,i.rangeData=t.getData(n.from.row,n.from.col,n.to.row,n.to.col),i}return WC(r,[{key:"undo",value:function(n,i){var a=n.getPlugin("mergeCells");n.addHookOnce("afterRender",i),a.unmergeRange(this.cellRange,!0),n.populateFromArray(this.cellRange.from.row,this.cellRange.from.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(n,i){var a=n.getPlugin("mergeCells");n.addHookOnce("afterRender",i),a.mergeRange(this.cellRange)}}]),r}(Ye.Action);Ye.MergeCellsAction=GI;var XI=function(e){UC(r,e);function r(t,n){var i;return BC(this,r),i=$C(this,Rf(r).call(this)),i.cellRange=n,i}return WC(r,[{key:"undo",value:function(n,i){var a=n.getPlugin("mergeCells");n.addHookOnce("afterRender",i),a.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(n,i){var a=n.getPlugin("mergeCells");n.addHookOnce("afterRender",i),a.unmergeRange(this.cellRange,!0),n.render()}}]),r}(Ye.Action);Ye.UnmergeCellsAction=XI;Ye.RowMoveAction=function(e,r){this.rows=e.slice(),this.target=r};Wi(Ye.RowMoveAction,Ye.Action);Ye.RowMoveAction.prototype.undo=function(e,r){var t=e.getPlugin("manualRowMove");e.addHookOnce("afterRender",r);for(var n=this.rows[0]<this.target?-1*this.rows.length:0,i=this.rows[0]>this.target?this.rows[0]+this.rows.length:this.rows[0],a=[],o=this.rows.length+n,s=n;s<o;s+=1)a.push(this.target+s);t.moveRows(a.slice(),i),e.render(),e.selectCell(this.rows[0],0,this.rows[this.rows.length-1],e.countCols()-1,!1,!1)};Ye.RowMoveAction.prototype.redo=function(e,r){var t=e.getPlugin("manualRowMove");e.addHookOnce("afterRender",r),t.moveRows(this.rows.slice(),this.target),e.render();var n=this.rows[0]<this.target?this.target-this.rows.length:this.target;e.selectCell(n,0,n+this.rows.length-1,e.countCols()-1,!1,!1)};function VC(){var e=this,r=typeof e.getSettings().undo>"u"||e.getSettings().undo;r?e.undoRedo||(e.undoRedo=new Ye(e),KI(e),e.addHook("beforeKeyDown",dy),e.addHook("afterChange",vy)):e.undoRedo&&(delete e.undoRedo,qI(e),e.removeHook("beforeKeyDown",dy),e.removeHook("afterChange",vy))}function dy(e){var r=this,t=(e.ctrlKey||e.metaKey)&&!e.altKey;t&&(e.keyCode===89||e.shiftKey&&e.keyCode===90?(r.undoRedo.redo(),Hr(e)):e.keyCode===90&&(r.undoRedo.undo(),Hr(e)))}function vy(e,r){var t=this;if(r==="loadData")return t.undoRedo.clear()}function KI(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function qI(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}var xs=at.getSingleton();xs.add("afterInit",VC);xs.add("afterUpdateSettings",VC);xs.register("beforeUndo");xs.register("afterUndo");xs.register("beforeRedo");xs.register("afterRedo");const gy=Object.freeze(Object.defineProperty({__proto__:null,AutoColumnSize:J_,AutoFill:Q_,AutoRowSize:eC,Base:fr,ColumnSorting:uC,Comments:hC,ContextMenu:Gv,CopyPaste:vC,CustomBorders:mC,DragToScroll:pC,ManualColumnFreeze:yC,ManualColumnMove:CC,ManualColumnResize:SC,ManualRowMove:EC,ManualRowResize:TC,MergeCells:DC,MultipleSelectionHandles:PC,ObserveChanges:LC,PersistentState:q_,Search:IC,TouchScroll:HC,UndoRedo:Ye},Symbol.toStringTag,{value:"Module"}));function Ue(e,r){var t=new pc(e,r||{},G1);return t.init(),t}rD(Ue);Ue.Core=pc;Ue.DefaultSettings=av;Ue.EventManager=Ft;Ue._getListenersCounter=px;Ue.buildDate="19/12/2018 13:16:54";Ue.packageName="handsontable";Ue.version="6.2.2";Ue.hooks=at.getSingleton();Ue.__GhostTable=Uv;var ZI=[Pb,ex,bA,G2,nx,hR,iR,_R,Nb,yA,sR,mR],JI=[hx,dx];Ue.helper={};Ue.dom={};pe(ZI,function(e){pe(Object.getOwnPropertyNames(e),function(r){r.charAt(0)!=="_"&&(Ue.helper[r]=e[r])})});pe(JI,function(e){pe(Object.getOwnPropertyNames(e),function(r){r.charAt(0)!=="_"&&(Ue.dom[r]=e[r])})});Ue.cellTypes={};pe(pA(),function(e){Ue.cellTypes[e]=hc(e)});Ue.cellTypes.registerCellType=pi;Ue.cellTypes.getCellType=hc;Ue.editors={};pe(E2(),function(e){Ue.editors["".concat(va(e),"Editor")]=Kn(e)});Ue.editors.registerEditor=Tn;Ue.editors.getEditor=Kn;Ue.renderers={};pe(j2(),function(e){var r=Dr(e);e==="base"&&(Ue.renderers.cellDecorator=r),Ue.renderers["".concat(va(e),"Renderer")]=r});Ue.renderers.registerRenderer=$i;Ue.renderers.getRenderer=Dr;Ue.validators={};pe(tA(),function(e){Ue.validators["".concat(va(e),"Validator")]=xa(e)});Ue.validators.registerValidator=Ss;Ue.validators.getValidator=xa;Ue.plugins={};pe(Object.getOwnPropertyNames(gy),function(e){var r=gy[e];e==="Base"?Ue.plugins["".concat(e,"Plugin")]=r:Ue.plugins[e]=r});Ue.plugins.registerPlugin=ur;Ue.languages={};Ue.languages.dictionaryKeys=JA;Ue.languages.getLanguageDictionary=H_;Ue.languages.getLanguagesDictionaries=nM;Ue.languages.registerLanguageDictionary=I_;Ue.languages.getTranslatedPhrase=function(){return W_.apply(void 0,arguments)};function Zo(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Zo=function(r){return typeof r}:Zo=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Zo(e)}function hs(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function my(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ds(e,r,t){return r&&my(e.prototype,r),t&&my(e,t),e}function QI(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function py(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function eH(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?py(Object(t),!0).forEach(function(n){QI(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):py(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function El(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&h0(e,r)}function kf(e){return kf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},kf(e)}function h0(e,r){return h0=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},h0(e,r)}function tH(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function Tl(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rH(e,r){return r&&(typeof r=="object"||typeof r=="function")?r:Tl(e)}function Ol(e){var r=tH();return function(){var n=kf(e),i;if(r){var a=kf(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return rH(this,i)}}var xh=null,nH="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",zC="hot-wrapper-editor-container";function iH(){if(typeof console<"u"){var e;(e=console).warn.apply(e,arguments)}}function d0(e,r){var t=wr.Children.toArray(e),n=wr.Children.count(e),i=null;return n!==0&&(n===1&&t[0].props[r]?i=t[0]:i=t.find(function(a){return a.props[r]!==void 0})),i||null}function jC(e){return e?e.type.WrappedComponent?e.type.WrappedComponent:e.type:null}function Eh(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;e.querySelectorAll('[class^="'.concat(zC,'"]')).forEach(function(r){r.parentNode&&r.parentNode.removeChild(r)})}function YC(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,r=arguments.length>1?arguments[1]:void 0;if(r!==null){var t=e.createElement("DIV"),n=GC(r.props,!1),i=n.id,a=n.className,o=n.style;return i&&(t.id=i),t.className=[zC,a].join(" "),o&&Object.assign(t.style,o),e.body.appendChild(t),mw.createPortal(r,t)}}function v0(e,r){var t=d0(e,"hot-editor"),n=jC(t);return t?wr.cloneElement(t,{emitEditorInstance:function(a){r.set(n,a)},isEditor:!0}):null}function aH(e,r,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:document;n||(n=document),xh||(xh=n.createDocumentFragment());var i=n.createElement("DIV");xh.appendChild(i);var a=wr.cloneElement(e,eH({key:"".concat(r.row,"-").concat(r.col)},r));return{portal:mw.createPortal(a,i,"".concat(r.row,"-").concat(r.col,"-").concat(Math.random())),portalContainer:i}}function GC(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:e.id||(r?"hot-"+Math.random().toString(36).substring(5):void 0),className:e.className||"",style:e.style||{}}}function XC(e){var r=wr.version.split(".").map(function(n){return parseInt(n)}),t=r[0]>=16&&r[1]>=3;t&&(e.UNSAFE_componentWillUpdate=e.componentWillUpdate,e.componentWillUpdate=void 0,e.UNSAFE_componentWillMount=e.componentWillMount,e.componentWillMount=void 0)}var KC=function(){function e(){hs(this,e)}return ds(e,null,[{key:"getSettings",value:function(t){var n={};if(t.settings){var i=t.settings;for(var a in i)i.hasOwnProperty(a)&&(n[a]=i[a])}for(var o in t)o!=="settings"&&o!=="children"&&t.hasOwnProperty(o)&&(n[o]=t[o]);return n}}]),e}(),oH=function(e){El(t,e);var r=Ol(t);function t(n,i){var a;return hs(this,t),a=r.call(this,n,i),a.localEditorPortal=null,XC(Tl(a)),a}return ds(t,[{key:"getLocalEditorPortal",value:function(){return this.localEditorPortal}},{key:"setLocalEditorPortal",value:function(i){this.localEditorPortal=i}},{key:"getSettingsProps",value:function(){var i=this;return this.internalProps=["__componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(a){return!i.internalProps.includes(a)}).reduce(function(a,o){return a[o]=i.props[o],a},{})}},{key:"hasProp",value:function(i){return!!this.props[i]}},{key:"getLocalEditorElement",value:function(){return v0(this.props.children,this.props._getEditorCache())}},{key:"createColumnSettings",value:function(){var i=this.props._getChildElementByType(this.props.children,"hot-renderer"),a=this.getLocalEditorElement();this.columnSettings=KC.getSettings(this.getSettingsProps()),i!==null?(this.columnSettings.renderer=this.props._getRendererWrapper(i),this.props._componentRendererColumns.set(this.props._columnIndex,!0)):this.hasProp("renderer")?this.columnSettings.renderer=this.props.renderer:this.columnSettings.renderer=void 0,a!==null?this.columnSettings.editor=this.props._getEditorClass(a):this.hasProp("editor")?this.columnSettings.editor=this.props.editor:this.columnSettings.editor=void 0}},{key:"createLocalEditorPortal",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props.children,a=this.props._getEditorCache(),o=v0(i,a);o&&this.setLocalEditorPortal(YC(this.props._getOwnerDocument(),o,a))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentWillMount",value:function(){this.createLocalEditorPortal()}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentWillUpdate",value:function(i,a,o){this.createLocalEditorPortal(i.children)}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){return wr.createElement(wr.Fragment,null,this.getLocalEditorPortal())}}]),t}(wr.Component),sH=function(e){El(t,e);var r=Ol(t);function t(n){var i;return hs(this,t),i=r.call(this,n),i.state={portals:[]},i}return ds(t,[{key:"render",value:function(){return wr.createElement(wr.Fragment,null,this.state.portals)}}]),t}(wr.Component),lH="5.0.0";function Kv(e,r){return r={exports:{}},e(r,r.exports),r.exports}/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nr=typeof Symbol=="function"&&Symbol.for,qv=Nr?Symbol.for("react.element"):60103,Zv=Nr?Symbol.for("react.portal"):60106,Ac=Nr?Symbol.for("react.fragment"):60107,Mc=Nr?Symbol.for("react.strict_mode"):60108,Dc=Nr?Symbol.for("react.profiler"):60114,Pc=Nr?Symbol.for("react.provider"):60109,Nc=Nr?Symbol.for("react.context"):60110,Jv=Nr?Symbol.for("react.async_mode"):60111,Fc=Nr?Symbol.for("react.concurrent_mode"):60111,Lc=Nr?Symbol.for("react.forward_ref"):60112,Ic=Nr?Symbol.for("react.suspense"):60113,uH=Nr?Symbol.for("react.suspense_list"):60120,Hc=Nr?Symbol.for("react.memo"):60115,Bc=Nr?Symbol.for("react.lazy"):60116,fH=Nr?Symbol.for("react.block"):60121,cH=Nr?Symbol.for("react.fundamental"):60117,hH=Nr?Symbol.for("react.responder"):60118,dH=Nr?Symbol.for("react.scope"):60119;function On(e){if(Zo(e)==="object"&&e!==null){var r=e.$$typeof;switch(r){case qv:switch(e=e.type,e){case Jv:case Fc:case Ac:case Dc:case Mc:case Ic:return e;default:switch(e=e&&e.$$typeof,e){case Nc:case Lc:case Bc:case Hc:case Pc:return e;default:return r}}case Zv:return r}}}function qC(e){return On(e)===Fc}var vH=Jv,gH=Fc,mH=Nc,pH=Pc,yH=qv,wH=Lc,_H=Ac,CH=Bc,SH=Hc,bH=Zv,xH=Dc,EH=Mc,TH=Ic,OH=function(r){return qC(r)||On(r)===Jv},RH=qC,kH=function(r){return On(r)===Nc},AH=function(r){return On(r)===Pc},MH=function(r){return Zo(r)==="object"&&r!==null&&r.$$typeof===qv},DH=function(r){return On(r)===Lc},PH=function(r){return On(r)===Ac},NH=function(r){return On(r)===Bc},FH=function(r){return On(r)===Hc},LH=function(r){return On(r)===Zv},IH=function(r){return On(r)===Dc},HH=function(r){return On(r)===Mc},BH=function(r){return On(r)===Ic},WH=function(r){return typeof r=="string"||typeof r=="function"||r===Ac||r===Fc||r===Dc||r===Mc||r===Ic||r===uH||Zo(r)==="object"&&r!==null&&(r.$$typeof===Bc||r.$$typeof===Hc||r.$$typeof===Pc||r.$$typeof===Nc||r.$$typeof===Lc||r.$$typeof===cH||r.$$typeof===hH||r.$$typeof===dH||r.$$typeof===fH)},$H=On,UH={AsyncMode:vH,ConcurrentMode:gH,ContextConsumer:mH,ContextProvider:pH,Element:yH,ForwardRef:wH,Fragment:_H,Lazy:CH,Memo:SH,Portal:bH,Profiler:xH,StrictMode:EH,Suspense:TH,isAsyncMode:OH,isConcurrentMode:RH,isContextConsumer:kH,isContextProvider:AH,isElement:MH,isForwardRef:DH,isFragment:PH,isLazy:NH,isMemo:FH,isPortal:LH,isProfiler:IH,isStrictMode:HH,isSuspense:BH,isValidElementType:WH,typeOf:$H},Dt=Kv(function(e,r){});Dt.AsyncMode;Dt.ConcurrentMode;Dt.ContextConsumer;Dt.ContextProvider;Dt.Element;Dt.ForwardRef;Dt.Fragment;Dt.Lazy;Dt.Memo;Dt.Portal;Dt.Profiler;Dt.StrictMode;Dt.Suspense;Dt.isAsyncMode;Dt.isConcurrentMode;Dt.isContextConsumer;Dt.isContextProvider;Dt.isElement;Dt.isForwardRef;Dt.isFragment;Dt.isLazy;Dt.isMemo;Dt.isPortal;Dt.isProfiler;Dt.isStrictMode;Dt.isSuspense;Dt.isValidElementType;Dt.typeOf;Kv(function(e){e.exports=UH});/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var yy=Object.getOwnPropertySymbols,VH=Object.prototype.hasOwnProperty,zH=Object.prototype.propertyIsEnumerable;function jH(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function YH(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var r={},t=0;t<10;t++)r["_"+String.fromCharCode(t)]=t;var n=Object.getOwnPropertyNames(r).map(function(a){return r[a]});if(n.join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(a){i[a]=a}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}YH();var GH="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",XH=GH;Function.call.bind(Object.prototype.hasOwnProperty);function ZC(){}function JC(){}JC.resetWarningCache=ZC;var KH=function(){function r(i,a,o,s,l,u){if(u!==XH){var f=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw f.name="Invariant Violation",f}}r.isRequired=r;function t(){return r}var n={array:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:t,element:r,elementType:r,instanceOf:t,node:r,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:JC,resetWarningCache:ZC};return n.PropTypes=n,n},Th=Kv(function(e){e.exports=KH()}),QC=function(e){El(t,e);var r=Ol(t);function t(n,i){var a;return hs(this,t),a=r.call(this,n,i),a.id=null,a.hotInstance=null,a.hotElementRef=null,a.columnSettings=[],a.portalManager=null,a.portalCacheArray=[],a.globalEditorPortal=null,a.renderedCellCache=new Map,a.editorCache=new Map,a.componentRendererColumns=new Map,XC(Tl(a)),a}return ds(t,[{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"getGlobalEditorPortal",value:function(){return this.globalEditorPortal}},{key:"setGlobalEditorPortal",value:function(i){this.globalEditorPortal=i}},{key:"clearCache",value:function(){var i=this.getRenderedCellCache();this.setGlobalEditorPortal(null),Eh(this.getOwnerDocument()),this.getEditorCache().clear(),i.clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return this.hotElementRef?this.hotElementRef.ownerDocument:document}},{key:"setHotElementRef",value:function(i){this.hotElementRef=i}},{key:"getRendererWrapper",value:function(i){var a=this;return function(o,s,l,u,f,c,h){var d=a.getRenderedCellCache();if(d.has("".concat(l,"-").concat(u))&&(s.innerHTML=d.get("".concat(l,"-").concat(u)).innerHTML),s&&!s.getAttribute("ghost-table")){for(var g=aH(i,{TD:s,row:l,col:u,prop:f,value:c,cellProperties:h,isRenderer:!0},function(){},s.ownerDocument),v=g.portal,p=g.portalContainer;s.firstChild;)s.removeChild(s.firstChild);s.appendChild(p),a.portalCacheArray.push(v)}return d.set("".concat(l,"-").concat(u),s),s}}},{key:"getEditorClass",value:function(i){var a=jC(i),o=this.getEditorCache(),s=o.get(a);return this.makeEditorClass(s)}},{key:"makeEditorClass",value:function(i){var a=function(o){El(l,o);var s=Ol(l);function l(u,f,c,h,d,g){var v;return hs(this,l),v=s.call(this,u,f,c,h,d,g),i.hotCustomEditorInstance=Tl(v),v.editorComponent=i,v}return ds(l,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),l}(Ue.editors.BaseEditor);return Object.getOwnPropertyNames(Ue.editors.BaseEditor.prototype).forEach(function(o){o!=="constructor"&&(a.prototype[o]=function(){for(var s,l=arguments.length,u=new Array(l),f=0;f<l;f++)u[f]=arguments[f];return(s=i[o]).call.apply(s,[i].concat(u))})}),a}},{key:"getGlobalRendererElement",value:function(){var i=this.props.children;return d0(i,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props.children;return v0(i,this.getEditorCache())}},{key:"createGlobalEditorPortal",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props.children,a=this.getGlobalEditorElement(i);a&&this.setGlobalEditorPortal(YC(this.getOwnerDocument(),a,this.getEditorCache()))}},{key:"createNewGlobalSettings",value:function(){var i=KC.getSettings(this.props),a=this.getGlobalRendererElement(),o=this.getGlobalEditorElement();return i.columns=this.columnSettings.length?this.columnSettings:i.columns,o?i.editor=this.getEditorClass(o):i.editor=this.props.editor||(this.props.settings?this.props.settings.editor:void 0),a?(i.renderer=this.getRendererWrapper(a),this.componentRendererColumns.set("global",!0)):i.renderer=this.props.renderer||(this.props.settings?this.props.settings.renderer:void 0),i}},{key:"displayAutoSizeWarning",value:function(i){(this.hotInstance.getPlugin("autoRowSize").enabled||this.hotInstance.getPlugin("autoColumnSize").enabled)&&this.componentRendererColumns.size>0&&iH(nH)}},{key:"setHotColumnSettings",value:function(i,a){this.columnSettings[a]=i}},{key:"handsontableBeforeRender",value:function(){this.getRenderedCellCache().clear()}},{key:"handsontableAfterRender",value:function(){var i=this;this.portalManager.setState(function(){return Object.assign({},{portals:i.portalCacheArray})},function(){i.portalCacheArray.length=0})}},{key:"updateHot",value:function(i){this.hotInstance.updateSettings(i,!1)}},{key:"setPortalManagerRef",value:function(i){this.portalManager=i}},{key:"componentWillMount",value:function(){this.clearCache(),this.createGlobalEditorPortal()}},{key:"componentDidMount",value:function(){var i=this,a=this.createNewGlobalSettings();this.hotInstance=new Ue.Core(this.hotElementRef,a),this.hotInstance.addHook("beforeRender",function(o){i.handsontableBeforeRender()}),this.hotInstance.addHook("afterRender",function(){i.handsontableAfterRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(a)}},{key:"componentWillUpdate",value:function(i,a,o){this.clearCache(),Eh(this.getOwnerDocument()),this.createGlobalEditorPortal(i.children)}},{key:"componentDidUpdate",value:function(){var i=this.createNewGlobalSettings();this.updateHot(i),this.displayAutoSizeWarning(i)}},{key:"componentWillUnmount",value:function(){this.hotInstance.destroy(),Eh(this.getOwnerDocument())}},{key:"render",value:function(){var i=this,a=GC(this.props),o=a.id,s=a.className,l=a.style,u=function(d){return d.type===oH},f=wr.Children.toArray(this.props.children);f=f.filter(function(h){return u(h)});var c=f.map(function(h,d){return wr.cloneElement(h,{_componentRendererColumns:i.componentRendererColumns,_emitColumnSettings:i.setHotColumnSettings.bind(i),_columnIndex:d,_getChildElementByType:d0.bind(i),_getRendererWrapper:i.getRendererWrapper.bind(i),_getEditorClass:i.getEditorClass.bind(i),_getOwnerDocument:i.getOwnerDocument.bind(i),_getEditorCache:i.getEditorCache.bind(i),children:h.props.children})});return c.push(this.getGlobalEditorPortal()),wr.createElement(wr.Fragment,null,wr.createElement("div",{ref:this.setHotElementRef.bind(this),id:o,className:s,style:l},c),wr.createElement(sH,{ref:this.setPortalManagerRef.bind(this)}))}}],[{key:"version",get:function(){return lH}}]),t}(wr.Component);QC.propTypes={style:Th.object,id:Th.string,className:Th.string};wr.Component;/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Af={};Af.version="0.20.1";var Ei=1200,Hs,Rl=function(e){Ei=e};function qH(){Rl(1200)}function ZH(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var su=function(r){return String.fromCharCode(r)},wy=function(r){return String.fromCharCode(r)},qr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Mf(e){for(var r="",t=0,n=0,i=0,a=0,o=0,s=0,l=0,u=0;u<e.length;)t=e.charCodeAt(u++),a=t>>2,n=e.charCodeAt(u++),o=(t&3)<<4|n>>4,i=e.charCodeAt(u++),s=(n&15)<<2|i>>6,l=i&63,isNaN(n)?s=l=64:isNaN(i)&&(l=64),r+=qr.charAt(a)+qr.charAt(o)+qr.charAt(s)+qr.charAt(l);return r}function JH(e){for(var r="",t=0,n=0,i=0,a=0,o=0,s=0,l=0,u=0;u<e.length;)t=e.charCodeAt(u++),t>255&&(t=95),a=t>>2,n=e.charCodeAt(u++),n>255&&(n=95),o=(t&3)<<4|n>>4,i=e.charCodeAt(u++),i>255&&(i=95),s=(n&15)<<2|i>>6,l=i&63,isNaN(n)?s=l=64:isNaN(i)&&(l=64),r+=qr.charAt(a)+qr.charAt(o)+qr.charAt(s)+qr.charAt(l);return r}function QH(e){for(var r="",t=0,n=0,i=0,a=0,o=0,s=0,l=0,u=0;u<e.length;)t=e[u++],a=t>>2,n=e[u++],o=(t&3)<<4|n>>4,i=e[u++],s=(n&15)<<2|i>>6,l=i&63,isNaN(n)?s=l=64:isNaN(i)&&(l=64),r+=qr.charAt(a)+qr.charAt(o)+qr.charAt(s)+qr.charAt(l);return r}function ga(e){var r="",t=0,n=0,i=0,a=0,o=0,s=0,l=0;e=e.replace(/^data:([^\/]+\/[^\/]+)?;base64\,/,"").replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)a=qr.indexOf(e.charAt(u++)),o=qr.indexOf(e.charAt(u++)),t=a<<2|o>>4,r+=String.fromCharCode(t),s=qr.indexOf(e.charAt(u++)),n=(o&15)<<4|s>>2,s!==64&&(r+=String.fromCharCode(n)),l=qr.indexOf(e.charAt(u++)),i=(s&3)<<6|l,l!==64&&(r+=String.fromCharCode(i));return r}var Et=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),yi=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}(),kl=function(){if(typeof Buffer>"u")return!1;var e=yi([65,0]);if(!e)return!1;var r=e.toString("utf16le");return r.length==1}();function vo(e){return Et?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function _y(e){return Et?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var wn=function(r){return Et?yi(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function Wc(e){if(typeof ArrayBuffer>"u")return wn(e);for(var r=new ArrayBuffer(e.length),t=new Uint8Array(r),n=0;n!=e.length;++n)t[n]=e.charCodeAt(n)&255;return r}function go(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function e3(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var dr=Et?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:yi(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),i=0;for(r=0,t=0;r<e.length;t+=i,++r)i=e[r].length,e[r]instanceof Uint8Array?n.set(e[r],t):typeof e[r]=="string"?n.set(new Uint8Array(wn(e[r])),t):n.set(new Uint8Array(e[r]),t);return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function t3(e){for(var r=[],t=0,n=e.length+250,i=vo(e.length+255),a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o<128)i[t++]=o;else if(o<2048)i[t++]=192|o>>6&31,i[t++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var s=e.charCodeAt(++a)&1023;i[t++]=240|o>>8&7,i[t++]=128|o>>2&63,i[t++]=128|s>>6&15|(o&3)<<4,i[t++]=128|s&63}else i[t++]=224|o>>12&15,i[t++]=128|o>>6&63,i[t++]=128|o&63;t>n&&(r.push(i.slice(0,t)),t=0,i=vo(65535),n=65530)}return r.push(i.slice(0,t)),dr(r)}var il=/\u0000/g,lu=/[\u0001-\u0006]/g;function Jo(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function Vn(e,r){var t=""+e;return t.length>=r?t:Yt("0",r-t.length)+t}function Qv(e,r){var t=""+e;return t.length>=r?t:Yt(" ",r-t.length)+t}function Df(e,r){var t=""+e;return t.length>=r?t:t+Yt(" ",r-t.length)}function r3(e,r){var t=""+Math.round(e);return t.length>=r?t:Yt("0",r-t.length)+t}function n3(e,r){var t=""+e;return t.length>=r?t:Yt("0",r-t.length)+t}var Cy=Math.pow(2,32);function Io(e,r){if(e>Cy||e<-Cy)return r3(e,r);var t=Math.round(e);return n3(t,r)}function Pf(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var Sy=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Oh=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function i3(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Wt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},by={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},a3={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Nf(e,r,t){for(var n=e<0?-1:1,i=e*n,a=0,o=1,s=0,l=1,u=0,f=0,c=Math.floor(i);u<r&&(c=Math.floor(i),s=c*o+a,f=c*u+l,!(i-c<5e-8));)i=1/(i-c),a=o,o=s,l=u,u=f;if(f>r&&(u>r?(f=l,s=a):(f=u,s=o)),!t)return[0,n*s,f];var h=Math.floor(n*s/f);return[h,n*s-h*f,f]}function o3(e){var r=e.toPrecision(16);if(r.indexOf("e")>-1){var t=r.slice(0,r.indexOf("e"));return t=t.indexOf(".")>-1?t.slice(0,t.slice(0,2)=="0."?17:16):t.slice(0,15)+Yt("0",t.length-15),t+r.slice(r.indexOf("e"))}var n=r.indexOf(".")>-1?r.slice(0,r.slice(0,2)=="0."?17:16):r.slice(0,15)+Yt("0",r.length-15);return Number(n)}function Ho(e,r,t){if(e>2958465||e<0)return null;e=o3(e);var n=e|0,i=Math.floor(86400*(e-n)),a=0,o=[],s={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(s.u)<1e-6&&(s.u=0),r&&r.date1904&&(n+=1462),s.u>.9999&&(s.u=0,++i==86400&&(s.T=i=0,++n,++s.D)),n===60)o=t?[1317,10,29]:[1900,2,29],a=3;else if(n===0)o=t?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),t&&(a=c3(l,o))}return s.y=o[0],s.m=o[1],s.d=o[2],s.S=i%60,i=Math.floor(i/60),s.M=i%60,i=Math.floor(i/60),s.H=i,s.q=a,s}function eg(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function s3(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function l3(e){var r=e<0?12:11,t=eg(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function u3(e){var r=eg(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function f3(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=l3(e):r===10?t=e.toFixed(10).substr(0,12):t=u3(e),eg(s3(t.toUpperCase()))}function g0(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):f3(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ii(14,Ur(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function c3(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function h3(e,r,t,n){var i="",a=0,o=0,s=t.y,l,u=0;switch(e){case 98:s=t.y+543;case 121:switch(r.length){case 1:case 2:l=s%100,u=2;break;default:l=s%1e4,u=4;break}break;case 109:switch(r.length){case 1:case 2:l=t.m,u=r.length;break;case 3:return Oh[t.m-1][1];case 5:return Oh[t.m-1][0];default:return Oh[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:l=t.d,u=r.length;break;case 3:return Sy[t.q][0];default:return Sy[t.q][1]}break;case 104:switch(r.length){case 1:case 2:l=1+(t.H+11)%12,u=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:l=t.H,u=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:l=t.M,u=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?Vn(t.S,r.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,a=Math.round(o*(t.S+t.u)),a>=60*o&&(a=0),r==="s"?a===0?"0":""+a/o:(i=Vn(a,2+n),r==="ss"?i.substr(0,2):"."+i.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":l=t.D*24+t.H;break;case"[m]":case"[mm]":l=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":l=((t.D*24+t.H)*60+t.M)*60+(n==0?Math.round(t.S+t.u):t.S);break;default:throw"bad abstime format: "+r}u=r.length===3?1:2;break;case 101:l=s,u=1;break}var f=u>0?Vn(l,u):"";return f}function ca(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,n=e.substr(0,t);t!=e.length;t+=r)n+=(n.length>0?",":"")+e.substr(t,r);return n}var eS=/%/g;function d3(e,r,t){var n=r.replace(eS,""),i=r.length-n.length;return Di(e,n,t*Math.pow(10,2*i))+Yt("%",i)}function v3(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Di(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function tS(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+tS(e,-r);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(r)*Math.LOG10E)%i;if(a<0&&(a+=i),t=(r/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),t.indexOf("e")===-1){var o=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+a):t+="E+"+(o-a);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(s,l,u,f){return l+u+f.substr(0,(i+a)%i)+"."+f.substr(a)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var rS=/# (\?+)( ?)\/( ?)(\d+)/;function g3(e,r,t){var n=parseInt(e[4],10),i=Math.round(r*n),a=Math.floor(i/n),o=i-a*n,s=n;return t+(a===0?"":""+a)+" "+(o===0?Yt(" ",e[1].length+1+e[4].length):Qv(o,e[1].length)+e[2]+"/"+e[3]+Vn(s,e[4].length))}function m3(e,r,t){return t+(r===0?"":""+r)+Yt(" ",e[1].length+2+e[4].length)}var nS=/^#*0*\.([0#]+)/,iS=/\).*[0#]/,aS=/\(###\) ###\\?-####/;function an(e){for(var r="",t,n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function xy(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function Ey(e,r){var t=e-Math.floor(e),n=Math.pow(10,r);return r<(""+Math.round(t*n)).length?0:Math.round(t*n)}function p3(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function y3(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Dn(e,r,t){if(e.charCodeAt(0)===40&&!r.match(iS)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Dn("n",n,t):"("+Dn("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return v3(e,r,t);if(r.indexOf("%")!==-1)return d3(e,r,t);if(r.indexOf("E")!==-1)return tS(r,t);if(r.charCodeAt(0)===36)return"$"+Dn(e,r.substr(r.charAt(1)==" "?2:1),t);var i,a,o,s,l=Math.abs(t),u=t<0?"-":"";if(r.match(/^00+$/))return u+Io(l,r.length);if(r.match(/^[#?]+$/))return i=Io(t,0),i==="0"&&(i=""),i.length>r.length?i:an(r.substr(0,r.length-i.length))+i;if(a=r.match(rS))return g3(a,l,u);if(r.match(/^#+0+$/))return u+Io(l,r.length-r.indexOf("0"));if(a=r.match(nS))return i=xy(t,a[1].length).replace(/^([^\.]+)$/,"$1."+an(a[1])).replace(/\.$/,"."+an(a[1])).replace(/\.(\d*)$/,function(g,v){return"."+v+Yt("0",an(a[1]).length-v.length)}),r.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),a=r.match(/^(0*)\.(#*)$/))return u+xy(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=r.match(/^#{1,3},##0(\.?)$/))return u+ca(Io(l,0));if(a=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Dn(e,r,-t):ca(""+(Math.floor(t)+p3(t,a[1].length)))+"."+Vn(Ey(t,a[1].length),a[1].length);if(a=r.match(/^#,#*,#0/))return Dn(e,r.replace(/^#,#*,/,""),t);if(a=r.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Jo(Dn(e,r.replace(/[\\-]/g,""),t)),o=0,Jo(Jo(r.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<i.length?i.charAt(o++):g==="0"?"0":""}));if(r.match(aS))return i=Dn(e,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(a=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),s=Nf(l,Math.pow(10,o)-1,!1),i=""+u,f=Di("n",a[1],s[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+a[2]+"/"+a[3],f=Df(s[2],o),f.length<a[4].length&&(f=an(a[4].substr(a[4].length-f.length))+f),i+=f,i;if(a=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),s=Nf(l,Math.pow(10,o)-1,!0),u+(s[0]||(s[1]?"":"0"))+" "+(s[1]?Qv(s[1],o)+a[2]+"/"+a[3]+Df(s[2],o):Yt(" ",2*o+1+a[2].length+a[3].length));if(a=r.match(/^[#0?]+$/))return i=Io(t,0),r.length<=i.length?i:an(r.substr(0,r.length-i.length))+i;if(a=r.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var c=r.indexOf(".")-o,h=r.length-i.length-c;return an(r.substr(0,c)+i+r.substr(r.length-h))}if(a=r.match(/^00,000\.([#0]*0)$/))return o=Ey(t,a[1].length),t<0?"-"+Dn(e,r,-t):ca(y3(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Vn(0,3-g.length):"")+g})+"."+Vn(o,a[1].length);switch(r){case"###,##0.00":return Dn(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var d=ca(Io(l,0));return d!=="0"?u+d:"";case"###,###.00":return Dn(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Dn(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function w3(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Di(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function _3(e,r,t){var n=r.replace(eS,""),i=r.length-n.length;return Di(e,n,t*Math.pow(10,2*i))+Yt("%",i)}function oS(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+oS(e,-r);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(r)*Math.LOG10E)%i;if(a<0&&(a+=i),t=(r/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),!t.match(/[Ee]/)){var o=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+a):t+="E+"+(o-a),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(s,l,u,f){return l+u+f.substr(0,(i+a)%i)+"."+f.substr(a)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Qn(e,r,t){if(e.charCodeAt(0)===40&&!r.match(iS)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Qn("n",n,t):"("+Qn("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return w3(e,r,t);if(r.indexOf("%")!==-1)return _3(e,r,t);if(r.indexOf("E")!==-1)return oS(r,t);if(r.charCodeAt(0)===36)return"$"+Qn(e,r.substr(r.charAt(1)==" "?2:1),t);var i,a,o,s,l=Math.abs(t),u=t<0?"-":"";if(r.match(/^00+$/))return u+Vn(l,r.length);if(r.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>r.length?i:an(r.substr(0,r.length-i.length))+i;if(a=r.match(rS))return m3(a,l,u);if(r.match(/^#+0+$/))return u+Vn(l,r.length-r.indexOf("0"));if(a=r.match(nS))return i=(""+t).replace(/^([^\.]+)$/,"$1."+an(a[1])).replace(/\.$/,"."+an(a[1])),i=i.replace(/\.(\d*)$/,function(g,v){return"."+v+Yt("0",an(a[1]).length-v.length)}),r.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),a=r.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=r.match(/^#{1,3},##0(\.?)$/))return u+ca(""+l);if(a=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Qn(e,r,-t):ca(""+t)+"."+Yt("0",a[1].length);if(a=r.match(/^#,#*,#0/))return Qn(e,r.replace(/^#,#*,/,""),t);if(a=r.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Jo(Qn(e,r.replace(/[\\-]/g,""),t)),o=0,Jo(Jo(r.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<i.length?i.charAt(o++):g==="0"?"0":""}));if(r.match(aS))return i=Qn(e,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(a=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),s=Nf(l,Math.pow(10,o)-1,!1),i=""+u,f=Di("n",a[1],s[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+a[2]+"/"+a[3],f=Df(s[2],o),f.length<a[4].length&&(f=an(a[4].substr(a[4].length-f.length))+f),i+=f,i;if(a=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),s=Nf(l,Math.pow(10,o)-1,!0),u+(s[0]||(s[1]?"":"0"))+" "+(s[1]?Qv(s[1],o)+a[2]+"/"+a[3]+Df(s[2],o):Yt(" ",2*o+1+a[2].length+a[3].length));if(a=r.match(/^[#0?]+$/))return i=""+t,r.length<=i.length?i:an(r.substr(0,r.length-i.length))+i;if(a=r.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var c=r.indexOf(".")-o,h=r.length-i.length-c;return an(r.substr(0,c)+i+r.substr(r.length-h))}if(a=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Qn(e,r,-t):ca(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Vn(0,3-g.length):"")+g})+"."+Vn(0,a[1].length);switch(r){case"###,###":case"##,###":case"#,###":var d=ca(""+l);return d!=="0"?u+d:"";default:if(r.match(/\.[0#?]*$/))return Qn(e,r.slice(0,r.lastIndexOf(".")),t)+an(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function Di(e,r,t){return(t|0)===t?Qn(e,r,t):Dn(e,r,t)}function C3(e){for(var r=[],t=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=e.substr(i,n-i),i=n+1}if(r[r.length]=e.substr(i),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var sS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function mo(e){for(var r=0,t="",n="";r<e.length;)switch(t=e.charAt(r)){case"G":Pf(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="上午/下午")return!0;++r;break;case"[":for(n=t;e.charAt(r++)!=="]"&&r<e.length;)n+=e.charAt(r);if(n.match(sS))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function S3(e,r,t,n){for(var i=[],a="",o=0,s="",l="t",u,f,c,h="H";o<e.length;)switch(s=e.charAt(o)){case"G":if(!Pf(e,o))throw new Error("unrecognized character "+s+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(a="";(c=e.charCodeAt(++o))!==34&&o<e.length;)a+=String.fromCharCode(c);i[i.length]={t:"t",v:a},++o;break;case"\\":var d=e.charAt(++o),g=d==="("||d===")"?d:"t";i[i.length]={t:g,v:d},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:r},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(u==null&&(u=Ho(r,t,e.charAt(o+1)==="2"),u==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},l=s,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":s=s.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||u==null&&(u=Ho(r,t),u==null))return"";for(a=s;++o<e.length&&e.charAt(o).toLowerCase()===s;)a+=s;s==="m"&&l.toLowerCase()==="h"&&(s="M"),s==="h"&&(s=h),i[i.length]={t:s,v:a},l=s;break;case"A":case"a":case"上":var v={t:s,v:s};if(u==null&&(u=Ho(r,t)),e.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(v.v=u.H>=12?e.charAt(o+2):s),v.t="T",h="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(v.v=u.H>=12?"PM":"AM"),v.t="T",o+=5,h="h"):e.substr(o,5).toUpperCase()==="上午/下午"?(u!=null&&(v.v=u.H>=12?"下午":"上午"),v.t="T",o+=5,h="h"):(v.t="t",++o),u==null&&v.t==="T")return"";i[i.length]=v,l=s;break;case"[":for(a=s;e.charAt(o++)!=="]"&&o<e.length;)a+=e.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(sS)){if(u==null&&(u=Ho(r,t),u==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",mo(e)||(i[i.length]={t:"t",v:a}));break;case".":if(u!=null){for(a=s;++o<e.length&&(s=e.charAt(o))==="0";)a+=s;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=s;++o<e.length&&"0#?.,E+-%".indexOf(s=e.charAt(o))>-1;)a+=s;i[i.length]={t:"n",v:a};break;case"?":for(a=s;e.charAt(++o)===s;)a+=s;i[i.length]={t:s,v:a},l=s;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":s,v:s},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=s;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)a+=e.charAt(o);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:s,v:s},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(s)===-1)throw new Error("unrecognized character "+s+" in "+e);i[i.length]={t:"t",v:s},++o;break}var p=0,C=0,F;for(o=i.length-1,l="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=h,l="h",p<1&&(p=1);break;case"s":(F=i[o].v.match(/\.0+$/))&&(C=Math.max(C,F[0].length-1),p=4),p<3&&(p=3);case"d":case"y":case"e":l=i[o].t;break;case"M":l=i[o].t,p<2&&(p=2);break;case"m":l==="s"&&(i[o].t="M",p<2&&(p=2));break;case"X":break;case"Z":p<1&&i[o].v.match(/[Hh]/)&&(p=1),p<2&&i[o].v.match(/[Mm]/)&&(p=2),p<3&&i[o].v.match(/[Ss]/)&&(p=3)}var D;switch(p){case 0:break;case 1:case 2:case 3:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H),u.H>=24&&(u.H=0,++u.D,D=Ho(u.D),D.u=u.u,D.S=u.S,D.M=u.M,D.H=u.H,u=D);break;case 4:switch(C){case 1:u.u=Math.round(u.u*10)/10;break;case 2:u.u=Math.round(u.u*100)/100;break;case 3:u.u=Math.round(u.u*1e3)/1e3;break}u.u>=1&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H),u.H>=24&&(u.H=0,++u.D,D=Ho(u.D),D.u=u.u,D.S=u.S,D.M=u.M,D.H=u.H,u=D);break}var ee="",ue;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=h3(i[o].t.charCodeAt(0),i[o].v,u,C),i[o].t="t";break;case"n":case"?":for(ue=o+1;i[ue]!=null&&((s=i[ue].t)==="?"||s==="D"||(s===" "||s==="t")&&i[ue+1]!=null&&(i[ue+1].t==="?"||i[ue+1].t==="t"&&i[ue+1].v==="/")||i[o].t==="("&&(s===" "||s==="n"||s===")")||s==="t"&&(i[ue].v==="/"||i[ue].v===" "&&i[ue+1]!=null&&i[ue+1].t=="?"));)i[o].v+=i[ue].v,i[ue]={v:"",t:";"},++ue;ee+=i[o].v,o=ue-1;break;case"G":i[o].t="t",i[o].v=g0(r,t);break}var se="",U,re;if(ee.length>0){ee.charCodeAt(0)==40?(U=r<0&&ee.charCodeAt(0)===45?-r:r,re=Di("n",ee,U)):(U=r<0&&n>1?-r:r,re=Di("n",ee,U),U<0&&i[0]&&i[0].t=="t"&&(re=re.substr(1),i[0].v="-"+i[0].v)),ue=re.length-1;var m=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){m=o;break}var _=i.length;if(m===i.length&&re.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(ue>=i[o].v.length-1?(ue-=i[o].v.length,i[o].v=re.substr(ue+1,i[o].v.length)):ue<0?i[o].v="":(i[o].v=re.substr(0,ue+1),ue=-1),i[o].t="t",_=o);ue>=0&&_<i.length&&(i[_].v=re.substr(0,ue+1)+i[_].v)}else if(m!==i.length&&re.indexOf("E")===-1){for(ue=re.indexOf(".")-1,o=m;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(f=i[o].v.indexOf(".")>-1&&o===m?i[o].v.indexOf(".")-1:i[o].v.length-1,se=i[o].v.substr(f+1);f>=0;--f)ue>=0&&(i[o].v.charAt(f)==="0"||i[o].v.charAt(f)==="#")&&(se=re.charAt(ue--)+se);i[o].v=se,i[o].t="t",_=o}for(ue>=0&&_<i.length&&(i[_].v=re.substr(0,ue+1)+i[_].v),ue=re.indexOf(".")+1,o=m;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==m)){for(f=i[o].v.indexOf(".")>-1&&o===m?i[o].v.indexOf(".")+1:0,se=i[o].v.substr(0,f);f<i[o].v.length;++f)ue<re.length&&(se+=re.charAt(ue++));i[o].v=se,i[o].t="t",_=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(U=n>1&&r<0&&o>0&&i[o-1].v==="-"?-r:r,i[o].v=Di(i[o].t,i[o].v,U),i[o].t="t");var x="";for(o=0;o!==i.length;++o)i[o]!=null&&(x+=i[o].v);return x}var Ty=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Oy(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function b3(e,r){var t=C3(e),n=t.length,i=t[n-1].indexOf("@");if(n<4&&i>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var a=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,a];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var o=t[0].match(Ty),s=t[1].match(Ty);return Oy(r,o)?[n,t[0]]:Oy(r,s)?[n,t[1]]:[n,t[o!=null&&s!=null?2:1]]}return[n,a]}function Ii(e,r,t){t==null&&(t={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?n=t.dateNF:n=e;break;case"number":e==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:Wt)[e],n==null&&(n=t.table&&t.table[by[e]]||Wt[by[e]]),n==null&&(n=a3[e]||"General");break}if(Pf(n,0))return g0(r,t);r instanceof Date&&(r=Ur(r,t.date1904));var i=b3(n,r);if(Pf(i[1]))return g0(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return S3(i[1],r,t,i[0])}function lS(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(Wt[t]==null){r<0&&(r=t);continue}if(Wt[t]==e){r=t;break}}r<0&&(r=391)}return Wt[r]=e,r}function $c(e){for(var r=0;r!=392;++r)e[r]!==void 0&&lS(e[r],r)}function Uc(){Wt=i3()}var Ff=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function x3(e){var r=typeof e=="number"?Wt[e]:e;return r=r.replace(Ff,"(\\d+)"),Ff.lastIndex=0,new RegExp("^"+r+"$")}function E3(e,r,t){var n=-1,i=-1,a=-1,o=-1,s=-1,l=-1;(r.match(Ff)||[]).forEach(function(c,h){var d=parseInt(t[h+1],10);switch(c.toLowerCase().charAt(0)){case"y":n=d;break;case"d":a=d;break;case"h":o=d;break;case"s":l=d;break;case"m":o>=0?s=d:i=d;break}}),Ff.lastIndex=0,l>=0&&s==-1&&i>=0&&(s=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return o==-1&&s==-1&&l==-1?u:n==-1&&i==-1&&a==-1?f:u+"T"+f}var T3={"d.m":"d\\.m"};function O3(e,r){return lS(T3[e]||e,r)}var Ry=function(){var e={};e.version="1.2.0";function r(){for(var U=0,re=new Array(256),m=0;m!=256;++m)U=m,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,re[m]=U;return typeof Int32Array<"u"?new Int32Array(re):re}var t=r();function n(U){var re=0,m=0,_=0,x=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(_=0;_!=256;++_)x[_]=U[_];for(_=0;_!=256;++_)for(m=U[_],re=256+_;re<4096;re+=256)m=x[re]=m>>>8^U[m&255];var B=[];for(_=1;_!=16;++_)B[_-1]=typeof Int32Array<"u"&&typeof x.subarray=="function"?x.subarray(_*256,_*256+256):x.slice(_*256,_*256+256);return B}var i=n(t),a=i[0],o=i[1],s=i[2],l=i[3],u=i[4],f=i[5],c=i[6],h=i[7],d=i[8],g=i[9],v=i[10],p=i[11],C=i[12],F=i[13],D=i[14];function ee(U,re){for(var m=re^-1,_=0,x=U.length;_<x;)m=m>>>8^t[(m^U.charCodeAt(_++))&255];return~m}function ue(U,re){for(var m=re^-1,_=U.length-15,x=0;x<_;)m=D[U[x++]^m&255]^F[U[x++]^m>>8&255]^C[U[x++]^m>>16&255]^p[U[x++]^m>>>24]^v[U[x++]]^g[U[x++]]^d[U[x++]]^h[U[x++]]^c[U[x++]]^f[U[x++]]^u[U[x++]]^l[U[x++]]^s[U[x++]]^o[U[x++]]^a[U[x++]]^t[U[x++]];for(_+=15;x<_;)m=m>>>8^t[(m^U[x++])&255];return~m}function se(U,re){for(var m=re^-1,_=0,x=U.length,B=0,Q=0;_<x;)B=U.charCodeAt(_++),B<128?m=m>>>8^t[(m^B)&255]:B<2048?(m=m>>>8^t[(m^(192|B>>6&31))&255],m=m>>>8^t[(m^(128|B&63))&255]):B>=55296&&B<57344?(B=(B&1023)+64,Q=U.charCodeAt(_++)&1023,m=m>>>8^t[(m^(240|B>>8&7))&255],m=m>>>8^t[(m^(128|B>>2&63))&255],m=m>>>8^t[(m^(128|Q>>6&15|(B&3)<<4))&255],m=m>>>8^t[(m^(128|Q&63))&255]):(m=m>>>8^t[(m^(224|B>>12&15))&255],m=m>>>8^t[(m^(128|B>>6&63))&255],m=m>>>8^t[(m^(128|B&63))&255]);return~m}return e.table=t,e.bstr=ee,e.buf=ue,e.str=se,e}(),Nt=function(){var r={};r.version="1.2.2";function t(y,V){for(var M=y.split("/"),L=V.split("/"),I=0,z=0,w=Math.min(M.length,L.length);I<w;++I){if(z=M[I].length-L[I].length)return z;if(M[I]!=L[I])return M[I]<L[I]?-1:1}return M.length-L.length}function n(y){if(y.charAt(y.length-1)=="/")return y.slice(0,-1).indexOf("/")===-1?y:n(y.slice(0,-1));var V=y.lastIndexOf("/");return V===-1?y:y.slice(0,V+1)}function i(y){if(y.charAt(y.length-1)=="/")return i(y.slice(0,-1));var V=y.lastIndexOf("/");return V===-1?y:y.slice(V+1)}function a(y,V){typeof V=="string"&&(V=new Date(V));var M=V.getHours();M=M<<6|V.getMinutes(),M=M<<5|V.getSeconds()>>>1,y.write_shift(2,M);var L=V.getFullYear()-1980;L=L<<4|V.getMonth()+1,L=L<<5|V.getDate(),y.write_shift(2,L)}function o(y){var V=y.read_shift(2)&65535,M=y.read_shift(2)&65535,L=new Date,I=M&31;M>>>=5;var z=M&15;M>>>=4,L.setMilliseconds(0),L.setFullYear(M+1980),L.setMonth(z-1),L.setDate(I);var w=V&31;V>>>=5;var S=V&63;return V>>>=6,L.setHours(V),L.setMinutes(S),L.setSeconds(w<<1),L}function s(y){on(y,0);for(var V={},M=0;y.l<=y.length-4;){var L=y.read_shift(2),I=y.read_shift(2),z=y.l+I,w={};switch(L){case 21589:M=y.read_shift(1),M&1&&(w.mtime=y.read_shift(4)),I>5&&(M&2&&(w.atime=y.read_shift(4)),M&4&&(w.ctime=y.read_shift(4))),w.mtime&&(w.mt=new Date(w.mtime*1e3));break;case 1:{var S=y.read_shift(4),E=y.read_shift(4);w.usz=E*Math.pow(2,32)+S,S=y.read_shift(4),E=y.read_shift(4),w.csz=E*Math.pow(2,32)+S}break}y.l=z,V[L]=w}return V}var l;function u(){return l||(l=R3)}function f(y,V){if(y[0]==80&&y[1]==75)return xr(y,V);if((y[0]|32)==109&&(y[1]|32)==105)return Fr(y,V);if(y.length<512)throw new Error("CFB file size "+y.length+" < 512");var M=3,L=512,I=0,z=0,w=0,S=0,E=0,N=[],k=y.slice(0,512);on(k,0);var j=c(k);switch(M=j[0],M){case 3:L=512;break;case 4:L=4096;break;case 0:if(j[1]==0)return xr(y,V);default:throw new Error("Major Version: Expected 3 or 4 saw "+M)}L!==512&&(k=y.slice(0,L),on(k,28));var G=y.slice(0,L);h(k,M);var X=k.read_shift(4,"i");if(M===3&&X!==0)throw new Error("# Directory Sectors: Expected 0 saw "+X);k.l+=4,w=k.read_shift(4,"i"),k.l+=4,k.chk("00100000","Mini Stream Cutoff Size: "),S=k.read_shift(4,"i"),I=k.read_shift(4,"i"),E=k.read_shift(4,"i"),z=k.read_shift(4,"i");for(var K=-1,J=0;J<109&&(K=k.read_shift(4,"i"),!(K<0));++J)N[J]=K;var te=d(y,L);p(E,z,te,L,N);var xe=F(te,w,N,L);w<xe.length&&(xe[w].name="!Directory"),I>0&&S!==Q&&(xe[S].name="!MiniFAT"),xe[N[0]].name="!FAT",xe.fat_addrs=N,xe.ssz=L;var He={},je=[],vt=[],Pt=[];D(w,xe,te,je,I,He,vt,S),g(vt,Pt,je),je.shift();var Bt={FileIndex:vt,FullPaths:Pt};return V&&V.raw&&(Bt.raw={header:G,sectors:te}),Bt}function c(y){if(y[y.l]==80&&y[y.l+1]==75)return[0,0];y.chk(A,"Header Signature: "),y.l+=16;var V=y.read_shift(2,"u");return[y.read_shift(2,"u"),V]}function h(y,V){var M=9;switch(y.l+=2,M=y.read_shift(2)){case 9:if(V!=3)throw new Error("Sector Shift: Expected 9 saw "+M);break;case 12:if(V!=4)throw new Error("Sector Shift: Expected 12 saw "+M);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+M)}y.chk("0600","Mini Sector Shift: "),y.chk("000000000000","Reserved: ")}function d(y,V){for(var M=Math.ceil(y.length/V)-1,L=[],I=1;I<M;++I)L[I-1]=y.slice(I*V,(I+1)*V);return L[M-1]=y.slice(M*V),L}function g(y,V,M){for(var L=0,I=0,z=0,w=0,S=0,E=M.length,N=[],k=[];L<E;++L)N[L]=k[L]=L,V[L]=M[L];for(;S<k.length;++S)L=k[S],I=y[L].L,z=y[L].R,w=y[L].C,N[L]===L&&(I!==-1&&N[I]!==I&&(N[L]=N[I]),z!==-1&&N[z]!==z&&(N[L]=N[z])),w!==-1&&(N[w]=L),I!==-1&&L!=N[L]&&(N[I]=N[L],k.lastIndexOf(I)<S&&k.push(I)),z!==-1&&L!=N[L]&&(N[z]=N[L],k.lastIndexOf(z)<S&&k.push(z));for(L=1;L<E;++L)N[L]===L&&(z!==-1&&N[z]!==z?N[L]=N[z]:I!==-1&&N[I]!==I&&(N[L]=N[I]));for(L=1;L<E;++L)if(y[L].type!==0){if(S=L,S!=N[S])do S=N[S],V[L]=V[S]+"/"+V[L];while(S!==0&&N[S]!==-1&&S!=N[S]);N[L]=-1}for(V[0]+="/",L=1;L<E;++L)y[L].type!==2&&(V[L]+="/")}function v(y,V,M){for(var L=y.start,I=y.size,z=[],w=L;M&&I>0&&w>=0;)z.push(V.slice(w*B,w*B+B)),I-=B,w=Ba(M,w*4);return z.length===0?fe(0):dr(z).slice(0,y.size)}function p(y,V,M,L,I){var z=Q;if(y===Q){if(V!==0)throw new Error("DIFAT chain shorter than expected")}else if(y!==-1){var w=M[y],S=(L>>>2)-1;if(!w)return;for(var E=0;E<S&&(z=Ba(w,E*4))!==Q;++E)I.push(z);V>=1&&p(Ba(w,L-4),V-1,M,L,I)}}function C(y,V,M,L,I){var z=[],w=[];I||(I=[]);var S=L-1,E=0,N=0;for(E=V;E>=0;){I[E]=!0,z[z.length]=E,w.push(y[E]);var k=M[Math.floor(E*4/L)];if(N=E*4&S,L<4+N)throw new Error("FAT boundary crossed: "+E+" 4 "+L);if(!y[k])break;E=Ba(y[k],N)}return{nodes:z,data:Ly([w])}}function F(y,V,M,L){var I=y.length,z=[],w=[],S=[],E=[],N=L-1,k=0,j=0,G=0,X=0;for(k=0;k<I;++k)if(S=[],G=k+V,G>=I&&(G-=I),!w[G]){E=[];var K=[];for(j=G;j>=0;){K[j]=!0,w[j]=!0,S[S.length]=j,E.push(y[j]);var J=M[Math.floor(j*4/L)];if(X=j*4&N,L<4+X)throw new Error("FAT boundary crossed: "+j+" 4 "+L);if(!y[J]||(j=Ba(y[J],X),K[j]))break}z[G]={nodes:S,data:Ly([E])}}return z}function D(y,V,M,L,I,z,w,S){for(var E=0,N=L.length?2:0,k=V[y].data,j=0,G=0,X;j<k.length;j+=128){var K=k.slice(j,j+128);on(K,64),G=K.read_shift(2),X=og(K,0,G-N),L.push(X);var J={name:X,type:K.read_shift(1),color:K.read_shift(1),L:K.read_shift(4,"i"),R:K.read_shift(4,"i"),C:K.read_shift(4,"i"),clsid:K.read_shift(16),state:K.read_shift(4,"i"),start:0,size:0},te=K.read_shift(2)+K.read_shift(2)+K.read_shift(2)+K.read_shift(2);te!==0&&(J.ct=ee(K,K.l-8));var xe=K.read_shift(2)+K.read_shift(2)+K.read_shift(2)+K.read_shift(2);xe!==0&&(J.mt=ee(K,K.l-8)),J.start=K.read_shift(4,"i"),J.size=K.read_shift(4,"i"),J.size<0&&J.start<0&&(J.size=J.type=0,J.start=Q,J.name=""),J.type===5?(E=J.start,I>0&&E!==Q&&(V[E].name="!StreamData")):J.size>=4096?(J.storage="fat",V[J.start]===void 0&&(V[J.start]=C(M,J.start,V.fat_addrs,V.ssz)),V[J.start].name=J.name,J.content=V[J.start].data.slice(0,J.size)):(J.storage="minifat",J.size<0?J.size=0:E!==Q&&J.start!==Q&&V[E]&&(J.content=v(J,V[E].data,(V[S]||{}).data))),J.content&&on(J.content,0),z[X]=J,w.push(J)}}function ee(y,V){return new Date((Cn(y,V+4)/1e7*Math.pow(2,32)+Cn(y,V)/1e7-11644473600)*1e3)}function ue(y,V){return u(),f(l.readFileSync(y),V)}function se(y,V){var M=V&&V.type;switch(M||Et&&Buffer.isBuffer(y)&&(M="buffer"),M||"base64"){case"file":return ue(y,V);case"base64":return f(wn(ga(y)),V);case"binary":return f(wn(y),V)}return f(y,V)}function U(y,V){var M=V||{},L=M.root||"Root Entry";if(y.FullPaths||(y.FullPaths=[]),y.FileIndex||(y.FileIndex=[]),y.FullPaths.length!==y.FileIndex.length)throw new Error("inconsistent CFB structure");y.FullPaths.length===0&&(y.FullPaths[0]=L+"/",y.FileIndex[0]={name:L,type:5}),M.CLSID&&(y.FileIndex[0].clsid=M.CLSID),re(y)}function re(y){var V="Sh33tJ5";if(!Nt.find(y,"/"+V)){var M=fe(4);M[0]=55,M[1]=M[3]=50,M[2]=54,y.FileIndex.push({name:V,type:2,content:M,size:4,L:69,R:69,C:69}),y.FullPaths.push(y.FullPaths[0]+V),m(y)}}function m(y,V){U(y);for(var M=!1,L=!1,I=y.FullPaths.length-1;I>=0;--I){var z=y.FileIndex[I];switch(z.type){case 0:L?M=!0:(y.FileIndex.pop(),y.FullPaths.pop());break;case 1:case 2:case 5:L=!0,isNaN(z.R*z.L*z.C)&&(M=!0),z.R>-1&&z.L>-1&&z.R==z.L&&(M=!0);break;default:M=!0;break}}if(!(!M&&!V)){var w=new Date(1987,1,19),S=0,E=Object.create?Object.create(null):{},N=[];for(I=0;I<y.FullPaths.length;++I)E[y.FullPaths[I]]=!0,y.FileIndex[I].type!==0&&N.push([y.FullPaths[I],y.FileIndex[I]]);for(I=0;I<N.length;++I){var k=n(N[I][0]);for(L=E[k];!L;){for(;n(k)&&!E[n(k)];)k=n(k);N.push([k,{name:i(k).replace("/",""),type:1,clsid:ne,ct:w,mt:w,content:null}]),E[k]=!0,k=n(N[I][0]),L=E[k]}}for(N.sort(function(X,K){return t(X[0],K[0])}),y.FullPaths=[],y.FileIndex=[],I=0;I<N.length;++I)y.FullPaths[I]=N[I][0],y.FileIndex[I]=N[I][1];for(I=0;I<N.length;++I){var j=y.FileIndex[I],G=y.FullPaths[I];if(j.name=i(G).replace("/",""),j.L=j.R=j.C=-(j.color=1),j.size=j.content?j.content.length:0,j.start=0,j.clsid=j.clsid||ne,I===0)j.C=N.length>1?1:-1,j.size=0,j.type=5;else if(G.slice(-1)=="/"){for(S=I+1;S<N.length&&n(y.FullPaths[S])!=G;++S);for(j.C=S>=N.length?-1:S,S=I+1;S<N.length&&n(y.FullPaths[S])!=n(G);++S);j.R=S>=N.length?-1:S,j.type=1}else n(y.FullPaths[I+1]||"")==n(G)&&(j.R=I+1),j.type=2}}}function _(y,V){var M=V||{};if(M.fileType=="mad")return gn(y,M);switch(m(y),M.fileType){case"zip":return Ne(y,M)}var L=function(X){for(var K=0,J=0,te=0;te<X.FileIndex.length;++te){var xe=X.FileIndex[te];if(xe.content){var He=xe.content.length;He>0&&(He<4096?K+=He+63>>6:J+=He+511>>9)}}for(var je=X.FullPaths.length+3>>2,vt=K+7>>3,Pt=K+127>>7,Bt=vt+J+je+Pt,ct=Bt+127>>7,Ct=ct<=109?0:Math.ceil((ct-109)/127);Bt+ct+Ct+127>>7>ct;)Ct=++ct<=109?0:Math.ceil((ct-109)/127);var Lt=[1,Ct,ct,Pt,je,J,K,0];return X.FileIndex[0].size=K<<6,Lt[7]=(X.FileIndex[0].start=Lt[0]+Lt[1]+Lt[2]+Lt[3]+Lt[4]+Lt[5])+(Lt[6]+7>>3),Lt}(y),I=fe(L[7]<<9),z=0,w=0;{for(z=0;z<8;++z)I.write_shift(1,W[z]);for(z=0;z<8;++z)I.write_shift(2,0);for(I.write_shift(2,62),I.write_shift(2,3),I.write_shift(2,65534),I.write_shift(2,9),I.write_shift(2,6),z=0;z<3;++z)I.write_shift(2,0);for(I.write_shift(4,0),I.write_shift(4,L[2]),I.write_shift(4,L[0]+L[1]+L[2]+L[3]-1),I.write_shift(4,0),I.write_shift(4,4096),I.write_shift(4,L[3]?L[0]+L[1]+L[2]-1:Q),I.write_shift(4,L[3]),I.write_shift(-4,L[1]?L[0]-1:Q),I.write_shift(4,L[1]),z=0;z<109;++z)I.write_shift(-4,z<L[2]?L[1]+z:-1)}if(L[1])for(w=0;w<L[1];++w){for(;z<236+w*127;++z)I.write_shift(-4,z<L[2]?L[1]+z:-1);I.write_shift(-4,w===L[1]-1?Q:w+1)}var S=function(X){for(w+=X;z<w-1;++z)I.write_shift(-4,z+1);X&&(++z,I.write_shift(-4,Q))};for(w=z=0,w+=L[1];z<w;++z)I.write_shift(-4,b.DIFSECT);for(w+=L[2];z<w;++z)I.write_shift(-4,b.FATSECT);S(L[3]),S(L[4]);for(var E=0,N=0,k=y.FileIndex[0];E<y.FileIndex.length;++E)k=y.FileIndex[E],k.content&&(N=k.content.length,!(N<4096)&&(k.start=w,S(N+511>>9)));for(S(L[6]+7>>3);I.l&511;)I.write_shift(-4,b.ENDOFCHAIN);for(w=z=0,E=0;E<y.FileIndex.length;++E)k=y.FileIndex[E],k.content&&(N=k.content.length,!(!N||N>=4096)&&(k.start=w,S(N+63>>6)));for(;I.l&511;)I.write_shift(-4,b.ENDOFCHAIN);for(z=0;z<L[4]<<2;++z){var j=y.FullPaths[z];if(!j||j.length===0){for(E=0;E<17;++E)I.write_shift(4,0);for(E=0;E<3;++E)I.write_shift(4,-1);for(E=0;E<12;++E)I.write_shift(4,0);continue}k=y.FileIndex[z],z===0&&(k.start=k.size?k.start-1:Q);var G=z===0&&M.root||k.name;if(G.length>32&&(console.error("Name "+G+" will be truncated to "+G.slice(0,32)),G=G.slice(0,32)),N=2*(G.length+1),I.write_shift(64,G,"utf16le"),I.write_shift(2,N),I.write_shift(1,k.type),I.write_shift(1,k.color),I.write_shift(-4,k.L),I.write_shift(-4,k.R),I.write_shift(-4,k.C),k.clsid)I.write_shift(16,k.clsid,"hex");else for(E=0;E<4;++E)I.write_shift(4,0);I.write_shift(4,k.state||0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,k.start),I.write_shift(4,k.size),I.write_shift(4,0)}for(z=1;z<y.FileIndex.length;++z)if(k=y.FileIndex[z],k.size>=4096)if(I.l=k.start+1<<9,Et&&Buffer.isBuffer(k.content))k.content.copy(I,I.l,0,k.size),I.l+=k.size+511&-512;else{for(E=0;E<k.size;++E)I.write_shift(1,k.content[E]);for(;E&511;++E)I.write_shift(1,0)}for(z=1;z<y.FileIndex.length;++z)if(k=y.FileIndex[z],k.size>0&&k.size<4096)if(Et&&Buffer.isBuffer(k.content))k.content.copy(I,I.l,0,k.size),I.l+=k.size+63&-64;else{for(E=0;E<k.size;++E)I.write_shift(1,k.content[E]);for(;E&63;++E)I.write_shift(1,0)}if(Et)I.l=I.length;else for(;I.l<I.length;)I.write_shift(1,0);return I}function x(y,V){var M=y.FullPaths.map(function(E){return E.toUpperCase()}),L=M.map(function(E){var N=E.split("/");return N[N.length-(E.slice(-1)=="/"?2:1)]}),I=!1;V.charCodeAt(0)===47?(I=!0,V=M[0].slice(0,-1)+V):I=V.indexOf("/")!==-1;var z=V.toUpperCase(),w=I===!0?M.indexOf(z):L.indexOf(z);if(w!==-1)return y.FileIndex[w];var S=!z.match(lu);for(z=z.replace(il,""),S&&(z=z.replace(lu,"!")),w=0;w<M.length;++w)if((S?M[w].replace(lu,"!"):M[w]).replace(il,"")==z||(S?L[w].replace(lu,"!"):L[w]).replace(il,"")==z)return y.FileIndex[w];return null}var B=64,Q=-2,A="d0cf11e0a1b11ae1",W=[208,207,17,224,161,177,26,225],ne="00000000000000000000000000000000",b={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Q,FREESECT:-1,HEADER_SIGNATURE:A,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ne,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function R(y,V,M){u();var L=_(y,M);l.writeFileSync(V,L)}function Z(y){for(var V=new Array(y.length),M=0;M<y.length;++M)V[M]=String.fromCharCode(y[M]);return V.join("")}function ie(y,V){var M=_(y,V);switch(V&&V.type||"buffer"){case"file":return u(),l.writeFileSync(V.filename,M),M;case"binary":return typeof M=="string"?M:Z(M);case"base64":return Mf(typeof M=="string"?M:Z(M));case"buffer":if(Et)return Buffer.isBuffer(M)?M:yi(M);case"array":return typeof M=="string"?wn(M):M}return M}var ve;function le(y){try{var V=y.InflateRaw,M=new V;if(M._processChunk(new Uint8Array([3,0]),M._finishFlushFlag),M.bytesRead)ve=y;else throw new Error("zlib does not expose bytesRead")}catch(L){console.error("cannot use native zlib: "+(L.message||L))}}function ge(y,V){if(!ve)return wt(y,V);var M=ve.InflateRaw,L=new M,I=L._processChunk(y.slice(y.l),L._finishFlushFlag);return y.l+=L.bytesRead,I}function Se(y){return ve?ve.deflateRawSync(y):Ve(y)}var Ee=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Re=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ze=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function P(y){var V=(y<<1|y<<11)&139536|(y<<5|y<<15)&558144;return(V>>16|V>>8|V)&255}for(var H=typeof Uint8Array<"u",O=H?new Uint8Array(256):[],T=0;T<256;++T)O[T]=P(T);function Y(y,V){var M=O[y&255];return V<=8?M>>>8-V:(M=M<<8|O[y>>8&255],V<=16?M>>>16-V:(M=M<<8|O[y>>16&255],M>>>24-V))}function q(y,V){var M=V&7,L=V>>>3;return(y[L]|(M<=6?0:y[L+1]<<8))>>>M&3}function ae(y,V){var M=V&7,L=V>>>3;return(y[L]|(M<=5?0:y[L+1]<<8))>>>M&7}function he(y,V){var M=V&7,L=V>>>3;return(y[L]|(M<=4?0:y[L+1]<<8))>>>M&15}function oe(y,V){var M=V&7,L=V>>>3;return(y[L]|(M<=3?0:y[L+1]<<8))>>>M&31}function be(y,V){var M=V&7,L=V>>>3;return(y[L]|(M<=1?0:y[L+1]<<8))>>>M&127}function ce(y,V,M){var L=V&7,I=V>>>3,z=(1<<M)-1,w=y[I]>>>L;return M<8-L||(w|=y[I+1]<<8-L,M<16-L)||(w|=y[I+2]<<16-L,M<24-L)||(w|=y[I+3]<<24-L),w&z}function Ce(y,V,M){var L=V&7,I=V>>>3;return L<=5?y[I]|=(M&7)<<L:(y[I]|=M<<L&255,y[I+1]=(M&7)>>8-L),V+3}function Me(y,V,M){var L=V&7,I=V>>>3;return M=(M&1)<<L,y[I]|=M,V+1}function Fe(y,V,M){var L=V&7,I=V>>>3;return M<<=L,y[I]|=M&255,M>>>=8,y[I+1]=M,V+8}function ke(y,V,M){var L=V&7,I=V>>>3;return M<<=L,y[I]|=M&255,M>>>=8,y[I+1]=M&255,y[I+2]=M>>>8,V+16}function de(y,V){var M=y.length,L=2*M>V?2*M:V+5,I=0;if(M>=V)return y;if(Et){var z=_y(L);if(y.copy)y.copy(z);else for(;I<y.length;++I)z[I]=y[I];return z}else if(H){var w=new Uint8Array(L);if(w.set)w.set(y);else for(;I<M;++I)w[I]=y[I];return w}return y.length=L,y}function Oe(y){for(var V=new Array(y),M=0;M<y;++M)V[M]=0;return V}function we(y,V,M){var L=1,I=0,z=0,w=0,S=0,E=y.length,N=H?new Uint16Array(32):Oe(32);for(z=0;z<32;++z)N[z]=0;for(z=E;z<M;++z)y[z]=0;E=y.length;var k=H?new Uint16Array(E):Oe(E);for(z=0;z<E;++z)N[I=y[z]]++,L<I&&(L=I),k[z]=0;for(N[0]=0,z=1;z<=L;++z)N[z+16]=S=S+N[z-1]<<1;for(z=0;z<E;++z)S=y[z],S!=0&&(k[z]=N[S+16]++);var j=0;for(z=0;z<E;++z)if(j=y[z],j!=0)for(S=Y(k[z],L)>>L-j,w=(1<<L+4-j)-1;w>=0;--w)V[S|w<<j]=j&15|z<<4;return L}var et=H?new Uint16Array(512):Oe(512),ut=H?new Uint16Array(32):Oe(32);if(!H){for(var nt=0;nt<512;++nt)et[nt]=0;for(nt=0;nt<32;++nt)ut[nt]=0}(function(){for(var y=[],V=0;V<32;V++)y.push(5);we(y,ut,32);var M=[];for(V=0;V<=143;V++)M.push(8);for(;V<=255;V++)M.push(9);for(;V<=279;V++)M.push(7);for(;V<=287;V++)M.push(8);we(M,et,288)})();var tr=function(){for(var V=H?new Uint8Array(32768):[],M=0,L=0;M<ze.length-1;++M)for(;L<ze[M+1];++L)V[L]=M;for(;L<32768;++L)V[L]=29;var I=H?new Uint8Array(259):[];for(M=0,L=0;M<Re.length-1;++M)for(;L<Re[M+1];++L)I[L]=M;function z(S,E){for(var N=0;N<S.length;){var k=Math.min(65535,S.length-N),j=N+k==S.length;for(E.write_shift(1,+j),E.write_shift(2,k),E.write_shift(2,~k&65535);k-- >0;)E[E.l++]=S[N++]}return E.l}function w(S,E){for(var N=0,k=0,j=H?new Uint16Array(32768):[];k<S.length;){var G=Math.min(65535,S.length-k);if(G<10){for(N=Ce(E,N,+(k+G==S.length)),N&7&&(N+=8-(N&7)),E.l=N/8|0,E.write_shift(2,G),E.write_shift(2,~G&65535);G-- >0;)E[E.l++]=S[k++];N=E.l*8;continue}N=Ce(E,N,+(k+G==S.length)+2);for(var X=0;G-- >0;){var K=S[k];X=(X<<5^K)&32767;var J=-1,te=0;if((J=j[X])&&(J|=k&-32768,J>k&&(J-=32768),J<k))for(;S[J+te]==S[k+te]&&te<250;)++te;if(te>2){K=I[te],K<=22?N=Fe(E,N,O[K+1]>>1)-1:(Fe(E,N,3),N+=5,Fe(E,N,O[K-23]>>5),N+=3);var xe=K<8?0:K-4>>2;xe>0&&(ke(E,N,te-Re[K]),N+=xe),K=V[k-J],N=Fe(E,N,O[K]>>3),N-=3;var He=K<4?0:K-2>>1;He>0&&(ke(E,N,k-J-ze[K]),N+=He);for(var je=0;je<te;++je)j[X]=k&32767,X=(X<<5^S[k])&32767,++k;G-=te-1}else K<=143?K=K+48:N=Me(E,N,1),N=Fe(E,N,O[K]),j[X]=k&32767,++k}N=Fe(E,N,0)-1}return E.l=(N+7)/8|0,E.l}return function(E,N){return E.length<8?z(E,N):w(E,N)}}();function Ve(y){var V=fe(50+Math.floor(y.length*1.1)),M=tr(y,V);return V.slice(0,M)}var Ie=H?new Uint16Array(32768):Oe(32768),Xe=H?new Uint16Array(32768):Oe(32768),tt=H?new Uint16Array(128):Oe(128),Qe=1,ot=1;function ht(y,V){var M=oe(y,V)+257;V+=5;var L=oe(y,V)+1;V+=5;var I=he(y,V)+4;V+=4;for(var z=0,w=H?new Uint8Array(19):Oe(19),S=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],E=1,N=H?new Uint8Array(8):Oe(8),k=H?new Uint8Array(8):Oe(8),j=w.length,G=0;G<I;++G)w[Ee[G]]=z=ae(y,V),E<z&&(E=z),N[z]++,V+=3;var X=0;for(N[0]=0,G=1;G<=E;++G)k[G]=X=X+N[G-1]<<1;for(G=0;G<j;++G)(X=w[G])!=0&&(S[G]=k[X]++);var K=0;for(G=0;G<j;++G)if(K=w[G],K!=0){X=O[S[G]]>>8-K;for(var J=(1<<7-K)-1;J>=0;--J)tt[X|J<<K]=K&7|G<<3}var te=[];for(E=1;te.length<M+L;)switch(X=tt[be(y,V)],V+=X&7,X>>>=3){case 16:for(z=3+q(y,V),V+=2,X=te[te.length-1];z-- >0;)te.push(X);break;case 17:for(z=3+ae(y,V),V+=3;z-- >0;)te.push(0);break;case 18:for(z=11+be(y,V),V+=7;z-- >0;)te.push(0);break;default:te.push(X),E<X&&(E=X);break}var xe=te.slice(0,M),He=te.slice(M);for(G=M;G<286;++G)xe[G]=0;for(G=L;G<30;++G)He[G]=0;return Qe=we(xe,Ie,286),ot=we(He,Xe,30),V}function it(y,V){if(y[0]==3&&!(y[1]&3))return[vo(V),2];for(var M=0,L=0,I=_y(V||1<<18),z=0,w=I.length>>>0,S=0,E=0;!(L&1);){if(L=ae(y,M),M+=3,L>>>1)L>>1==1?(S=9,E=5):(M=ht(y,M),S=Qe,E=ot);else{M&7&&(M+=8-(M&7));var N=y[M>>>3]|y[(M>>>3)+1]<<8;if(M+=32,N>0)for(!V&&w<z+N&&(I=de(I,z+N),w=I.length);N-- >0;)I[z++]=y[M>>>3],M+=8;continue}for(;;){!V&&w<z+32767&&(I=de(I,z+32767),w=I.length);var k=ce(y,M,S),j=L>>>1==1?et[k]:Ie[k];if(M+=j&15,j>>>=4,!(j>>>8&255))I[z++]=j;else{if(j==256)break;j-=257;var G=j<8?0:j-4>>2;G>5&&(G=0);var X=z+Re[j];G>0&&(X+=ce(y,M,G),M+=G),k=ce(y,M,E),j=L>>>1==1?ut[k]:Xe[k],M+=j&15,j>>>=4;var K=j<4?0:j-2>>1,J=ze[j];for(K>0&&(J+=ce(y,M,K),M+=K),!V&&w<X&&(I=de(I,X+100),w=I.length);z<X;)I[z]=I[z-J],++z}}}return V?[I,M+7>>>3]:[I.slice(0,z),M+7>>>3]}function wt(y,V){var M=y.slice(y.l||0),L=it(M,V);return y.l+=L[1],L[0]}function qt(y,V){if(y)typeof console<"u"&&console.error(V);else throw new Error(V)}function xr(y,V){var M=y;on(M,0);var L=[],I=[],z={FileIndex:L,FullPaths:I};U(z,{root:V.root});for(var w=M.length-4;(M[w]!=80||M[w+1]!=75||M[w+2]!=5||M[w+3]!=6)&&w>=0;)--w;M.l=w+4,M.l+=4;var S=M.read_shift(2);M.l+=6;var E=M.read_shift(4);for(M.l=E,w=0;w<S;++w){M.l+=20;var N=M.read_shift(4),k=M.read_shift(4),j=M.read_shift(2),G=M.read_shift(2),X=M.read_shift(2);M.l+=8;var K=M.read_shift(4),J=s(M.slice(M.l+j,M.l+j+G));M.l+=j+G+X;var te=M.l;M.l=K+4,J&&J[1]&&((J[1]||{}).usz&&(k=J[1].usz),(J[1]||{}).csz&&(N=J[1].csz)),Ht(M,N,k,z,J),M.l=te}return z}function Ht(y,V,M,L,I){y.l+=2;var z=y.read_shift(2),w=y.read_shift(2),S=o(y);if(z&8257)throw new Error("Unsupported ZIP encryption");for(var E=y.read_shift(4),N=y.read_shift(4),k=y.read_shift(4),j=y.read_shift(2),G=y.read_shift(2),X="",K=0;K<j;++K)X+=String.fromCharCode(y[y.l++]);if(G){var J=s(y.slice(y.l,y.l+G));(J[21589]||{}).mt&&(S=J[21589].mt),(J[1]||{}).usz&&(k=J[1].usz),(J[1]||{}).csz&&(N=J[1].csz),I&&((I[21589]||{}).mt&&(S=I[21589].mt),(I[1]||{}).usz&&(k=J[1].usz),(I[1]||{}).csz&&(N=J[1].csz))}y.l+=G;var te=y.slice(y.l,y.l+N);switch(w){case 8:te=ge(y,k);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+w)}var xe=!1;z&8&&(E=y.read_shift(4),E==134695760&&(E=y.read_shift(4),xe=!0),N=y.read_shift(4),k=y.read_shift(4)),N!=V&&qt(xe,"Bad compressed size: "+V+" != "+N),k!=M&&qt(xe,"Bad uncompressed size: "+M+" != "+k),kn(L,X,te,{unsafe:!0,mt:S})}function Ne(y,V){var M=V||{},L=[],I=[],z=fe(1),w=M.compression?8:0,S=0,E=0,N=0,k=0,j=0,G=y.FullPaths[0],X=G,K=y.FileIndex[0],J=[],te=0;for(E=1;E<y.FullPaths.length;++E)if(X=y.FullPaths[E].slice(G.length),K=y.FileIndex[E],!(!K.size||!K.content||X=="Sh33tJ5")){var xe=k,He=fe(X.length);for(N=0;N<X.length;++N)He.write_shift(1,X.charCodeAt(N)&127);He=He.slice(0,He.l),J[j]=typeof K.content=="string"?Ry.bstr(K.content,0):Ry.buf(K.content,0);var je=typeof K.content=="string"?wn(K.content):K.content;w==8&&(je=Se(je)),z=fe(30),z.write_shift(4,67324752),z.write_shift(2,20),z.write_shift(2,S),z.write_shift(2,w),K.mt?a(z,K.mt):z.write_shift(4,0),z.write_shift(-4,J[j]),z.write_shift(4,je.length),z.write_shift(4,K.content.length),z.write_shift(2,He.length),z.write_shift(2,0),k+=z.length,L.push(z),k+=He.length,L.push(He),k+=je.length,L.push(je),z=fe(46),z.write_shift(4,33639248),z.write_shift(2,0),z.write_shift(2,20),z.write_shift(2,S),z.write_shift(2,w),z.write_shift(4,0),z.write_shift(-4,J[j]),z.write_shift(4,je.length),z.write_shift(4,K.content.length),z.write_shift(2,He.length),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(4,0),z.write_shift(4,xe),te+=z.l,I.push(z),te+=He.length,I.push(He),++j}return z=fe(22),z.write_shift(4,101010256),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,j),z.write_shift(2,j),z.write_shift(4,te),z.write_shift(4,k),z.write_shift(2,0),dr([dr(L),dr(I),z])}var Er={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Tr(y,V){if(y.ctype)return y.ctype;var M=y.name||"",L=M.match(/\.([^\.]+)$/);return L&&Er[L[1]]||V&&(L=(M=V).match(/[\.\\]([^\.\\])+$/),L&&Er[L[1]])?Er[L[1]]:"application/octet-stream"}function rr(y){for(var V=Mf(y),M=[],L=0;L<V.length;L+=76)M.push(V.slice(L,L+76));return M.join(`\r
`)+`\r
`}function zr(y){var V=y.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(N){var k=N.charCodeAt(0).toString(16).toUpperCase();return"="+(k.length==1?"0"+k:k)});V=V.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),V.charAt(0)==`
`&&(V="=0D"+V.slice(1)),V=V.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var M=[],L=V.split(`\r
`),I=0;I<L.length;++I){var z=L[I];if(z.length==0){M.push("");continue}for(var w=0;w<z.length;){var S=76,E=z.slice(w,w+S);E.charAt(S-1)=="="?S--:E.charAt(S-2)=="="?S-=2:E.charAt(S-3)=="="&&(S-=3),E=z.slice(w,w+S),w+=S,w<z.length&&(E+="="),M.push(E)}}return M.join(`\r
`)}function vn(y){for(var V=[],M=0;M<y.length;++M){for(var L=y[M];M<=y.length&&L.charAt(L.length-1)=="=";)L=L.slice(0,L.length-1)+y[++M];V.push(L)}for(var I=0;I<V.length;++I)V[I]=V[I].replace(/[=][0-9A-Fa-f]{2}/g,function(z){return String.fromCharCode(parseInt(z.slice(1),16))});return wn(V.join(`\r
`))}function Rn(y,V,M){for(var L="",I="",z="",w,S=0;S<10;++S){var E=V[S];if(!E||E.match(/^\s*$/))break;var N=E.match(/^(.*?):\s*([^\s].*)$/);if(N)switch(N[1].toLowerCase()){case"content-location":L=N[2].trim();break;case"content-type":z=N[2].trim();break;case"content-transfer-encoding":I=N[2].trim();break}}switch(++S,I.toLowerCase()){case"base64":w=wn(ga(V.slice(S).join("")));break;case"quoted-printable":w=vn(V.slice(S));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+I)}var k=kn(y,L.slice(M.length),w,{unsafe:!0});z&&(k.ctype=z)}function Fr(y,V){if(Z(y.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var M=V&&V.root||"",L=(Et&&Buffer.isBuffer(y)?y.toString("binary"):Z(y)).split(`\r
`),I=0,z="";for(I=0;I<L.length;++I)if(z=L[I],!!/^Content-Location:/i.test(z)&&(z=z.slice(z.indexOf("file")),M||(M=z.slice(0,z.lastIndexOf("/")+1)),z.slice(0,M.length)!=M))for(;M.length>0&&(M=M.slice(0,M.length-1),M=M.slice(0,M.lastIndexOf("/")+1),z.slice(0,M.length)!=M););var w=(L[1]||"").match(/boundary="(.*?)"/);if(!w)throw new Error("MAD cannot find boundary");var S="--"+(w[1]||""),E=[],N=[],k={FileIndex:E,FullPaths:N};U(k);var j,G=0;for(I=0;I<L.length;++I){var X=L[I];X!==S&&X!==S+"--"||(G++&&Rn(k,L.slice(j,I),M),j=I)}return k}function gn(y,V){var M=V||{},L=M.boundary||"SheetJS";L="------="+L;for(var I=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+L.slice(2)+'"',"","",""],z=y.FullPaths[0],w=z,S=y.FileIndex[0],E=1;E<y.FullPaths.length;++E)if(w=y.FullPaths[E].slice(z.length),S=y.FileIndex[E],!(!S.size||!S.content||w=="Sh33tJ5")){w=w.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(te){return"_x"+te.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(te){return"_u"+te.charCodeAt(0).toString(16)+"_"});for(var N=S.content,k=Et&&Buffer.isBuffer(N)?N.toString("binary"):Z(N),j=0,G=Math.min(1024,k.length),X=0,K=0;K<=G;++K)(X=k.charCodeAt(K))>=32&&X<128&&++j;var J=j>=G*4/5;I.push(L),I.push("Content-Location: "+(M.root||"file:///C:/SheetJS/")+w),I.push("Content-Transfer-Encoding: "+(J?"quoted-printable":"base64")),I.push("Content-Type: "+Tr(S,w)),I.push(""),I.push(J?zr(k):rr(k))}return I.push(L+`--\r
`),I.join(`\r
`)}function Ta(y){var V={};return U(V,y),V}function kn(y,V,M,L){var I=L&&L.unsafe;I||U(y);var z=!I&&Nt.find(y,V);if(!z){var w=y.FullPaths[0];V.slice(0,w.length)==w?w=V:(w.slice(-1)!="/"&&(w+="/"),w=(w+V).replace("//","/")),z={name:i(V),type:2},y.FileIndex.push(z),y.FullPaths.push(w),I||Nt.utils.cfb_gc(y)}return z.content=M,z.size=M?M.length:0,L&&(L.CLSID&&(z.clsid=L.CLSID),L.mt&&(z.mt=L.mt),L.ct&&(z.ct=L.ct)),z}function As(y,V){U(y);var M=Nt.find(y,V);if(M){for(var L=0;L<y.FileIndex.length;++L)if(y.FileIndex[L]==M)return y.FileIndex.splice(L,1),y.FullPaths.splice(L,1),!0}return!1}function wi(y,V,M){U(y);var L=Nt.find(y,V);if(L){for(var I=0;I<y.FileIndex.length;++I)if(y.FileIndex[I]==L)return y.FileIndex[I].name=i(M),y.FullPaths[I]=M,!0}return!1}function Ms(y){m(y,!0)}return r.find=x,r.read=se,r.parse=f,r.write=ie,r.writeFile=R,r.utils={cfb_new:Ta,cfb_add:kn,cfb_del:As,cfb_mov:wi,cfb_gc:Ms,ReadShift:al,CheckField:ES,prep_blob:on,bconcat:dr,use_zlib:le,_deflateRaw:Ve,_inflateRaw:wt,consts:b},r}(),R3;function ky(e){return typeof e=="string"?Wc(e):Array.isArray(e)?e3(e):e}function Vl(e,r,t){if(typeof Deno<"u"){if(t&&typeof r=="string")switch(t){case"utf8":r=new TextEncoder(t).encode(r);break;case"binary":r=Wc(r);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(e,r)}var n=t=="utf8"?Mi(r):r;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([ky(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=a,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}else if(typeof URL<"u"&&!URL.createObjectURL&&typeof chrome=="object"){var s="data:application/octet-stream;base64,"+QH(new Uint8Array(ky(n)));return chrome.downloads.download({url:s,filename:e,saveAs:!0})}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(r)&&(r=go(r)),l.write(r),l.close(),r}catch(u){if(!u.message||!u.message.match(/onstruct/))throw u}throw new Error("cannot save file "+e)}function vr(e){for(var r=Object.keys(e),t=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(e,r[n])&&t.push(r[n]);return t}function Ay(e,r){for(var t=[],n=vr(e),i=0;i!==n.length;++i)t[e[n[i]][r]]==null&&(t[e[n[i]][r]]=n[i]);return t}function tg(e){for(var r=[],t=vr(e),n=0;n!==t.length;++n)r[e[t[n]]]=t[n];return r}function Vc(e){for(var r=[],t=vr(e),n=0;n!==t.length;++n)r[e[t[n]]]=parseInt(t[n],10);return r}function k3(e){for(var r=[],t=vr(e),n=0;n!==t.length;++n)r[e[t[n]]]==null&&(r[e[t[n]]]=[]),r[e[t[n]]].push(t[n]);return r}var uS=Date.UTC(1899,11,30,0,0,0),A3=Date.UTC(1899,11,31,0,0,0),M3=Date.UTC(1904,0,1,0,0,0);function Ur(e,r){var t=e.getTime(),n=(t-uS)/(24*60*60*1e3);return r?(n-=1462,n<-1402?n-1:n):n<60?n-1:n}function Qo(e){if(e>=60&&e<61)return e;var r=new Date;return r.setTime((e>60?e:e+1)*24*60*60*1e3+uS),r}var D3=/^(\d+):(\d+)(:\d+)?(\.\d+)?$/,P3=/^(\d+)-(\d+)-(\d+)$/,fS=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)?(\.\d+)?$/;function cn(e,r){if(e instanceof Date)return e;var t=e.match(D3);if(t)return new Date((r?M3:A3)+((parseInt(t[1],10)*60+parseInt(t[2],10))*60+(t[3]?parseInt(t[3].slice(1),10):0))*1e3+(t[4]?parseInt((t[4]+"000").slice(1,4),10):0));if(t=e.match(P3),t)return new Date(Date.UTC(+t[1],+t[2]-1,+t[3],0,0,0,0));if(t=e.match(fS),t)return new Date(Date.UTC(+t[1],+t[2]-1,+t[3],+t[4],+t[5],t[6]&&parseInt(t[6].slice(1),10)||0,t[7]&&parseInt(t[7].slice(1),10)||0));var n=new Date(e);return n}function rg(e,r){if(Et&&Buffer.isBuffer(e)){if(r&&kl){if(e[0]==255&&e[1]==254)return Mi(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Mi(ZH(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(e[0]==255&&e[1]==254)return Mi(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Mi(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(a){return t[a]||a})}catch{}var n=[],i=0;try{for(i=0;i<e.length-65536;i+=65536)n.push(String.fromCharCode.apply(0,e.slice(i,i+65536)));n.push(String.fromCharCode.apply(0,e.slice(i)))}catch{try{for(;i<e.length-16384;i+=16384)n.push(String.fromCharCode.apply(0,e.slice(i,i+16384)));n.push(String.fromCharCode.apply(0,e.slice(i)))}catch{for(;i!=e.length;++i)n.push(String.fromCharCode(e[i]))}}return n.join("")}function Qr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=Qr(e[t]));return r}function Yt(e,r){for(var t="";t.length<r;)t+=e;return t}function Pi(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,a){return t=-t,a}),!isNaN(r=Number(n)))?r/t:r}var N3=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/,F3=/^([01]?\d|2[0-3])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))$/,L3=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)(\.\d+)?[Z]?$/,I3=new Date("6/9/69 00:00 UTC").valueOf()==-177984e5;function H3(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],+e[4],parseFloat(e[3])*1e3)):new Date(Date.UTC(1899,11,31,e[7]=="p"?12:0,+e[1],+e[2],parseFloat(e[3])*1e3)):e[5]?new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],+e[5],e[6]?parseFloat(e[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),0,0,0))}function B3(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[4],parseFloat(e[3])*1e3)):new Date(Date.UTC(1899,11,31,0,+e[1],+e[2],parseFloat(e[3])*1e3)):e[5]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[5],e[6]?parseFloat(e[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+e[1],+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1],0,0,0))}var W3=["january","february","march","april","may","june","july","august","september","october","november","december"];function Lf(e){if(L3.test(e))return e.indexOf("Z")==-1?zc(new Date(e)):new Date(e);var r=e.toLowerCase(),t=r.replace(/\s+/g," ").trim(),n=t.match(N3);if(n)return H3(n);if(n=t.match(F3),n)return B3(n);if(n=t.match(fS),n)return new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],n[6]&&parseInt(n[6].slice(1),10)||0,n[7]&&parseInt(n[7].slice(1),10)||0));var i=new Date(I3&&e.indexOf("UTC")==-1?e+" UTC":e),a=new Date(NaN),o=i.getYear();i.getMonth();var s=i.getDate();if(isNaN(s))return a;if(r.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(r=r.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),r.length>3&&W3.indexOf(r)==-1)return a}else if(r.replace(/[ap]m?/,"").match(/[a-z]/))return a;return o<0||o>8099||e.match(/[^-0-9:,\/\\\ ]/)?a:i}function vs(e){return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())}function zc(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))}function st(e,r,t){if(e.FullPaths){if(typeof t=="string"){var n;return Et?n=yi(t):n=t3(t),Nt.utils.cfb_add(e,r,n)}Nt.utils.cfb_add(e,r,t)}else e.file(r,t)}function ng(){return Nt.utils.cfb_new()}var mr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,$3={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ig=tg($3),ag=/[&<>'"]/g,U3=/[\u0000-\u0008\u000b-\u001f\uFFFE-\uFFFF]/g;function lt(e){var r=e+"";return r.replace(ag,function(t){return ig[t]}).replace(U3,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function My(e){return lt(e).replace(/ /g,"_x0020_")}var cS=/[\u0000-\u001f]/g;function Dy(e){var r=e+"";return r.replace(ag,function(t){return ig[t]}).replace(/\n/g,"<br/>").replace(cS,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function V3(e){var r=e+"";return r.replace(ag,function(t){return ig[t]}).replace(cS,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function z3(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function j3(e){switch(e){case 1:case!0:case"1":case"true":return!0;case 0:case!1:case"0":case"false":return!1}return!1}function Rh(e){for(var r="",t=0,n=0,i=0,a=0,o=0,s=0;t<e.length;){if(n=e.charCodeAt(t++),n<128){r+=String.fromCharCode(n);continue}if(i=e.charCodeAt(t++),n>191&&n<224){o=(n&31)<<6,o|=i&63,r+=String.fromCharCode(o);continue}if(a=e.charCodeAt(t++),n<240){r+=String.fromCharCode((n&15)<<12|(i&63)<<6|a&63);continue}o=e.charCodeAt(t++),s=((n&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536,r+=String.fromCharCode(55296+(s>>>10&1023)),r+=String.fromCharCode(56320+(s&1023))}return r}function Py(e){var r=vo(2*e.length),t,n,i=1,a=0,o=0,s;for(n=0;n<e.length;n+=i)i=1,(s=e.charCodeAt(n))<128?t=s:s<224?(t=(s&31)*64+(e.charCodeAt(n+1)&63),i=2):s<240?(t=(s&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,t=(s&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),t-=65536,o=55296+(t>>>10&1023),t=56320+(t&1023)),o!==0&&(r[a++]=o&255,r[a++]=o>>>8,o=0),r[a++]=t%256,r[a++]=t>>>8;return r.slice(0,a).toString("ucs2")}function Ny(e){return yi(e,"binary").toString("utf8")}var uu="foo bar bazâð£",es=Et&&(Ny(uu)==Rh(uu)&&Ny||Py(uu)==Rh(uu)&&Py)||Rh,Mi=Et?function(e){return yi(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,n=0,i=0;t<e.length;)switch(n=e.charCodeAt(t++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(t++)-56320+(n<<10),r.push(String.fromCharCode(240+(i>>18&7))),r.push(String.fromCharCode(144+(i>>12&63))),r.push(String.fromCharCode(128+(i>>6&63))),r.push(String.fromCharCode(128+(i&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},Y3=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),hS=/(^\s|\s$|\n)/;function Br(e,r){return"<"+e+(r.match(hS)?' xml:space="preserve"':"")+">"+r+"</"+e+">"}function Al(e){return vr(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function Te(e,r,t){return"<"+e+(t!=null?Al(t):"")+(r!=null?(r.match(hS)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function m0(e,r){try{return e.toISOString().replace(/\.\d*/,"")}catch(t){if(r)throw t}return""}function G3(e,r){switch(typeof e){case"string":var t=Te("vt:lpwstr",lt(e));return r&&(t=t.replace(/&quot;/g,"_x0022_")),t;case"number":return Te((e|0)==e?"vt:i4":"vt:r8",lt(String(e)));case"boolean":return Te("vt:bool",e?"true":"false")}if(e instanceof Date)return Te("vt:filetime",m0(e));throw new Error("Unable to serialize "+e)}var Ar={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Es=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],_n={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function X3(e,r){for(var t=1-2*(e[r+7]>>>7),n=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),i=e[r+6]&15,a=5;a>=0;--a)i=i*256+e[r+a];return n==2047?i==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),t*Math.pow(2,n-52)*i)}function K3(e,r,t){var n=(r<0||1/r==-1/0?1:0)<<7,i=0,a=0,o=n?-r:r;isFinite(o)?o==0?i=a=0:(i=Math.floor(Math.log(o)/Math.LN2),a=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(r)?26985:0);for(var s=0;s<=5;++s,a/=256)e[t+s]=a&255;e[t+6]=(i&15)<<4|a&15,e[t+7]=i>>4|n}var Fy=function(e){for(var r=[],t=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,a=e[0][n].length;i<a;i+=t)r.push.apply(r,e[0][n].slice(i,i+t));return r},Ly=Et?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:yi(r)})):Fy(e)}:Fy,Iy=function(e,r,t){for(var n=[],i=r;i<t;i+=2)n.push(String.fromCharCode(Ys(e,i)));return n.join("").replace(il,"")},og=Et?function(e,r,t){return!Buffer.isBuffer(e)||!kl?Iy(e,r,t):e.toString("utf16le",r,t).replace(il,"")}:Iy,Hy=function(e,r,t){for(var n=[],i=r;i<r+t;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},dS=Et?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):Hy(e,r,t)}:Hy,By=function(e,r,t){for(var n=[],i=r;i<t;i++)n.push(String.fromCharCode(Wo(e,i)));return n.join("")},zl=Et?function(r,t,n){return Buffer.isBuffer(r)?r.toString("utf8",t,n):By(r,t,n)}:By,vS=function(e,r){var t=Cn(e,r);return t>0?zl(e,r+4,r+4+t-1):""},gS=vS,mS=function(e,r){var t=Cn(e,r);return t>0?zl(e,r+4,r+4+t-1):""},pS=mS,yS=function(e,r){var t=2*Cn(e,r);return t>0?zl(e,r+4,r+4+t-1):""},wS=yS,_S=function(r,t){var n=Cn(r,t);return n>0?og(r,t+4,t+4+n):""},CS=_S,SS=function(e,r){var t=Cn(e,r);return t>0?zl(e,r+4,r+4+t):""},bS=SS,xS=function(e,r){return X3(e,r)},If=xS,sg=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};Et&&(gS=function(r,t){if(!Buffer.isBuffer(r))return vS(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},pS=function(r,t){if(!Buffer.isBuffer(r))return mS(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},wS=function(r,t){if(!Buffer.isBuffer(r)||!kl)return yS(r,t);var n=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n-1)},CS=function(r,t){if(!Buffer.isBuffer(r)||!kl)return _S(r,t);var n=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n)},bS=function(r,t){if(!Buffer.isBuffer(r))return SS(r,t);var n=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+n)},If=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):xS(r,t)},sg=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var Wo=function(e,r){return e[r]},Ys=function(e,r){return e[r+1]*256+e[r]},q3=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},Cn=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},Ba=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},Z3=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function al(e,r){var t="",n,i,a=[],o,s,l,u;switch(r){case"dbcs":if(u=this.l,Et&&Buffer.isBuffer(this)&&kl)t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)t+=String.fromCharCode(Ys(this,u)),u+=2;e*=2;break;case"utf8":t=zl(this,this.l,this.l+e);break;case"utf16le":e*=2,t=og(this,this.l,this.l+e);break;case"wstr":return al.call(this,e,"dbcs");case"lpstr-ansi":t=gS(this,this.l),e=4+Cn(this,this.l);break;case"lpstr-cp":t=pS(this,this.l),e=4+Cn(this,this.l);break;case"lpwstr":t=wS(this,this.l),e=4+2*Cn(this,this.l);break;case"lpp4":e=4+Cn(this,this.l),t=CS(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Cn(this,this.l),t=bS(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(o=Wo(this,this.l+e++))!==0;)a.push(su(o));t=a.join("");break;case"_wstr":for(e=0,t="";(o=Ys(this,this.l+e))!==0;)a.push(su(o)),e+=2;e+=2,t=a.join("");break;case"dbcs-cont":for(t="",u=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Wo(this,u),this.l=u+1,s=al.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),a.join("")+s;a.push(su(Ys(this,u))),u+=2}t=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",u=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Wo(this,u),this.l=u+1,s=al.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),a.join("")+s;a.push(su(Wo(this,u))),u+=1}t=a.join("");break;default:switch(e){case 1:return n=Wo(this,this.l),this.l++,n;case 2:return n=(r==="i"?q3:Ys)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||!(this[this.l+3]&128)?(n=(e>0?Ba:Z3)(this,this.l),this.l+=4,n):(i=Cn(this,this.l),this.l+=4,i);case 8:case-8:if(r==="f")return e==8?i=If(this,this.l):i=If([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:t=dS(this,this.l,e);break}}return this.l+=e,t}var J3=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},Q3=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},eB=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function tB(e,r,t){var n=0,i=0;if(t==="dbcs"){for(i=0;i!=r.length;++i)eB(this,r.charCodeAt(i),this.l+2*i);n=2*r.length}else if(t==="sbcs"||t=="cpstr"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=r.length;++i)this[this.l+i]=r.charCodeAt(i)&255;n=r.length}else if(t==="hex"){for(;i<e;++i)this[this.l++]=parseInt(r.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var a=Math.min(this.l+e,this.length);for(i=0;i<Math.min(r.length,e);++i){var o=r.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,J3(this,r,this.l);break;case 8:if(n=8,t==="f"){K3(this,r,this.l);break}case 16:break;case-4:n=4,Q3(this,r,this.l);break}return this.l+=n,this}function ES(e,r){var t=dS(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function on(e,r){e.l=r,e.read_shift=al,e.chk=ES,e.write_shift=tB}function di(e,r){e.l+=r}function fe(e){var r=vo(e);return on(r,0),r}function Zr(){var e=[],r=Et?256:2048,t=function(u){var f=fe(u);return on(f,0),f},n=t(r),i=function(){n&&(n.l&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n)),n=null)},a=function(u){return n&&u<n.length-n.l?n:(i(),n=t(Math.max(u+1,r)))},o=function(){return i(),dr(e)},s=function(u){i(),n=u,n.l==null&&(n.l=n.length),a(r)};return{next:a,push:s,end:o,_bufs:e}}function ye(e,r,t,n){var i=+r,a;if(!isNaN(i)){n||(n=uU[i].p||(t||[]).length||0),a=1+(i>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var o=e.next(a);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var s=0;s!=4;++s)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&sg(t)&&e.push(t)}}function ol(e,r,t){var n=Qr(e);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Wy(e,r,t){var n=Qr(e);return n.s=ol(n.s,r.s,t),n.e=ol(n.e,r.s,t),n}function sl(e,r){if(e.cRel&&e.c<0)for(e=Qr(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=Qr(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=Qt(e);return!e.cRel&&e.cRel!=null&&(t=iB(t)),!e.rRel&&e.rRel!=null&&(t=rB(t)),t}function kh(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Ot(e.s.c)+":"+(e.e.cRel?"":"$")+Ot(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+kt(e.s.r)+":"+(e.e.rRel?"":"$")+kt(e.e.r):sl(e.s,r.biff)+":"+sl(e.e,r.biff)}function lg(e){return parseInt(nB(e),10)-1}function kt(e){return""+(e+1)}function rB(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function nB(e){return e.replace(/\$(\d+)$/,"$1")}function ug(e){for(var r=aB(e),t=0,n=0;n!==r.length;++n)t=26*t+r.charCodeAt(n)-64;return t-1}function Ot(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function iB(e){return e.replace(/^([A-Z])/,"$$$1")}function aB(e){return e.replace(/^\$([A-Z])/,"$1")}function oB(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Kt(e){for(var r=0,t=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?r=10*r+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:r-1}}function Qt(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function $r(e){var r=e.indexOf(":");return r==-1?{s:Kt(e),e:Kt(e)}:{s:Kt(e.slice(0,r)),e:Kt(e.slice(r+1))}}function gr(e,r){return typeof r>"u"||typeof r=="number"?gr(e.s,e.e):(typeof e!="string"&&(e=Qt(e)),typeof r!="string"&&(r=Qt(r)),e==r?e:e+":"+r)}function Ml(e){var r=$r(e);return"$"+Ot(r.s.c)+"$"+kt(r.s.r)+":$"+Ot(r.e.c)+"$"+kt(r.e.r)}function Dl(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e.replace(/'/g,"''")+"'":e}function Ut(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,i=0,a=e.length;for(t=0;n<a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)t=26*t+i;for(r.s.c=--t,t=0;n<a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)t=10*t+i;if(r.s.r=--t,n===a||i!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,t=0;n!=a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)t=26*t+i;for(r.e.c=--t,t=0;n!=a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)t=10*t+i;return r.e.r=--t,r}function $y(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=Ii(e.z,t?Ur(r):r)}catch{}try{return e.w=Ii((e.XF||{}).numFmtId||(t?14:0),t?Ur(r):r)}catch{return""+r}}function Hi(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?uo[e.v]||e.v:r==null?$y(e,e.v):$y(e,r))}function Ts(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",n={};return n[t]=e,{SheetNames:[t],Sheets:n}}function sB(e){var r={},t=e||{};return t.dense&&(r["!data"]=[]),r}function TS(e,r,t){var n=t||{},i=e?e["!data"]!=null:n.dense,a=e||{};i&&!a["!data"]&&(a["!data"]=[]);var o=0,s=0;if(a&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?Kt(n.origin):n.origin;o=l.r,s=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var f=Ut(a["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),o==-1&&(u.e.r=o=f.e.r+1)}for(var c=[],h=0;h!=r.length;++h)if(r[h]){if(!Array.isArray(r[h]))throw new Error("aoa_to_sheet expects an array of arrays");var d=o+h,g=""+(d+1);i&&(a["!data"][d]||(a["!data"][d]=[]),c=a["!data"][d]);for(var v=0;v!=r[h].length;++v)if(!(typeof r[h][v]>"u")){var p={v:r[h][v]},C=s+v;if(u.s.r>d&&(u.s.r=d),u.s.c>C&&(u.s.c=C),u.e.r<d&&(u.e.r=d),u.e.c<C&&(u.e.c=C),r[h][v]&&typeof r[h][v]=="object"&&!Array.isArray(r[h][v])&&!(r[h][v]instanceof Date))p=r[h][v];else if(Array.isArray(p.v)&&(p.f=r[h][v][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||Wt[14],n.UTC||(p.v=zc(p.v)),n.cellDates?(p.t="d",p.w=Ii(p.z,Ur(p.v,n.date1904))):(p.t="n",p.v=Ur(p.v,n.date1904),p.w=Ii(p.z,p.v))):p.t="s";if(i)c[C]&&c[C].z&&(p.z=c[C].z),c[C]=p;else{var F=Ot(C)+g;a[F]&&a[F].z&&(p.z=a[F].z),a[F]=p}}}return u.s.c<1e7&&(a["!ref"]=gr(u)),a}function Os(e,r){return TS(null,e,r)}function lB(e){return e.read_shift(4,"i")}function jn(e,r){return r||(r=fe(4)),r.write_shift(4,e),r}function Jr(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function br(e,r){var t=!1;return r==null&&(t=!0,r=fe(4+2*e.length)),r.write_shift(4,e.length),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}function uB(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function fB(e,r){return r||(r=fe(4)),r.write_shift(2,e.ich||0),r.write_shift(2,e.ifnt||0),r}function fg(e,r){var t=e.l,n=e.read_shift(1),i=Jr(e),a=[],o={t:i,h:i};if(n&1){for(var s=e.read_shift(4),l=0;l!=s;++l)a.push(uB(e));o.r=a}else o.r=[{ich:0,ifnt:0}];return e.l=t+r,o}function cB(e,r){var t=!1;return r==null&&(t=!0,r=fe(15+4*e.t.length)),r.write_shift(1,0),br(e.t,r),t?r.slice(0,r.l):r}var hB=fg;function dB(e,r){var t=!1;return r==null&&(t=!0,r=fe(23+4*e.t.length)),r.write_shift(1,1),br(e.t,r),r.write_shift(4,1),fB({ich:0,ifnt:0},r),t?r.slice(0,r.l):r}function Hn(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function bo(e,r){return r==null&&(r=fe(8)),r.write_shift(-4,e.c),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}function xo(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}function Eo(e,r){return r==null&&(r=fe(4)),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}var vB=Jr,OS=br;function jc(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}function Pl(e,r){var t=!1;return r==null&&(t=!0,r=fe(127)),r.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}var gB=Jr,p0=jc,cg=Pl;function hg(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,n=r[0]&2;e.l+=4;var i=n===0?If([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):Ba(r,0)>>2;return t?i/100:i}function RS(e,r){r==null&&(r=fe(4));var t=0,n=0,i=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?n=1:i==(i|0)&&i>=-(1<<29)&&i<1<<29&&(n=1,t=1),n)r.write_shift(-4,((t?i:e)<<2)+(t+2));else throw new Error("unsupported RkNumber "+e)}function kS(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}function mB(e,r){return r||(r=fe(16)),r.write_shift(4,e.s.r),r.write_shift(4,e.e.r),r.write_shift(4,e.s.c),r.write_shift(4,e.e.c),r}var To=kS,Rs=mB;function ks(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function po(e,r){return(r||fe(8)).write_shift(8,e,"f")}function pB(e){var r={},t=e.read_shift(1),n=t>>>1,i=e.read_shift(1),a=e.read_shift(2,"i"),o=e.read_shift(1),s=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:r.auto=1;break;case 1:r.index=i;var u=TB[i];u&&(r.rgb=Qy(u));break;case 2:r.rgb=Qy([o,s,l]);break;case 3:r.theme=i;break}return a!=0&&(r.tint=a>0?a/32767:a/32768),r}function Hf(e,r){if(r||(r=fe(8)),!e||e.auto)return r.write_shift(4,0),r.write_shift(4,0),r;e.index!=null?(r.write_shift(1,2),r.write_shift(1,e.index)):e.theme!=null?(r.write_shift(1,6),r.write_shift(1,e.theme)):(r.write_shift(1,5),r.write_shift(1,0));var t=e.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),r.write_shift(2,t),!e.rgb||e.theme!=null)r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),r.write_shift(1,parseInt(n.slice(0,2),16)),r.write_shift(1,parseInt(n.slice(2,4),16)),r.write_shift(1,parseInt(n.slice(4,6),16)),r.write_shift(1,255)}return r}function yB(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function wB(e,r){r||(r=fe(2));var t=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return r.write_shift(1,t),r.write_shift(1,0),r}var AS=2,mn=3,fu=11,Bf=19,cu=64,_B=65,CB=71,SB=4108,bB=4126,Ir=80,Uy={1:{n:"CodePage",t:AS},2:{n:"Category",t:Ir},3:{n:"PresentationFormat",t:Ir},4:{n:"ByteCount",t:mn},5:{n:"LineCount",t:mn},6:{n:"ParagraphCount",t:mn},7:{n:"SlideCount",t:mn},8:{n:"NoteCount",t:mn},9:{n:"HiddenCount",t:mn},10:{n:"MultimediaClipCount",t:mn},11:{n:"ScaleCrop",t:fu},12:{n:"HeadingPairs",t:SB},13:{n:"TitlesOfParts",t:bB},14:{n:"Manager",t:Ir},15:{n:"Company",t:Ir},16:{n:"LinksUpToDate",t:fu},17:{n:"CharacterCount",t:mn},19:{n:"SharedDoc",t:fu},22:{n:"HyperlinksChanged",t:fu},23:{n:"AppVersion",t:mn,p:"version"},24:{n:"DigSig",t:_B},26:{n:"ContentType",t:Ir},27:{n:"ContentStatus",t:Ir},28:{n:"Language",t:Ir},29:{n:"Version",t:Ir},255:{},2147483648:{n:"Locale",t:Bf},2147483651:{n:"Behavior",t:Bf},1919054434:{}},Vy={1:{n:"CodePage",t:AS},2:{n:"Title",t:Ir},3:{n:"Subject",t:Ir},4:{n:"Author",t:Ir},5:{n:"Keywords",t:Ir},6:{n:"Comments",t:Ir},7:{n:"Template",t:Ir},8:{n:"LastAuthor",t:Ir},9:{n:"RevNumber",t:Ir},10:{n:"EditTime",t:cu},11:{n:"LastPrinted",t:cu},12:{n:"CreatedDate",t:cu},13:{n:"ModifiedDate",t:cu},14:{n:"PageCount",t:mn},15:{n:"WordCount",t:mn},16:{n:"CharCount",t:mn},17:{n:"Thumbnail",t:CB},18:{n:"Application",t:Ir},19:{n:"DocSecurity",t:mn},255:{},2147483648:{n:"Locale",t:Bf},2147483651:{n:"Behavior",t:Bf},1919054434:{}};function xB(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var EB=xB([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,0,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),TB=Qr(EB),uo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},OB={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},RB=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"],kB={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},hu={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function MS(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function DS(e,r,t){var n=k3(kB),i=[],a;t||(i[i.length]=mr,i[i.length]=Te("Types",null,{xmlns:Ar.CT,"xmlns:xsd":Ar.xsd,"xmlns:xsi":Ar.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(u){return Te("Default",null,{Extension:u[0],ContentType:u[1]})})));var o=function(u){e[u]&&e[u].length>0&&(a=e[u][0],i[i.length]=Te("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:hu[u][r.bookType]||hu[u].xlsx}))},s=function(u){(e[u]||[]).forEach(function(f){i[i.length]=Te("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:hu[u][r.bookType]||hu[u].xlsx})})},l=function(u){(e[u]||[]).forEach(function(f){i[i.length]=Te("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:n[u][0]})})};return o("workbooks"),s("sheets"),s("charts"),l("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),s("metadata"),l("people"),!t&&i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var yt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",CONN:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/connections",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function PS(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function ts(e){var r=[mr,Te("Relationships",null,{xmlns:Ar.RELS})];return vr(e["!id"]).forEach(function(t){r[r.length]=Te("Relationship",null,e["!id"][t])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function xt(e,r,t,n,i,a){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),r<0)for(r=e["!idx"];e["!id"]["rId"+r];++r);if(e["!idx"]=r+1,i.Id="rId"+r,i.Type=n,i.Target=t,a?i.TargetMode=a:[yt.HLINK,yt.XPATH,yt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+r);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,r}function AB(e){var r=[mr];r.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),r.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<e.length;++t)r.push('  <manifest:file-entry manifest:full-path="'+e[t][0]+'" manifest:media-type="'+e[t][1]+`"/>
`);return r.push("</manifest:manifest>"),r.join("")}function zy(e,r,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+r+`"/>
`,`  </rdf:Description>
`].join("")}function MB(e,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+`"/>
`,`  </rdf:Description>
`].join("")}function DB(e){var r=[mr];r.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=e.length;++t)r.push(zy(e[t][0],e[t][1])),r.push(MB("",e[t][0]));return r.push(zy("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}function NS(e,r){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Af.version+"</meta:generator></office:meta></office:document-meta>"}var fo=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Ah(e,r,t,n,i){i[e]!=null||r==null||r===""||(i[e]=r,r=lt(r),n[n.length]=t?Te(e,r,t):Br(e,r))}function FS(e,r){var t=r||{},n=[mr,Te("cp:coreProperties",null,{"xmlns:cp":Ar.CORE_PROPS,"xmlns:dc":Ar.dc,"xmlns:dcterms":Ar.dcterms,"xmlns:dcmitype":Ar.dcmitype,"xmlns:xsi":Ar.xsi})],i={};if(!e&&!t.Props)return n.join("");e&&(e.CreatedDate!=null&&Ah("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:m0(e.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&Ah("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:m0(e.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var a=0;a!=fo.length;++a){var o=fo[a],s=t.Props&&t.Props[o[1]]!=null?t.Props[o[1]]:e?e[o[1]]:null;s===!0?s="1":s===!1?s="0":typeof s=="number"&&(s=String(s)),s!=null&&Ah(o[0],s,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var rs=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],LS=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function IS(e){var r=[],t=Te;return e||(e={}),e.Application="SheetJS",r[r.length]=mr,r[r.length]=Te("Properties",null,{xmlns:Ar.EXT_PROPS,"xmlns:vt":Ar.vt}),rs.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=lt(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(r[r.length]=t(n[0],i))}}),r[r.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=t("TitlesOfParts",t("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+lt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}function HS(e){var r=[mr,Te("Properties",null,{xmlns:Ar.CUST_PROPS,"xmlns:vt":Ar.vt})];if(!e)return r.join("");var t=1;return vr(e).forEach(function(i){++t,r[r.length]=Te("property",G3(e[i],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:lt(i)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var jy={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function PB(e,r){var t=[];return vr(jy).map(function(n){for(var i=0;i<fo.length;++i)if(fo[i][1]==n)return fo[i];for(i=0;i<rs.length;++i)if(rs[i][1]==n)return rs[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=r&&r.Props&&r.Props[n[1]]!=null?r.Props[n[1]]:e[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),t.push(Br(jy[n[1]]||n[1],i))}}),Te("DocumentProperties",t.join(""),{xmlns:_n.o})}function NB(e,r){var t=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&vr(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var o=0;o<fo.length;++o)if(a==fo[o][1])return;for(o=0;o<rs.length;++o)if(a==rs[o][1])return;for(o=0;o<t.length;++o)if(a==t[o])return;var s=e[a],l="string";typeof s=="number"?(l="float",s=String(s)):s===!0||s===!1?(l="boolean",s=s?"1":"0"):s=String(s),i.push(Te(My(a),s,{"dt:dt":l}))}}),r&&vr(r).forEach(function(a){if(Object.prototype.hasOwnProperty.call(r,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var o=r[a],s="string";typeof o=="number"?(s="float",o=String(o)):o===!0||o===!1?(s="boolean",o=o?"1":"0"):o instanceof Date?(s="dateTime.tz",o=o.toISOString()):o=String(o),i.push(Te(My(a),o,{"dt:dt":s}))}}),"<"+n+' xmlns="'+_n.o+'">'+i.join("")+"</"+n+">"}function FB(e){var r=typeof e=="string"?new Date(Date.parse(e)):e,t=r.getTime()/1e3+11644473600,n=t%Math.pow(2,32),i=(t-n)/Math.pow(2,32);n*=1e7,i*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),i+=a);var o=fe(8);return o.write_shift(4,n),o.write_shift(4,i),o}function Yy(e,r){var t=fe(4),n=fe(4);switch(t.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,r);break;case 5:n=fe(8),n.write_shift(8,r,"f");break;case 11:n.write_shift(4,r?1:0);break;case 64:n=FB(r);break;case 31:case 80:for(n=fe(4+2*(r.length+1)+(r.length%2?0:2)),n.write_shift(4,r.length+1),n.write_shift(0,r,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}return dr([t,n])}var BS=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function LB(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Gy(e,r,t){var n=fe(8),i=[],a=[],o=8,s=0,l=fe(8),u=fe(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),a.push(l),i.push(u),o+=8+l.length,!r){u=fe(8),u.write_shift(4,0),i.unshift(u);var f=[fe(4)];for(f[0].write_shift(4,e.length),s=0;s<e.length;++s){var c=e[s][0];for(l=fe(8+2*(c.length+1)+(c.length%2?0:2)),l.write_shift(4,s+2),l.write_shift(4,c.length+1),l.write_shift(0,c,"dbcs");l.l!=l.length;)l.write_shift(1,0);f.push(l)}l=dr(f),a.unshift(l),o+=8+l.length}for(s=0;s<e.length;++s)if(!(r&&!r[e[s][0]])&&!(BS.indexOf(e[s][0])>-1||LS.indexOf(e[s][0])>-1)&&e[s][1]!=null){var h=e[s][1],d=0;if(r){d=+r[e[s][0]];var g=t[d];if(g.p=="version"&&typeof h=="string"){var v=h.split(".");h=(+v[0]<<16)+(+v[1]||0)}l=Yy(g.t,h)}else{var p=LB(h);p==-1&&(p=31,h=String(h)),l=Yy(p,h)}a.push(l),u=fe(8),u.write_shift(4,r?d:2+s),i.push(u),o+=8+l.length}var C=8*(a.length+1);for(s=0;s<a.length;++s)i[s].write_shift(4,C),C+=a[s].length;return n.write_shift(4,o),n.write_shift(4,a.length),dr([n].concat(i).concat(a))}function Xy(e,r,t,n,i,a){var o=fe(i?68:48),s=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Nt.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,r,"hex"),o.write_shift(4,i?68:48);var l=Gy(e,t,n);if(s.push(l),i){var u=Gy(i,null,null);o.write_shift(16,a,"hex"),o.write_shift(4,68+l.length),s.push(u)}return dr(s)}function IB(e,r){r||(r=fe(e));for(var t=0;t<e;++t)r.write_shift(1,0);return r}function HB(e,r){return e.read_shift(r)===1}function Xr(e,r){return r||(r=fe(2)),r.write_shift(2,+!!e),r}function mf(e){return e.read_shift(2,"u")}function Nn(e,r){return r||(r=fe(2)),r.write_shift(2,e),r}function WS(e,r,t){return t||(t=fe(2)),t.write_shift(1,r=="e"?+e:+!!e),t.write_shift(1,r=="e"?1:0),t}function $S(e,r,t){var n=e.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont",a=Ei;if(t&&t.biff>=8&&(Ei=1200),!t||t.biff==8){var o=e.read_shift(1);o&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var s=n?e.read_shift(n,i):"";return Ei=a,s}function BB(e){var r=e.t||"",t=fe(3);t.write_shift(2,r.length),t.write_shift(1,1);var n=fe(2*r.length);n.write_shift(2*r.length,r,"utf16le");var i=[t,n];return dr(i)}function WB(e,r,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(r,"sbcs-cont"):n=e.read_shift(r,"dbcs-cont"),n}function $B(e,r,t){var n=e.read_shift(t&&t.biff==2?1:2);return n===0?(e.l++,""):WB(e,n,t)}function UB(e,r,t){if(t.biff>5)return $B(e,r,t);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function US(e,r,t){return t||(t=fe(3+2*e.length)),t.write_shift(2,e.length),t.write_shift(1,1),t.write_shift(31,e,"utf16le"),t}function Ky(e,r){r||(r=fe(6+e.length*2)),r.write_shift(4,1+e.length);for(var t=0;t<e.length;++t)r.write_shift(2,e.charCodeAt(t));return r.write_shift(2,0),r}function VB(e){var r=fe(512),t=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),a=i>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}r.write_shift(4,2),r.write_shift(4,a);var o=[8,6815827,6619237,4849780,83];for(t=0;t<o.length;++t)r.write_shift(4,o[t]);if(a==28)n=n.slice(1),Ky(n,r);else if(a&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<o.length;++t)r.write_shift(1,parseInt(o[t],16));var s=i>-1?n.slice(0,i):n;for(r.write_shift(4,2*(s.length+1)),t=0;t<s.length;++t)r.write_shift(2,s.charCodeAt(t));r.write_shift(2,0),a&8&&Ky(i>-1?n.slice(i+1):"",r)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<o.length;++t)r.write_shift(1,parseInt(o[t],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(r.write_shift(2,l),r.write_shift(4,n.length-3*l+1),t=0;t<n.length-3*l;++t)r.write_shift(1,n.charCodeAt(t+3*l)&255);for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),t=0;t<6;++t)r.write_shift(4,0)}return r.slice(0,r.l)}function yo(e,r,t,n){return n||(n=fe(6)),n.write_shift(2,e),n.write_shift(2,r),n.write_shift(2,t||0),n}function zB(e,r,t){var n=t.biff>8?4:2,i=e.read_shift(n),a=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[i,a,o]}function jB(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r},e:{c:i,r:t}}}function VS(e,r){return r||(r=fe(8)),r.write_shift(2,e.s.r),r.write_shift(2,e.e.r),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c),r}function dg(e,r,t){var n=1536,i=16;switch(t.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=fe(i);return a.write_shift(2,n),a.write_shift(2,r),i>4&&a.write_shift(2,29282),i>6&&a.write_shift(2,1997),i>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function YB(e,r){var t=!r||r.biff==8,n=fe(t?112:54);for(n.write_shift(r.biff==8?2:1,7),t&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(t?0:536870912));n.l<n.length;)n.write_shift(1,t?0:32);return n}function GB(e,r){var t=!r||r.biff>=8?2:1,n=fe(8+t*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),r.biff>=8&&n.write_shift(1,1),n.write_shift(t*e.name.length,e.name,r.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function XB(e,r){var t=fe(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=BB(e[i]);var a=dr([t].concat(n));return a.parts=[t.length].concat(n.map(function(o){return o.length})),a}function KB(){var e=fe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function qB(e){var r=fe(18),t=1718;return e&&e.RTL&&(t|=64),r.write_shift(2,t),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}function ZB(e,r){var t=e.name||"Arial",n=r&&r.biff==5,i=n?15+t.length:16+2*t.length,a=fe(i);return a.write_shift(2,(e.sz||12)*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,t.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le"),a}function JB(e,r,t,n){var i=fe(10);return yo(e,r,n,i),i.write_shift(4,t),i}function QB(e,r,t,n,i){var a=!i||i.biff==8,o=fe(8+ +a+(1+a)*t.length);return yo(e,r,n,o),o.write_shift(2,t.length),a&&o.write_shift(1,1),o.write_shift((1+a)*t.length,t,a?"utf16le":"sbcs"),o}function e6(e,r,t,n){var i=t&&t.biff==5;n||(n=fe(i?3+r.length:5+2*r.length)),n.write_shift(2,e),n.write_shift(i?1:2,r.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*r.length,r,i?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}function t6(e){var r=fe(1+e.length);return r.write_shift(1,e.length),r.write_shift(e.length,e,"sbcs"),r}function r6(e){var r=fe(3+e.length);return r.l+=2,r.write_shift(1,e.length),r.write_shift(e.length,e,"sbcs"),r}function n6(e,r){var t=r.biff==8||!r.biff?4:2,n=fe(2*t+6);return n.write_shift(t,e.s.r),n.write_shift(t,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function qy(e,r,t,n){var i=t&&t.biff==5;n||(n=fe(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,r<<4));var a=0;return e.numFmtId>0&&i&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function i6(e){var r=fe(4);return r.l+=2,r.write_shift(1,e.numFmtId),r.l++,r}function zS(e){var r=fe(12);return r.l++,r.write_shift(1,e.numFmtId),r.l+=10,r}var a6=zS;function o6(e){var r=fe(8);return r.write_shift(4,0),r.write_shift(2,e[0]?e[0]+1:0),r.write_shift(2,e[1]?e[1]+1:0),r}function Mh(e,r,t,n,i,a){var o=fe(8);return yo(e,r,n,o),WS(t,a,o),o}function s6(e,r,t,n){var i=fe(14);return yo(e,r,n,i),po(t,i),i}function l6(e,r,t){if(t.biff<8||!(t.biff>8)&&r==e[e.l]+(e[e.l+1]==3?1:0)+1)return Zy(e,r,t);for(var n=[],i=e.l+r,a=e.read_shift(t.biff>8?4:2);a--!==0;)n.push(zB(e,t.biff>8?12:6,t));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function Zy(e,r,t){e[e.l+1]==3&&e[e.l]++;var n=$S(e,r,t);return n.charCodeAt(0)==3?n.slice(1):n}function Dh(e,r,t,n){var i=fe(6+(n||e.length));return i.write_shift(2,r),i.write_shift(2,t),i.write_shift(2,n||e.length),i.write_shift(e.length,e,"sbcs"),i}function u6(e){var r=fe(2+e.length*8);r.write_shift(2,e.length);for(var t=0;t<e.length;++t)VS(e[t],r);return r}function f6(e){var r=fe(24),t=Kt(e[0]);r.write_shift(2,t.r),r.write_shift(2,t.r),r.write_shift(2,t.c),r.write_shift(2,t.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)r.write_shift(1,parseInt(n[i],16));return dr([r,VB(e[1])])}function c6(e){var r=e[1].Tooltip,t=fe(10+2*(r.length+1));t.write_shift(2,2048);var n=Kt(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var i=0;i<r.length;++i)t.write_shift(2,r.charCodeAt(i));return t.write_shift(2,0),t}function h6(e){return e||(e=fe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function d6(e,r,t){if(!t.cellStyles)return di(e,r);var n=t&&t.biff>=12?4:2,i=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),s=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var u={s:i,e:a,w:o,ixfe:s,flags:l};return(t.biff>=5||!t.biff)&&(u.level=l>>8&7),u}function v6(e,r){var t=fe(12);t.write_shift(2,r),t.write_shift(2,r),t.write_shift(2,e.width*256),t.write_shift(2,0);var n=0;return e.hidden&&(n|=1),t.write_shift(1,n),n=e.level||0,t.write_shift(1,n),t.write_shift(2,0),t}function g6(e){for(var r=fe(2*e),t=0;t<e;++t)r.write_shift(2,t+1);return r}function jl(e,r,t,n,i){return e||(e=fe(7)),e.write_shift(2,r),e.write_shift(2,t),e.write_shift(1,n||0),e.write_shift(1,i||0),e.write_shift(1,0),e}function m6(e,r,t,n,i){var a=fe(15);return jl(a,e,r,n||0,i||0),a.write_shift(8,t,"f"),a}function p6(e,r,t,n,i){var a=fe(9);return jl(a,e,r,n||0,i||0),a.write_shift(2,t),a}var y6=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=tg({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(s,l){var u=[],f=vo(1);switch(l.type){case"base64":f=wn(ga(s));break;case"binary":f=wn(s);break;case"buffer":case"array":f=s;break}on(f,0);var c=f.read_shift(1),h=!!(c&136),d=!1,g=!1;switch(c){case 2:break;case 3:break;case 48:d=!0,h=!0;break;case 49:d=!0,h=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+c.toString(16))}var v=0,p=521;c==2&&(v=f.read_shift(2)),f.l+=3,c!=2&&(v=f.read_shift(4)),v>1048576&&(v=1e6),c!=2&&(p=f.read_shift(2));var C=f.read_shift(2);l.codepage,c!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&e[f[f.l]],f.l+=1,f.l+=2),g&&(f.l+=36);for(var F=[],D={},ee=Math.min(f.length,c==2?521:p-10-(d?264:0)),ue=g?32:11;f.l<ee&&f[f.l]!=13;)switch(D={},D.name=go(f.slice(f.l,f.l+ue)).replace(/[\u0000\r\n].*$/g,""),f.l+=ue,D.type=String.fromCharCode(f.read_shift(1)),c!=2&&!g&&(D.offset=f.read_shift(4)),D.len=f.read_shift(1),c==2&&(D.offset=f.read_shift(2)),D.dec=f.read_shift(1),D.name.length&&F.push(D),c!=2&&(f.l+=g?13:14),D.type){case"B":(!d||D.len!=8)&&l.WTF&&console.log("Skipping "+D.name+":"+D.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+D.name+":"+D.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+D.type)}if(f[f.l]!==13&&(f.l=p-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=p;var se=0,U=0;for(u[0]=[],U=0;U!=F.length;++U)u[0][U]=F[U].name;for(;v-- >0;){if(f[f.l]===42){f.l+=C;continue}for(++f.l,u[++se]=[],U=0,U=0;U!=F.length;++U){var re=f.slice(f.l,f.l+F[U].len);f.l+=F[U].len,on(re,0);var m=go(re);switch(F[U].type){case"C":m.trim().length&&(u[se][U]=m.replace(/\s+$/,""));break;case"D":m.length===8?(u[se][U]=new Date(Date.UTC(+m.slice(0,4),+m.slice(4,6)-1,+m.slice(6,8),0,0,0,0)),l&&l.UTC||(u[se][U]=vs(u[se][U]))):u[se][U]=m;break;case"F":u[se][U]=parseFloat(m.trim());break;case"+":case"I":u[se][U]=g?re.read_shift(-4,"i")^2147483648:re.read_shift(4,"i");break;case"L":switch(m.trim().toUpperCase()){case"Y":case"T":u[se][U]=!0;break;case"N":case"F":u[se][U]=!1;break;case"":case"\0":case"?":break;default:throw new Error("DBF Unrecognized L:|"+m+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+c.toString(16));u[se][U]="##MEMO##"+(g?parseInt(m.trim(),10):re.read_shift(4));break;case"N":m=m.replace(/\u0000/g,"").trim(),m&&m!="."&&(u[se][U]=+m||0);break;case"@":u[se][U]=new Date(re.read_shift(-8,"f")-621356832e5);break;case"T":{var _=re.read_shift(4),x=re.read_shift(4);if(_==0&&x==0)break;u[se][U]=new Date((_-2440588)*864e5+x),l&&l.UTC||(u[se][U]=vs(u[se][U]))}break;case"Y":u[se][U]=re.read_shift(4,"i")/1e4+re.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[se][U]=-re.read_shift(-8,"f");break;case"B":if(d&&F[U].len==8){u[se][U]=re.read_shift(8,"f");break}case"G":case"P":re.l+=F[U].len;break;case"0":if(F[U].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+F[U].type)}}}if(c!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=F,u}function n(s,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var f=Os(t(s,u),u);return f["!cols"]=u.DBF.map(function(c){return{wch:c.len,DBF:c}}),delete u.DBF,f}function i(s,l){try{var u=Ts(n(s,l),l);return u.bookType="dbf",u}catch(f){if(l&&l.WTF)throw f}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function o(s,l){if(!s["!ref"])throw new Error("Cannot export empty sheet to DBF");var u=l||{},f=Ei;if(+u.codepage>=0&&Rl(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var c=Zr(),h=C0(s,{header:1,raw:!0,cellDates:!0}),d=h[0],g=h.slice(1),v=s["!cols"]||[],p=0,C=0,F=0,D=1;for(p=0;p<d.length;++p){if(((v[p]||{}).DBF||{}).name){d[p]=v[p].DBF.name,++F;continue}if(d[p]!=null){if(++F,typeof d[p]=="number"&&(d[p]=d[p].toString(10)),typeof d[p]!="string")throw new Error("DBF Invalid column name "+d[p]+" |"+typeof d[p]+"|");if(d.indexOf(d[p])!==p){for(C=0;C<1024;++C)if(d.indexOf(d[p]+"_"+C)==-1){d[p]+="_"+C;break}}}}var ee=Ut(s["!ref"]),ue=[],se=[],U=[];for(p=0;p<=ee.e.c-ee.s.c;++p){var re="",m="",_=0,x=[];for(C=0;C<g.length;++C)g[C][p]!=null&&x.push(g[C][p]);if(x.length==0||d[p]==null){ue[p]="?";continue}for(C=0;C<x.length;++C){switch(typeof x[C]){case"number":m="B";break;case"string":m="C";break;case"boolean":m="L";break;case"object":m=x[C]instanceof Date?"D":"C";break;default:m="C"}_=Math.max(_,String(x[C]).length),re=re&&re!=m?"C":m}_>250&&(_=250),m=((v[p]||{}).DBF||{}).type,m=="C"&&v[p].DBF.len>_&&(_=v[p].DBF.len),re=="B"&&m=="N"&&(re="N",U[p]=v[p].DBF.dec,_=v[p].DBF.len),se[p]=re=="C"||m=="N"?_:a[re]||0,D+=se[p],ue[p]=re}var B=c.next(32);for(B.write_shift(4,318902576),B.write_shift(4,g.length),B.write_shift(2,296+32*F),B.write_shift(2,D),p=0;p<4;++p)B.write_shift(4,0);var Q=+r[Ei]||3;for(B.write_shift(4,0|Q<<8),e[Q]!=+u.codepage&&(u.codepage&&console.error("DBF Unsupported codepage "+Ei+", using 1252"),Ei=1252),p=0,C=0;p<d.length;++p)if(d[p]!=null){var A=c.next(32),W=(d[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);A.write_shift(1,W,"sbcs"),A.write_shift(1,ue[p]=="?"?"C":ue[p],"sbcs"),A.write_shift(4,C),A.write_shift(1,se[p]||a[ue[p]]||0),A.write_shift(1,U[p]||0),A.write_shift(1,2),A.write_shift(4,0),A.write_shift(1,0),A.write_shift(4,0),A.write_shift(4,0),C+=se[p]||a[ue[p]]||0}var ne=c.next(264);for(ne.write_shift(4,13),p=0;p<65;++p)ne.write_shift(4,0);for(p=0;p<g.length;++p){var b=c.next(D);for(b.write_shift(1,0),C=0;C<d.length;++C)if(d[C]!=null)switch(ue[C]){case"L":b.write_shift(1,g[p][C]==null?63:g[p][C]?84:70);break;case"B":b.write_shift(8,g[p][C]||0,"f");break;case"N":var R="0";for(typeof g[p][C]=="number"&&(R=g[p][C].toFixed(U[C]||0)),R.length>se[C]&&(R=R.slice(0,se[C])),F=0;F<se[C]-R.length;++F)b.write_shift(1,32);b.write_shift(1,R,"sbcs");break;case"D":g[p][C]?(b.write_shift(4,("0000"+g[p][C].getFullYear()).slice(-4),"sbcs"),b.write_shift(2,("00"+(g[p][C].getMonth()+1)).slice(-2),"sbcs"),b.write_shift(2,("00"+g[p][C].getDate()).slice(-2),"sbcs")):b.write_shift(8,"00000000","sbcs");break;case"C":var Z=b.l,ie=String(g[p][C]!=null?g[p][C]:"").slice(0,se[C]);for(b.write_shift(1,ie,"cpstr"),Z+=se[C]-b.l,F=0;F<Z;++F)b.write_shift(1,32);break}}return Ei=f,c.next(1).write_shift(1,26),c.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}}(),w6=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+vr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1").replace("{","\\{")+"|\\|)","gm");try{r=new RegExp("\x1BN("+vr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm")}catch{}var t=function(d,g){var v=e[g];return typeof v=="number"?wy(v):v},n=function(d,g,v){var p=g.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return p==59?d:wy(p)};e["|"]=254;var i=function(d){return d.replace(/\n/g,"\x1B :").replace(/\r/g,"\x1B =")};function a(d,g){switch(g.type){case"base64":return o(ga(d),g);case"binary":return o(d,g);case"buffer":return o(Et&&Buffer.isBuffer(d)?d.toString("binary"):go(d),g);case"array":return o(rg(d),g)}throw new Error("Unrecognized type "+g.type)}function o(d,g){var v=d.split(/[\n\r]+/),p=-1,C=-1,F=0,D=0,ee=[],ue=[],se=null,U={},re=[],m=[],_=[],x=0,B,Q={Workbook:{WBProps:{},Names:[]}};for(+g.codepage>=0&&Rl(+g.codepage);F!==v.length;++F){x=0;var A=v[F].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,t),W=A.replace(/;;/g,"\0").split(";").map(function(T){return T.replace(/\u0000/g,";")}),ne=W[0],b;if(A.length>0)switch(ne){case"ID":break;case"E":break;case"B":break;case"O":for(D=1;D<W.length;++D)switch(W[D].charAt(0)){case"V":{var R=parseInt(W[D].slice(1),10);R>=1&&R<=4&&(Q.Workbook.WBProps.date1904=!0)}break}break;case"W":break;case"P":switch(W[1].charAt(0)){case"P":ue.push(A.slice(3).replace(/;;/g,";"));break}break;case"NN":{var Z={Sheet:0};for(D=1;D<W.length;++D)switch(W[D].charAt(0)){case"N":Z.Name=W[D].slice(1);break;case"E":Z.Ref=(g&&g.sheet||"Sheet1")+"!"+rw(W[D].slice(1));break}Q.Workbook.Names.push(Z)}break;case"C":var ie=!1,ve=!1,le=!1,ge=!1,Se=-1,Ee=-1,Re="",ze="z",P="";for(D=1;D<W.length;++D)switch(W[D].charAt(0)){case"A":P=W[D].slice(1);break;case"X":C=parseInt(W[D].slice(1),10)-1,ve=!0;break;case"Y":for(p=parseInt(W[D].slice(1),10)-1,ve||(C=0),B=ee.length;B<=p;++B)ee[B]=[];break;case"K":b=W[D].slice(1),b.charAt(0)==='"'?(b=b.slice(1,b.length-1),ze="s"):b==="TRUE"||b==="FALSE"?(b=b==="TRUE",ze="b"):isNaN(Pi(b))||(b=Pi(b),ze="n",se!==null&&mo(se)&&g.cellDates&&(b=Qo(Q.Workbook.WBProps.date1904?b+1462:b),ze=typeof b=="number"?"n":"d")),ie=!0;break;case"E":ge=!0,Re=rw(W[D].slice(1),{r:p,c:C});break;case"S":le=!0;break;case"G":break;case"R":Se=parseInt(W[D].slice(1),10)-1;break;case"C":Ee=parseInt(W[D].slice(1),10)-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+A)}if(ie&&(ee[p][C]?(ee[p][C].t=ze,ee[p][C].v=b):ee[p][C]={t:ze,v:b},se&&(ee[p][C].z=se),g.cellText!==!1&&se&&(ee[p][C].w=Ii(ee[p][C].z,ee[p][C].v,{date1904:Q.Workbook.WBProps.date1904})),se=null),le){if(ge)throw new Error("SYLK shared formula cannot have own formula");var H=Se>-1&&ee[Se][Ee];if(!H||!H[1])throw new Error("SYLK shared formula cannot find base");Re=_8(H[1],{r:p-Se,c:C-Ee})}Re&&(ee[p][C]?ee[p][C].f=Re:ee[p][C]={t:"n",f:Re}),P&&(ee[p][C]||(ee[p][C]={t:"z"}),ee[p][C].c=[{a:"SheetJSYLK",t:P}]);break;case"F":var O=0;for(D=1;D<W.length;++D)switch(W[D].charAt(0)){case"X":C=parseInt(W[D].slice(1),10)-1,++O;break;case"Y":for(p=parseInt(W[D].slice(1),10)-1,B=ee.length;B<=p;++B)ee[B]=[];break;case"M":x=parseInt(W[D].slice(1),10)/20;break;case"F":break;case"G":break;case"P":se=ue[parseInt(W[D].slice(1),10)];break;case"S":break;case"D":break;case"N":break;case"W":for(_=W[D].slice(1).split(" "),B=parseInt(_[0],10);B<=parseInt(_[1],10);++B)x=parseInt(_[2],10),m[B-1]=x===0?{hidden:!0}:{wch:x};break;case"C":C=parseInt(W[D].slice(1),10)-1,m[C]||(m[C]={});break;case"R":p=parseInt(W[D].slice(1),10)-1,re[p]||(re[p]={}),x>0?(re[p].hpt=x,re[p].hpx=XS(x)):x===0&&(re[p].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+A)}O<1&&(se=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+A)}}return re.length>0&&(U["!rows"]=re),m.length>0&&(U["!cols"]=m),m.forEach(function(T){vg(T)}),g&&g.sheetRows&&(ee=ee.slice(0,g.sheetRows)),[ee,U,Q]}function s(d,g){var v=a(d,g),p=v[0],C=v[1],F=v[2],D=Qr(g);D.date1904=(((F||{}).Workbook||{}).WBProps||{}).date1904;var ee=Os(p,D);vr(C).forEach(function(se){ee[se]=C[se]});var ue=Ts(ee,g);return vr(F).forEach(function(se){ue[se]=F[se]}),ue.bookType="sylk",ue}function l(d,g,v,p,C,F){var D="C;Y"+(v+1)+";X"+(p+1)+";K";switch(d.t){case"n":D+=d.v||0,d.f&&!d.F&&(D+=";E"+Gc(d.f,{r:v,c:p}));break;case"b":D+=d.v?"TRUE":"FALSE";break;case"e":D+=d.w||d.v;break;case"d":D+=Ur(cn(d.v,F),F);break;case"s":D+='"'+(d.v==null?"":String(d.v)).replace(/"/g,"").replace(/;/g,";;")+'"';break}return D}function u(d,g,v){var p="C;Y"+(g+1)+";X"+(v+1)+";A";return p+=i(d.map(function(C){return C.t}).join("")),p}function f(d,g){g.forEach(function(v,p){var C="F;W"+(p+1)+" "+(p+1)+" ";v.hidden?C+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=Wf(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=$f(v.wpx)),typeof v.wch=="number"&&(C+=Math.round(v.wch))),C.charAt(C.length-1)!=" "&&d.push(C)})}function c(d,g){g.forEach(function(v,p){var C="F;";v.hidden?C+="M0;":v.hpt?C+="M"+20*v.hpt+";":v.hpx&&(C+="M"+20*Uf(v.hpx)+";"),C.length>2&&d.push(C+"R"+(p+1))})}function h(d,g,v){g||(g={}),g._formats=["General"];var p=["ID;PSheetJS;N;E"],C=[],F=Ut(d["!ref"]||"A1"),D,ee=d["!data"]!=null,ue=`\r
`,se=(((v||{}).Workbook||{}).WBProps||{}).date1904,U="General";p.push("P;PGeneral");var re=F.s.r,m=F.s.c,_=[];if(d["!ref"]){for(re=F.s.r;re<=F.e.r;++re)if(!(ee&&!d["!data"][re])){for(_=[],m=F.s.c;m<=F.e.c;++m)D=ee?d["!data"][re][m]:d[Ot(m)+kt(re)],!(!D||!D.c)&&_.push(u(D.c,re,m));_.length&&C.push(_.join(ue))}}if(d["!ref"]){for(re=F.s.r;re<=F.e.r;++re)if(!(ee&&!d["!data"][re])){for(_=[],m=F.s.c;m<=F.e.c;++m)if(D=ee?d["!data"][re][m]:d[Ot(m)+kt(re)],!(!D||D.v==null&&(!D.f||D.F))){if((D.z||(D.t=="d"?Wt[14]:"General"))!=U){var x=g._formats.indexOf(D.z);x==-1&&(g._formats.push(D.z),x=g._formats.length-1,p.push("P;P"+D.z.replace(/;/g,";;"))),_.push("F;P"+x+";Y"+(re+1)+";X"+(m+1))}_.push(l(D,d,re,m,g,se))}C.push(_.join(ue))}}return p.push("F;P0;DG0G8;M255"),d["!cols"]&&f(p,d["!cols"]),d["!rows"]&&c(p,d["!rows"]),d["!ref"]&&p.push("B;Y"+(F.e.r-F.s.r+1)+";X"+(F.e.c-F.s.c+1)+";D"+[F.s.c,F.s.r,F.e.c,F.e.r].join(" ")),p.push("O;L;D;B"+(se?";V4":"")+";K47;G100 0.001"),delete g._formats,p.join(ue)+ue+C.join(ue)+ue+"E"+ue}return{to_workbook:s,from_sheet:h}}(),_6=function(){function e(s,l){switch(l.type){case"base64":return r(ga(s),l);case"binary":return r(s,l);case"buffer":return r(Et&&Buffer.isBuffer(s)?s.toString("binary"):go(s),l);case"array":return r(rg(s),l)}throw new Error("Unrecognized type "+l.type)}function r(s,l){for(var u=s.split(`
`),f=-1,c=-1,h=0,d=[];h!==u.length;++h){if(u[h].trim()==="BOT"){d[++f]=[],c=0;continue}if(!(f<0)){var g=u[h].trim().split(","),v=g[0],p=g[1];++h;for(var C=u[h]||"";(C.match(/["]/g)||[]).length&1&&h<u.length-1;)C+=`
`+u[++h];switch(C=C.trim(),+v){case-1:if(C==="BOT"){d[++f]=[],c=0;continue}else if(C!=="EOD")throw new Error("Unrecognized DIF special command "+C);break;case 0:C==="TRUE"?d[f][c]=!0:C==="FALSE"?d[f][c]=!1:isNaN(Pi(p))?isNaN(Lf(p).getDate())?d[f][c]=p:(d[f][c]=cn(p),l&&l.UTC||(d[f][c]=vs(d[f][c]))):d[f][c]=Pi(p),++c;break;case 1:C=C.slice(1,C.length-1),C=C.replace(/""/g,'"'),C&&C.match(/^=".*"$/)&&(C=C.slice(2,-1)),d[f][c++]=C!==""?C:null;break}if(C==="EOD")break}}return l&&l.sheetRows&&(d=d.slice(0,l.sheetRows)),d}function t(s,l){return Os(e(s,l),l)}function n(s,l){var u=Ts(t(s,l),l);return u.bookType="dif",u}function i(s,l){return"0,"+String(s)+`\r
`+l}function a(s){return`1,0\r
"`+s.replace(/"/g,'""')+'"'}function o(s){if(!s["!ref"])throw new Error("Cannot export empty sheet to DIF");for(var l=Ut(s["!ref"]),u=s["!data"]!=null,f=[`TABLE\r
0,1\r
"sheetjs"\r
`,`VECTORS\r
0,`+(l.e.r-l.s.r+1)+`\r
""\r
`,`TUPLES\r
0,`+(l.e.c-l.s.c+1)+`\r
""\r
`,`DATA\r
0,0\r
""\r
`],c=l.s.r;c<=l.e.r;++c){for(var h=u?s["!data"][c]:[],d=`-1,0\r
BOT\r
`,g=l.s.c;g<=l.e.c;++g){var v=u?h&&h[g]:s[Qt({r:c,c:g})];if(v==null){d+=`1,0\r
""\r
`;continue}switch(v.t){case"n":v.w!=null?d+="0,"+v.w+`\r
V`:v.v!=null?d+=i(v.v,"V"):v.f!=null&&!v.F?d+=a("="+v.f):d+=`1,0\r
""`;break;case"b":d+=v.v?i(1,"TRUE"):i(0,"FALSE");break;case"s":d+=a(isNaN(+v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=Ii(v.z||Wt[14],Ur(cn(v.v)))),d+=i(v.w,"V");break;default:d+=`1,0\r
""`}d+=`\r
`}f.push(d)}return f.join("")+`-1,0\r
EOD`}return{to_workbook:n,to_sheet:t,from_sheet:o}}(),jS=function(){function e(c){return c.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(c){return c.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(c,h){for(var d=c.split(`
`),g=-1,v=-1,p=0,C=[];p!==d.length;++p){var F=d[p].trim().split(":");if(F[0]==="cell"){var D=Kt(F[1]);if(C.length<=D.r)for(g=C.length;g<=D.r;++g)C[g]||(C[g]=[]);switch(g=D.r,v=D.c,F[2]){case"t":C[g][v]=e(F[3]);break;case"v":C[g][v]=+F[3];break;case"vtf":var ee=F[F.length-1];case"vtc":switch(F[3]){case"nl":C[g][v]=!!+F[4];break;default:C[g][v]=+F[4];break}F[2]=="vtf"&&(C[g][v]=[C[g][v],ee])}}}return h&&h.sheetRows&&(C=C.slice(0,h.sheetRows)),C}function n(c,h){return Os(t(c,h),h)}function i(c,h){return Ts(n(c,h),h)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,s=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(c){if(!c||!c["!ref"])return"";for(var h=[],d=[],g,v="",p=$r(c["!ref"]),C=c["!data"]!=null,F=p.s.r;F<=p.e.r;++F)for(var D=p.s.c;D<=p.e.c;++D)if(v=Qt({r:F,c:D}),g=C?(c["!data"][F]||[])[D]:c[v],!(!g||g.v==null||g.t==="z")){switch(d=["cell",v,"t"],g.t){case"s":case"str":d.push(r(g.v));break;case"n":g.f?(d[2]="vtf",d[3]="n",d[4]=g.v,d[5]=r(g.f)):(d[2]="v",d[3]=g.v);break;case"b":d[2]="vt"+(g.f?"f":"c"),d[3]="nl",d[4]=g.v?"1":"0",d[5]=r(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var ee=Ur(cn(g.v));d[2]="vtc",d[3]="nd",d[4]=""+ee,d[5]=g.w||Ii(g.z||Wt[14],ee);break;case"e":continue}h.push(d.join(":"))}return h.push("sheet:c:"+(p.e.c-p.s.c+1)+":r:"+(p.e.r-p.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function f(c){return[a,o,s,o,u(c),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:f}}(),C6=function(){function e(f,c,h,d,g){g.raw?c[h][d]=f:f===""||(f==="TRUE"?c[h][d]=!0:f==="FALSE"?c[h][d]=!1:isNaN(Pi(f))?isNaN(Lf(f).getDate())?c[h][d]=f:c[h][d]=cn(f):c[h][d]=Pi(f))}function r(f,c){var h=c||{},d=[];if(!f||f.length===0)return d;for(var g=f.split(/[\r\n]/),v=g.length-1;v>=0&&g[v].length===0;)--v;for(var p=10,C=0,F=0;F<=v;++F)C=g[F].indexOf(" "),C==-1?C=g[F].length:C++,p=Math.max(p,C);for(F=0;F<=v;++F){d[F]=[];var D=0;for(e(g[F].slice(0,p).trim(),d,F,D,h),D=1;D<=(g[F].length-p)/10+1;++D)e(g[F].slice(p+(D-1)*10,p+D*10).trim(),d,F,D,h)}return h.sheetRows&&(d=d.slice(0,h.sheetRows)),d}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(f){for(var c={},h=!1,d=0,g=0;d<f.length;++d)(g=f.charCodeAt(d))==34?h=!h:!h&&g in t&&(c[g]=(c[g]||0)+1);g=[];for(d in c)Object.prototype.hasOwnProperty.call(c,d)&&g.push([c[d],d]);if(!g.length){c=n;for(d in c)Object.prototype.hasOwnProperty.call(c,d)&&g.push([c[d],d])}return g.sort(function(v,p){return v[0]-p[0]||n[v[1]]-n[p[1]]}),t[g.pop()[1]]||44}function a(f,c){var h=c||{},d="",g={};h.dense&&(g["!data"]=[]);var v={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(d=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(d=f.charAt(4),f=f.slice(6)):d=i(f.slice(0,1024)):h&&h.FS?d=h.FS:d=i(f.slice(0,1024));var p=0,C=0,F=0,D=0,ee=0,ue=d.charCodeAt(0),se=!1,U=0,re=f.charCodeAt(0),m=h.dateNF!=null?x3(h.dateNF):null;function _(){var x=f.slice(D,ee);x.slice(-1)=="\r"&&(x=x.slice(0,-1));var B={};if(x.charAt(0)=='"'&&x.charAt(x.length-1)=='"'&&(x=x.slice(1,-1).replace(/""/g,'"')),h.cellText!==!1&&(B.w=x),x.length===0)B.t="z";else if(h.raw)B.t="s",B.v=x;else if(x.trim().length===0)B.t="s",B.v=x;else if(x.charCodeAt(0)==61)x.charCodeAt(1)==34&&x.charCodeAt(x.length-1)==34?(B.t="s",B.v=x.slice(2,-1).replace(/""/g,'"')):C8(x)?(B.t="s",B.f=x.slice(1),B.v=x):(B.t="s",B.v=x);else if(x=="TRUE")B.t="b",B.v=!0;else if(x=="FALSE")B.t="b",B.v=!1;else if(!isNaN(F=Pi(x)))B.t="n",B.v=F;else if(!isNaN((F=Lf(x)).getDate())||m&&x.match(m)){if(B.z=h.dateNF||Wt[14],m&&x.match(m)){var Q=E3(x,h.dateNF,x.match(m)||[]);F=cn(Q),h&&h.UTC===!1&&(F=vs(F))}else h&&h.UTC===!1?F=vs(F):h.cellText!==!1&&h.dateNF&&(B.w=Ii(B.z,F));h.cellDates?(B.t="d",B.v=F):(B.t="n",B.v=Ur(F)),h.cellNF||delete B.z}else B.t="s",B.v=x;if(B.t=="z"||(h.dense?(g["!data"][p]||(g["!data"][p]=[]),g["!data"][p][C]=B):g[Qt({c:C,r:p})]=B),D=ee+1,re=f.charCodeAt(D),v.e.c<C&&(v.e.c=C),v.e.r<p&&(v.e.r=p),U==ue)++C;else if(C=0,++p,h.sheetRows&&h.sheetRows<=p)return!0}e:for(;ee<f.length;++ee)switch(U=f.charCodeAt(ee)){case 34:re===34&&(se=!se);break;case 13:if(se)break;f.charCodeAt(ee+1)==10&&++ee;case ue:case 10:if(!se&&_())break e;break}return ee-D>0&&_(),g["!ref"]=gr(v),g}function o(f,c){return!(c&&c.PRN)||c.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?a(f,c):Os(r(f,c),c)}function s(f,c){var h="",d=c.type=="string"?[0,0,0,0]:KU(f,c);switch(c.type){case"base64":h=ga(f);break;case"binary":h=f;break;case"buffer":c.codepage==65001?h=f.toString("utf8"):c.codepage&&typeof Hs<"u"?h=Hs.utils.decode(c.codepage,f):h=Et&&Buffer.isBuffer(f)?f.toString("binary"):go(f);break;case"array":h=rg(f);break;case"string":h=f;break;default:throw new Error("Unrecognized type "+c.type)}return d[0]==239&&d[1]==187&&d[2]==191?h=es(h.slice(3)):c.type!="string"&&c.type!="buffer"&&c.codepage==65001?h=es(h):c.type=="binary"&&typeof Hs<"u"&&c.codepage&&(h=Hs.utils.decode(c.codepage,Hs.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?jS.to_sheet(c.type=="string"?h:es(h),c):o(h,c)}function l(f,c){return Ts(s(f,c),c)}function u(f){var c=[];if(!f["!ref"])return"";for(var h=Ut(f["!ref"]),d,g=f["!data"]!=null,v=h.s.r;v<=h.e.r;++v){for(var p=[],C=h.s.c;C<=h.e.c;++C){var F=Qt({r:v,c:C});if(d=g?(f["!data"][v]||[])[C]:f[F],!d||d.v==null){p.push("          ");continue}for(var D=(d.w||(Hi(d),d.w)||"").slice(0,10);D.length<10;)D+=" ";p.push(D+(C===0?" ":""))}c.push(p.join(""))}return c.join(`
`)}return{to_workbook:l,to_sheet:s,from_sheet:u}}(),Jy=function(){function e(P,H,O){if(P){on(P,P.l||0);for(var T=O.Enum||ge;P.l<P.length;){var Y=P.read_shift(2),q=T[Y]||T[65535],ae=P.read_shift(2),he=P.l+ae,oe=q.f&&q.f(P,ae,O);if(P.l=he,H(oe,q,Y))return}}}function r(P,H){switch(H.type){case"base64":return n(wn(ga(P)),H);case"binary":return n(wn(P),H);case"buffer":case"array":return n(P,H)}throw"Unsupported type "+H.type}var t=["mmmm","dd-mmm-yyyy","dd-mmm","mmm-yyyy","@","mm/dd","hh:mm:ss AM/PM","hh:mm AM/PM","mm/dd/yyyy","mm/dd","hh:mm:ss","hh:mm"];function n(P,H){if(!P)return P;var O=H||{},T={},Y="Sheet1",q="",ae=0,he={},oe=[],be=[],ce=[];O.dense&&(ce=T["!data"]=[]);var Ce={s:{r:0,c:0},e:{r:0,c:0}},Me=O.sheetRows||0,Fe={};if(P[4]==81&&P[5]==80&&P[6]==87)return ze(P,H);if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)O.Enum=ge,e(P,function(we,et,ut){switch(ut){case 0:O.vers=we,we>=4096&&(O.qpro=!0);break;case 255:O.vers=we,O.works=!0;break;case 6:Ce=we;break;case 204:we&&(q=we);break;case 222:q=we;break;case 15:case 51:(!O.qpro&&!O.works||ut==51)&&we[1].v.charCodeAt(0)<48&&(we[1].v=we[1].v.slice(1)),(O.works||O.works2)&&(we[1].v=we[1].v.replace(/\r\n/g,`
`));case 13:case 14:case 16:(we[2]&112)==112&&(we[2]&15)>1&&(we[2]&15)<15&&(we[1].z=O.dateNF||t[(we[2]&15)-1]||Wt[14],O.cellDates&&(we[1].v=Qo(we[1].v),we[1].t=typeof we[1].v=="number"?"n":"d")),O.qpro&&we[3]>ae&&(T["!ref"]=gr(Ce),he[Y]=T,oe.push(Y),T={},O.dense&&(ce=T["!data"]=[]),Ce={s:{r:0,c:0},e:{r:0,c:0}},ae=we[3],Y=q||"Sheet"+(ae+1),q="");var nt=O.dense?(ce[we[0].r]||[])[we[0].c]:T[Qt(we[0])];if(nt){nt.t=we[1].t,nt.v=we[1].v,we[1].z!=null&&(nt.z=we[1].z),we[1].f!=null&&(nt.f=we[1].f),Fe=nt;break}O.dense?(ce[we[0].r]||(ce[we[0].r]=[]),ce[we[0].r][we[0].c]=we[1]):T[Qt(we[0])]=we[1],Fe=we[1];break;case 21509:O.works2=!0;break;case 21506:we==5281&&(Fe.z="hh:mm:ss",O.cellDates&&Fe.t=="n"&&(Fe.v=Qo(Fe.v),Fe.t=typeof Fe.v=="number"?"n":"d"));break}},O);else if(P[2]==26||P[2]==14)O.Enum=Se,P[2]==14&&(O.qpro=!0,P.l=0),e(P,function(we,et,ut){switch(ut){case 204:Y=we;break;case 22:we[1].v.charCodeAt(0)<48&&(we[1].v=we[1].v.slice(1)),we[1].v=we[1].v.replace(/\x0F./g,function(nt){return String.fromCharCode(nt.charCodeAt(1)-32)}).replace(/\r\n/g,`
`);case 23:case 24:case 25:case 37:case 39:case 40:if(we[3]>ae&&(T["!ref"]=gr(Ce),he[Y]=T,oe.push(Y),T={},O.dense&&(ce=T["!data"]=[]),Ce={s:{r:0,c:0},e:{r:0,c:0}},ae=we[3],Y="Sheet"+(ae+1)),Me>0&&we[0].r>=Me)break;O.dense?(ce[we[0].r]||(ce[we[0].r]=[]),ce[we[0].r][we[0].c]=we[1]):T[Qt(we[0])]=we[1],Ce.e.c<we[0].c&&(Ce.e.c=we[0].c),Ce.e.r<we[0].r&&(Ce.e.r=we[0].r);break;case 27:we[14e3]&&(be[we[14e3][0]]=we[14e3][1]);break;case 1537:be[we[0]]=we[1],we[0]==ae&&(Y=we[1]);break}},O);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(T["!ref"]=gr(Ce),he[q||Y]=T,oe.push(q||Y),!be.length)return{SheetNames:oe,Sheets:he};for(var ke={},de=[],Oe=0;Oe<be.length;++Oe)he[oe[Oe]]?(de.push(be[Oe]||oe[Oe]),ke[be[Oe]]=he[be[Oe]]||he[oe[Oe]]):(de.push(be[Oe]),ke[be[Oe]]={"!ref":"A1"});return{SheetNames:de,Sheets:ke}}function i(P,H){var O=H||{};if(+O.codepage>=0&&Rl(+O.codepage),O.type=="string")throw new Error("Cannot write WK1 to JS string");var T=Zr();if(!P["!ref"])throw new Error("Cannot export empty sheet to WK1");var Y=Ut(P["!ref"]),q=P["!data"]!=null,ae=[];_e(T,0,o(1030)),_e(T,6,u(Y));for(var he=Math.min(Y.e.r,8191),oe=Y.s.c;oe<=Y.e.c;++oe)ae[oe]=Ot(oe);for(var be=Y.s.r;be<=he;++be){var ce=kt(be);for(oe=Y.s.c;oe<=Y.e.c;++oe){var Ce=q?(P["!data"][be]||[])[oe]:P[ae[oe]+ce];if(!(!Ce||Ce.t=="z"))switch(Ce.t){case"n":(Ce.v|0)==Ce.v&&Ce.v>=-32768&&Ce.v<=32767?_e(T,13,p(be,oe,Ce)):_e(T,14,F(be,oe,Ce));break;case"d":var Me=Ur(Ce.v);(Me|0)==Me&&Me>=-32768&&Me<=32767?_e(T,13,p(be,oe,{t:"n",v:Me,z:Ce.z||Wt[14]})):_e(T,14,F(be,oe,{t:"n",v:Me,z:Ce.z||Wt[14]}));break;default:var Fe=Hi(Ce);_e(T,15,d(be,oe,Fe.slice(0,239)))}}}return _e(T,1),T.end()}function a(P,H){var O=H||{};if(+O.codepage>=0&&Rl(+O.codepage),O.type=="string")throw new Error("Cannot write WK3 to JS string");var T=Zr();_e(T,0,s(P));for(var Y=0,q=0;Y<P.SheetNames.length;++Y)(P.Sheets[P.SheetNames[Y]]||{})["!ref"]&&_e(T,27,le(P.SheetNames[Y],q++));var ae=0;for(Y=0;Y<P.SheetNames.length;++Y){var he=P.Sheets[P.SheetNames[Y]];if(!(!he||!he["!ref"])){for(var oe=Ut(he["!ref"]),be=he["!data"]!=null,ce=[],Ce=Math.min(oe.e.r,8191),Me=oe.s.r;Me<=Ce;++Me)for(var Fe=kt(Me),ke=oe.s.c;ke<=oe.e.c;++ke){Me===oe.s.r&&(ce[ke]=Ot(ke));var de=ce[ke]+Fe,Oe=be?(he["!data"][Me]||[])[ke]:he[de];if(!(!Oe||Oe.t=="z"))if(Oe.t=="n")_e(T,23,Q(Me,ke,ae,Oe.v));else{var we=Hi(Oe);_e(T,22,_(Me,ke,ae,we.slice(0,239)))}}++ae}}return _e(T,1),T.end()}function o(P){var H=fe(2);return H.write_shift(2,P),H}function s(P){var H=fe(26);H.write_shift(2,4096),H.write_shift(2,4),H.write_shift(4,0);for(var O=0,T=0,Y=0,q=0;q<P.SheetNames.length;++q){var ae=P.SheetNames[q],he=P.Sheets[ae];if(!(!he||!he["!ref"])){++Y;var oe=$r(he["!ref"]);O<oe.e.r&&(O=oe.e.r),T<oe.e.c&&(T=oe.e.c)}}return O>8191&&(O=8191),H.write_shift(2,O),H.write_shift(1,Y),H.write_shift(1,T),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(1,1),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(4,0),H}function l(P,H,O){var T={s:{c:0,r:0},e:{c:0,r:0}};return H==8&&O.qpro?(T.s.c=P.read_shift(1),P.l++,T.s.r=P.read_shift(2),T.e.c=P.read_shift(1),P.l++,T.e.r=P.read_shift(2),T):(T.s.c=P.read_shift(2),T.s.r=P.read_shift(2),H==12&&O.qpro&&(P.l+=2),T.e.c=P.read_shift(2),T.e.r=P.read_shift(2),H==12&&O.qpro&&(P.l+=2),T.s.c==65535&&(T.s.c=T.e.c=T.s.r=T.e.r=0),T)}function u(P){var H=fe(8);return H.write_shift(2,P.s.c),H.write_shift(2,P.s.r),H.write_shift(2,P.e.c),H.write_shift(2,P.e.r),H}function f(P,H,O){var T=[{c:0,r:0},{t:"n",v:0},0,0];return O.qpro&&O.vers!=20768?(T[0].c=P.read_shift(1),T[3]=P.read_shift(1),T[0].r=P.read_shift(2),P.l+=2):O.works?(T[0].c=P.read_shift(2),T[0].r=P.read_shift(2),T[2]=P.read_shift(2)):(T[2]=P.read_shift(1),T[0].c=P.read_shift(2),T[0].r=P.read_shift(2)),T}function c(P){return P.z&&mo(P.z)?240|(t.indexOf(P.z)+1||2):255}function h(P,H,O){var T=P.l+H,Y=f(P,H,O);if(Y[1].t="s",(O.vers&65534)==20768){P.l++;var q=P.read_shift(1);return Y[1].v=P.read_shift(q,"utf8"),Y}return O.qpro&&P.l++,Y[1].v=P.read_shift(T-P.l,"cstr"),Y}function d(P,H,O){var T=fe(7+O.length);T.write_shift(1,255),T.write_shift(2,H),T.write_shift(2,P),T.write_shift(1,39);for(var Y=0;Y<T.length;++Y){var q=O.charCodeAt(Y);T.write_shift(1,q>=128?95:q)}return T.write_shift(1,0),T}function g(P,H,O){var T=P.l+H,Y=f(P,H,O);if(Y[1].t="s",O.vers==20768){var q=P.read_shift(1);return Y[1].v=P.read_shift(q,"utf8"),Y}return Y[1].v=P.read_shift(T-P.l,"cstr"),Y}function v(P,H,O){var T=f(P,H,O);return T[1].v=P.read_shift(2,"i"),T}function p(P,H,O){var T=fe(7);return T.write_shift(1,c(O)),T.write_shift(2,H),T.write_shift(2,P),T.write_shift(2,O.v,"i"),T}function C(P,H,O){var T=f(P,H,O);return T[1].v=P.read_shift(8,"f"),T}function F(P,H,O){var T=fe(13);return T.write_shift(1,c(O)),T.write_shift(2,H),T.write_shift(2,P),T.write_shift(8,O.v,"f"),T}function D(P,H,O){var T=P.l+H,Y=f(P,H,O);if(Y[1].v=P.read_shift(8,"f"),O.qpro)P.l=T;else{var q=P.read_shift(2);U(P.slice(P.l,P.l+q),Y),P.l+=q}return Y}function ee(P,H,O){var T=H&32768;return H&=-32769,H=(T?P:0)+(H>=8192?H-16384:H),(T?"":"$")+(O?Ot(H):kt(H))}var ue={31:["NA",0],33:["ABS",1],34:["TRUNC",1],35:["SQRT",1],36:["LOG",1],37:["LN",1],38:["PI",0],39:["SIN",1],40:["COS",1],41:["TAN",1],42:["ATAN2",2],43:["ATAN",1],44:["ASIN",1],45:["ACOS",1],46:["EXP",1],47:["MOD",2],49:["ISNA",1],50:["ISERR",1],51:["FALSE",0],52:["TRUE",0],53:["RAND",0],54:["DATE",3],63:["ROUND",2],64:["TIME",3],68:["ISNUMBER",1],69:["ISTEXT",1],70:["LEN",1],71:["VALUE",1],73:["MID",3],74:["CHAR",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],102:["UPPER",1],103:["LOWER",1],107:["PROPER",1],109:["TRIM",1],111:["T",1]},se=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function U(P,H){on(P,0);for(var O=[],T=0,Y="",q="",ae="",he="";P.l<P.length;){var oe=P[P.l++];switch(oe){case 0:O.push(P.read_shift(8,"f"));break;case 1:q=ee(H[0].c,P.read_shift(2),!0),Y=ee(H[0].r,P.read_shift(2),!1),O.push(q+Y);break;case 2:{var be=ee(H[0].c,P.read_shift(2),!0),ce=ee(H[0].r,P.read_shift(2),!1);q=ee(H[0].c,P.read_shift(2),!0),Y=ee(H[0].r,P.read_shift(2),!1),O.push(be+ce+":"+q+Y)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:O.push("("+O.pop()+")");break;case 5:O.push(P.read_shift(2));break;case 6:{for(var Ce="";oe=P[P.l++];)Ce+=String.fromCharCode(oe);O.push('"'+Ce.replace(/"/g,'""')+'"')}break;case 8:O.push("-"+O.pop());break;case 23:O.push("+"+O.pop());break;case 22:O.push("NOT("+O.pop()+")");break;case 20:case 21:he=O.pop(),ae=O.pop(),O.push(["AND","OR"][oe-20]+"("+ae+","+he+")");break;default:if(oe<32&&se[oe])he=O.pop(),ae=O.pop(),O.push(ae+se[oe]+he);else if(ue[oe]){if(T=ue[oe][1],T==69&&(T=P[P.l++]),T>O.length){console.error("WK1 bad formula parse 0x"+oe.toString(16)+":|"+O.join("|")+"|");return}var Me=O.slice(-T);O.length-=T,O.push(ue[oe][0]+"("+Me.join(",")+")")}else return oe<=7?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=24?console.error("WK1 unsupported op "+oe.toString(16)):oe<=30?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=115?console.error("WK1 unsupported function opcode "+oe.toString(16)):console.error("WK1 unrecognized opcode "+oe.toString(16))}}O.length==1?H[1].f=""+O[0]:console.error("WK1 bad formula parse |"+O.join("|")+"|")}function re(P){var H=[{c:0,r:0},{t:"n",v:0},0];return H[0].r=P.read_shift(2),H[3]=P[P.l++],H[0].c=P[P.l++],H}function m(P,H){var O=re(P);return O[1].t="s",O[1].v=P.read_shift(H-4,"cstr"),O}function _(P,H,O,T){var Y=fe(6+T.length);Y.write_shift(2,P),Y.write_shift(1,O),Y.write_shift(1,H),Y.write_shift(1,39);for(var q=0;q<T.length;++q){var ae=T.charCodeAt(q);Y.write_shift(1,ae>=128?95:ae)}return Y.write_shift(1,0),Y}function x(P,H){var O=re(P);O[1].v=P.read_shift(2);var T=O[1].v>>1;if(O[1].v&1)switch(T&7){case 0:T=(T>>3)*5e3;break;case 1:T=(T>>3)*500;break;case 2:T=(T>>3)/20;break;case 3:T=(T>>3)/200;break;case 4:T=(T>>3)/2e3;break;case 5:T=(T>>3)/2e4;break;case 6:T=(T>>3)/16;break;case 7:T=(T>>3)/64;break}return O[1].v=T,O}function B(P,H){var O=re(P),T=P.read_shift(4),Y=P.read_shift(4),q=P.read_shift(2);if(q==65535)return T===0&&Y===3221225472?(O[1].t="e",O[1].v=15):T===0&&Y===3489660928?(O[1].t="e",O[1].v=42):O[1].v=0,O;var ae=q&32768;return q=(q&32767)-16446,O[1].v=(1-ae*2)*(Y*Math.pow(2,q+32)+T*Math.pow(2,q)),O}function Q(P,H,O,T){var Y=fe(14);if(Y.write_shift(2,P),Y.write_shift(1,O),Y.write_shift(1,H),T==0)return Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(2,65535),Y;var q=0,ae=0,he=0,oe=0;return T<0&&(q=1,T=-T),ae=Math.log2(T)|0,T/=Math.pow(2,ae-31),oe=T>>>0,oe&2147483648||(T/=2,++ae,oe=T>>>0),T-=oe,oe|=2147483648,oe>>>=0,T*=Math.pow(2,32),he=T>>>0,Y.write_shift(4,he),Y.write_shift(4,oe),ae+=16383+(q?32768:0),Y.write_shift(2,ae),Y}function A(P,H){var O=B(P);return P.l+=H-14,O}function W(P,H){var O=re(P),T=P.read_shift(4);return O[1].v=T>>6,O}function ne(P,H){var O=re(P),T=P.read_shift(8,"f");return O[1].v=T,O}function b(P,H){var O=ne(P);return P.l+=H-12,O}function R(P,H){return P[P.l+H-1]==0?P.read_shift(H,"cstr"):""}function Z(P,H){var O=P[P.l++];O>H-1&&(O=H-1);for(var T="";T.length<O;)T+=String.fromCharCode(P[P.l++]);return T}function ie(P,H,O){if(!(!O.qpro||H<21)){var T=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var Y=P.read_shift(H-21,"cstr");return[T,Y]}}function ve(P,H){for(var O={},T=P.l+H;P.l<T;){var Y=P.read_shift(2);if(Y==14e3){for(O[Y]=[0,""],O[Y][0]=P.read_shift(2);P[P.l];)O[Y][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return O}function le(P,H){var O=fe(5+P.length);O.write_shift(2,14e3),O.write_shift(2,H);for(var T=0;T<P.length;++T){var Y=P.charCodeAt(T);O[O.l++]=Y>127?95:Y}return O[O.l++]=0,O}var ge={0:{n:"BOF",f:mf},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:C},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:D},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:R},222:{n:"SHEETNAMELP",f:Z},255:{n:"BOF",f:mf},21506:{n:"WKSNF",f:mf},65535:{n:""}},Se={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:m},23:{n:"NUMBER17",f:B},24:{n:"NUMBER18",f:x},25:{n:"FORMULA19",f:A},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ve},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:W},38:{n:"??"},39:{n:"NUMBER27",f:ne},40:{n:"FORMULA28",f:b},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:R},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ie},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},Ee={5:"dd-mmm-yy",6:"dd-mmm",7:"mmm-yy",8:"mm/dd/yy",10:"hh:mm:ss AM/PM",11:"hh:mm AM/PM",14:"dd-mmm-yyyy",15:"mmm-yyyy",34:"0.00",50:"0.00;[Red]0.00",66:"0.00;(0.00)",82:"0.00;[Red](0.00)",162:'"$"#,##0.00;\\("$"#,##0.00\\)',288:"0%",304:"0E+00",320:"# ?/?"};function Re(P){var H=P.read_shift(2),O=P.read_shift(1);if(O!=0)throw"unsupported QPW string type "+O.toString(16);return P.read_shift(H,"sbcs-cont")}function ze(P,H){on(P,0);var O=H||{},T={};O.dense&&(T["!data"]=[]);var Y=[],q="",ae={s:{r:-1,c:-1},e:{r:-1,c:-1}},he=0,oe=0,be=0,ce=0,Ce={SheetNames:[],Sheets:{}},Me=[];e:for(;P.l<P.length;){var Fe=P.read_shift(2),ke=P.read_shift(2),de=P.slice(P.l,P.l+ke);switch(on(de,0),Fe){case 1:if(de.read_shift(4)!=962023505)throw"Bad QPW9 BOF!";break;case 2:break e;case 8:break;case 10:for(var Oe=de.read_shift(4),we=(de.length-de.l)/Oe|0,et=0;et<Oe;++et){var ut=de.l+we,nt={};de.l+=2,nt.numFmtId=de.read_shift(2),Ee[nt.numFmtId]&&(nt.z=Ee[nt.numFmtId]),de.l=ut,Me.push(nt)}break;case 1025:break;case 1026:break;case 1031:for(de.l+=12;de.l<de.length;)he=de.read_shift(2),oe=de.read_shift(1),Y.push(de.read_shift(he,"cstr"));break;case 1032:break;case 1537:{var tr=de.read_shift(2);T={},O.dense&&(T["!data"]=[]),ae.s.c=de.read_shift(2),ae.e.c=de.read_shift(2),ae.s.r=de.read_shift(4),ae.e.r=de.read_shift(4),de.l+=4,de.l+2<de.length&&(he=de.read_shift(2),oe=de.read_shift(1),q=he==0?"":de.read_shift(he,"cstr")),q||(q=Ot(tr))}break;case 1538:{if(ae.s.c>255||ae.s.r>999999)break;ae.e.c<ae.s.c&&(ae.e.c=ae.s.c),ae.e.r<ae.s.r&&(ae.e.r=ae.s.r),T["!ref"]=gr(ae),wg(Ce,T,q)}break;case 2561:be=de.read_shift(2),ae.e.c<be&&(ae.e.c=be),ae.s.c>be&&(ae.s.c=be),ce=de.read_shift(4),ae.s.r>ce&&(ae.s.r=ce),ce=de.read_shift(4),ae.e.r<ce&&(ae.e.r=ce);break;case 3073:{ce=de.read_shift(4),he=de.read_shift(4),ae.s.r>ce&&(ae.s.r=ce),ae.e.r<ce+he-1&&(ae.e.r=ce+he-1);for(var Ve=Ot(be);de.l<de.length;){var Ie={t:"z"},Xe=de.read_shift(1),tt=-1;Xe&128&&(tt=de.read_shift(2));var Qe=Xe&64?de.read_shift(2)-1:0;switch(Xe&31){case 0:break;case 1:break;case 2:Ie={t:"n",v:de.read_shift(2)};break;case 3:Ie={t:"n",v:de.read_shift(2,"i")};break;case 4:Ie={t:"n",v:hg(de)};break;case 5:Ie={t:"n",v:de.read_shift(8,"f")};break;case 7:Ie={t:"s",v:Y[oe=de.read_shift(4)-1]};break;case 8:Ie={t:"n",v:de.read_shift(8,"f")},de.l+=2,de.l+=4,isNaN(Ie.v)&&(Ie={t:"e",v:15});break;default:throw"Unrecognized QPW cell type "+(Xe&31)}tt!=-1&&(Me[tt-1]||{}).z&&(Ie.z=Me[tt-1].z);var ot=0;if(Xe&32)switch(Xe&31){case 2:ot=de.read_shift(2);break;case 3:ot=de.read_shift(2,"i");break;case 7:ot=de.read_shift(2);break;default:throw"Unsupported delta for QPW cell type "+(Xe&31)}if(!(!O.sheetStubs&&Ie.t=="z")){var ht=Qr(Ie);Ie.t=="n"&&Ie.z&&mo(Ie.z)&&O.cellDates&&(ht.v=Qo(Ie.v),ht.t=typeof ht.v=="number"?"n":"d"),T["!data"]!=null?(T["!data"][ce]||(T["!data"][ce]=[]),T["!data"][ce][be]=ht):T[Ve+kt(ce)]=ht}for(++ce,--he;Qe-- >0&&he>=0;){if(Xe&32)switch(Xe&31){case 2:Ie={t:"n",v:Ie.v+ot&65535};break;case 3:Ie={t:"n",v:Ie.v+ot&65535},Ie.v>32767&&(Ie.v-=65536);break;case 7:Ie={t:"s",v:Y[oe=oe+ot>>>0]};break;default:throw"Cannot apply delta for QPW cell type "+(Xe&31)}else switch(Xe&31){case 1:Ie={t:"z"};break;case 2:Ie={t:"n",v:de.read_shift(2)};break;case 7:Ie={t:"s",v:Y[oe=de.read_shift(4)-1]};break;default:throw"Cannot apply repeat for QPW cell type "+(Xe&31)}!O.sheetStubs&&Ie.t=="z"||(T["!data"]!=null?(T["!data"][ce]||(T["!data"][ce]=[]),T["!data"][ce][be]=Ie):T[Ve+kt(ce)]=Ie),++ce,--he}}}break;case 3074:{be=de.read_shift(2),ce=de.read_shift(4);var it=Re(de);T["!data"]!=null?(T["!data"][ce]||(T["!data"][ce]=[]),T["!data"][ce][be]={t:"s",v:it}):T[Ot(be)+kt(ce)]={t:"s",v:it}}break}P.l+=ke}return Ce}return{sheet_to_wk1:i,book_to_wk3:a,to_workbook:r}}(),S6=/^\s|\s$|[\t\n\r]/;function b6(e,r){if(!r.bookSST)return"";var t=[mr];t[t.length]=Te("sst",null,{xmlns:Es[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],a="<si>";i.r?a+=i.r:(a+="<t",i.t||(i.t=""),typeof i.t!="string"&&(i.t=String(i.t)),i.t.match(S6)&&(a+=' xml:space="preserve"'),a+=">"+lt(i.t)+"</t>"),a+="</si>",t[t.length]=a}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function x6(e){return[e.read_shift(4),e.read_shift(4)]}function E6(e,r){return r||(r=fe(8)),r.write_shift(4,e.Count),r.write_shift(4,e.Unique),r}var T6=cB;function O6(e){var r=Zr();ye(r,159,E6(e));for(var t=0;t<e.length;++t)ye(r,19,T6(e[t]));return ye(r,160),r.end()}function R6(e){for(var r=[],t=e.split(""),n=0;n<t.length;++n)r[n]=t[n].charCodeAt(0);return r}function YS(e){var r=0,t,n=R6(e),i=n.length+1,a,o,s,l,u;for(t=vo(i),t[0]=n.length,a=1;a!=i;++a)t[a]=n[a-1];for(a=i-1;a>=0;--a)o=t[a],s=r&16384?1:0,l=r<<1&32767,u=s|l,r=u^o;return r^52811}function k6(e,r){var t=["{\\rtf1\\ansi"];if(!e["!ref"])return t[0]+"}";for(var n=Ut(e["!ref"]),i,a=e["!data"]!=null,o=[],s=n.s.r;s<=n.e.r;++s){t.push("\\trowd\\trautofit1");for(var l=n.s.c;l<=n.e.c;++l)t.push("\\cellx"+(l+1));for(t.push("\\pard\\intbl"),a&&(o=e["!data"][s]||[]),l=n.s.c;l<=n.e.c;++l){var u=Qt({r:s,c:l});if(i=a?o[l]:e[u],!i||i.v==null&&(!i.f||i.F)){t.push(" \\cell");continue}t.push(" "+(i.w||(Hi(i),i.w)||"").replace(/[\r\n]/g,"\\par ")),t.push("\\cell")}t.push("\\pard\\intbl\\row")}return t.join("")+"}"}function Qy(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}var A6=6,Ni=A6;function Wf(e){return Math.floor((e+Math.round(128/Ni)/256)*Ni)}function $f(e){return Math.floor((e-5)/Ni*100+.5)/100}function y0(e){return Math.round((e*Ni+5)/Ni*256)/256}function vg(e){e.width?(e.wpx=Wf(e.width),e.wch=$f(e.wpx),e.MDW=Ni):e.wpx?(e.wch=$f(e.wpx),e.width=y0(e.wch),e.MDW=Ni):typeof e.wch=="number"&&(e.width=y0(e.wch),e.wpx=Wf(e.width),e.MDW=Ni),e.customWidth&&delete e.customWidth}var M6=96,GS=M6;function Uf(e){return e*96/GS}function XS(e){return e*GS/96}function D6(e){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var n=t[0];n<=t[1];++n)e[n]!=null&&(r[r.length]=Te("numFmt",null,{numFmtId:n,formatCode:lt(e[n])}))}),r.length===1?"":(r[r.length]="</numFmts>",r[0]=Te("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function P6(e){var r=[];return r[r.length]=Te("cellXfs",null),e.forEach(function(t){r[r.length]=Te("xf",null,t)}),r[r.length]="</cellXfs>",r.length===2?"":(r[0]=Te("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function N6(e,r){var t=[mr,Te("styleSheet",null,{xmlns:Es[0],"xmlns:vt":Ar.vt})],n;return e.SSF&&(n=D6(e.SSF))!=null&&(t[t.length]=n),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=P6(r.cellXfs))&&(t[t.length]=n),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function F6(e,r){var t=e.read_shift(2),n=Jr(e);return[t,n]}function L6(e,r,t){t||(t=fe(6+4*r.length)),t.write_shift(2,e),br(r,t);var n=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),n}function I6(e,r,t){var n={};n.sz=e.read_shift(2)/20;var i=yB(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var s=e.read_shift(1);s>0&&(n.family=s);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=pB(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Jr(e),n}function H6(e,r){r||(r=fe(25+4*32)),r.write_shift(2,e.sz*20),wB(e,r),r.write_shift(2,e.bold?700:400);var t=0;e.vertAlign=="superscript"?t=1:e.vertAlign=="subscript"&&(t=2),r.write_shift(2,t),r.write_shift(1,e.underline||0),r.write_shift(1,e.family||0),r.write_shift(1,e.charset||0),r.write_shift(1,0),Hf(e.color,r);var n=0;return e.scheme=="major"&&(n=1),e.scheme=="minor"&&(n=2),r.write_shift(1,n),br(e.name,r),r.length>r.l?r.slice(0,r.l):r}var B6=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Ph,W6=di;function ew(e,r){r||(r=fe(4*3+8*7+16*1)),Ph||(Ph=tg(B6));var t=Ph[e.patternType];t==null&&(t=40),r.write_shift(4,t);var n=0;if(t!=40)for(Hf({auto:1},r),Hf({auto:1},r);n<12;++n)r.write_shift(4,0);else{for(;n<4;++n)r.write_shift(4,0);for(;n<12;++n)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function $6(e,r){var t=e.l+r,n=e.read_shift(2),i=e.read_shift(2);return e.l=t,{ixfe:n,numFmtId:i}}function KS(e,r,t){t||(t=fe(16)),t.write_shift(2,r||0),t.write_shift(2,e.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var n=0;return t.write_shift(1,n),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function Bs(e,r){return r||(r=fe(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var U6=di;function V6(e,r){return r||(r=fe(51)),r.write_shift(1,0),Bs(null,r),Bs(null,r),Bs(null,r),Bs(null,r),Bs(null,r),r.length>r.l?r.slice(0,r.l):r}function z6(e,r){return r||(r=fe(12+4*10)),r.write_shift(4,e.xfId),r.write_shift(2,1),r.write_shift(1,+e.builtinId),r.write_shift(1,0),Pl(e.name||"",r),r.length>r.l?r.slice(0,r.l):r}function j6(e,r,t){var n=fe(2052);return n.write_shift(4,e),Pl(r,n),Pl(t,n),n.length>n.l?n.slice(0,n.l):n}function Y6(e,r){if(r){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)r[i]!=null&&++t}),t!=0&&(ye(e,615,jn(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)r[i]!=null&&ye(e,44,L6(i,r[i]))}),ye(e,616))}}function G6(e){var r=1;ye(e,611,jn(r)),ye(e,43,H6({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),ye(e,612)}function X6(e){var r=2;ye(e,603,jn(r)),ye(e,45,ew({patternType:"none"})),ye(e,45,ew({patternType:"gray125"})),ye(e,604)}function K6(e){var r=1;ye(e,613,jn(r)),ye(e,46,V6()),ye(e,614)}function q6(e){var r=1;ye(e,626,jn(r)),ye(e,47,KS({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),ye(e,627)}function Z6(e,r){ye(e,617,jn(r.length)),r.forEach(function(t){ye(e,47,KS(t,0))}),ye(e,618)}function J6(e){var r=1;ye(e,619,jn(r)),ye(e,48,z6({xfId:0,builtinId:0,name:"Normal"})),ye(e,620)}function Q6(e){var r=0;ye(e,505,jn(r)),ye(e,506)}function e8(e){var r=0;ye(e,508,j6(r,"TableStyleMedium9","PivotStyleMedium4")),ye(e,509)}function t8(e,r){var t=Zr();return ye(t,278),Y6(t,e.SSF),G6(t),X6(t),K6(t),q6(t),Z6(t,r.cellXfs),J6(t),Q6(t),e8(t),ye(t,279),t.end()}function qS(e,r){if(r&&r.themeXLSX)return r.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var t=[mr];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function r8(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:Jr(e)}}function n8(e){var r=fe(12+2*e.name.length);return r.write_shift(4,e.flags),r.write_shift(4,e.version),br(e.name,r),r.slice(0,r.l)}function i8(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function a8(e){var r=fe(4+8*e.length);r.write_shift(4,e.length);for(var t=0;t<e.length;++t)r.write_shift(4,e[t][0]),r.write_shift(4,e[t][1]);return r}function o8(e,r){var t=fe(8+2*r.length);return t.write_shift(4,e),br(r,t),t.slice(0,t.l)}function s8(e){return e.l+=4,e.read_shift(4)!=0}function l8(e,r){var t=fe(8);return t.write_shift(4,e),t.write_shift(4,r?1:0),t}function u8(){var e=Zr();return ye(e,332),ye(e,334,jn(1)),ye(e,335,n8({name:"XLDAPR",version:12e4,flags:3496657072})),ye(e,336),ye(e,339,o8(1,"XLDAPR")),ye(e,52),ye(e,35,jn(514)),ye(e,4096,jn(0)),ye(e,4097,Nn(1)),ye(e,36),ye(e,53),ye(e,340),ye(e,337,l8(1,!0)),ye(e,51,a8([[1,0]])),ye(e,338),ye(e,333),e.end()}function f8(){var e=[mr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function c8(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=Qt(t);var n=e.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}function ZS(e,r,t){var n=[21600,21600],i=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),a=[Te("xml",null,{"xmlns:v":_n.v,"xmlns:o":_n.o,"xmlns:x":_n.x,"xmlns:mv":_n.mv}).replace(/\/>/,">"),Te("o:shapelayout",Te("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"})],o=65536*e,s=r||[];return s.length>0&&a.push(Te("v:shapetype",[Te("v:stroke",null,{joinstyle:"miter"}),Te("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202",coordsize:n.join(","),"o:spt":202,path:i})),s.forEach(function(l){++o,a.push(h8(l,o))}),a.push("</xml>"),a.join("")}function h8(e,r,t){var n=Kt(e[0]),i={color2:"#BEFF82",type:"gradient"};i.type=="gradient"&&(i.angle="-180");var a=i.type=="gradient"?Te("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,o=Te("v:fill",a,i),s={on:"t",obscured:"t"};return["<v:shape"+Al({id:"_x0000_s"+r,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",o,Te("v:shadow",null,s),Te("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Br("x:Anchor",[n.c+1,0,n.r+1,0,n.c+3,20,n.r+5,20].join(",")),Br("x:AutoFill","False"),Br("x:Row",String(n.r)),Br("x:Column",String(n.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"].join("")}function d8(e){var r=[mr,Te("comments",null,{xmlns:Es[0]})],t=[];return r.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var a=lt(i.a);t.indexOf(a)==-1&&(t.push(a),r.push("<author>"+a+"</author>")),i.T&&i.ID&&t.indexOf("tc="+i.ID)==-1&&(t.push("tc="+i.ID),r.push("<author>tc="+i.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),e.forEach(function(n){var i=0,a=[],o=0;if(n[1][0]&&n[1][0].T&&n[1][0].ID&&(i=t.indexOf("tc="+n[1][0].ID)),n[1].forEach(function(u){u.a&&(i=t.indexOf(lt(u.a))),u.T&&++o,a.push(u.t==null?"":lt(u.t))}),o===0)n[1].forEach(function(u){r.push('<comment ref="'+n[0]+'" authorId="'+t.indexOf(lt(u.a))+'"><text>'),r.push(Br("t",u.t==null?"":lt(u.t))),r.push("</text></comment>")});else{n[1][0]&&n[1][0].T&&n[1][0].ID&&(i=t.indexOf("tc="+n[1][0].ID)),r.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>');for(var s=`Comment:
    `+a[0]+`
`,l=1;l<a.length;++l)s+=`Reply:
    `+a[l]+`
`;r.push(Br("t",lt(s))),r.push("</text></comment>")}}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function JS(e,r,t){var n=[mr,Te("ThreadedComments",null,{xmlns:Ar.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var a="";(i[1]||[]).forEach(function(o,s){if(!o.T){delete o.ID;return}o.a&&r.indexOf(o.a)==-1&&r.push(o.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};s==0?a=l.id:l.parentId=a,o.ID=l.id,o.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(o.a)).slice(-12)+"}"),n.push(Te("threadedComment",Br("text",o.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function QS(e){var r=[mr,Te("personList",null,{xmlns:Ar.TCMNT,"xmlns:x":Es[0]}).replace(/[\/]>/,">")];return e.forEach(function(t,n){r.push(Te("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:t,providerId:"None"}))}),r.push("</personList>"),r.join("")}function v8(e){var r={};r.iauthor=e.read_shift(4);var t=To(e);return r.rfx=t.s,r.ref=Qt(t.s),e.l+=16,r}function g8(e,r){return r==null&&(r=fe(36)),r.write_shift(4,e[1].iauthor),Rs(e[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}var m8=Jr;function tw(e){return br(e.slice(0,54))}function p8(e){var r=Zr(),t=[];return ye(r,628),ye(r,630),e.forEach(function(n){n[1].forEach(function(i){t.indexOf(i.a)>-1||(t.push(i.a.slice(0,54)),ye(r,632,tw(i.a)),i.T&&i.ID&&t.indexOf("tc="+i.ID)==-1&&(t.push("tc="+i.ID),ye(r,632,tw("tc="+i.ID))))})}),ye(r,631),ye(r,633),e.forEach(function(n){n[1].forEach(function(i){var a=-1;i.ID&&(a=t.indexOf("tc="+i.ID)),a==-1&&n[1][0].T&&n[1][0].ID&&(a=t.indexOf("tc="+n[1][0].ID)),a==-1&&(a=t.indexOf(i.a)),i.iauthor=a;var o={s:Kt(n[0]),e:Kt(n[0])};ye(r,635,g8([o,i])),i.t&&i.t.length>0&&ye(r,637,dB(i)),ye(r,636),delete i.iauthor})}),ye(r,634),ye(r,629),r.end()}function y8(e,r){r.FullPaths.forEach(function(t,n){if(n!=0){var i=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Nt.utils.cfb_add(e,i,r.FileIndex[n].content)}})}var w8=["xlsb","xlsm","xlam","biff8","xla"],rw=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(n,i,a,o){var s=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),o.length==0?s=!0:o.charAt(0)=="["&&(s=!0,o=o.slice(1,-1));var u=a.length>0?parseInt(a,10)|0:0,f=o.length>0?parseInt(o,10)|0:0;return s?f+=r.c:--f,l?u+=r.r:--u,i+(s?"":"$")+Ot(f)+(l?"":"$")+kt(u)}return function(i,a){return r=a,i.replace(e,t)}}(),Yc=/(^|[^._A-Z0-9])(\$?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])(\$?)(\d{1,7})(?![_.\(A-Za-z0-9])/g;try{Yc=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g}catch{}var Gc=function(){return function(r,t){return r.replace(Yc,function(n,i,a,o,s,l){var u=ug(o)-(a?0:t.c),f=lg(l)-(s?0:t.r),c=s=="$"?f+1:f==0?"":"["+f+"]",h=a=="$"?u+1:u==0?"":"["+u+"]";return i+"R"+c+"C"+h})}}();function _8(e,r){return e.replace(Yc,function(t,n,i,a,o,s){return n+(i=="$"?i+a:Ot(ug(a)+r.c))+(o=="$"?o+s:kt(lg(s)+r.r))})}function C8(e){return e.length!=1}function cr(e){e.l+=1}function ma(e,r){var t=e.read_shift(r==1?1:2);return[t&16383,t>>14&1,t>>15&1]}function eb(e,r,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return tb(e);t.biff==12&&(n=4)}var i=e.read_shift(n),a=e.read_shift(n),o=ma(e,2),s=ma(e,2);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function tb(e){var r=ma(e,2),t=ma(e,2),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function S8(e,r,t){if(t.biff<8)return tb(e);var n=e.read_shift(t.biff==12?4:2),i=e.read_shift(t.biff==12?4:2),a=ma(e,2),o=ma(e,2);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function rb(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return b8(e);var n=e.read_shift(t&&t.biff==12?4:2),i=ma(e,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function b8(e){var r=ma(e,2),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function x8(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function E8(e,r,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return T8(e);var i=e.read_shift(n>=12?4:2),a=e.read_shift(2),o=(a&16384)>>14,s=(a&32768)>>15;if(a&=16383,s==1)for(;i>524287;)i-=1048576;if(o==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:o,rRel:s}}function T8(e){var r=e.read_shift(2),t=e.read_shift(1),n=(r&32768)>>15,i=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),i==1&&t>=128&&(t=t-256),{r,c:t,cRel:i,rRel:n}}function O8(e,r,t){var n=(e[e.l++]&96)>>5,i=eb(e,t.biff>=2&&t.biff<=5?6:8,t);return[n,i]}function R8(e,r,t){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),a=8;if(t)switch(t.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var o=eb(e,a,t);return[n,i,o]}function k8(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function A8(e,r,t){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=8;if(t)switch(t.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,i]}function M8(e,r,t){var n=(e[e.l++]&96)>>5,i=S8(e,r-1,t);return[n,i]}function D8(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[n]}function nw(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function P8(e,r,t){e.l+=2;for(var n=e.read_shift(t&&t.biff==2?1:2),i=[],a=0;a<=n;++a)i.push(e.read_shift(t&&t.biff==2?1:2));return i}function N8(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function F8(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function L8(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function I8(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[n]}function nb(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function H8(e){return e.read_shift(2),nb(e)}function B8(e){return e.read_shift(2),nb(e)}function W8(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var i=rb(e,0,t);return[n,i]}function $8(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var i=E8(e,0,t);return[n,i]}function U8(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var a=rb(e,0,t);return[n,i,a]}function V8(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(t&&t.biff<=3?1:2);return[e5[i],ob[i],n]}function z8(e,r,t){var n=e[e.l++],i=e.read_shift(1),a=t&&t.biff<=3?[n==88?-1:0,e.read_shift(1)]:j8(e);return[i,(a[0]===0?ob:QW)[a[1]]]}function j8(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Y8(e,r,t){e.l+=t&&t.biff==2?3:4}function G8(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(t&&t.biff==2?1:2);return[n,i]}function X8(e){return e.l++,uo[e.read_shift(1)]}function K8(e){return e.l++,e.read_shift(2)}function q8(e){return e.l++,e.read_shift(1)!==0}function Z8(e){return e.l++,ks(e)}function J8(e,r,t){return e.l++,$S(e,r-1,t)}function Q8(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=HB(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=uo[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=ks(e);break;case 2:t[1]=UB(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function eW(e,r,t){for(var n=e.read_shift(t.biff==12?4:2),i=[],a=0;a!=n;++a)i.push((t.biff==12?To:jB)(e));return i}function tW(e,r,t){var n=0,i=0;t.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--i==0&&(i=256));for(var a=0,o=[];a!=n&&(o[a]=[]);++a)for(var s=0;s!=i;++s)o[a][s]=Q8(e,t.biff);return o}function rW(e,r,t){var n=e.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,a=e.read_shift(i);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function nW(e,r,t){if(t.biff==5)return iW(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),a=e.read_shift(4);return[n,i,a]}function iW(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[r,t,n]}function aW(e,r,t){var n=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var i=e.read_shift(t&&t.biff==2?1:2);return[n,i]}function oW(e,r,t){var n=e.read_shift(1)>>>5&3,i=e.read_shift(t&&t.biff==2?1:2);return[n,i]}function sW(e,r,t){var n=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[n]}function lW(e,r,t){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=4;if(t)switch(t.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,i]}var uW=di,fW=di,cW=di;function Yl(e,r,t){return e.l+=2,[x8(e)]}function gg(e){return e.l+=6,[]}var hW=Yl,dW=gg,vW=gg,gW=Yl;function ib(e){return e.l+=2,[mf(e),e.read_shift(2)&1]}var mW=Yl,pW=ib,yW=gg,wW=Yl,_W=Yl,CW=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function SW(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),a=e.read_shift(2),o=CW[t>>2&31];return{ixti:r,coltype:t&3,rt:o,idx:n,c:i,C:a}}function bW(e){return e.l+=2,[e.read_shift(4)]}function xW(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function EW(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function TW(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function OW(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function RW(e){return e.l+=4,[0,0]}var iw={1:{n:"PtgExp",f:G8},2:{n:"PtgTbl",f:cW},3:{n:"PtgAdd",f:cr},4:{n:"PtgSub",f:cr},5:{n:"PtgMul",f:cr},6:{n:"PtgDiv",f:cr},7:{n:"PtgPower",f:cr},8:{n:"PtgConcat",f:cr},9:{n:"PtgLt",f:cr},10:{n:"PtgLe",f:cr},11:{n:"PtgEq",f:cr},12:{n:"PtgGe",f:cr},13:{n:"PtgGt",f:cr},14:{n:"PtgNe",f:cr},15:{n:"PtgIsect",f:cr},16:{n:"PtgUnion",f:cr},17:{n:"PtgRange",f:cr},18:{n:"PtgUplus",f:cr},19:{n:"PtgUminus",f:cr},20:{n:"PtgPercent",f:cr},21:{n:"PtgParen",f:cr},22:{n:"PtgMissArg",f:cr},23:{n:"PtgStr",f:J8},26:{n:"PtgSheet",f:xW},27:{n:"PtgEndSheet",f:EW},28:{n:"PtgErr",f:X8},29:{n:"PtgBool",f:q8},30:{n:"PtgInt",f:K8},31:{n:"PtgNum",f:Z8},32:{n:"PtgArray",f:D8},33:{n:"PtgFunc",f:V8},34:{n:"PtgFuncVar",f:z8},35:{n:"PtgName",f:rW},36:{n:"PtgRef",f:W8},37:{n:"PtgArea",f:O8},38:{n:"PtgMemArea",f:aW},39:{n:"PtgMemErr",f:uW},40:{n:"PtgMemNoMem",f:fW},41:{n:"PtgMemFunc",f:oW},42:{n:"PtgRefErr",f:sW},43:{n:"PtgAreaErr",f:k8},44:{n:"PtgRefN",f:$8},45:{n:"PtgAreaN",f:M8},46:{n:"PtgMemAreaN",f:TW},47:{n:"PtgMemNoMemN",f:OW},57:{n:"PtgNameX",f:nW},58:{n:"PtgRef3d",f:U8},59:{n:"PtgArea3d",f:R8},60:{n:"PtgRefErr3d",f:lW},61:{n:"PtgAreaErr3d",f:A8},255:{}},kW={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},AW={1:{n:"PtgElfLel",f:ib},2:{n:"PtgElfRw",f:wW},3:{n:"PtgElfCol",f:hW},6:{n:"PtgElfRwV",f:_W},7:{n:"PtgElfColV",f:gW},10:{n:"PtgElfRadical",f:mW},11:{n:"PtgElfRadicalS",f:yW},13:{n:"PtgElfColS",f:dW},15:{n:"PtgElfColSV",f:vW},16:{n:"PtgElfRadicalLel",f:pW},25:{n:"PtgList",f:SW},29:{n:"PtgSxName",f:bW},255:{}},MW={0:{n:"PtgAttrNoop",f:RW},1:{n:"PtgAttrSemi",f:I8},2:{n:"PtgAttrIf",f:F8},4:{n:"PtgAttrChoose",f:P8},8:{n:"PtgAttrGoto",f:N8},16:{n:"PtgAttrSum",f:Y8},32:{n:"PtgAttrBaxcel",f:nw},33:{n:"PtgAttrBaxcel",f:nw},64:{n:"PtgAttrSpace",f:H8},65:{n:"PtgAttrSpaceSemi",f:B8},128:{n:"PtgAttrIfError",f:L8},255:{}};function DW(e,r,t,n){if(n.biff<8)return di(e,r);for(var i=e.l+r,a=[],o=0;o!==t.length;++o)switch(t[o][0]){case"PtgArray":t[o][1]=tW(e,0,n),a.push(t[o][1]);break;case"PtgMemArea":t[o][2]=eW(e,t[o][1],n),a.push(t[o][2]);break;case"PtgExp":n&&n.biff==12&&(t[o][1][1]=e.read_shift(4),a.push(t[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[o][0]}return r=i-e.l,r!==0&&a.push(di(e,r)),a}function PW(e,r,t){for(var n=e.l+r,i,a,o=[];n!=e.l;)r=n-e.l,a=e[e.l],i=iw[a]||iw[kW[a]],(a===24||a===25)&&(i=(a===24?AW:MW)[e[e.l+1]]),!i||!i.f?di(e,r):o.push([i.n,i.f(e,r,t)]);return o}function NW(e){for(var r=[],t=0;t<e.length;++t){for(var n=e[t],i=[],a=0;a<n.length;++a){var o=n[a];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}r.push(i.join(","))}return r.join(";")}var FW={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function LW(e,r){var t=e.lastIndexOf("!"),n=r.lastIndexOf("!");return t==-1&&n==-1?e+":"+r:t>0&&n>0&&e.slice(0,t).toLowerCase()==r.slice(0,n).toLowerCase()?e+":"+r.slice(n+1):(console.error("Cannot hydrate range",e,r),e+":"+r)}function ab(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!n)return"SH33TJSERR1";var i="";if(t.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function aw(e,r,t){var n=ab(e,r,t);return n=="#REF"?n:Dl(n,t)}function gs(e,r,t,n,i){var a=i&&i.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},s=[],l,u,f,c=0,h=0,d,g="";if(!e[0]||!e[0][0])return"";for(var v=-1,p="",C=0,F=e[0].length;C<F;++C){var D=e[0][C];switch(D[0]){case"PtgUminus":s.push("-"+s.pop());break;case"PtgUplus":s.push("+"+s.pop());break;case"PtgPercent":s.push(s.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=s.pop(),u=s.pop(),v>=0){switch(e[0][v][1][0]){case 0:p=Yt(" ",e[0][v][1][1]);break;case 1:p=Yt("\r",e[0][v][1][1]);break;default:if(p="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}u=u+p,v=-1}s.push(u+FW[D[0]]+l);break;case"PtgIsect":l=s.pop(),u=s.pop(),s.push(u+" "+l);break;case"PtgUnion":l=s.pop(),u=s.pop(),s.push(u+","+l);break;case"PtgRange":l=s.pop(),u=s.pop(),s.push(LW(u,l));break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=ol(D[1][1],o,i),s.push(sl(f,a));break;case"PtgRefN":f=t?ol(D[1][1],t,i):D[1][1],s.push(sl(f,a));break;case"PtgRef3d":c=D[1][1],f=ol(D[1][2],o,i),g=aw(n,c,i),s.push(g+"!"+sl(f,a));break;case"PtgFunc":case"PtgFuncVar":var ee=D[1][0],ue=D[1][1];ee||(ee=0),ee&=127;var se=ee==0?[]:s.slice(-ee);s.length-=ee,ue==="User"&&(ue=se.shift()),s.push(ue+"("+se.join(",")+")");break;case"PtgBool":s.push(D[1]?"TRUE":"FALSE");break;case"PtgInt":s.push(D[1]);break;case"PtgNum":s.push(String(D[1]));break;case"PtgStr":s.push('"'+D[1].replace(/"/g,'""')+'"');break;case"PtgErr":s.push(D[1]);break;case"PtgAreaN":d=Wy(D[1][1],t?{s:t}:o,i),s.push(kh(d,i));break;case"PtgArea":d=Wy(D[1][1],o,i),s.push(kh(d,i));break;case"PtgArea3d":c=D[1][1],d=D[1][2],g=aw(n,c,i),s.push(g+"!"+kh(d,i));break;case"PtgAttrSum":s.push("SUM("+s.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=D[1][2];var U=(n.names||[])[h-1]||(n[0]||[])[h],re=U?U.Name:"SH33TJSNAME"+String(h);re&&re.slice(0,6)=="_xlfn."&&!i.xlfn&&(re=re.slice(6)),s.push(re);break;case"PtgNameX":var m=D[1][1];h=D[1][2];var _;if(i.biff<=5)m<0&&(m=-m),n[m]&&(_=n[m][h]);else{var x="";if(((n[m]||[])[0]||[])[0]==14849||(((n[m]||[])[0]||[])[0]==1025?n[m][h]&&n[m][h].itab>0&&(x=n.SheetNames[n[m][h].itab-1]+"!"):x=n.SheetNames[h-1]+"!"),n[m]&&n[m][h])x+=n[m][h].Name;else if(n[0]&&n[0][h])x+=n[0][h].Name;else{var B=(ab(n,m,i)||"").split(";;");B[h-1]?x=B[h-1]:x+="SH33TJSERRX"}s.push(x);break}_||(_={Name:"SH33TJSERRY"}),s.push(_.Name);break;case"PtgParen":var Q="(",A=")";if(v>=0){switch(p="",e[0][v][1][0]){case 2:Q=Yt(" ",e[0][v][1][1])+Q;break;case 3:Q=Yt("\r",e[0][v][1][1])+Q;break;case 4:A=Yt(" ",e[0][v][1][1])+A;break;case 5:A=Yt("\r",e[0][v][1][1])+A;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}v=-1}s.push(Q+s.pop()+A);break;case"PtgRefErr":s.push("#REF!");break;case"PtgRefErr3d":s.push("#REF!");break;case"PtgExp":f={c:D[1][1],r:D[1][0]};var W={c:t.c,r:t.r};if(n.sharedf[Qt(f)]){var ne=n.sharedf[Qt(f)];s.push(gs(ne,o,W,n,i))}else{var b=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){s.push(gs(u[1],o,W,n,i)),b=!0;break}b||s.push(D[1])}break;case"PtgArray":s.push("{"+NW(D[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=C;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":s.push("");break;case"PtgAreaErr":s.push("#REF!");break;case"PtgAreaErr3d":s.push("#REF!");break;case"PtgList":s.push("Table"+D[1].idx+"[#"+D[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(D));default:throw new Error("Unrecognized Formula Token: "+String(D))}var R=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&v>=0&&R.indexOf(e[0][C][0])==-1){D=e[0][v];var Z=!0;switch(D[1][0]){case 4:Z=!1;case 0:p=Yt(" ",D[1][1]);break;case 5:Z=!1;case 1:p=Yt("\r",D[1][1]);break;default:if(p="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+D[1][0])}s.push((Z?p:"")+s.pop()+(Z?"":p)),v=-1}}if(s.length>1&&i.WTF)throw new Error("bad formula stack");return s[0]=="TRUE"?!0:s[0]=="FALSE"?!1:s[0]}function IW(e){if(e==null){var r=fe(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}else if(typeof e=="number")return po(e);return po(0)}function HW(e,r,t,n,i){var a=yo(r,t,i),o=IW(e.v),s=fe(6),l=33;s.write_shift(2,l),s.write_shift(4,0);for(var u=fe(e.bf.length),f=0;f<e.bf.length;++f)u[f]=e.bf[f];var c=dr([a,o,s,u]);return c}function Xc(e,r,t){var n=e.read_shift(4),i=PW(e,n,t),a=e.read_shift(4),o=a>0?DW(e,a,i,t):null;return[i,o]}var BW=Xc,Kc=Xc,WW=Xc,$W=Xc;function ow(e){if((e|0)==e&&e<Math.pow(2,16)&&e>=0){var r=fe(11);return r.write_shift(4,3),r.write_shift(1,30),r.write_shift(2,e),r.write_shift(4,0),r}var t=fe(17);return t.write_shift(4,11),t.write_shift(1,31),t.write_shift(8,e),t.write_shift(4,0),t}function UW(e){var r=fe(10);return r.write_shift(4,2),r.write_shift(1,28),r.write_shift(1,e),r.write_shift(4,0),r}function VW(e){var r=fe(10);return r.write_shift(4,2),r.write_shift(1,29),r.write_shift(1,e?1:0),r.write_shift(4,0),r}function zW(e){var r=fe(7);r.write_shift(4,3+2*e.length),r.write_shift(1,23),r.write_shift(2,e.length);var t=fe(2*e.length);t.write_shift(2*e.length,e,"utf16le");var n=fe(4);return n.write_shift(4,0),dr([r,t,n])}function jW(e){var r=Kt(e),t=fe(15);return t.write_shift(4,7),t.write_shift(1,36),t.write_shift(4,r.r),t.write_shift(2,r.c|(e.charAt(0)=="$"?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),t.write_shift(4,0),t}function YW(e,r){var t=e.lastIndexOf("!"),n=e.slice(0,t);e=e.slice(t+1);var i=Kt(e);n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var a=fe(17);return a.write_shift(4,9),a.write_shift(1,58),a.write_shift(2,2+r.SheetNames.map(function(o){return o.toLowerCase()}).indexOf(n.toLowerCase())),a.write_shift(4,i.r),a.write_shift(2,i.c|(e.charAt(0)=="$"?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),a.write_shift(4,0),a}function GW(e,r){var t=e.lastIndexOf("!"),n=e.slice(0,t);e=e.slice(t+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var i=fe(17);return i.write_shift(4,9),i.write_shift(1,60),i.write_shift(2,2+r.SheetNames.map(function(a){return a.toLowerCase()}).indexOf(n.toLowerCase())),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(4,0),i}function XW(e){var r=e.split(":"),t=r[0],n=fe(23);n.write_shift(4,15),t=r[0];var i=Kt(t);return n.write_shift(1,36),n.write_shift(4,i.r),n.write_shift(2,i.c|(t.charAt(0)=="$"?0:1)<<14|(t.match(/\$\d/)?0:1)<<15),n.write_shift(4,0),t=r[1],i=Kt(t),n.write_shift(1,36),n.write_shift(4,i.r),n.write_shift(2,i.c|(t.charAt(0)=="$"?0:1)<<14|(t.match(/\$\d/)?0:1)<<15),n.write_shift(4,0),n.write_shift(1,17),n.write_shift(4,0),n}function KW(e,r){var t=e.lastIndexOf("!"),n=e.slice(0,t);e=e.slice(t+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var i=e.split(":"),a=fe(27);a.write_shift(4,19);var o=i[0],s=Kt(o);return a.write_shift(1,58),a.write_shift(2,2+r.SheetNames.map(function(l){return l.toLowerCase()}).indexOf(n.toLowerCase())),a.write_shift(4,s.r),a.write_shift(2,s.c|(o.charAt(0)=="$"?0:1)<<14|(o.match(/\$\d/)?0:1)<<15),o=i[1],s=Kt(o),a.write_shift(1,58),a.write_shift(2,2+r.SheetNames.map(function(l){return l.toLowerCase()}).indexOf(n.toLowerCase())),a.write_shift(4,s.r),a.write_shift(2,s.c|(o.charAt(0)=="$"?0:1)<<14|(o.match(/\$\d/)?0:1)<<15),a.write_shift(1,17),a.write_shift(4,0),a}function qW(e,r){var t=e.lastIndexOf("!"),n=e.slice(0,t);e=e.slice(t+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var i=$r(e),a=fe(23);return a.write_shift(4,15),a.write_shift(1,59),a.write_shift(2,2+r.SheetNames.map(function(o){return o.toLowerCase()}).indexOf(n.toLowerCase())),a.write_shift(4,i.s.r),a.write_shift(4,i.e.r),a.write_shift(2,i.s.c),a.write_shift(2,i.e.c),a.write_shift(4,0),a}function ZW(e,r){if(typeof e=="number")return ow(e);if(typeof e=="boolean")return VW(e);if(/^#(DIV\/0!|GETTING_DATA|N\/A|NAME\?|NULL!|NUM!|REF!|VALUE!)$/.test(e))return UW(+OB[e]);if(e.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return jW(e);if(e.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return XW(e);if(e.match(/^#REF!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return qW(e,r);if(e.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return YW(e,r);if(e.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return KW(e,r);if(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!#REF!$/.test(e))return GW(e,r);if(/^".*"$/.test(e))return zW(e);if(/^[+-]\d+$/.test(e))return ow(parseInt(e,10));throw"Formula |"+e+"| not supported for XLSB"}var JW=ZW,QW={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ob={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},e5={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function t5(e){var r="of:="+e.replace(Yc,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return r.replace(/;/g,"|").replace(/,/g,";")}function sb(e){return e.replace(/!/,".").replace(/:/,":.")}var ll=typeof Map<"u";function mg(e,r,t){var n=0,i=e.length;if(t){if(ll?t.has(r):Object.prototype.hasOwnProperty.call(t,r)){for(var a=ll?t.get(r):t[r];n<a.length;++n)if(e[a[n]].t===r)return e.Count++,a[n]}}else for(;n<i;++n)if(e[n].t===r)return e.Count++,n;return e[i]={t:r},e.Count++,e.Unique++,t&&(ll?(t.has(r)||t.set(r,[]),t.get(r).push(i)):(Object.prototype.hasOwnProperty.call(t,r)||(t[r]=[]),t[r].push(i))),i}function qc(e,r){var t={min:e+1,max:e+1},n=-1;return r.MDW&&(Ni=r.MDW),r.width!=null?t.customWidth=1:r.wpx!=null?n=$f(r.wpx):r.wch!=null&&(n=r.wch),n>-1?(t.width=y0(n),t.customWidth=1):r.width!=null&&(t.width=r.width),r.hidden&&(t.hidden=!0),r.level!=null&&(t.outlineLevel=t.level=r.level),t}function lb(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function Ea(e,r,t){var n=t.revssf[r.z!=null?r.z:"General"],i=60,a=e.length;if(n==null&&t.ssf){for(;i<392;++i)if(t.ssf[i]==null){O3(r.z,i),t.ssf[i]=r.z,t.revssf[r.z]=n=i;break}}for(i=0;i!=a;++i)if(e[i].numFmtId===n)return i;return e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function r5(e,r,t){if(e&&e["!ref"]){var n=Ut(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+t+"): "+e["!ref"])}}function n5(e){if(e.length===0)return"";for(var r='<mergeCells count="'+e.length+'">',t=0;t!=e.length;++t)r+='<mergeCell ref="'+gr(e[t])+'"/>';return r+"</mergeCells>"}function i5(e,r,t,n,i){var a=!1,o={},s=null;if(n.bookType!=="xlsx"&&r.vbaraw){var l=r.SheetNames[t];try{r.Workbook&&(l=r.Workbook.Sheets[t].CodeName||l)}catch{}a=!0,o.codeName=Mi(lt(l))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),s=(s||"")+Te("outlinePr",null,u)}!a&&!s||(i[i.length]=Te("sheetPr",s,o))}var a5=["objects","scenarios","selectLockedCells","selectUnlockedCells"],o5=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function s5(e){var r={sheet:1};return a5.forEach(function(t){e[t]!=null&&e[t]&&(r[t]="1")}),o5.forEach(function(t){e[t]!=null&&!e[t]&&(r[t]="0")}),e.password&&(r.password=YS(e.password).toString(16).toUpperCase()),Te("sheetProtection",null,r)}function l5(e){return lb(e),Te("pageMargins",null,e)}function u5(e,r){for(var t=["<cols>"],n,i=0;i!=r.length;++i)(n=r[i])&&(t[t.length]=Te("col",null,qc(i,n)));return t[t.length]="</cols>",t.join("")}function f5(e,r,t,n){var i=typeof e.ref=="string"?e.ref:gr(e.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var a=t.Workbook.Names,o=$r(i);o.s.r==o.e.r&&(o.e.r=$r(r["!ref"]).e.r,i=gr(o));for(var s=0;s<a.length;++s){var l=a[s];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref=Dl(t.SheetNames[n])+"!"+Ml(i);break}}return s==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+i}),Te("autoFilter",null,{ref:i})}function c5(e,r,t,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Te("sheetViews",Te("sheetView",null,i),{})}function h5(e,r,t,n,i,a,o){if(e.c&&t["!comments"].push([r,e.c]),(e.v===void 0||e.t==="z"&&!(n||{}).sheetStubs)&&typeof e.f!="string"&&typeof e.z>"u")return"";var s="",l=e.t,u=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":isNaN(e.v)?(e.t="e",s=uo[e.v=36]):isFinite(e.v)?s=""+e.v:(e.t="e",s=uo[e.v=7]);break;case"e":s=uo[e.v];break;case"d":if(n&&n.cellDates){var f=cn(e.v,o);s=f.toISOString(),f.getUTCFullYear()<1900&&(s=s.slice(s.indexOf("T")+1).replace("Z",""))}else e=Qr(e),e.t="n",s=""+(e.v=Ur(cn(e.v,o),o));typeof e.z>"u"&&(e.z=Wt[14]);break;default:s=e.v;break}var c=e.t=="z"||e.v==null?"":Br("v",lt(s)),h={r},d=Ea(n.cellXfs,e,n);switch(d!==0&&(h.s=d),e.t){case"n":break;case"d":h.t="d";break;case"b":h.t="b";break;case"e":h.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){c=Br("v",""+mg(n.Strings,e.v,n.revStrings)),h.t="s";break}else h.t="str";break}if(e.t!=l&&(e.t=l,e.v=u),typeof e.f=="string"&&e.f){var g=e.F&&e.F.slice(0,r.length)==r?{t:"array",ref:e.F}:null;c=Te("f",lt(e.f),g)+(e.v!=null?c:"")}return e.l&&(e.l.display=lt(s),t["!links"].push([r,e.l])),e.D&&(h.cm=1),Te("c",c,h)}function d5(e,r,t,n){var i=[],a=[],o=Ut(e["!ref"]),s="",l,u="",f=[],c=0,h=0,d=e["!rows"],g=e["!data"]!=null,v={r:u},p,C=-1,F=(((n||{}).Workbook||{}).WBProps||{}).date1904;for(h=o.s.c;h<=o.e.c;++h)f[h]=Ot(h);for(c=o.s.r;c<=o.e.r;++c){for(a=[],u=kt(c),h=o.s.c;h<=o.e.c;++h){l=f[h]+u;var D=g?(e["!data"][c]||[])[h]:e[l];D!==void 0&&(s=h5(D,l,e,r,t,n,F))!=null&&a.push(s)}(a.length>0||d&&d[c])&&(v={r:u},d&&d[c]&&(p=d[c],p.hidden&&(v.hidden=1),C=-1,p.hpx?C=Uf(p.hpx):p.hpt&&(C=p.hpt),C>-1&&(v.ht=C,v.customHeight=1),p.level&&(v.outlineLevel=p.level)),i[i.length]=Te("row",a.join(""),v))}if(d)for(;c<d.length;++c)d&&d[c]&&(v={r:c+1},p=d[c],p.hidden&&(v.hidden=1),C=-1,p.hpx?C=Uf(p.hpx):p.hpt&&(C=p.hpt),C>-1&&(v.ht=C,v.customHeight=1),p.level&&(v.outlineLevel=p.level),i[i.length]=Te("row","",v));return i.join("")}function v5(e,r,t,n){var i=[mr,Te("worksheet",null,{xmlns:Es[0],"xmlns:r":Ar.r})],a=t.SheetNames[e],o=0,s="",l=t.Sheets[a];l==null&&(l={});var u=l["!ref"]||"A1",f=Ut(u);if(f.e.c>16383||f.e.r>1048575){if(r.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),u=gr(f)}n||(n={}),l["!comments"]=[];var c=[];i5(l,t,e,r,i),i[i.length]=Te("dimension",null,{ref:u}),i[i.length]=c5(l,r,e,t),r.sheetFormat&&(i[i.length]=Te("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=u5(l,l["!cols"])),i[o=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(s=d5(l,r,e,t),s.length>0&&(i[i.length]=s)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),l["!protect"]&&(i[i.length]=s5(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=f5(l["!autofilter"],l,t,e)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=n5(l["!merges"]));var h=-1,d,g=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(v){v[1].Target&&(d={ref:v[0]},v[1].Target.charAt(0)!="#"&&(g=xt(n,-1,lt(v[1].Target).replace(/#.*$/,""),yt.HLINK),d["r:id"]="rId"+g),(h=v[1].Target.indexOf("#"))>-1&&(d.location=lt(v[1].Target.slice(h+1))),v[1].Tooltip&&(d.tooltip=lt(v[1].Tooltip)),d.display=v[1].display,i[i.length]=Te("hyperlink",null,d))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=l5(l["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&(i[i.length]=Br("ignoredErrors",Te("ignoredError",null,{numberStoredAsText:1,sqref:u}))),c.length>0&&(g=xt(n,-1,"../drawings/drawing"+(e+1)+".xml",yt.DRAW),i[i.length]=Te("drawing",null,{"r:id":"rId"+g}),l["!drawing"]=c),l["!comments"].length>0&&(g=xt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",yt.VML),i[i.length]=Te("legacyDrawing",null,{"r:id":"rId"+g}),l["!legacy"]=g),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function g5(e,r){var t={},n=e.l+r;t.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(t.level=a&7),a&16&&(t.hidden=!0),a&32&&(t.hpt=i/20),t}function m5(e,r,t){var n=fe(145),i=(t["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var a=320;i.hpx?a=Uf(i.hpx)*20:i.hpt&&(a=i.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var s=0,l=n.l;n.l+=4;for(var u={r:e,c:0},f=t["!data"]!=null,c=0;c<16;++c)if(!(r.s.c>c+1<<10||r.e.c<c<<10)){for(var h=-1,d=-1,g=c<<10;g<c+1<<10;++g){u.c=g;var v=f?(t["!data"][u.r]||[])[u.c]:t[Qt(u)];v&&(h<0&&(h=g),d=g)}h<0||(++s,n.write_shift(4,h),n.write_shift(4,d))}var p=n.l;return n.l=l,n.write_shift(4,s),n.l=p,n.length>n.l?n.slice(0,n.l):n}function p5(e,r,t,n){var i=m5(n,t,r);(i.length>17||(r["!rows"]||[])[n])&&ye(e,0,i)}var y5=To,w5=Rs;function _5(){}function C5(e,r){var t={},n=e[e.l];return++e.l,t.above=!(n&64),t.left=!(n&128),e.l+=18,t.name=vB(e),t}function S5(e,r,t){t==null&&(t=fe(84+4*e.length));var n=192;r&&(r.above&&(n&=-65),r.left&&(n&=-129)),t.write_shift(1,n);for(var i=1;i<3;++i)t.write_shift(1,0);return Hf({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),OS(e,t),t.slice(0,t.l)}function b5(e){var r=Hn(e);return[r]}function x5(e,r,t){return t==null&&(t=fe(8)),bo(r,t)}function E5(e){var r=xo(e);return[r]}function T5(e,r,t){return t==null&&(t=fe(4)),Eo(r,t)}function O5(e){var r=Hn(e),t=e.read_shift(1);return[r,t,"b"]}function R5(e,r,t){return t==null&&(t=fe(9)),bo(r,t),t.write_shift(1,e.v?1:0),t}function k5(e){var r=xo(e),t=e.read_shift(1);return[r,t,"b"]}function A5(e,r,t){return t==null&&(t=fe(5)),Eo(r,t),t.write_shift(1,e.v?1:0),t}function M5(e){var r=Hn(e),t=e.read_shift(1);return[r,t,"e"]}function Nh(e,r,t){return t==null&&(t=fe(9)),bo(r,t),t.write_shift(1,e.v),t}function D5(e){var r=xo(e),t=e.read_shift(1);return[r,t,"e"]}function Fh(e,r,t){return t==null&&(t=fe(8)),Eo(r,t),t.write_shift(1,e.v),t.write_shift(2,0),t.write_shift(1,0),t}function P5(e){var r=Hn(e),t=e.read_shift(4);return[r,t,"s"]}function N5(e,r,t){return t==null&&(t=fe(12)),bo(r,t),t.write_shift(4,r.v),t}function F5(e){var r=xo(e),t=e.read_shift(4);return[r,t,"s"]}function L5(e,r,t){return t==null&&(t=fe(8)),Eo(r,t),t.write_shift(4,r.v),t}function I5(e){var r=Hn(e),t=ks(e);return[r,t,"n"]}function H5(e,r,t){return t==null&&(t=fe(16)),bo(r,t),po(e.v,t),t}function B5(e){var r=xo(e),t=ks(e);return[r,t,"n"]}function W5(e,r,t){return t==null&&(t=fe(12)),Eo(r,t),po(e.v,t),t}function $5(e){var r=Hn(e),t=hg(e);return[r,t,"n"]}function U5(e,r,t){return t==null&&(t=fe(12)),bo(r,t),RS(e.v,t),t}function V5(e){var r=xo(e),t=hg(e);return[r,t,"n"]}function z5(e,r,t){return t==null&&(t=fe(8)),Eo(r,t),RS(e.v,t),t}function j5(e){var r=Hn(e),t=fg(e);return[r,t,"is"]}function Y5(e){var r=Hn(e),t=Jr(e);return[r,t,"str"]}function G5(e,r,t){var n=e.v==null?"":String(e.v);return t==null&&(t=fe(12+4*e.v.length)),bo(r,t),br(n,t),t.length>t.l?t.slice(0,t.l):t}function X5(e){var r=xo(e),t=Jr(e);return[r,t,"str"]}function K5(e,r,t){var n=e.v==null?"":String(e.v);return t==null&&(t=fe(8+4*n.length)),Eo(r,t),br(n,t),t.length>t.l?t.slice(0,t.l):t}function q5(e,r,t){var n=e.l+r,i=Hn(e);i.r=t["!row"];var a=e.read_shift(1),o=[i,a,"b"];if(t.cellFormula){e.l+=2;var s=Kc(e,n-e.l,t);o[3]=gs(s,null,i,t.supbooks,t)}else e.l=n;return o}function Z5(e,r,t){var n=e.l+r,i=Hn(e);i.r=t["!row"];var a=e.read_shift(1),o=[i,a,"e"];if(t.cellFormula){e.l+=2;var s=Kc(e,n-e.l,t);o[3]=gs(s,null,i,t.supbooks,t)}else e.l=n;return o}function J5(e,r,t){var n=e.l+r,i=Hn(e);i.r=t["!row"];var a=ks(e),o=[i,a,"n"];if(t.cellFormula){e.l+=2;var s=Kc(e,n-e.l,t);o[3]=gs(s,null,i,t.supbooks,t)}else e.l=n;return o}function Q5(e,r,t){var n=e.l+r,i=Hn(e);i.r=t["!row"];var a=Jr(e),o=[i,a,"str"];if(t.cellFormula){e.l+=2;var s=Kc(e,n-e.l,t);o[3]=gs(s,null,i,t.supbooks,t)}else e.l=n;return o}var e$=To,t$=Rs;function r$(e,r){return r==null&&(r=fe(4)),r.write_shift(4,e),r}function n$(e,r){var t=e.l+r,n=To(e),i=jc(e),a=Jr(e),o=Jr(e),s=Jr(e);e.l=t;var l={rfx:n,relId:i,loc:a,display:s};return o&&(l.Tooltip=o),l}function i$(e,r){var t=fe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Rs({s:Kt(e[0]),e:Kt(e[0])},t),cg("rId"+r,t);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return br(i||"",t),br(e[1].Tooltip||"",t),br("",t),t.slice(0,t.l)}function a$(){}function o$(e,r,t){var n=e.l+r,i=kS(e),a=e.read_shift(1),o=[i];if(o[2]=a,t.cellFormula){var s=BW(e,n-e.l,t);o[1]=s}else e.l=n;return o}function s$(e,r,t){var n=e.l+r,i=To(e),a=[i];if(t.cellFormula){var o=$W(e,n-e.l,t);a[1]=o,e.l=n}else e.l=n;return a}function l$(e,r,t){t==null&&(t=fe(18));var n=qc(e,r);t.write_shift(-4,e),t.write_shift(-4,e),t.write_shift(4,(n.width||10)*256),t.write_shift(4,0);var i=0;return r.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),r.level&&(i|=r.level<<8),t.write_shift(2,i),t}var ub=["left","right","top","bottom","header","footer"];function u$(e){var r={};return ub.forEach(function(t){r[t]=ks(e)}),r}function f$(e,r){return r==null&&(r=fe(6*8)),lb(e),ub.forEach(function(t){po(e[t],r)}),r}function c$(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function h$(e,r,t){t==null&&(t=fe(30));var n=924;return(((r||{}).Views||[])[0]||{}).RTL&&(n|=32),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function d$(e){var r=fe(24);return r.write_shift(4,4),r.write_shift(4,1),Rs(e,r),r}function v$(e,r){return r==null&&(r=fe(16*4+2)),r.write_shift(2,e.password?YS(e.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?r.write_shift(4,e[t[0]]!=null&&!e[t[0]]?1:0):r.write_shift(4,e[t[0]]!=null&&e[t[0]]?0:1)}),r}function g$(){}function m$(){}function p$(e,r,t,n,i,a,o,s){var l={r:t,c:n};if(r.c&&a["!comments"].push([Qt(l),r.c]),r.v===void 0)return!1;var u="";switch(r.t){case"b":u=r.v?"1":"0";break;case"d":r=Qr(r),r.z=r.z||Wt[14],r.v=Ur(cn(r.v,s),s),r.t="n";break;case"n":case"e":u=""+r.v;break;default:u=r.v;break}switch(l.s=Ea(i.cellXfs,r,i),r.l&&a["!links"].push([Qt(l),r.l]),r.t){case"s":case"str":return i.bookSST?(u=mg(i.Strings,r.v==null?"":String(r.v),i.revStrings),l.t="s",l.v=u,o?ye(e,18,L5(r,l)):ye(e,7,N5(r,l))):(l.t="str",o?ye(e,17,K5(r,l)):ye(e,6,G5(r,l))),!0;case"n":return r.v==(r.v|0)&&r.v>-1e3&&r.v<1e3?o?ye(e,13,z5(r,l)):ye(e,2,U5(r,l)):isNaN(r.v)?o?ye(e,14,Fh({t:"e",v:36},l)):ye(e,3,Nh({t:"e",v:36},l)):isFinite(r.v)?o?ye(e,16,W5(r,l)):ye(e,5,H5(r,l)):o?ye(e,14,Fh({t:"e",v:7},l)):ye(e,3,Nh({t:"e",v:7},l)),!0;case"b":return l.t="b",o?ye(e,15,A5(r,l)):ye(e,4,R5(r,l)),!0;case"e":return l.t="e",o?ye(e,14,Fh(r,l)):ye(e,3,Nh(r,l)),!0}return o?ye(e,12,T5(r,l)):ye(e,1,x5(r,l)),!0}function y$(e,r,t,n,i){var a=Ut(r["!ref"]||"A1"),o,s="",l=[],u=(((i||{}).Workbook||{}).WBProps||{}).date1904;ye(e,145);var f=r["!data"]!=null,c=a.e.r;r["!rows"]&&(c=Math.max(a.e.r,r["!rows"].length-1));for(var h=a.s.r;h<=c;++h){s=kt(h),p5(e,r,a,h);var d=!1;if(h<=a.e.r)for(var g=a.s.c;g<=a.e.c;++g){h===a.s.r&&(l[g]=Ot(g)),o=l[g]+s;var v=f?(r["!data"][h]||[])[g]:r[o];if(!v){d=!1;continue}d=p$(e,v,h,g,n,r,d,u)}}ye(e,146)}function w$(e,r){!r||!r["!merges"]||(ye(e,177,r$(r["!merges"].length)),r["!merges"].forEach(function(t){ye(e,176,t$(t))}),ye(e,178))}function _$(e,r){!r||!r["!cols"]||(ye(e,390),r["!cols"].forEach(function(t,n){t&&ye(e,60,l$(n,t))}),ye(e,391))}function C$(e,r){!r||!r["!ref"]||(ye(e,648),ye(e,649,d$(Ut(r["!ref"]))),ye(e,650))}function S$(e,r,t){r["!links"].forEach(function(n){if(n[1].Target){var i=xt(t,-1,n[1].Target.replace(/#.*$/,""),yt.HLINK);ye(e,494,i$(n,i))}}),delete r["!links"]}function b$(e,r,t,n){if(r["!comments"].length>0){var i=xt(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",yt.VML);ye(e,551,cg("rId"+i)),r["!legacy"]=i}}function x$(e,r,t,n){if(r["!autofilter"]){var i=r["!autofilter"],a=typeof i.ref=="string"?i.ref:gr(i.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var o=t.Workbook.Names,s=$r(a);s.s.r==s.e.r&&(s.e.r=$r(r["!ref"]).e.r,a=gr(s));for(var l=0;l<o.length;++l){var u=o[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref=Dl(t.SheetNames[n])+"!"+Ml(a);break}}l==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:Dl(t.SheetNames[n])+"!"+Ml(a)}),ye(e,161,Rs(Ut(a))),ye(e,162)}}function E$(e,r,t){ye(e,133),ye(e,137,h$(r,t)),ye(e,138),ye(e,134)}function T$(e,r){r["!protect"]&&ye(e,535,v$(r["!protect"]))}function O$(e,r,t,n){var i=Zr(),a=t.SheetNames[e],o=t.Sheets[a]||{},s=a;try{t&&t.Workbook&&(s=t.Workbook.Sheets[e].CodeName||s)}catch{}var l=Ut(o["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(r.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],ye(i,129),(t.vbaraw||o["!outline"])&&ye(i,147,S5(s,o["!outline"])),ye(i,148,w5(l)),E$(i,o,t.Workbook),_$(i,o),y$(i,o,e,r,t),T$(i,o),x$(i,o,t,e),w$(i,o),S$(i,o,n),o["!margins"]&&ye(i,476,f$(o["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&C$(i,o),b$(i,o,e,n),ye(i,130),i.end()}function R$(e,r){e.l+=10;var t=Jr(e);return{name:t}}var k$=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function A$(e){return!e.Workbook||!e.Workbook.WBProps?"false":j3(e.Workbook.WBProps.date1904)?"true":"false"}var M$=":][*?/\\".split("");function fb(e,r){try{if(e=="")throw new Error("Sheet name cannot be blank");if(e.length>31)throw new Error("Sheet name cannot exceed 31 chars");if(e.charCodeAt(0)==39||e.charCodeAt(e.length-1)==39)throw new Error("Sheet name cannot start or end with apostrophe (')");if(e.toLowerCase()=="history")throw new Error("Sheet name cannot be 'History'");M$.forEach(function(t){if(e.indexOf(t)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")})}catch(t){if(r)return!1;throw t}return!0}function D$(e,r,t){e.forEach(function(n,i){fb(n);for(var a=0;a<i;++a)if(n==e[a])throw new Error("Duplicate Sheet Name: "+n);if(t){var o=r&&r[i]&&r[i].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function P$(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var r=e.Workbook&&e.Workbook.Sheets||[];D$(e.SheetNames,r,!!e.vbaraw);for(var t=0;t<e.SheetNames.length;++t)r5(e.Sheets[e.SheetNames[t]],e.SheetNames[t],t);e.SheetNames.forEach(function(n,i){var a=e.Sheets[n];if(!(!a||!a["!autofilter"])){var o;e.Workbook||(e.Workbook={}),e.Workbook.Names||(e.Workbook.Names=[]),e.Workbook.Names.forEach(function(l){l.Name=="_xlnm._FilterDatabase"&&l.Sheet==i&&(o=l)});var s=Dl(n)+"!"+Ml(a["!autofilter"].ref);o?o.Ref=s:e.Workbook.Names.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:s})}})}function N$(e){var r=[mr];r[r.length]=Te("workbook",null,{xmlns:Es[0],"xmlns:r":Ar.r});var t=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(k$.forEach(function(s){e.Workbook.WBProps[s[0]]!=null&&e.Workbook.WBProps[s[0]]!=s[1]&&(n[s[0]]=e.Workbook.WBProps[s[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),r[r.length]=Te("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],a=0;if(i&&i[0]&&i[0].Hidden){for(r[r.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!i[a]||!i[a].Hidden);++a);a==e.SheetNames.length&&(a=0),r[r.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var o={name:lt(e.SheetNames[a].slice(0,31))};if(o.sheetId=""+(a+1),o["r:id"]="rId"+(a+1),i[a])switch(i[a].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}r[r.length]=Te("sheet",null,o)}return r[r.length]="</sheets>",t&&(r[r.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(s){var l={name:s.Name};s.Comment&&(l.comment=s.Comment),s.Sheet!=null&&(l.localSheetId=""+s.Sheet),s.Hidden&&(l.hidden="1"),s.Ref&&(r[r.length]=Te("definedName",lt(s.Ref),l))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function F$(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=p0(e),t.name=Jr(e),t}function L$(e,r){return r||(r=fe(127)),r.write_shift(4,e.Hidden),r.write_shift(4,e.iTabID),cg(e.strRelID,r),br(e.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function I$(e,r){var t={},n=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var i=r>8?Jr(e):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function H$(e,r){r||(r=fe(72));var t=0;return e&&(e.date1904&&(t|=1),e.filterPrivacy&&(t|=8)),r.write_shift(4,t),r.write_shift(4,0),OS(e&&e.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}function B$(e,r,t){var n=e.l+r,i=e.read_shift(4);e.l+=1;var a=e.read_shift(4),o=gB(e),s=WW(e,0,t),l=jc(e);i&32&&(o="_xlnm."+o),e.l=n;var u={Name:o,Ptg:s,Flags:i};return a<268435455&&(u.Sheet=a),l&&(u.Comment=l),u}function W$(e,r){var t=fe(9),n=0,i=e.Name;RB.indexOf(i)>-1&&(n|=32,i=i.slice(6)),t.write_shift(4,n),t.write_shift(1,0),t.write_shift(4,e.Sheet==null?4294967295:e.Sheet);var a=[t,br(i),JW(e.Ref,r)];if(e.Comment)a.push(Pl(e.Comment));else{var o=fe(4);o.write_shift(4,4294967295),a.push(o)}return dr(a)}function $$(e,r){ye(e,143);for(var t=0;t!=r.SheetNames.length;++t){var n=r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t]&&r.Workbook.Sheets[t].Hidden||0,i={Hidden:n,iTabID:t+1,strRelID:"rId"+(t+1),name:r.SheetNames[t]};ye(e,156,L$(i))}ye(e,144)}function U$(e,r){r||(r=fe(127));for(var t=0;t!=4;++t)r.write_shift(4,0);return br("SheetJS",r),br(Af.version,r),br(Af.version,r),br("7262",r),r.length>r.l?r.slice(0,r.l):r}function V$(e,r){r||(r=fe(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,e),r.write_shift(4,e);var t=120;return r.write_shift(1,t),r.length>r.l?r.slice(0,r.l):r}function z$(e,r){if(!(!r.Workbook||!r.Workbook.Sheets)){for(var t=r.Workbook.Sheets,n=0,i=-1,a=-1;n<t.length;++n)!t[n]||!t[n].Hidden&&i==-1?i=n:t[n].Hidden==1&&a==-1&&(a=n);a>i||(ye(e,135),ye(e,158,V$(i)),ye(e,136))}}function j$(e,r){!r.Workbook||!r.Workbook.Names||r.Workbook.Names.forEach(function(t){try{if(t.Flags&14)return;ye(e,39,W$(t,r))}catch{console.error("Could not serialize defined name "+JSON.stringify(t))}})}function Y$(e){var r=e.SheetNames.length,t=fe(12*r+28);t.write_shift(4,r+2),t.write_shift(4,0),t.write_shift(4,-2),t.write_shift(4,-2),t.write_shift(4,0),t.write_shift(4,-1),t.write_shift(4,-1);for(var n=0;n<r;++n)t.write_shift(4,0),t.write_shift(4,n),t.write_shift(4,n);return t}function G$(e,r){ye(e,353),ye(e,357),ye(e,362,Y$(r)),ye(e,354)}function X$(e,r){var t=Zr();return ye(t,131),ye(t,128,U$()),ye(t,153,H$(e.Workbook&&e.Workbook.WBProps||null)),z$(t,e),$$(t,e),G$(t,e),(e.Workbook||{}).Names&&j$(t,e),ye(t,132),t.end()}function K$(e,r){var t=[];return e.Props&&t.push(PB(e.Props,r)),e.Custprops&&t.push(NB(e.Props,e.Custprops)),t.join("")}function q$(e){return(((e||{}).Workbook||{}).WBProps||{}).date1904?'<ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel"><Date1904/></ExcelWorkbook>':""}function Z$(e,r){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(n,i){var a=[];a.push(Te("NumberFormat",null,{"ss:Format":lt(Wt[n.numFmtId])}));var o={"ss:ID":"s"+(21+i)};t.push(Te("Style",a.join(""),o))}),Te("Styles",t.join(""))}function cb(e){return Te("NamedRange",null,{"ss:Name":e.Name.slice(0,6)=="_xlnm."?e.Name.slice(6):e.Name,"ss:RefersTo":"="+Gc(e.Ref,{r:0,c:0})})}function J$(e){if(!((e||{}).Workbook||{}).Names)return"";for(var r=e.Workbook.Names,t=[],n=0;n<r.length;++n){var i=r[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||t.push(cb(i)))}return Te("Names",t.join(""))}function Q$(e,r,t,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,a=[],o=0;o<i.length;++o){var s=i[o];s.Sheet==t&&(s.Name.match(/^_xlfn\./)||a.push(cb(s)))}return a.join("")}function eU(e,r,t,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(Te("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(Te("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(Te("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[t])if(n.Workbook.Sheets[t].Hidden)i.push(Te("Visible",n.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<t&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==t&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(Br("ProtectContents","True")),e["!protect"].objects&&i.push(Br("ProtectObjects","True")),e["!protect"].scenarios&&i.push(Br("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(Br("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(Br("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":Te("WorksheetOptions",i.join(""),{xmlns:_n.x})}function tU(e){return e.map(function(r){var t=z3(r.t||""),n=Te("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"}),i={};return r.a&&(i["ss:Author"]=r.a),e.hidden||(i["ss:ShowAlways"]="1"),Te("Comment",n,i)}).join("")}function rU(e,r,t,n,i,a,o){if(!e||e.v==null&&e.f==null)return"";var s={};if(e.f&&(s["ss:Formula"]="="+lt(Gc(e.f,o))),e.F&&e.F.slice(0,r.length)==r){var l=Kt(e.F.slice(r.length+1));s["ss:ArrayRange"]="RC:R"+(l.r==o.r?"":"["+(l.r-o.r)+"]")+"C"+(l.c==o.c?"":"["+(l.c-o.c)+"]")}if(e.l&&e.l.Target&&(s["ss:HRef"]=lt(e.l.Target),e.l.Tooltip&&(s["x:HRefScreenTip"]=lt(e.l.Tooltip))),t["!merges"])for(var u=t["!merges"],f=0;f!=u.length;++f)u[f].s.c!=o.c||u[f].s.r!=o.r||(u[f].e.c>u[f].s.c&&(s["ss:MergeAcross"]=u[f].e.c-u[f].s.c),u[f].e.r>u[f].s.r&&(s["ss:MergeDown"]=u[f].e.r-u[f].s.r));var c="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":c="Number",h=String(e.v);break;case"b":c="Boolean",h=e.v?"1":"0";break;case"e":c="Error",h=uo[e.v];break;case"d":c="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Wt[14]);break;case"s":c="String",h=V3(e.v||"");break}var d=Ea(n.cellXfs,e,n);s["ss:StyleID"]="s"+(21+d),s["ss:Index"]=o.c+1;var g=e.v!=null?h:"",v=e.t=="z"?"":'<Data ss:Type="'+c+'">'+g+"</Data>";return(e.c||[]).length>0&&(v+=tU(e.c)),Te("Cell",v,s)}function nU(e,r){var t='<Row ss:Index="'+(e+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=XS(r.hpt)),r.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(t+=' ss:Hidden="1"')),t+">"}function iU(e,r,t,n){if(!e["!ref"])return"";var i=Ut(e["!ref"]),a=e["!merges"]||[],o=0,s=[];e["!cols"]&&e["!cols"].forEach(function(p,C){vg(p);var F=!!p.width,D=qc(C,p),ee={"ss:Index":C+1};F&&(ee["ss:Width"]=Wf(D.width)),p.hidden&&(ee["ss:Hidden"]="1"),s.push(Te("Column",null,ee))});for(var l=e["!data"]!=null,u=i.s.r;u<=i.e.r;++u){for(var f=[nU(u,(e["!rows"]||[])[u])],c=i.s.c;c<=i.e.c;++c){var h=!1;for(o=0;o!=a.length;++o)if(!(a[o].s.c>c)&&!(a[o].s.r>u)&&!(a[o].e.c<c)&&!(a[o].e.r<u)){(a[o].s.c!=c||a[o].s.r!=u)&&(h=!0);break}if(!h){var d={r:u,c},g=Ot(c)+kt(u),v=l?(e["!data"][u]||[])[c]:e[g];f.push(rU(v,g,e,r,t,n,d))}}f.push("</Row>"),f.length>2&&s.push(f.join(""))}return s.join("")}function aU(e,r,t){var n=[],i=t.SheetNames[e],a=t.Sheets[i],o=a?Q$(a,r,e,t):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=a?iU(a,r,e,t):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(eU(a,r,e,t)),a["!autofilter"]&&n.push('<AutoFilter x:Range="'+Gc(Ml(a["!autofilter"].ref),{r:0,c:0})+'" xmlns="urn:schemas-microsoft-com:office:excel"></AutoFilter>'),n.join("")}function oU(e,r){r||(r={}),e.SSF||(e.SSF=Qr(Wt)),e.SSF&&(Uc(),$c(e.SSF),r.revssf=Vc(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF,r.cellXfs=[],Ea(r.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(K$(e,r)),t.push(q$(e)),t.push(""),t.push("");for(var n=0;n<e.SheetNames.length;++n)t.push(Te("Worksheet",aU(n,r,e),{"ss:Name":lt(e.SheetNames[n])}));return t[2]=Z$(e,r),t[3]=J$(e),mr+Te("Workbook",t.join(""),{xmlns:_n.ss,"xmlns:o":_n.o,"xmlns:x":_n.x,"xmlns:ss":_n.ss,"xmlns:dt":_n.dt,"xmlns:html":_n.html})}var Lh={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function sU(e,r){var t=[],n=[],i=[],a=0,o,s=Ay(Uy,"n"),l=Ay(Vy,"n");if(e.Props)for(o=vr(e.Props),a=0;a<o.length;++a)(Object.prototype.hasOwnProperty.call(s,o[a])?t:Object.prototype.hasOwnProperty.call(l,o[a])?n:i).push([o[a],e.Props[o[a]]]);if(e.Custprops)for(o=vr(e.Custprops),a=0;a<o.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},o[a])||(Object.prototype.hasOwnProperty.call(s,o[a])?t:Object.prototype.hasOwnProperty.call(l,o[a])?n:i).push([o[a],e.Custprops[o[a]]]);var u=[];for(a=0;a<i.length;++a)BS.indexOf(i[a][0])>-1||LS.indexOf(i[a][0])>-1||i[a][1]!=null&&u.push(i[a]);n.length&&Nt.utils.cfb_add(r,"/SummaryInformation",Xy(n,Lh.SI,l,Vy)),(t.length||u.length)&&Nt.utils.cfb_add(r,"/DocumentSummaryInformation",Xy(t,Lh.DSI,s,Uy,u.length?u:null,Lh.UDI))}function lU(e,r){var t=r||{},n=Nt.utils.cfb_new({root:"R"}),i="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":i="/Workbook",t.biff=8;break;case"biff5":i="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Nt.utils.cfb_add(n,i,db(e,t)),t.biff==8&&(e.Props||e.Custprops)&&sU(e,n),t.biff==8&&e.vbaraw&&y8(n,Nt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var uU={0:{f:g5},1:{f:b5},2:{f:$5},3:{f:M5},4:{f:O5},5:{f:I5},6:{f:Y5},7:{f:P5},8:{f:Q5},9:{f:J5},10:{f:q5},11:{f:Z5},12:{f:E5},13:{f:V5},14:{f:D5},15:{f:k5},16:{f:B5},17:{f:X5},18:{f:F5},19:{f:fg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:B$},40:{},42:{},43:{f:I6},44:{f:F6},45:{f:W6},46:{f:U6},47:{f:$6},48:{},49:{f:lB},50:{},51:{f:i8},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:d6},62:{f:j5},63:{f:c8},64:{f:g$},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:di,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:c$},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:C5},148:{f:y5,p:16},151:{f:a$},152:{},153:{f:I$},154:{},155:{},156:{f:F$},157:{},158:{},159:{T:1,f:x6},160:{T:-1},161:{T:1,f:To},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:e$},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:r8},336:{T:-1},337:{f:s8,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:p0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:l6},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:o$},427:{f:s$},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:u$},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:_5},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:n$},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:p0},551:{f:jc},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:m8},633:{T:1},634:{T:-1},635:{T:1,f:v8},636:{T:-1},637:{f:hB},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:R$},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:m$},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function _e(e,r,t,n){var i=r;if(!isNaN(i)){var a=n||(t||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,a),a>0&&sg(t)&&e.push(t)}}function fU(e,r,t,n){var i=n||(t||[]).length||0;if(i<=8224)return _e(e,r,t,i);var a=r;if(!isNaN(a)){for(var o=t.parts||[],s=0,l=0,u=0;u+(o[s]||8224)<=8224;)u+=o[s]||8224,s++;var f=e.next(4);for(f.write_shift(2,a),f.write_shift(2,u),e.push(t.slice(l,l+u)),l+=u;l<i;){for(f=e.next(4),f.write_shift(2,60),u=0;u+(o[s]||8224)<=8224;)u+=o[s]||8224,s++;f.write_shift(2,u),e.push(t.slice(l,l+u)),l+=u}}}function Ih(e,r,t,n){var i=fe(9);return jl(i,e,r),WS(t,n||"b",i),i}function cU(e,r,t){var n=fe(8+2*t.length);return jl(n,e,r),n.write_shift(1,t.length),n.write_shift(t.length,t,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function hb(e,r){r.forEach(function(t){var n=t[0].map(function(a){return a.t}).join("");if(n.length<=2048)return _e(e,28,Dh(n,t[1],t[2]));_e(e,28,Dh(n.slice(0,2048),t[1],t[2],n.length));for(var i=2048;i<n.length;i+=2048)_e(e,28,Dh(n.slice(i,Math.min(i+2048,n.length)),-1,-1,Math.min(2048,n.length-i)))})}function hU(e,r,t,n,i,a){var o=0;r.z!=null&&(o=i._BIFF2FmtTable.indexOf(r.z),o==-1&&(i._BIFF2FmtTable.push(r.z),o=i._BIFF2FmtTable.length-1));var s=0;if(r.z!=null){for(;s<i.cellXfs.length&&i.cellXfs[s].numFmtId!=o;++s);s==i.cellXfs.length&&i.cellXfs.push({numFmtId:o})}if(r.v!=null)switch(r.t){case"d":case"n":var l=r.t=="d"?Ur(cn(r.v,a),a):r.v;i.biff==2&&l==(l|0)&&l>=0&&l<65536?_e(e,2,p6(t,n,l,s,o)):isNaN(l)?_e(e,5,Ih(t,n,36,"e")):isFinite(l)?_e(e,3,m6(t,n,l,s,o)):_e(e,5,Ih(t,n,7,"e"));return;case"b":case"e":_e(e,5,Ih(t,n,r.v,r.t));return;case"s":case"str":_e(e,4,cU(t,n,r.v==null?"":String(r.v).slice(0,255)));return}_e(e,1,jl(null,t,n))}function dU(e,r,t,n,i){var a=r["!data"]!=null,o=Ut(r["!ref"]||"A1"),s="",l=[];if(o.e.c>255||o.e.r>16383){if(n.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383)}for(var u=(((i||{}).Workbook||{}).WBProps||{}).date1904,f=[],c=[],h=o.s.c;h<=o.e.c;++h)l[h]=Ot(h);for(var d=o.s.r;d<=o.e.r;++d)for(a&&(f=r["!data"][d]||[]),s=kt(d),h=o.s.c;h<=o.e.c;++h){var g=a?f[h]:r[l[h]+s];g&&(hU(e,g,d,h,n,u),g.c&&c.push([g.c,d,h]))}hb(e,c)}function vU(e,r){for(var t=r||{},n=Zr(),i=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==t.sheet&&(i=a);if(i==0&&t.sheet&&e.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);_e(n,t.biff==4?1033:t.biff==3?521:9,dg(e,16,t)),((e.Workbook||{}).WBProps||{}).date1904&&_e(n,34,Xr(!0)),t.cellXfs=[{numFmtId:0}],t._BIFF2FmtTable=["General"],t._Fonts=[];var o=Zr();return dU(o,e.Sheets[e.SheetNames[i]],i,t,e),t._BIFF2FmtTable.forEach(function(s){t.biff<=3?_e(n,30,t6(s)):_e(n,1054,r6(s))}),t.cellXfs.forEach(function(s){switch(t.biff){case 2:_e(n,67,i6(s));break;case 3:_e(n,579,zS(s));break;case 4:_e(n,1091,a6(s));break}}),delete t._BIFF2FmtTable,delete t.cellXfs,delete t._Fonts,n.push(o.end()),_e(n,10),n.end()}var Bn=1,Pn=[];function gU(){var e=fe(82+8*Pn.length);e.write_shift(2,15),e.write_shift(2,61440),e.write_shift(4,74+8*Pn.length);{e.write_shift(2,0),e.write_shift(2,61446),e.write_shift(4,16+8*Pn.length);{e.write_shift(4,Bn),e.write_shift(4,Pn.length+1);for(var r=0,t=0;t<Pn.length;++t)r+=Pn[t]&&Pn[t][1]||0;e.write_shift(4,r),e.write_shift(4,Pn.length)}Pn.forEach(function(n){e.write_shift(4,n[0]),e.write_shift(4,n[2])})}return e.write_shift(2,51),e.write_shift(2,61451),e.write_shift(4,18),e.write_shift(2,191),e.write_shift(4,524296),e.write_shift(2,385),e.write_shift(4,134217793),e.write_shift(2,448),e.write_shift(4,134217792),e.write_shift(2,64),e.write_shift(2,61726),e.write_shift(4,16),e.write_shift(4,134217741),e.write_shift(4,134217740),e.write_shift(4,134217751),e.write_shift(4,268435703),e}function mU(e,r){var t=[],n=0,i=Zr(),a=Bn,o;r.forEach(function(l,u){var f="",c=l[0].map(function(D){return D.a&&!f&&(f=D.a),D.t}).join("");++Bn;{var h=fe(150);h.write_shift(2,15),h.write_shift(2,61444),h.write_shift(4,150),h.write_shift(2,3234),h.write_shift(2,61450),h.write_shift(4,8),h.write_shift(4,Bn),h.write_shift(4,2560),h.write_shift(2,227),h.write_shift(2,61451),h.write_shift(4,84),h.write_shift(2,128),h.write_shift(4,0),h.write_shift(2,139),h.write_shift(4,2),h.write_shift(2,191),h.write_shift(4,524296),h.write_shift(2,344),h.l+=4,h.write_shift(2,385),h.write_shift(4,134217808),h.write_shift(2,387),h.write_shift(4,134217808),h.write_shift(2,389),h.write_shift(4,268435700),h.write_shift(2,447),h.write_shift(4,1048592),h.write_shift(2,448),h.write_shift(4,134217809),h.write_shift(2,451),h.write_shift(4,268435700),h.write_shift(2,513),h.write_shift(4,134217809),h.write_shift(2,515),h.write_shift(4,268435700),h.write_shift(2,575),h.write_shift(4,196609),h.write_shift(2,959),h.write_shift(4,131072|(l[0].hidden?2:0)),h.l+=2,h.write_shift(2,61456),h.write_shift(4,18),h.write_shift(2,3),h.write_shift(2,l[2]+2),h.l+=2,h.write_shift(2,l[1]+1),h.l+=2,h.write_shift(2,l[2]+4),h.l+=2,h.write_shift(2,l[1]+5),h.l+=2,h.l+=2,h.write_shift(2,61457),h.l+=4,h.l=150,u==0?o=h:_e(i,236,h)}n+=150;{var d=fe(52);d.write_shift(2,21),d.write_shift(2,18),d.write_shift(2,25),d.write_shift(2,Bn),d.write_shift(2,0),d.l=22,d.write_shift(2,13),d.write_shift(2,22),d.write_shift(4,1651663474),d.write_shift(4,2503426821),d.write_shift(4,2150634280),d.write_shift(4,1768515844+Bn*256),d.write_shift(2,0),d.write_shift(4,0),d.l+=4,_e(i,93,d)}{var g=fe(8);g.l+=2,g.write_shift(2,61453),g.l+=4,_e(i,236,g)}n+=8;{var v=fe(18);v.write_shift(2,18),v.l+=8,v.write_shift(2,c.length),v.write_shift(2,16),v.l+=4,_e(i,438,v);{var p=fe(1+c.length);p.write_shift(1,0),p.write_shift(c.length,c,"sbcs"),_e(i,60,p)}{var C=fe(16);C.l+=8,C.write_shift(2,c.length),C.l+=6,_e(i,60,C)}}{var F=fe(12+f.length);F.write_shift(2,l[1]),F.write_shift(2,l[2]),F.write_shift(2,0|(l[0].hidden?0:2)),F.write_shift(2,Bn),F.write_shift(2,f.length),F.write_shift(1,0),F.write_shift(f.length,f,"sbcs"),F.l++,t.push(F)}});{var s=fe(80);s.write_shift(2,15),s.write_shift(2,61442),s.write_shift(4,n+s.length-8),s.write_shift(2,16),s.write_shift(2,61448),s.write_shift(4,8),s.write_shift(4,r.length+1),s.write_shift(4,Bn),s.write_shift(2,15),s.write_shift(2,61443),s.write_shift(4,n+48),s.write_shift(2,15),s.write_shift(2,61444),s.write_shift(4,40),s.write_shift(2,1),s.write_shift(2,61449),s.write_shift(4,16),s.l+=16,s.write_shift(2,2),s.write_shift(2,61450),s.write_shift(4,8),s.write_shift(4,a),s.write_shift(4,5),_e(e,236,o?dr([s,o]):s)}e.push(i.end()),t.forEach(function(l){_e(e,28,l)}),Pn.push([a,r.length+1,Bn]),++Bn}function pU(e,r,t){_e(e,49,ZB({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},t))}function yU(e,r,t){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)r[i]!=null&&_e(e,1054,e6(i,r[i],t))})}function wU(e,r){var t=fe(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),_e(e,2151,t),t=fe(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),VS(Ut(r["!ref"]||"A1"),t),t.write_shift(4,4),_e(e,2152,t)}function _U(e,r){for(var t=0;t<16;++t)_e(e,224,qy({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(n){_e(e,224,qy(n,0,r))})}function CU(e,r){for(var t=0;t<r["!links"].length;++t){var n=r["!links"][t];_e(e,440,f6(n)),n[1].Tooltip&&_e(e,2048,c6(n))}delete r["!links"]}function SU(e,r){if(r){var t=0;r.forEach(function(n,i){++t<=256&&n&&_e(e,125,v6(qc(i,n),i))})}}function bU(e,r,t,n,i,a){var o=16+Ea(i.cellXfs,r,i);if(r.v==null&&!r.bf){_e(e,513,yo(t,n,o));return}if(r.bf)_e(e,6,HW(r,t,n,i,o));else switch(r.t){case"d":case"n":var s=r.t=="d"?Ur(cn(r.v,a),a):r.v;isNaN(s)?_e(e,517,Mh(t,n,36,o,i,"e")):isFinite(s)?_e(e,515,s6(t,n,s,o)):_e(e,517,Mh(t,n,7,o,i,"e"));break;case"b":case"e":_e(e,517,Mh(t,n,r.v,o,i,r.t));break;case"s":case"str":if(i.bookSST){var l=mg(i.Strings,r.v==null?"":String(r.v),i.revStrings);_e(e,253,JB(t,n,l,o))}else _e(e,516,QB(t,n,(r.v==null?"":String(r.v)).slice(0,255),o,i));break;default:_e(e,513,yo(t,n,o))}}function xU(e,r,t){var n=Zr(),i=t.SheetNames[e],a=t.Sheets[i]||{},o=(t||{}).Workbook||{},s=(o.Sheets||[])[e]||{},l=a["!data"]!=null,u=r.biff==8,f,c="",h=[],d=Ut(a["!ref"]||"A1"),g=u?65536:16384;if(d.e.c>255||d.e.r>=g){if(r.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,g-1)}_e(n,2057,dg(t,16,r)),_e(n,13,Nn(1)),_e(n,12,Nn(100)),_e(n,15,Xr(!0)),_e(n,17,Xr(!1)),_e(n,16,po(.001)),_e(n,95,Xr(!0)),_e(n,42,Xr(!1)),_e(n,43,Xr(!1)),_e(n,130,Nn(1)),_e(n,128,o6([0,0])),_e(n,131,Xr(!1)),_e(n,132,Xr(!1)),u&&SU(n,a["!cols"]),_e(n,512,n6(d,r));var v=(((t||{}).Workbook||{}).WBProps||{}).date1904;u&&(a["!links"]=[]);for(var p=[],C=[],F=d.s.c;F<=d.e.c;++F)h[F]=Ot(F);for(var D=d.s.r;D<=d.e.r;++D)for(l&&(C=a["!data"][D]||[]),c=kt(D),F=d.s.c;F<=d.e.c;++F){f=h[F]+c;var ee=l?C[F]:a[f];ee&&(bU(n,ee,D,F,r,v),u&&ee.l&&a["!links"].push([f,ee.l]),ee.c&&p.push([ee.c,D,F]))}var ue=s.CodeName||s.name||i;return u?mU(n,p):hb(n,p),u&&_e(n,574,qB((o.Views||[])[0])),u&&(a["!merges"]||[]).length&&_e(n,229,u6(a["!merges"])),u&&CU(n,a),_e(n,442,US(ue)),u&&wU(n,a),_e(n,10),n.end()}function EU(e,r,t){var n=Zr(),i=(e||{}).Workbook||{},a=i.Sheets||[],o=i.WBProps||{},s=t.biff==8,l=t.biff==5;if(_e(n,2057,dg(e,5,t)),t.bookType=="xla"&&_e(n,135),_e(n,225,s?Nn(1200):null),_e(n,193,IB(2)),l&&_e(n,191),l&&_e(n,192),_e(n,226),_e(n,92,YB("SheetJS",t)),_e(n,66,Nn(s?1200:1252)),s&&_e(n,353,Nn(0)),s&&_e(n,448),_e(n,317,g6(e.SheetNames.length)),s&&e.vbaraw&&_e(n,211),s&&e.vbaraw){var u=o.CodeName||"ThisWorkbook";_e(n,442,US(u))}_e(n,156,Nn(17)),_e(n,25,Xr(!1)),_e(n,18,Xr(!1)),_e(n,19,Nn(0)),s&&_e(n,431,Xr(!1)),s&&_e(n,444,Nn(0)),_e(n,61,KB()),_e(n,64,Xr(!1)),_e(n,141,Nn(0)),_e(n,34,Xr(A$(e)=="true")),_e(n,14,Xr(!0)),s&&_e(n,439,Xr(!1)),_e(n,218,Nn(0)),pU(n,e,t),yU(n,e.SSF,t),_U(n,t),s&&_e(n,352,Xr(!1));var f=n.end(),c=Zr();s&&_e(c,140,h6()),s&&Pn.length&&_e(c,235,gU()),s&&t.Strings&&fU(c,252,XB(t.Strings)),_e(c,10);var h=c.end(),d=Zr(),g=0,v=0;for(v=0;v<e.SheetNames.length;++v)g+=(s?12:11)+(s?2:1)*e.SheetNames[v].length;var p=f.length+g+h.length;for(v=0;v<e.SheetNames.length;++v){var C=a[v]||{};_e(d,133,GB({pos:p,hs:C.Hidden||0,dt:0,name:e.SheetNames[v]},t)),p+=r[v].length}var F=d.end();if(g!=F.length)throw new Error("BS8 "+g+" != "+F.length);var D=[];return f.length&&D.push(f),F.length&&D.push(F),h.length&&D.push(h),dr(D)}function TU(e,r){var t=r||{},n=[];e&&!e.SSF&&(e.SSF=Qr(Wt)),e&&e.SSF&&(Uc(),$c(e.SSF),t.revssf=Vc(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),Bn=1,Pn=[],t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,pg(t),t.cellXfs=[],Ea(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=xU(i,t,e);return n.unshift(EU(e,n,t)),dr(n)}function db(e,r){for(var t=0;t<=e.SheetNames.length;++t){var n=e.Sheets[e.SheetNames[t]];if(!(!n||!n["!ref"])){var i=$r(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var a=r||{};switch(a.biff||2){case 8:case 5:return TU(e,r);case 4:case 3:case 2:return vU(e,r)}throw new Error("invalid type "+a.bookType+" for BIFF")}function OU(e,r,t,n){for(var i=e["!merges"]||[],a=[],o={},s=e["!data"]!=null,l=r.s.c;l<=r.e.c;++l){for(var u=0,f=0,c=0;c<i.length;++c)if(!(i[c].s.r>t||i[c].s.c>l)&&!(i[c].e.r<t||i[c].e.c<l)){if(i[c].s.r<t||i[c].s.c<l){u=-1;break}u=i[c].e.r-i[c].s.r+1,f=i[c].e.c-i[c].s.c+1;break}if(!(u<0)){var h=Ot(l)+kt(t),d=s?(e["!data"][t]||[])[l]:e[h],g=d&&d.v!=null&&(d.h||Dy(d.w||(Hi(d),d.w)||""))||"";o={},u>1&&(o.rowspan=u),f>1&&(o.colspan=f),n.editable?g='<span contenteditable="true">'+g+"</span>":d&&(o["data-t"]=d&&d.t||"z",d.v!=null&&(o["data-v"]=d.v instanceof Date?d.v.toISOString():d.v),d.z!=null&&(o["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+Dy(d.l.Target)+'">'+g+"</a>")),o.id=(n.id||"sjs")+"-"+h,a.push(Te("td",g,o))}}var v="<tr>";return v+a.join("")+"</tr>"}var RU='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',kU="</body></html>";function AU(e,r,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function vb(e,r){var t=r||{},n=t.header!=null?t.header:RU,i=t.footer!=null?t.footer:kU,a=[n],o=$r(e["!ref"]||"A1");if(a.push(AU(e,o,t)),e["!ref"])for(var s=o.s.r;s<=o.e.r;++s)a.push(OU(e,o,s,t));return a.push("</table>"+i),a.join("")}function gb(e,r,t){var n=r.rows;if(!n)throw"Unsupported origin when "+r.tagName+" is not a TABLE";var i=t||{},a=e["!data"]!=null,o=0,s=0;if(i.origin!=null)if(typeof i.origin=="number")o=i.origin;else{var l=typeof i.origin=="string"?Kt(i.origin):i.origin;o=l.r,s=l.c}var u=Math.min(i.sheetRows||1e7,n.length),f={s:{r:0,c:0},e:{r:o,c:s}};if(e["!ref"]){var c=$r(e["!ref"]);f.s.r=Math.min(f.s.r,c.s.r),f.s.c=Math.min(f.s.c,c.s.c),f.e.r=Math.max(f.e.r,c.e.r),f.e.c=Math.max(f.e.c,c.e.c),o==-1&&(f.e.r=o=c.e.r+1)}var h=[],d=0,g=e["!rows"]||(e["!rows"]=[]),v=0,p=0,C=0,F=0,D=0,ee=0;for(e["!cols"]||(e["!cols"]=[]);v<n.length&&p<u;++v){var ue=n[v];if(sw(ue)){if(i.display)continue;g[p]={hidden:!0}}var se=ue.cells;for(C=F=0;C<se.length;++C){var U=se[C];if(!(i.display&&sw(U))){var re=U.hasAttribute("data-v")?U.getAttribute("data-v"):U.hasAttribute("v")?U.getAttribute("v"):Y3(U.innerHTML),m=U.getAttribute("data-z")||U.getAttribute("z");for(d=0;d<h.length;++d){var _=h[d];_.s.c==F+s&&_.s.r<p+o&&p+o<=_.e.r&&(F=_.e.c+1-s,d=-1)}ee=+U.getAttribute("colspan")||1,((D=+U.getAttribute("rowspan")||1)>1||ee>1)&&h.push({s:{r:p+o,c:F+s},e:{r:p+o+(D||1)-1,c:F+s+(ee||1)-1}});var x={t:"s",v:re},B=U.getAttribute("data-t")||U.getAttribute("t")||"";re!=null&&(re.length==0?x.t=B||"z":i.raw||re.trim().length==0||B=="s"||(re==="TRUE"?x={t:"b",v:!0}:re==="FALSE"?x={t:"b",v:!1}:isNaN(Pi(re))?isNaN(Lf(re).getDate())||(x={t:"d",v:cn(re)},i.UTC&&(x.v=zc(x.v)),i.cellDates||(x={t:"n",v:Ur(x.v)}),x.z=i.dateNF||Wt[14]):x={t:"n",v:Pi(re)})),x.z===void 0&&m!=null&&(x.z=m);var Q="",A=U.getElementsByTagName("A");if(A&&A.length)for(var W=0;W<A.length&&!(A[W].hasAttribute("href")&&(Q=A[W].getAttribute("href"),Q.charAt(0)!="#"));++W);Q&&Q.charAt(0)!="#"&&Q.slice(0,11).toLowerCase()!="javascript:"&&(x.l={Target:Q}),a?(e["!data"][p+o]||(e["!data"][p+o]=[]),e["!data"][p+o][F+s]=x):e[Qt({c:F+s,r:p+o})]=x,f.e.c<F+s&&(f.e.c=F+s),F+=ee}}++p}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),f.e.r=Math.max(f.e.r,p-1+o),e["!ref"]=gr(f),p>=u&&(e["!fullref"]=gr((f.e.r=n.length-v+p-1+o,f))),e}function mb(e,r){var t=r||{},n={};return t.dense&&(n["!data"]=[]),gb(n,e,r)}function MU(e,r){var t=Ts(mb(e,r),r);return t}function sw(e){var r="",t=DU(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function DU(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var PU=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+Al({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return mr+r}}();function NU(e,r){var t="number",n="",i={"style:name":r},a="",o=0;e=e.replace(/"[$]"/g,"$");e:{if(e.indexOf(";")>-1&&(console.error("Unsupported ODS Style Map exported.  Using first branch of "+e),e=e.slice(0,e.indexOf(";"))),e=="@"){t="text",n="<number:text-content/>";break e}if(e.indexOf(/\$/)>-1&&(t="currency"),e[o]=='"'){for(a="";e[++o]!='"'||e[++o]=='"';)a+=e[o];--o,e[o+1]=="*"?(o++,n+="<number:fill-character>"+lt(a.replace(/""/g,'"'))+"</number:fill-character>"):n+="<number:text>"+lt(a.replace(/""/g,'"'))+"</number:text>",e=e.slice(o+1),o=0}var s=e.match(/# (\?+)\/(\?+)/);if(s){n+=Te("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":s[1].length,"number:max-denominator-value":Math.max(+s[1].replace(/./g,"9"),+s[2].replace(/./g,"9"))});break e}if(s=e.match(/# (\?+)\/(\d+)/)){n+=Te("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":s[1].length,"number:denominator-value":+s[2]});break e}if(s=e.match(/(\d+)(|\.\d+)%/)){t="percentage",n+=Te("number:number",null,{"number:decimal-places":s[2]&&s.length-1||0,"number:min-decimal-places":s[2]&&s.length-1||0,"number:min-integer-digits":s[1].length})+"<number:text>%</number:text>";break e}var l=!1;if(["y","m","d"].indexOf(e[0])>-1){t="date";t:for(;o<e.length;++o)switch(a=e[o].toLowerCase()){case"h":case"s":l=!0,--o;break t;case"m":r:for(var u=o+1;u<e.length;++u)switch(e[u]){case"y":case"d":break r;case"h":case"s":l=!0,--o;break t}case"y":case"d":for(;(e[++o]||"").toLowerCase()==a[0];)a+=a[0];switch(--o,a){case"y":case"yy":n+="<number:year/>";break;case"yyy":case"yyyy":n+='<number:year number:style="long"/>';break;case"mmmmm":console.error("ODS has no equivalent of format |mmmmm|");case"m":case"mm":case"mmm":case"mmmm":n+='<number:month number:style="'+(a.length%2?"short":"long")+'" number:textual="'+(a.length>=3?"true":"false")+'"/>';break;case"d":case"dd":n+='<number:day number:style="'+(a.length%2?"short":"long")+'"/>';break;case"ddd":case"dddd":n+='<number:day-of-week number:style="'+(a.length%2?"short":"long")+'"/>';break}break;case'"':for(;e[++o]!='"'||e[++o]=='"';)a+=e[o];--o,n+="<number:text>"+lt(a.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"\\":a=e[++o],n+="<number:text>"+lt(a)+"</number:text>";break;case"/":case":":n+="<number:text>"+lt(a)+"</number:text>";break;default:console.error("unrecognized character "+a+" in ODF format "+e)}if(!l)break e;e=e.slice(o+1),o=0}if(e.match(/^\[?[hms]/)){for(t=="number"&&(t="time"),e.match(/\[/)&&(e=e.replace(/[\[\]]/g,""),i["number:truncate-on-overflow"]="false");o<e.length;++o)switch(a=e[o].toLowerCase()){case"h":case"m":case"s":for(;(e[++o]||"").toLowerCase()==a[0];)a+=a[0];switch(--o,a){case"h":case"hh":n+='<number:hours number:style="'+(a.length%2?"short":"long")+'"/>';break;case"m":case"mm":n+='<number:minutes number:style="'+(a.length%2?"short":"long")+'"/>';break;case"s":case"ss":if(e[o+1]==".")do a+=e[o+1],++o;while(e[o+1]=="0");n+='<number:seconds number:style="'+(a.match("ss")?"long":"short")+'"'+(a.match(/\./)?' number:decimal-places="'+(a.match(/0+/)||[""])[0].length+'"':"")+"/>";break}break;case'"':for(;e[++o]!='"'||e[++o]=='"';)a+=e[o];--o,n+="<number:text>"+lt(a.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"/":case":":n+="<number:text>"+lt(a)+"</number:text>";break;case"a":if(e.slice(o,o+3).toLowerCase()=="a/p"){n+="<number:am-pm/>",o+=2;break}if(e.slice(o,o+5).toLowerCase()=="am/pm"){n+="<number:am-pm/>",o+=4;break}default:console.error("unrecognized character "+a+" in ODF format "+e)}break e}if(e.indexOf(/\$/)>-1&&(t="currency"),e[0]=="$"&&(n+='<number:currency-symbol number:language="en" number:country="US">$</number:currency-symbol>',e=e.slice(1),o=0),o=0,e[o]=='"'){for(;e[++o]!='"'||e[++o]=='"';)a+=e[o];--o,e[o+1]=="*"?(o++,n+="<number:fill-character>"+lt(a.replace(/""/g,'"'))+"</number:fill-character>"):n+="<number:text>"+lt(a.replace(/""/g,'"'))+"</number:text>",e=e.slice(o+1),o=0}var f=e.match(/([#0][0#,]*)(\.[0#]*|)(E[+]?0*|)/i);if(!f||!f[0])console.error("Could not find numeric part of "+e);else{var c=f[1].replace(/,/g,"");n+="<number:"+(f[3]?"scientific-":"")+'number number:min-integer-digits="'+(c.indexOf("0")==-1?"0":c.length-c.indexOf("0"))+'"'+(f[0].indexOf(",")>-1?' number:grouping="true"':"")+(f[2]&&' number:decimal-places="'+(f[2].length-1)+'"'||' number:decimal-places="0"')+(f[3]&&f[3].indexOf("+")>-1?' number:forced-exponent-sign="true"':"")+(f[3]?' number:min-exponent-digits="'+f[3].match(/0+/)[0].length+'"':"")+"></number:"+(f[3]?"scientific-":"")+"number>",o=f.index+f[0].length}if(e[o]=='"'){for(a="";e[++o]!='"'||e[++o]=='"';)a+=e[o];--o,n+="<number:text>"+lt(a.replace(/""/g,'"'))+"</number:text>"}}return n?Te("number:"+t+"-style",n,i):(console.error("Could not generate ODS number format for |"+e+"|"),"")}function lw(e,r,t){for(var n=[],i=0;i<e.length;++i){var a=e[i];a&&a.Sheet==(t==-1?null:t)&&n.push(a)}return n.length?`      <table:named-expressions>
`+n.map(function(o){var s=(t==-1?"$":"")+sb(o.Ref);return"        "+Te("table:named-range",null,{"table:name":o.Name,"table:cell-range-address":s,"table:base-cell-address":s.replace(/[\.]?[^\.]*$/,".$A$1")})}).join(`
`)+`
      </table:named-expressions>
`:""}var uw=function(){var e=function(i){return lt(i).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r=`          <table:table-cell />
`,t=function(i,a,o,s,l,u){var f=[];f.push('      <table:table table:name="'+lt(a.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,h=0,d=$r(i["!ref"]||"A1"),g=i["!merges"]||[],v=0,p=i["!data"]!=null;if(i["!cols"])for(h=0;h<=d.e.c;++h)f.push("        <table:table-column"+(i["!cols"][h]?' table:style-name="co'+i["!cols"][h].ods+'"':"")+`></table:table-column>
`);var C="",F=i["!rows"]||[];for(c=0;c<d.s.r;++c)C=F[c]?' table:style-name="ro'+F[c].ods+'"':"",f.push("        <table:table-row"+C+`></table:table-row>
`);for(;c<=d.e.r;++c){for(C=F[c]?' table:style-name="ro'+F[c].ods+'"':"",f.push("        <table:table-row"+C+`>
`),h=0;h<d.s.c;++h)f.push(r);for(;h<=d.e.c;++h){var D=!1,ee={},ue="";for(v=0;v!=g.length;++v)if(!(g[v].s.c>h)&&!(g[v].s.r>c)&&!(g[v].e.c<h)&&!(g[v].e.r<c)){(g[v].s.c!=h||g[v].s.r!=c)&&(D=!0),ee["table:number-columns-spanned"]=g[v].e.c-g[v].s.c+1,ee["table:number-rows-spanned"]=g[v].e.r-g[v].s.r+1;break}if(D){f.push(`          <table:covered-table-cell/>
`);continue}var se=Qt({r:c,c:h}),U=p?(i["!data"][c]||[])[h]:i[se];if(U&&U.f&&(ee["table:formula"]=lt(t5(U.f)),U.F&&U.F.slice(0,se.length)==se)){var re=$r(U.F);ee["table:number-matrix-columns-spanned"]=re.e.c-re.s.c+1,ee["table:number-matrix-rows-spanned"]=re.e.r-re.s.r+1}if(!U){f.push(r);continue}switch(U.t){case"b":ue=U.v?"TRUE":"FALSE",ee["office:value-type"]="boolean",ee["office:boolean-value"]=U.v?"true":"false";break;case"n":ue=U.w||String(U.v||0),ee["office:value-type"]="float",ee["office:value"]=U.v||0;break;case"s":case"str":ue=U.v==null?"":U.v,ee["office:value-type"]="string";break;case"d":ue=U.w||cn(U.v,u).toISOString(),ee["office:value-type"]="date",ee["office:date-value"]=cn(U.v,u).toISOString(),ee["table:style-name"]="ce1";break;default:f.push(r);continue}var m=e(ue);if(U.l&&U.l.Target){var _=U.l.Target;_=_.charAt(0)=="#"?"#"+sb(_.slice(1)):_,_.charAt(0)!="#"&&!_.match(/^\w+:/)&&(_="../"+_),m=Te("text:a",m,{"xlink:href":_.replace(/&/g,"&amp;")})}l[U.z]&&(ee["table:style-name"]="ce"+l[U.z].slice(1));var x=Te("text:p",m,{});if(U.c){for(var B="",Q="",A={},W=0;W<U.c.length;++W)!B&&U.c[W].a&&(B=U.c[W].a),Q+="<text:p>"+e(U.c[W].t)+"</text:p>";U.c.hidden||(A["office:display"]=!0),x=Te("office:annotation",Q,A)+x}f.push("          "+Te("table:table-cell",x,ee)+`
`)}f.push(`        </table:table-row>
`)}return(a.Workbook||{}).Names&&f.push(lw(a.Workbook.Names,a.SheetNames,o)),f.push(`      </table:table>
`),f.join("")},n=function(i,a){i.push(` <office:automatic-styles>
`);var o=0;a.SheetNames.map(function(f){return a.Sheets[f]}).forEach(function(f){if(f&&f["!cols"]){for(var c=0;c<f["!cols"].length;++c)if(f["!cols"][c]){var h=f["!cols"][c];if(h.width==null&&h.wpx==null&&h.wch==null)continue;vg(h),h.ods=o;var d=f["!cols"][c].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+d+`"/>
`),i.push(`  </style:style>
`),++o}}});var s=0;a.SheetNames.map(function(f){return a.Sheets[f]}).forEach(function(f){if(f&&f["!rows"]){for(var c=0;c<f["!rows"].length;++c)if(f["!rows"][c]){f["!rows"][c].ods=s;var h=f["!rows"][c].hpx+"px";i.push('  <style:style style:name="ro'+s+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),i.push(`  </style:style>
`),++s}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var l={},u=69;return a.SheetNames.map(function(f){return a.Sheets[f]}).forEach(function(f){if(f){var c=f["!data"]!=null;if(f["!ref"])for(var h=$r(f["!ref"]),d=0;d<=h.e.r;++d)for(var g=0;g<=h.e.c;++g){var v=c?(f["!data"][d]||[])[g]:f[Qt({r:d,c:g})];if(!(!v||!v.z||v.z.toLowerCase()=="general")&&!l[v.z]){var p=NU(v.z,"N"+u);p&&(l[v.z]="N"+u,++u,i.push(p+`
`))}}}}),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),vr(l).forEach(function(f){i.push('<style:style style:name="ce'+l[f].slice(1)+'" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="'+l[f]+`"/>
`)}),i.push(` </office:automatic-styles>
`),l};return function(a,o){var s=[mr],l=Al({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Al({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(s.push("<office:document"+l+u+`>
`),s.push(NS().replace(/<office:document-meta.*?>/,"").replace(/<\/office:document-meta>/,"")+`
`)):s.push("<office:document-content"+l+`>
`);var f=n(s,a);s.push(`  <office:body>
`),s.push(`    <office:spreadsheet>
`),((a.Workbook||{}).WBProps||{}).date1904&&s.push(`      <table:calculation-settings table:case-sensitive="false" table:search-criteria-must-apply-to-whole-cell="true" table:use-wildcards="true" table:use-regular-expressions="false" table:automatic-find-labels="false">
        <table:null-date table:date-value="1904-01-01"/>
      </table:calculation-settings>
`);for(var c=0;c!=a.SheetNames.length;++c)s.push(t(a.Sheets[a.SheetNames[c]],a,c,o,f,((a.Workbook||{}).WBProps||{}).date1904));return(a.Workbook||{}).Names&&s.push(lw(a.Workbook.Names,a.SheetNames,-1)),s.push(`    </office:spreadsheet>
`),s.push(`  </office:body>
`),o.bookType=="fods"?s.push("</office:document>"):s.push("</office:document-content>"),s.join("")}}();function pb(e,r){if(r.bookType=="fods")return uw(e,r);var t=ng(),n="",i=[],a=[];return n="mimetype",st(t,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",st(t,n,uw(e,r)),i.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",st(t,n,PU(e,r)),i.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",st(t,n,mr+NS()),i.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",st(t,n,DB(a)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",st(t,n,AB(i)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */var sn=function(){try{return typeof Uint8Array>"u"||typeof Uint8Array.prototype.subarray>"u"?"slice":typeof Buffer<"u"?typeof Buffer.prototype.subarray>"u"?"slice":(typeof Buffer.from=="function"?Buffer.from([72,62]):new Buffer([72,62]))instanceof Uint8Array?"subarray":"slice":"subarray"}catch{return"slice"}}();function Vf(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Nl(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):es(go(e))}function nn(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):wn(Mi(e))}function pa(e){for(var r=0,t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0;t<e.length;++t){var a=e[t],o=a.length;if(o<250)for(var s=0;s<o;++s)n[i++]=a[s];else n.set(a,i),i+=o}return n}function FU(e,r,t){var n=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-16,i=t/Math.pow(10,n-6176);e[r+15]|=n>>7,e[r+14]|=(n&127)<<1;for(var a=0;i>=1;++a,i/=256)e[r+a]=i&255;e[r+15]|=t>=0?0:128}function Fl(e,r){var t=r.l,n=e[t]&127;e:if(e[t++]>=128&&(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r.l=t,n}function Ge(e){var r=new Uint8Array(7);r[0]=e&127;var t=1;e:if(e>127){if(r[t-1]|=128,r[t]=e>>7&127,++t,e<=16383||(r[t-1]|=128,r[t]=e>>14&127,++t,e<=2097151)||(r[t-1]|=128,r[t]=e>>21&127,++t,e<=268435455)||(r[t-1]|=128,r[t]=e/256>>>21&127,++t,e<=34359738367)||(r[t-1]|=128,r[t]=e/65536>>>21&127,++t,e<=4398046511103))break e;r[t-1]|=128,r[t]=e/16777216>>>21&127,++t}return r[sn](0,t)}function yb(e){for(var r={l:0},t=[];r.l<e.length;)t.push(Fl(e,r));return t}function wb(e){return pa(e.map(function(r){return Ge(r)}))}function Sn(e){var r=0,t=e[r]&127;return e[r++]<128||(t|=(e[r]&127)<<7,e[r++]<128)||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128)||(t|=(e[r]&15)<<28),t}function Je(e){for(var r=[],t={l:0};t.l<e.length;){var n=t.l,i=Fl(e,t),a=i&7;i=i/8|0;var o,s=t.l;switch(a){case 0:{for(;e[s++]>=128;);o=e[sn](t.l,s),t.l=s}break;case 1:o=e[sn](s,s+8),t.l=s+8;break;case 2:{var l=Fl(e,t);o=e[sn](t.l,t.l+l),t.l+=l}break;case 5:o=e[sn](s,s+4),t.l=s+4;break;default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(n))}var u={data:o,type:a};r[i]==null&&(r[i]=[]),r[i].push(u)}return r}function qe(e){var r=[];return e.forEach(function(t,n){n!=0&&t.forEach(function(i){i.data&&(r.push(Ge(n*8+i.type)),i.type==2&&r.push(Ge(i.data.length)),r.push(i.data))})}),pa(r)}function zf(e,r){return(e==null?void 0:e.map(function(t){return r(t.data)}))||[]}function jf(e){for(var r,t=[],n={l:0};n.l<e.length;){var i=Fl(e,n),a=Je(e[sn](n.l,n.l+i));n.l+=i;var o={id:Sn(a[1][0].data),messages:[]};a[2].forEach(function(s){var l=Je(s.data),u=Sn(l[3][0].data);o.messages.push({meta:l,data:e[sn](n.l,n.l+u)}),n.l+=u}),(r=a[3])!=null&&r[0]&&(o.merge=Sn(a[3][0].data)>>>0>0),t.push(o)}return t}function ns(e){var r=[];return e.forEach(function(t){var n=[[],[{data:Ge(t.id),type:0}],[]];t.merge!=null&&(n[3]=[{data:Ge(+!!t.merge),type:0}]);var i=[];t.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:Ge(o.data.length)}],n[2].push({data:qe(o.meta),type:2})});var a=qe(n);r.push(Ge(a.length)),r.push(a),i.forEach(function(o){return r.push(o)})}),pa(r)}function LU(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t={l:0},n=Fl(r,t),i=[],a=t.l;a<r.length;){var o=r[a]&3;if(o==0){var s=r[a++]>>2;if(s<60)++s;else{var l=s-59;s=r[a],l>1&&(s|=r[a+1]<<8),l>2&&(s|=r[a+2]<<16),l>3&&(s|=r[a+3]<<24),s>>>=0,s++,a+=l}i.push(r[sn](a,a+s)),a+=s;continue}else{var u=0,f=0;if(o==1?(f=(r[a]>>2&7)+4,u=(r[a++]&224)<<3,u|=r[a++]):(f=(r[a++]>>2)+1,o==2?(u=r[a]|r[a+1]<<8,a+=2):(u=(r[a]|r[a+1]<<8|r[a+2]<<16|r[a+3]<<24)>>>0,a+=4)),u==0)throw new Error("Invalid offset 0");for(var c=i.length-1,h=u;c>=0&&h>=i[c].length;)h-=i[c].length,--c;if(c<0)if(h==0)h=i[c=0].length;else throw new Error("Invalid offset beyond length");if(f<h)i.push(i[c][sn](i[c].length-h,i[c].length-h+f));else{for(h>0&&(i.push(i[c][sn](i[c].length-h)),f-=h),++c;f>=i[c].length;)i.push(i[c]),f-=i[c].length,++c;f&&i.push(i[c][sn](0,f))}i.length>25&&(i=[pa(i)])}}for(var d=0,g=0;g<i.length;++g)d+=i[g].length;if(d!=n)throw new Error("Unexpected length: ".concat(d," != ").concat(n));return i}function Yf(e){Array.isArray(e)&&(e=new Uint8Array(e));for(var r=[],t=0;t<e.length;){var n=e[t++],i=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push.apply(r,LU(n,e[sn](t,t+i))),t+=i}if(t!==e.length)throw new Error("data is not a valid framed stream!");return r.length==1?r[0]:pa(r)}function is(e){for(var r=[],t=0;t<e.length;){var n=Math.min(e.length-t,268435455),i=new Uint8Array(4);r.push(i);var a=Ge(n),o=a.length;r.push(a),n<=60?(o++,r.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,r.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,r.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,r.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,r.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),r.push(e[sn](t,t+n)),o+=n,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,t+=n}return pa(r)}function Hh(e,r){var t=new Uint8Array(32),n=Vf(t),i=12,a=0;switch(t[0]=5,e.t){case"n":if(e.z&&mo(e.z)){t[1]=5,n.setFloat64(i,(Qo(e.v+1462).getTime()-Date.UTC(2001,0,1))/1e3,!0),a|=4,i+=8;break}else t[1]=2,FU(t,i,e.v),a|=1,i+=16;break;case"b":t[1]=6,n.setFloat64(i,e.v?1:0,!0),a|=2,i+=8;break;case"s":{var o=e.v==null?"":String(e.v);if(e.l){var s=r.rsst.findIndex(function(u){var f;return u.v==o&&u.l==((f=e.l)==null?void 0:f.Target)});s==-1&&(r.rsst[s=r.rsst.length]={v:o,l:e.l.Target}),t[1]=9,n.setUint32(i,s,!0),a|=16,i+=4}else{var l=r.sst.indexOf(o);l==-1&&(r.sst[l=r.sst.length]=o),t[1]=3,n.setUint32(i,l,!0),a|=8,i+=4}}break;case"d":t[1]=5,n.setFloat64(i,(e.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),a|=4,i+=8;break;case"z":t[1]=0;break;default:throw"unsupported cell type "+e.t}return e.c&&(r.cmnt.push(IU(e.c)),n.setUint32(i,r.cmnt.length-1,!0),a|=524288,i+=4),n.setUint32(8,a,!0),t[sn](0,i)}function Bh(e,r){var t=new Uint8Array(32),n=Vf(t),i=12,a=0,o="";switch(t[0]=4,e.t){case"n":break;case"b":break;case"s":if(o=e.v==null?"":String(e.v),e.l){var s=r.rsst.findIndex(function(u){var f;return u.v==o&&u.l==((f=e.l)==null?void 0:f.Target)});s==-1&&(r.rsst[s=r.rsst.length]={v:o,l:e.l.Target}),t[1]=9,n.setUint32(i,s,!0),a|=512,i+=4}break;case"d":break;case"e":break;case"z":break;default:throw"unsupported cell type "+e.t}switch(e.c&&(n.setUint32(i,r.cmnt.length-1,!0),a|=4096,i+=4),e.t){case"n":t[1]=2,n.setFloat64(i,e.v,!0),a|=32,i+=8;break;case"b":t[1]=6,n.setFloat64(i,e.v?1:0,!0),a|=32,i+=8;break;case"s":if(o=e.v==null?"":String(e.v),!e.l){var l=r.sst.indexOf(o);l==-1&&(r.sst[l=r.sst.length]=o),t[1]=3,n.setUint32(i,l,!0),a|=16,i+=4}break;case"d":t[1]=5,n.setFloat64(i,(e.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),a|=64,i+=8;break;case"z":t[1]=0;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),t[sn](0,i)}function hr(e){var r=Je(e);return Sn(r[1][0].data)}function Gr(e){return qe([[],[{type:0,data:Ge(e)}]])}function Yr(e,r){var t,n=(t=e.messages[0].meta[5])!=null&&t[0]?yb(e.messages[0].meta[5][0].data):[],i=n.indexOf(r);i==-1&&(n.push(r),e.messages[0].meta[5]=[{type:2,data:wb(n)}])}function Ci(e,r){var t,n=(t=e.messages[0].meta[5])!=null&&t[0]?yb(e.messages[0].meta[5][0].data):[];e.messages[0].meta[5]=[{type:2,data:wb(n.filter(function(i){return i!=r}))}]}function IU(e){for(var r={a:"",t:"",replies:[]},t=0;t<e.length;++t)t==0?(r.a=e[t].a,r.t=e[t].t):r.replies.push({a:e[t].a,t:e[t].t});return r}function HU(e,r,t){var n,i,a,o=[[],[{type:0,data:Ge(0)}],[{type:0,data:Ge(0)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:Ge(5)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:Ge(1)}]];if(!((n=o[6])!=null&&n[0])||!((i=o[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var s=0;if(o[7][0].data.length<2*e.length){var l=new Uint8Array(2*e.length);l.set(o[7][0].data),o[7][0].data=l}if(o[4][0].data.length<2*e.length){var u=new Uint8Array(2*e.length);u.set(o[4][0].data),o[4][0].data=u}for(var f=Vf(o[7][0].data),c=0,h=[],d=Vf(o[4][0].data),g=0,v=[],p=t?4:1,C=0;C<e.length;++C){if(e[C]==null||e[C].t=="z"&&!((a=e[C].c)!=null&&a.length)||e[C].t=="e"){f.setUint16(C*2,65535,!0),d.setUint16(C*2,65535);continue}f.setUint16(C*2,c/p,!0),d.setUint16(C*2,g/p,!0);var F,D;switch(e[C].t){case"d":if(e[C].v instanceof Date){F=Hh(e[C],r),D=Bh(e[C],r);break}F=Hh(e[C],r),D=Bh(e[C],r);break;case"s":case"n":case"b":case"z":F=Hh(e[C],r),D=Bh(e[C],r);break;default:throw new Error("Unsupported value "+e[C])}h.push(F),c+=F.length,v.push(D),g+=D.length,++s}for(o[2][0].data=Ge(s),o[5][0].data=Ge(5);C<o[7][0].data.length/2;++C)f.setUint16(C*2,65535,!0),d.setUint16(C*2,65535,!0);return o[6][0].data=pa(h),o[3][0].data=pa(v),o[8]=[{type:0,data:Ge(t?1:0)}],o}function w0(e,r){return{meta:[[],[{type:0,data:Ge(e)}]],data:r}}function ai(e,r){r.last||(r.last=927262);for(var t=r.last;t<2e6;++t)if(!r[t])return r[r.last=t]=e,t;throw new Error("Too many messages")}function BU(e){var r={},t=[];return e.FileIndex.map(function(n,i){return[n,e.FullPaths[i]]}).forEach(function(n){var i=n[0],a=n[1];i.type==2&&i.name.match(/\.iwa/)&&i.content[0]==0&&jf(Yf(i.content)).forEach(function(o){t.push(o.id),r[o.id]={deps:[],location:a,type:Sn(o.messages[0].meta[1][0].data)}})}),e.FileIndex.forEach(function(n){n.name.match(/\.iwa/)&&n.content[0]==0&&jf(Yf(n.content)).forEach(function(i){i.messages.forEach(function(a){[5,6].forEach(function(o){a.meta[o]&&a.meta[o].forEach(function(s){r[i.id].deps.push(Sn(s.data))})})})})}),r}function du(e,r,t){return qe([[],[{type:0,data:Ge(1)}],[],[{type:5,data:new Uint8Array(Float32Array.from([e/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([r/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([t/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([1]).buffer)}],[],[],[],[],[],[{type:0,data:Ge(1)}]])}function fw(e){switch(e){case 0:return du(99,222,171);case 1:return du(162,197,240);case 2:return du(255,189,189)}return du(Math.random()*255,Math.random()*255,Math.random()*255)}function WU(e,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=Nt.read(r.numbers,{type:"base64"}),n=BU(t),i=oi(t,n,1);if(i==null)throw"Could not find message ".concat(1," in Numbers template");var a=zf(Je(i.messages[0].data)[1],hr);if(a.length>1)throw new Error("Template NUMBERS file must have exactly one sheet");return e.SheetNames.forEach(function(o,s){s>=1&&(UU(t,n,s+1),i=oi(t,n,1),a=zf(Je(i.messages[0].data)[1],hr)),VU(t,n,e.Sheets[o],o,s,a[s])}),t}function Tt(e,r,t,n){var i=Nt.find(e,r[t].location);if(!i)throw"Could not find ".concat(r[t].location," in Numbers template");var a=jf(Yf(i.content)),o=a.find(function(s){return s.id==t});n(o,a),i.content=is(ns(a)),i.size=i.content.length}function oi(e,r,t){var n=Nt.find(e,r[t].location);if(!n)throw"Could not find ".concat(r[t].location," in Numbers template");var i=jf(Yf(n.content)),a=i.find(function(o){return o.id==t});return a}function _0(e,r,t){e[3].push({type:2,data:qe([[],[{type:0,data:Ge(r)}],[{type:2,data:nn(t.replace(/-.*$/,""))}],[{type:2,data:nn(t)}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:Ge(0)}],[],[{type:0,data:Ge(0)}]])}),e[1]=[{type:0,data:Ge(Math.max(r+1,Sn(e[1][0].data)))}]}function La(e,r,t,n,i,a){a||(a=ai({deps:[],location:"",type:r},i));var o="".concat(n,"-").concat(a,".iwa");i[a].location="Root Entry"+o,Nt.utils.cfb_add(e,o,is(ns([{id:a,messages:[w0(r,qe(t))]}])));var s=o.replace(/^[\/]/,"").replace(/^Index\//,"").replace(/\.iwa$/,"");return Tt(e,i,2,function(l){var u=Je(l.messages[0].data);_0(u,a||0,s),l.messages[0].data=qe(u)}),a}function fn(e,r,t,n){var i=r[t].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),a=e[3].findIndex(function(s){var l,u,f=Je(s.data);return(l=f[3])!=null&&l[0]?Nl(f[3][0].data)==i:!!((u=f[2])!=null&&u[0]&&Nl(f[2][0].data)==i)}),o=Je(e[3][a].data);o[6]||(o[6]=[]),(Array.isArray(n)?n:[n]).forEach(function(s){o[6].push({type:2,data:qe([[],[{type:0,data:Ge(s)}]])})}),e[3][a].data=qe(o)}function $U(e,r,t,n){var i=r[t].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),a=e[3].findIndex(function(s){var l,u,f=Je(s.data);return(l=f[3])!=null&&l[0]?Nl(f[3][0].data)==i:!!((u=f[2])!=null&&u[0]&&Nl(f[2][0].data)==i)}),o=Je(e[3][a].data);o[6]||(o[6]=[]),o[6]=o[6].filter(function(s){return Sn(Je(s.data)[1][0].data)!=n}),e[3][a].data=qe(o)}function UU(e,r,t){var n=-1,i=-1,a={};Tt(e,r,1,function(l,u){var f=Je(l.messages[0].data);n=hr(Je(l.messages[0].data)[1][0].data),i=ai({deps:[1],location:r[n].location,type:2},r),a[n]=i,Yr(l,i),f[1].push({type:2,data:Gr(i)});var c=oi(e,r,n);c.id=i,r[1].location==r[i].location?u.push(c):Tt(e,r,i,function(h,d){return d.push(c)}),l.messages[0].data=qe(f)});var o=-1;Tt(e,r,i,function(l,u){for(var f=Je(l.messages[0].data),c=3;c<=69;++c)delete f[c];var h=zf(f[2],hr);h.forEach(function(g){return Ci(l,g)}),o=ai({deps:[i],location:r[h[0]].location,type:r[h[0]].type},r),Yr(l,o),a[h[0]]=o,f[2]=[{type:2,data:Gr(o)}];var d=oi(e,r,h[0]);d.id=o,r[h[0]].location==r[i].location?u.push(d):(Tt(e,r,2,function(g){var v=Je(g.messages[0].data);fn(v,r,i,o),g.messages[0].data=qe(v)}),Tt(e,r,o,function(g,v){return v.push(d)})),l.messages[0].data=qe(f)});var s=-1;Tt(e,r,o,function(l,u){for(var f=Je(l.messages[0].data),c=Je(f[1][0].data),h=3;h<=69;++h)delete c[h];var d=hr(c[2][0].data);c[2][0].data=Gr(a[d]),f[1][0].data=qe(c);var g=hr(f[2][0].data);Ci(l,g),s=ai({deps:[o],location:r[g].location,type:r[g].type},r),Yr(l,s),a[g]=s,f[2][0].data=Gr(s);var v=oi(e,r,g);v.id=s,r[o].location==r[s].location?u.push(v):Tt(e,r,s,function(p,C){return C.push(v)}),l.messages[0].data=qe(f)}),Tt(e,r,s,function(l,u){var f,c,h=Je(l.messages[0].data),d=Nl(h[1][0].data),g=d.replace(/-[A-Z0-9]*/,"-".concat(("0000"+t.toString(16)).slice(-4)));if(h[1][0].data=nn(g),[12,13,29,31,32,33,39,44,47,81,82,84].forEach(function(ue){return delete h[ue]}),h[45]){var v=Je(h[45][0].data),p=hr(v[1][0].data);Ci(l,p),delete h[45]}if(h[70]){var C=Je(h[70][0].data);(f=C[2])==null||f.forEach(function(ue){var se=Je(ue.data);[2,3].map(function(U){return se[U][0]}).forEach(function(U){var re=Je(U.data);if(re[8]){var m=hr(re[8][0].data);Ci(l,m)}})}),delete h[70]}[46,30,34,35,36,38,48,49,60,61,62,63,64,71,72,73,74,75,85,86,87,88,89].forEach(function(ue){if(h[ue]){var se=hr(h[ue][0].data);delete h[ue],Ci(l,se)}});var F=Je(h[4][0].data);{[2,4,5,6,11,12,13,15,16,17,18,19,20,21,22].forEach(function(ue){var se;if((se=F[ue])!=null&&se[0]){var U=hr(F[ue][0].data),re=ai({deps:[s],location:r[U].location,type:r[U].type},r);Ci(l,U),Yr(l,re),a[U]=re;var m=oi(e,r,U);if(m.id=re,r[U].location==r[s].location)u.push(m);else{r[re].location=r[U].location.replace(U.toString(),re.toString()),r[re].location==r[U].location&&(r[re].location=r[re].location.replace(/\.iwa/,"-".concat(re,".iwa"))),Nt.utils.cfb_add(e,r[re].location,is(ns([m])));var _=r[re].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");Tt(e,r,2,function(x){var B=Je(x.messages[0].data);_0(B,re,_),fn(B,r,s,re),x.messages[0].data=qe(B)})}F[ue][0].data=Gr(re)}});var D=Je(F[1][0].data);(c=D[2])==null||c.forEach(function(ue){var se=hr(ue.data),U=ai({deps:[s],location:r[se].location,type:r[se].type},r);Ci(l,se),Yr(l,U),a[se]=U;var re=oi(e,r,se);if(re.id=U,r[se].location==r[s].location)u.push(re);else{r[U].location=r[se].location.replace(se.toString(),U.toString()),r[U].location==r[se].location&&(r[U].location=r[U].location.replace(/\.iwa/,"-".concat(U,".iwa"))),Nt.utils.cfb_add(e,r[U].location,is(ns([re])));var m=r[U].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");Tt(e,r,2,function(_){var x=Je(_.messages[0].data);_0(x,U,m),fn(x,r,s,U),_.messages[0].data=qe(x)})}ue.data=Gr(U)}),F[1][0].data=qe(D);var ee=Je(F[3][0].data);ee[1].forEach(function(ue){var se=Je(ue.data),U=hr(se[2][0].data),re=a[U];if(!a[U]){re=ai({deps:[s],location:"",type:r[U].type},r),r[re].location="Root Entry/Index/Tables/Tile-".concat(re,".iwa"),a[U]=re;var m=oi(e,r,U);m.id=re,Ci(l,U),Yr(l,re),Nt.utils.cfb_add(e,"/Index/Tables/Tile-".concat(re,".iwa"),is(ns([m]))),Tt(e,r,2,function(_){var x=Je(_.messages[0].data);x[3].push({type:2,data:qe([[],[{type:0,data:Ge(re)}],[{type:2,data:nn("Tables/Tile")}],[{type:2,data:nn("Tables/Tile-".concat(re))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:Ge(0)}],[],[{type:0,data:Ge(0)}]])}),x[1]=[{type:0,data:Ge(Math.max(re+1,Sn(x[1][0].data)))}],fn(x,r,s,re),_.messages[0].data=qe(x)})}se[2][0].data=Gr(re),ue.data=qe(se)}),F[3][0].data=qe(ee)}h[4][0].data=qe(F),l.messages[0].data=qe(h)})}function VU(e,r,t,n,i,a){var o=[];Tt(e,r,a,function(u){var f=Je(u.messages[0].data);f[1]=[{type:2,data:nn(n)}],o=zf(f[2],hr),u.messages[0].data=qe(f)});var s=oi(e,r,o[0]),l=hr(Je(s.messages[0].data)[2][0].data);Tt(e,r,l,function(u,f){return jU(e,r,t,u,f,l)})}var zU=!0;function jU(e,r,t,n,i,a){if(!t["!ref"])throw new Error("Cannot export empty sheet to NUMBERS");var o=$r(t["!ref"]);o.s.r=o.s.c=0;var s=!1;o.e.c>999&&(s=!0,o.e.c=999),o.e.r>999999&&(s=!0,o.e.r=999999),s&&console.error("Truncating to ".concat(gr(o)));var l=[];if(t["!data"])l=t["!data"];else{for(var u=[],f=0;f<=o.e.c;++f)u[f]=Ot(f);for(var c=0;c<=o.e.r;++c){l[c]=[];var h=""+(c+1);for(f=0;f<=o.e.c;++f){var d=t[u[f]+h];d&&(l[c][f]=d)}}}var g={cmnt:[{a:"~54ee77S~",t:"... the people who are crazy enough to think they can change the world, are the ones who do."}],ferr:[],fmla:[],nfmt:[],ofmt:[],rsst:[{v:"~54ee77S~",l:"https://sheetjs.com/"}],sst:["~Sh33tJ5~"]},v=Je(n.messages[0].data);{v[6][0].data=Ge(o.e.r+1),v[7][0].data=Ge(o.e.c+1),delete v[46];var p=Je(v[4][0].data);{var C=hr(Je(p[1][0].data)[2][0].data);Tt(e,r,C,function(le,ge){var Se,Ee=Je(le.messages[0].data);if((Se=Ee==null?void 0:Ee[2])!=null&&Se[0])for(var Re=0;Re<l.length;++Re){var ze=Je(Ee[2][0].data);ze[1][0].data=Ge(Re),ze[4][0].data=Ge(l[Re].length),Ee[2][Re]={type:Ee[2][0].type,data:qe(ze)}}le.messages[0].data=qe(Ee)});var F=hr(p[2][0].data);Tt(e,r,F,function(le,ge){for(var Se=Je(le.messages[0].data),Ee=0;Ee<=o.e.c;++Ee){var Re=Je(Se[2][0].data);Re[1][0].data=Ge(Ee),Re[4][0].data=Ge(o.e.r+1),Se[2][Ee]={type:Se[2][0].type,data:qe(Re)}}le.messages[0].data=qe(Se)});var D=Je(p[9][0].data);D[1]=[];var ee=Je(p[3][0].data);{var ue=256;ee[2]=[{type:0,data:Ge(ue)}];var se=hr(Je(ee[1][0].data)[2][0].data),U=function(){var le=oi(e,r,2),ge=Je(le.messages[0].data),Se=ge[3].filter(function(Ee){return Sn(Je(Ee.data)[1][0].data)==se});return Se!=null&&Se.length?Sn(Je(Se[0].data)[12][0].data):0}();Nt.utils.cfb_del(e,r[se].location),Tt(e,r,2,function(le){var ge=Je(le.messages[0].data);ge[3]=ge[3].filter(function(Se){return Sn(Je(Se.data)[1][0].data)!=se}),$U(ge,r,a,se),le.messages[0].data=qe(ge)}),Ci(n,se),ee[1]=[];for(var re=Math.ceil((o.e.r+1)/ue),m=0;m<re;++m){var _=ai({deps:[],location:"",type:6002},r);r[_].location="Root Entry/Index/Tables/Tile-".concat(_,".iwa");for(var x=[[],[{type:0,data:Ge(0)}],[{type:0,data:Ge(Math.min(o.e.r+1,(m+1)*ue))}],[{type:0,data:Ge(0)}],[{type:0,data:Ge(Math.min((m+1)*ue,o.e.r+1)-m*ue)}],[],[{type:0,data:Ge(5)}],[{type:0,data:Ge(1)}],[{type:0,data:Ge(1)}]],B=m*ue;B<=Math.min(o.e.r,(m+1)*ue-1);++B){var Q=HU(l[B],g,zU);Q[1][0].data=Ge(B-m*ue),x[5].push({data:qe(Q),type:2})}ee[1].push({type:2,data:qe([[],[{type:0,data:Ge(m)}],[{type:2,data:Gr(_)}]])});var A={id:_,messages:[w0(6002,qe(x))]},W=is(ns([A]));Nt.utils.cfb_add(e,"/Index/Tables/Tile-".concat(_,".iwa"),W),Tt(e,r,2,function(le){var ge=Je(le.messages[0].data);ge[3].push({type:2,data:qe([[],[{type:0,data:Ge(_)}],[{type:2,data:nn("Tables/Tile")}],[{type:2,data:nn("Tables/Tile-".concat(_))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:Ge(0)}],[],[{type:0,data:Ge(U)}]])}),ge[1]=[{type:0,data:Ge(Math.max(_+1,Sn(ge[1][0].data)))}],fn(ge,r,a,_),le.messages[0].data=qe(ge)}),Yr(n,_),D[1].push({type:2,data:qe([[],[{type:0,data:Ge(m*ue)}],[{type:0,data:Ge(m)}]])})}}if(p[3][0].data=qe(ee),p[9][0].data=qe(D),p[10]=[{type:2,data:new Uint8Array([])}],t["!merges"]){var ne=ai({type:6144,deps:[a],location:r[a].location},r);i.push({id:ne,messages:[w0(6144,qe([[],t["!merges"].map(function(le){return{type:2,data:qe([[],[{type:2,data:qe([[],[{type:5,data:new Uint8Array(new Uint16Array([le.s.r,le.s.c]).buffer)}]])}],[{type:2,data:qe([[],[{type:5,data:new Uint8Array(new Uint16Array([le.e.r-le.s.r+1,le.e.c-le.s.c+1]).buffer)}]])}]])}})]))]}),p[13]=[{type:2,data:Gr(ne)}],Tt(e,r,2,function(le){var ge=Je(le.messages[0].data);fn(ge,r,a,ne),le.messages[0].data=qe(ge)}),Yr(n,ne)}else delete p[13];var b=hr(p[4][0].data);Tt(e,r,b,function(le){var ge=Je(le.messages[0].data);ge[3]=[],g.sst.forEach(function(Se,Ee){Ee!=0&&ge[3].push({type:2,data:qe([[],[{type:0,data:Ge(Ee)}],[{type:0,data:Ge(1)}],[{type:2,data:nn(Se)}]])})}),le.messages[0].data=qe(ge)});var R=hr(p[17][0].data);if(Tt(e,r,R,function(le){var ge=Je(le.messages[0].data);ge[3]=[];var Se=[904980,903835,903815,903845];g.rsst.forEach(function(Ee,Re){if(Re!=0){var ze=[[],[{type:0,data:new Uint8Array([5])}],[],[{type:2,data:nn(Ee.v)}]];ze[10]=[{type:0,data:new Uint8Array([1])}],ze[19]=[{type:2,data:new Uint8Array([10,6,8,0,18,2,101,110])}],ze[5]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,155,149,55])}],ze[2]=[{type:2,data:new Uint8Array([8,148,158,55])}],ze[6]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],ze[7]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,135,149,55])}],ze[8]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,165,149,55])}],ze[14]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],ze[24]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}];var P=ai({deps:[],location:"",type:2001},r),H=[];if(Ee.l){var O=La(e,2032,[[],[],[{type:2,data:nn(Ee.l)}]],"/Index/Tables/DataList",r);ze[11]=[];var T=[[],[]];T[1]||(T[1]=[]),T[1].push({type:2,data:qe([[],[{type:0,data:Ge(0)}],[{type:2,data:Gr(O)}]])}),ze[11][0]={type:2,data:qe(T)},H.push(O)}La(e,2001,ze,"/Index/Tables/DataList",r,P),Tt(e,r,P,function(q){Se.forEach(function(ae){return Yr(q,ae)}),H.forEach(function(ae){return Yr(q,ae)})});var Y=La(e,6218,[[],[{type:2,data:Gr(P)}],[],[{type:2,data:new Uint8Array([13,255,255,255,0,18,10,16,255,255,1,24,255,255,255,255,7])}]],"/Index/Tables/DataList",r);Tt(e,r,Y,function(q){return Yr(q,P)}),ge[3].push({type:2,data:qe([[],[{type:0,data:Ge(Re)}],[{type:0,data:Ge(1)}],[],[],[],[],[],[],[{type:2,data:Gr(Y)}]])}),Yr(le,Y),Tt(e,r,2,function(q){var ae=Je(q.messages[0].data);fn(ae,r,R,Y),fn(ae,r,Y,P),fn(ae,r,P,H),fn(ae,r,P,Se),q.messages[0].data=qe(ae)})}}),le.messages[0].data=qe(ge)}),g.cmnt.length>1){var Z=hr(p[19][0].data),ie={},ve=0;Tt(e,r,Z,function(le){var ge=Je(le.messages[0].data);ge[3]=[],g.cmnt.forEach(function(Se,Ee){if(Ee!=0){var Re=[];Se.replies&&Se.replies.forEach(function(H){ie[H.a||""]||(ie[H.a||""]=La(e,212,[[],[{type:2,data:nn(H.a||"")}],[{type:2,data:fw(++ve)}],[],[{type:0,data:Ge(0)}]],"/Index/Tables/DataList",r));var O=ie[H.a||""],T=La(e,3056,[[],[{type:2,data:nn(H.t||"")}],[{type:2,data:qe([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:Gr(O)}]],"/Index/Tables/DataList",r);Tt(e,r,T,function(Y){return Yr(Y,O)}),Re.push(T),Tt(e,r,2,function(Y){var q=Je(Y.messages[0].data);fn(q,r,T,O),Y.messages[0].data=qe(q)})}),ie[Se.a||""]||(ie[Se.a||""]=La(e,212,[[],[{type:2,data:nn(Se.a||"")}],[{type:2,data:fw(++ve)}],[],[{type:0,data:Ge(0)}]],"/Index/Tables/DataList",r));var ze=ie[Se.a||""],P=La(e,3056,[[],[{type:2,data:nn(Se.t||"")}],[{type:2,data:qe([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:Gr(ze)}],Re.map(function(H){return{type:2,data:Gr(H)}}),[{type:2,data:qe([[],[{type:0,data:Ge(Ee)}],[{type:0,data:Ge(0)}]])}]],"/Index/Tables/DataList",r);Tt(e,r,P,function(H){Yr(H,ze),Re.forEach(function(O){return Yr(H,O)})}),ge[3].push({type:2,data:qe([[],[{type:0,data:Ge(Ee)}],[{type:0,data:Ge(1)}],[],[],[],[],[],[],[],[{type:2,data:Gr(P)}]])}),Yr(le,P),Tt(e,r,2,function(H){var O=Je(H.messages[0].data);fn(O,r,Z,P),fn(O,r,P,ze),Re.length&&fn(O,r,P,Re),H.messages[0].data=qe(O)})}}),ge[2][0].data=Ge(g.cmnt.length+1),le.messages[0].data=qe(ge)})}}v[4][0].data=qe(p)}n.messages[0].data=qe(v)}function YU(e){return function(t){for(var n=0;n!=e.length;++n){var i=e[n];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function pg(e){YU([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function GU(e,r){e&&!e.SSF&&(e.SSF=Qr(Wt)),e&&e.SSF&&(Uc(),$c(e.SSF),r.revssf=Vc(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,ll?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t="bin",n=!0,i=MS();pg(r=r||{});var a=ng(),o="",s=0;if(r.cellXfs=[],Ea(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",st(a,o,FS(e.Props,r)),i.coreprops.push(o),xt(r.rels,2,o,yt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,st(a,o,IS(e.Props)),i.extprops.push(o),xt(r.rels,3,o,yt.EXT_PROPS),e.Custprops!==e.Props&&vr(e.Custprops||{}).length>0&&(o="docProps/custom.xml",st(a,o,HS(e.Custprops)),i.custprops.push(o),xt(r.rels,4,o,yt.CUST_PROPS));var f=["SheetJ5"];for(r.tcid=0,s=1;s<=e.SheetNames.length;++s){var c={"!id":{}},h=e.Sheets[e.SheetNames[s-1]],d=(h||{})["!type"]||"sheet";switch(d){case"chart":default:o="xl/worksheets/sheet"+s+"."+t,st(a,o,O$(s-1,r,e,c)),i.sheets.push(o),xt(r.wbrels,-1,"worksheets/sheet"+s+"."+t,yt.WS[0])}if(h){var g=h["!comments"],v=!1,p="";if(g&&g.length>0){var C=!1;g.forEach(function(D){D[1].forEach(function(ee){ee.T==!0&&(C=!0)})}),C&&(p="xl/threadedComments/threadedComment"+s+".xml",st(a,p,JS(g,f,r)),i.threadedcomments.push(p),xt(c,-1,"../threadedComments/threadedComment"+s+".xml",yt.TCMNT)),p="xl/comments"+s+"."+t,st(a,p,p8(g)),i.comments.push(p),xt(c,-1,"../comments"+s+"."+t,yt.CMNT),v=!0}h["!legacy"]&&v&&st(a,"xl/drawings/vmlDrawing"+s+".vml",ZS(s,h["!comments"])),delete h["!comments"],delete h["!legacy"]}c["!id"].rId1&&st(a,PS(o),ts(c))}r.Strings!=null&&r.Strings.length>0&&(o="xl/sharedStrings."+t,st(a,o,O6(r.Strings)),i.strs.push(o),xt(r.wbrels,-1,"sharedStrings."+t,yt.SST)),o="xl/workbook."+t,st(a,o,X$(e)),i.workbooks.push(o),xt(r.rels,1,o,yt.WB),o="xl/theme/theme1.xml";var F=qS(e.Themes,r);return st(a,o,F),i.themes.push(o),xt(r.wbrels,-1,"theme/theme1.xml",yt.THEME),o="xl/styles."+t,st(a,o,t8(e,r)),i.styles.push(o),xt(r.wbrels,-1,"styles."+t,yt.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",st(a,o,e.vbaraw),i.vba.push(o),xt(r.wbrels,-1,"vbaProject.bin",yt.VBA)),o="xl/metadata."+t,st(a,o,u8()),i.metadata.push(o),xt(r.wbrels,-1,"metadata."+t,yt.XLMETA),f.length>1&&(o="xl/persons/person.xml",st(a,o,QS(f)),i.people.push(o),xt(r.wbrels,-1,"persons/person.xml",yt.PEOPLE)),st(a,"[Content_Types].xml",DS(i,r)),st(a,"_rels/.rels",ts(r.rels)),st(a,"xl/_rels/workbook."+t+".rels",ts(r.wbrels)),delete r.revssf,delete r.ssf,a}function XU(e,r){e&&!e.SSF&&(e.SSF=Qr(Wt)),e&&e.SSF&&(Uc(),$c(e.SSF),r.revssf=Vc(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,ll?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t="xml",n=w8.indexOf(r.bookType)>-1,i=MS();pg(r=r||{});var a=ng(),o="",s=0;if(r.cellXfs=[],Ea(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",st(a,o,FS(e.Props,r)),i.coreprops.push(o),xt(r.rels,2,o,yt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,st(a,o,IS(e.Props)),i.extprops.push(o),xt(r.rels,3,o,yt.EXT_PROPS),e.Custprops!==e.Props&&vr(e.Custprops||{}).length>0&&(o="docProps/custom.xml",st(a,o,HS(e.Custprops)),i.custprops.push(o),xt(r.rels,4,o,yt.CUST_PROPS));var f=["SheetJ5"];for(r.tcid=0,s=1;s<=e.SheetNames.length;++s){var c={"!id":{}},h=e.Sheets[e.SheetNames[s-1]],d=(h||{})["!type"]||"sheet";switch(d){case"chart":default:o="xl/worksheets/sheet"+s+"."+t,st(a,o,v5(s-1,r,e,c)),i.sheets.push(o),xt(r.wbrels,-1,"worksheets/sheet"+s+"."+t,yt.WS[0])}if(h){var g=h["!comments"],v=!1,p="";if(g&&g.length>0){var C=!1;g.forEach(function(F){F[1].forEach(function(D){D.T==!0&&(C=!0)})}),C&&(p="xl/threadedComments/threadedComment"+s+".xml",st(a,p,JS(g,f,r)),i.threadedcomments.push(p),xt(c,-1,"../threadedComments/threadedComment"+s+".xml",yt.TCMNT)),p="xl/comments"+s+"."+t,st(a,p,d8(g)),i.comments.push(p),xt(c,-1,"../comments"+s+"."+t,yt.CMNT),v=!0}h["!legacy"]&&v&&st(a,"xl/drawings/vmlDrawing"+s+".vml",ZS(s,h["!comments"])),delete h["!comments"],delete h["!legacy"]}c["!id"].rId1&&st(a,PS(o),ts(c))}return r.Strings!=null&&r.Strings.length>0&&(o="xl/sharedStrings."+t,st(a,o,b6(r.Strings,r)),i.strs.push(o),xt(r.wbrels,-1,"sharedStrings."+t,yt.SST)),o="xl/workbook."+t,st(a,o,N$(e)),i.workbooks.push(o),xt(r.rels,1,o,yt.WB),o="xl/theme/theme1.xml",st(a,o,qS(e.Themes,r)),i.themes.push(o),xt(r.wbrels,-1,"theme/theme1.xml",yt.THEME),o="xl/styles."+t,st(a,o,N6(e,r)),i.styles.push(o),xt(r.wbrels,-1,"styles."+t,yt.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",st(a,o,e.vbaraw),i.vba.push(o),xt(r.wbrels,-1,"vbaProject.bin",yt.VBA)),o="xl/metadata."+t,st(a,o,f8()),i.metadata.push(o),xt(r.wbrels,-1,"metadata."+t,yt.XLMETA),f.length>1&&(o="xl/persons/person.xml",st(a,o,QS(f)),i.people.push(o),xt(r.wbrels,-1,"persons/person.xml",yt.PEOPLE)),st(a,"[Content_Types].xml",DS(i,r)),st(a,"_rels/.rels",ts(r.rels)),st(a,"xl/_rels/workbook."+t+".rels",ts(r.wbrels)),delete r.revssf,delete r.ssf,a}function KU(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=ga(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function _b(e,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return Vl(r.file,Nt.write(e,{type:Et?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return Nt.write(e,r)}function qU(e,r){switch(r.bookType){case"ods":return pb(e,r);case"numbers":return WU(e,r);case"xlsb":return GU(e,r);default:return XU(e,r)}}function ZU(e,r){var t=Qr(r||{}),n=qU(e,t);return JU(n,t)}function JU(e,r){var t={},n=Et?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(r.compression&&(t.compression="DEFLATE"),r.password)t.type=n;else switch(r.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":t.type=n;break;default:throw new Error("Unrecognized type "+r.type)}var i=e.FullPaths?Nt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!r.compression}):e.generate(t);if(typeof Deno<"u"&&typeof i=="string"){if(r.type=="binary"||r.type=="base64")return i;i=new Uint8Array(Wc(i))}return r.password&&typeof encrypt_agile<"u"?_b(encrypt_agile(i,r.password),r):r.type==="file"?Vl(r.file,i):r.type=="string"?es(i):i}function QU(e,r){var t=r||{},n=lU(e,t);return _b(n,t)}function ei(e,r,t){t||(t="");var n=t+e;switch(r.type){case"base64":return Mf(Mi(n));case"binary":return Mi(n);case"string":return e;case"file":return Vl(r.file,n,"utf8");case"buffer":return Et?yi(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):ei(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function e9(e,r){switch(r.type){case"base64":return JH(e);case"binary":return e;case"string":return e;case"file":return Vl(r.file,e,"binary");case"buffer":return Et?yi(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function vu(e,r){switch(r.type){case"string":case"base64":case"binary":for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return r.type=="base64"?Mf(t):r.type=="string"?es(t):t;case"file":return Vl(r.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+r.type)}}function Cb(e,r){qH(),P$(e);var t=Qr(r||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var n=Cb(e,t);return t.type="array",Wc(n)}var i=0;if(t.sheet&&(typeof t.sheet=="number"?i=t.sheet:i=e.SheetNames.indexOf(t.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return ei(oU(e,t),t);case"slk":case"sylk":return ei(w6.from_sheet(e.Sheets[e.SheetNames[i]],t,e),t);case"htm":case"html":return ei(vb(e.Sheets[e.SheetNames[i]],t),t);case"txt":return e9(Sb(e.Sheets[e.SheetNames[i]],t),t);case"csv":return ei(yg(e.Sheets[e.SheetNames[i]],t),t,"\uFEFF");case"dif":return ei(_6.from_sheet(e.Sheets[e.SheetNames[i]],t),t);case"dbf":return vu(y6.from_sheet(e.Sheets[e.SheetNames[i]],t),t);case"prn":return ei(C6.from_sheet(e.Sheets[e.SheetNames[i]],t),t);case"rtf":return ei(k6(e.Sheets[e.SheetNames[i]]),t);case"eth":return ei(jS.from_sheet(e.Sheets[e.SheetNames[i]],t),t);case"fods":return ei(pb(e,t),t);case"wk1":return vu(Jy.sheet_to_wk1(e.Sheets[e.SheetNames[i]],t),t);case"wk3":return vu(Jy.book_to_wk3(e,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),vu(db(e,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),QU(e,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return ZU(e,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function t9(e){if(!e.bookType){var r={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType=r[e.bookType]||e.bookType}}function r9(e,r,t){var n=t||{};return n.type="file",n.file=r,t9(n),Cb(e,n)}function n9(e,r,t,n,i,a,o){var s=kt(t),l=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,c=e["!data"]!=null,h=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:t,enumerable:!1})}catch{h.__rowNum__=t}else h.__rowNum__=t;if(!c||e["!data"][t])for(var d=r.s.c;d<=r.e.c;++d){var g=c?(e["!data"][t]||[])[d]:e[n[d]+s];if(g==null||g.t===void 0){if(l===void 0)continue;a[d]!=null&&(h[a[d]]=l);continue}var v=g.v;switch(g.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"b":case"n":if(!g.z||!mo(g.z)||(v=Qo(v),typeof v=="number"))break;case"d":o&&(o.UTC||o.raw===!1)||(v=vs(new Date(v)));break;default:throw new Error("unrecognized type "+g.t)}if(a[d]!=null){if(v==null)if(g.t=="e"&&v===null)h[a[d]]=null;else if(l!==void 0)h[a[d]]=l;else if(u&&v===null)h[a[d]]=null;else continue;else h[a[d]]=(g.t==="n"&&typeof o.rawNumbers=="boolean"?o.rawNumbers:u)?v:Hi(g,v,o);v!=null&&(f=!1)}}return{row:h,isempty:f}}function C0(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},n=0,i=1,a=[],o=0,s="",l={s:{r:0,c:0},e:{r:0,c:0}},u=r||{},f=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":l=Ut(f);break;case"number":l=Ut(e["!ref"]),l.s.r=f;break;default:l=f}n>0&&(i=0);var c=kt(l.s.r),h=[],d=[],g=0,v=0,p=e["!data"]!=null,C=l.s.r,F=0,D={};p&&!e["!data"][C]&&(e["!data"][C]=[]);var ee=u.skipHidden&&e["!cols"]||[],ue=u.skipHidden&&e["!rows"]||[];for(F=l.s.c;F<=l.e.c;++F)if(!(ee[F]||{}).hidden)switch(h[F]=Ot(F),t=p?e["!data"][C][F]:e[h[F]+c],n){case 1:a[F]=F-l.s.c;break;case 2:a[F]=h[F];break;case 3:a[F]=u.header[F-l.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),s=o=Hi(t,null,u),v=D[o]||0,!v)D[o]=1;else{do s=o+"_"+v++;while(D[s]);D[o]=v,D[s]=1}a[F]=s}for(C=l.s.r+i;C<=l.e.r;++C)if(!(ue[C]||{}).hidden){var se=n9(e,l,C,h,n,a,u);(se.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(d[g++]=se.row)}return d.length=g,d}var cw=/"/g;function i9(e,r,t,n,i,a,o,s){for(var l=!0,u=[],f="",c=kt(t),h=e["!data"]!=null,d=h&&e["!data"][t]||[],g=r.s.c;g<=r.e.c;++g)if(n[g]){var v=h?d[g]:e[n[g]+c];if(v==null)f="";else if(v.v!=null){l=!1,f=""+(s.rawNumbers&&v.t=="n"?v.v:Hi(v,null,s));for(var p=0,C=0;p!==f.length;++p)if((C=f.charCodeAt(p))===i||C===a||C===34||s.forceQuotes){f='"'+f.replace(cw,'""')+'"';break}f=="ID"&&(f='"ID"')}else v.f!=null&&!v.F?(l=!1,f="="+v.f,f.indexOf(",")>=0&&(f='"'+f.replace(cw,'""')+'"')):f="";u.push(f)}return s.blankrows===!1&&l?null:u.join(o)}function yg(e,r){var t=[],n=r??{};if(e==null||e["!ref"]==null)return"";for(var i=Ut(e["!ref"]),a=n.FS!==void 0?n.FS:",",o=a.charCodeAt(0),s=n.RS!==void 0?n.RS:`
`,l=s.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),f="",c=[],h=n.skipHidden&&e["!cols"]||[],d=n.skipHidden&&e["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(h[g]||{}).hidden||(c[g]=Ot(g));for(var v=0,p=i.s.r;p<=i.e.r;++p)(d[p]||{}).hidden||(f=i9(e,i,p,c,o,l,a,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&t.push((v++?s:"")+f)));return t.join("")}function Sb(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=yg(e,r);return t}function a9(e){var r="",t,n="";if(e==null||e["!ref"]==null)return[];var i=Ut(e["!ref"]),a="",o=[],s,l=[],u=e["!data"]!=null;for(s=i.s.c;s<=i.e.c;++s)o[s]=Ot(s);for(var f=i.s.r;f<=i.e.r;++f)for(a=kt(f),s=i.s.c;s<=i.e.c;++s)if(r=o[s]+a,t=u?(e["!data"][f]||[])[s]:e[r],n="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;n=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}l[l.length]=r+"="+n}return l}function bb(e,r,t){var n=t||{},i=e?e["!data"]!=null:n.dense,a=+!n.skipHeader,o=e||{};!e&&i&&(o["!data"]=[]);var s=0,l=0;if(o&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var u=typeof n.origin=="string"?Kt(n.origin):n.origin;s=u.r,l=u.c}var f={s:{c:0,r:0},e:{c:l,r:s+r.length-1+a}};if(o["!ref"]){var c=Ut(o["!ref"]);f.e.c=Math.max(f.e.c,c.e.c),f.e.r=Math.max(f.e.r,c.e.r),s==-1&&(s=c.e.r+1,f.e.r=s+r.length-1+a)}else s==-1&&(s=0,f.e.r=r.length-1+a);var h=n.header||[],d=0,g=[];r.forEach(function(p,C){i&&!o["!data"][s+C+a]&&(o["!data"][s+C+a]=[]),i&&(g=o["!data"][s+C+a]),vr(p).forEach(function(F){(d=h.indexOf(F))==-1&&(h[d=h.length]=F);var D=p[F],ee="z",ue="",se=i?"":Ot(l+d)+kt(s+C+a),U=i?g[l+d]:o[se];D&&typeof D=="object"&&!(D instanceof Date)?i?g[l+d]=D:o[se]=D:(typeof D=="number"?ee="n":typeof D=="boolean"?ee="b":typeof D=="string"?ee="s":D instanceof Date?(ee="d",n.UTC||(D=zc(D)),n.cellDates||(ee="n",D=Ur(D)),ue=U!=null&&U.z&&mo(U.z)?U.z:n.dateNF||Wt[14]):D===null&&n.nullError&&(ee="e",D=0),U?(U.t=ee,U.v=D,delete U.w,delete U.R,ue&&(U.z=ue)):i?g[l+d]=U={t:ee,v:D}:o[se]=U={t:ee,v:D},ue&&(U.z=ue))})}),f.e.c=Math.max(f.e.c,l+h.length-1);var v=kt(s);if(i&&!o["!data"][s]&&(o["!data"][s]=[]),a)for(d=0;d<h.length;++d)i?o["!data"][s][d+l]={t:"s",v:h[d]}:o[Ot(d+l)+v]={t:"s",v:h[d]};return o["!ref"]=gr(f),o}function o9(e,r){return bb(null,e,r)}function Gf(e,r,t){if(typeof r=="string"){if(e["!data"]!=null){var n=Kt(r);return e["!data"][n.r]||(e["!data"][n.r]=[]),e["!data"][n.r][n.c]||(e["!data"][n.r][n.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?Gf(e,Qt(r)):Gf(e,Ot(t||0)+kt(r))}function s9(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function l9(e,r){var t={SheetNames:[],Sheets:{}};return e&&wg(t,e,r||"Sheet1"),t}function wg(e,r,t,n){var i=1;if(!t)for(;i<=65535&&e.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(t)>=0){var a=t.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var o=a&&a[1]||t;for(++i;i<=65535&&e.SheetNames.indexOf(t=o+i)!=-1;++i);}if(fb(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function u9(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=s9(e,r);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[n].Hidden=t}function f9(e,r){return e.z=r,e}function xb(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function c9(e,r,t){return xb(e,"#"+r,t)}function h9(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function d9(e,r,t,n){for(var i=typeof r!="string"?r:Ut(r),a=typeof r=="string"?r:gr(r),o=i.s.r;o<=i.e.r;++o)for(var s=i.s.c;s<=i.e.c;++s){var l=Gf(e,o,s);l.t="n",l.F=a,delete l.v,o==i.s.r&&s==i.s.c&&(l.f=t,n&&(l.D=!0))}var u=$r(e["!ref"]);return u.s.r>i.s.r&&(u.s.r=i.s.r),u.s.c>i.s.c&&(u.s.c=i.s.c),u.e.r<i.e.r&&(u.e.r=i.e.r),u.e.c<i.e.c&&(u.e.c=i.e.c),e["!ref"]=gr(u),e}var Wh={encode_col:Ot,encode_row:kt,encode_cell:Qt,encode_range:gr,decode_col:ug,decode_row:lg,split_cell:oB,decode_cell:Kt,decode_range:$r,format_cell:Hi,sheet_new:sB,sheet_add_aoa:TS,sheet_add_json:bb,sheet_add_dom:gb,aoa_to_sheet:Os,json_to_sheet:o9,table_to_sheet:mb,table_to_book:MU,sheet_to_csv:yg,sheet_to_txt:Sb,sheet_to_json:C0,sheet_to_html:vb,sheet_to_formulae:a9,sheet_to_row_object_array:C0,sheet_get_cell:Gf,book_new:l9,book_append_sheet:wg,book_set_sheet_visibility:u9,cell_set_number_format:f9,cell_set_hyperlink:xb,cell_set_internal_link:c9,cell_add_comment:h9,sheet_set_array_formula:d9,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function v9({cells:e,columns:r=10}){const t=e/r,n=Array.from({length:t}).map(()=>Array.from({length:r}).map(()=>"placeholder")),i=Wh.book_new(),a=Wh.json_to_sheet(n);Wh.book_append_sheet(i,a,"Sheet1"),r9(i,`${t}x${r} = ${e}.xlsx`)}const g9=1e3,Eb="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),hw=Array.from({length:g9}).map(()=>Eb.map(()=>null));let dw=-1,vw=-1;function p9(){const[e,r]=Qc.useState(hw),[t,n]=Qc.useState(1e5);return Qc.useEffect(()=>{function i(a){a.key==="v"&&a.metaKey&&(dw=performance.now())}return window.addEventListener("keydown",i),()=>{window.removeEventListener("keydown",i)}},[]),ln.jsxs(ln.Fragment,{children:[ln.jsxs("nav",{children:[ln.jsxs("div",{children:[ln.jsxs("label",{style:{fontSize:14},children:["Number of cells",ln.jsx("input",{type:"number",value:t,onChange:i=>n(+i.target.value)})]}),ln.jsx("button",{style:{marginRight:20},onClick:()=>v9({cells:t}),children:"Generate excel"})]}),ln.jsxs("div",{children:[ln.jsx("button",{onClick:()=>{r(hw),gw()},children:"Clear"}),ln.jsx("button",{onClick:()=>{window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})},children:"Scroll to bottom"}),ln.jsx("button",{onClick:()=>gw(),children:"Back to top"})]})]}),ln.jsx("main",{children:ln.jsx("div",{id:"hot-app",style:{width:"100%",height:"100%"},children:ln.jsx(QC,{data:e,colHeaders:Eb,rowHeaders:!0,stretchH:"all",afterPaste:i=>{r(i);const a=i.length,o=i[0].length,s=a*o;vw=performance.now();const l=vw-dw,u=Math.round(l/1e3*100)/100;console.log(`${a-1} rows x ${o} columns (${s-10} cells)`),console.log(`Time: ${u} seconds

`)}})})})]})}function gw(){window.scrollTo({top:0,behavior:"smooth"})}export{p9 as default};
